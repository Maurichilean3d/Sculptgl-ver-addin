/*! For license information please see sculptgl.js.LICENSE.txt */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.sculptgl=t():e.sculptgl=t()}(self,()=>(()=>{var __webpack_modules__={2(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var gl_matrix__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(827),gl_matrix__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(322),math3d_Geometry__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(693),misc_Tablet__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(142),misc_Utils__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(445),gui_GuiTR__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(865);function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_toPropertyKey(n.key),n)}}function _createClass(e,t,r){return t&&_defineProperties(e.prototype,t),r&&_defineProperties(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function _toPropertyKey(e){var t=_toPrimitive(e,"string");return"symbol"==_typeof(t)?t:t+""}function _toPrimitive(e,t){if("object"!=_typeof(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=_typeof(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}var _TMP_NEAR=[0,0,0],_TMP_NEAR_1=[0,0,0],_TMP_FAR=[0,0,0],_TMP_INV=gl_matrix__WEBPACK_IMPORTED_MODULE_0__.vt(),_TMP_INTER=[0,0,0],_TMP_INTER_1=[0,0,0],_TMP_V1=[0,0,0],_TMP_V2=[0,0,0],_TMP_V3=[0,0,0],Picking=function(){function e(t,r){_classCallCheck(this,e),this._mesh=null,this._main=t,this._pickedFace=-1,this._pickedVertices=[],this._interPoint=[0,0,0],this._rLocal2=0,this._rWorld2=0,this._eyeDir=[0,0,0],this._xSym=!!r,this._pickedNormal=[0,0,0],this._alphaOrigin=[0,0,0],this._alphaSide=0,this._alphaLookAt=gl_matrix__WEBPACK_IMPORTED_MODULE_0__.vt(),this._alpha=null}return _createClass(e,[{key:"setIdAlpha",value:function(t){this._alpha=e.ALPHAS[t]}},{key:"getAlpha",value:function(e,t,r){var n=this._alpha;if(!n||!n._texture)return 1;var i=this._alphaLookAt,a=this._alphaSide,o=n._ratioY*(i[0]*e+i[4]*t+i[8]*r+i[12])/(this._xSym?-a:a);if(Math.abs(o)>1)return 0;var s=n._ratioX*(i[1]*e+i[5]*t+i[9]*r+i[13])/a;if(Math.abs(s)>1)return 0;var l=n._width;return o=(.5-.5*o)*l,s=(.5-.5*s)*n._height,n._texture[(0|o)+l*(0|s)]/255}},{key:"updateAlpha",value:function(e){var t=_TMP_V1,r=_TMP_V2,n=Math.sqrt(this._rLocal2);if(this._alphaSide=n*Math.SQRT1_2,gl_matrix__WEBPACK_IMPORTED_MODULE_1__.jb(t,this._interPoint,this._alphaOrigin),0!==gl_matrix__WEBPACK_IMPORTED_MODULE_1__.Il(t)){gl_matrix__WEBPACK_IMPORTED_MODULE_1__.S8(t,t);var i=this._pickedNormal;gl_matrix__WEBPACK_IMPORTED_MODULE_1__.Ln(t,t,i,-gl_matrix__WEBPACK_IMPORTED_MODULE_1__.Om(t,i)),gl_matrix__WEBPACK_IMPORTED_MODULE_1__.S8(t,t),e||gl_matrix__WEBPACK_IMPORTED_MODULE_1__.C(this._alphaOrigin,this._interPoint),gl_matrix__WEBPACK_IMPORTED_MODULE_1__.Ln(r,this._alphaOrigin,i,n),gl_matrix__WEBPACK_IMPORTED_MODULE_0__.t5(this._alphaLookAt,this._alphaOrigin,r,t)}}},{key:"initAlpha",value:function(){this.computePickedNormal(),this.updateAlpha()}},{key:"getMesh",value:function(){return this._mesh}},{key:"setLocalRadius2",value:function(e){this._rLocal2=e}},{key:"getLocalRadius2",value:function(){return this._rLocal2}},{key:"getLocalRadius",value:function(){return Math.sqrt(this._rLocal2)}},{key:"getWorldRadius2",value:function(){return this._rWorld2}},{key:"getWorldRadius",value:function(){return Math.sqrt(this._rWorld2)}},{key:"setIntersectionPoint",value:function(e){this._interPoint=e}},{key:"getEyeDirection",value:function(){return this._eyeDir}},{key:"getIntersectionPoint",value:function(){return this._interPoint}},{key:"getPickedVertices",value:function(){return this._pickedVertices}},{key:"getPickedFace",value:function(){return this._pickedFace}},{key:"getPickedNormal",value:function(){return this._pickedNormal}},{key:"intersectionMouseMeshes",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._main.getMeshes(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._main._mouseX,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._main._mouseY,n=this.unproject(t,r,0),i=this.unproject(t,r,.1),a=1/0,o=null,s=-1,l=0,u=e.length;l<u;++l){var c=e[l];if(c.isVisible()&&(gl_matrix__WEBPACK_IMPORTED_MODULE_0__.B8(_TMP_INV,c.getMatrix()),gl_matrix__WEBPACK_IMPORTED_MODULE_1__.Z0(_TMP_NEAR_1,n,_TMP_INV),gl_matrix__WEBPACK_IMPORTED_MODULE_1__.Z0(_TMP_FAR,i,_TMP_INV),this.intersectionRayMesh(c,_TMP_NEAR_1,_TMP_FAR))){var h=this.getIntersectionPoint(),f=gl_matrix__WEBPACK_IMPORTED_MODULE_1__.xg(_TMP_NEAR_1,h)*c.getScale();f<a&&(a=f,o=c,gl_matrix__WEBPACK_IMPORTED_MODULE_1__.C(_TMP_INTER_1,h),s=this.getPickedFace())}}return this._mesh=o,gl_matrix__WEBPACK_IMPORTED_MODULE_1__.C(this._interPoint,_TMP_INTER_1),this._pickedFace=s,-1!==s&&this.updateLocalAndWorldRadius2(),!!o}},{key:"intersectionMouseMesh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this._main.getMesh(),t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this._main._mouseX,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this._main._mouseY,n=this.unproject(t,r,0),i=this.unproject(t,r,.1),a=gl_matrix__WEBPACK_IMPORTED_MODULE_0__.vt();return gl_matrix__WEBPACK_IMPORTED_MODULE_0__.B8(a,e.getMatrix()),gl_matrix__WEBPACK_IMPORTED_MODULE_1__.Z0(n,n,a),gl_matrix__WEBPACK_IMPORTED_MODULE_1__.Z0(i,i,a),this.intersectionRayMesh(e,n,i)}},{key:"intersectionRayMesh",value:function(e,t,r){if(this._mesh=null,this._pickedFace=-1,gl_matrix__WEBPACK_IMPORTED_MODULE_1__.C(_TMP_NEAR,t),gl_matrix__WEBPACK_IMPORTED_MODULE_1__.C(_TMP_FAR,r),this._xSym){var n=e.getSymmetryOrigin(),i=e.getSymmetryNormal();math3d_Geometry__WEBPACK_IMPORTED_MODULE_2__.A.mirrorPoint(_TMP_NEAR,n,i),math3d_Geometry__WEBPACK_IMPORTED_MODULE_2__.A.mirrorPoint(_TMP_FAR,n,i)}var a=e.getVertices(),o=e.getFaces(),s=this.getEyeDirection();gl_matrix__WEBPACK_IMPORTED_MODULE_1__.jb(s,_TMP_FAR,_TMP_NEAR),gl_matrix__WEBPACK_IMPORTED_MODULE_1__.S8(s,s);for(var l=e.intersectRay(_TMP_NEAR,s),u=1/0,c=l.length,h=0;h<c;++h){var f=4*l[h],d=3*o[f],p=3*o[f+1],_=3*o[f+2];_TMP_V1[0]=a[d],_TMP_V1[1]=a[d+1],_TMP_V1[2]=a[d+2],_TMP_V2[0]=a[p],_TMP_V2[1]=a[p+1],_TMP_V2[2]=a[p+2],_TMP_V3[0]=a[_],_TMP_V3[1]=a[_+1],_TMP_V3[2]=a[_+2];var g=math3d_Geometry__WEBPACK_IMPORTED_MODULE_2__.A.intersectionRayTriangle(_TMP_NEAR,s,_TMP_V1,_TMP_V2,_TMP_V3,_TMP_INTER);g<0&&(p=o[f+3])!==misc_Utils__WEBPACK_IMPORTED_MODULE_4__.A.TRI_INDEX&&(p*=3,_TMP_V2[0]=a[p],_TMP_V2[1]=a[p+1],_TMP_V2[2]=a[p+2],g=math3d_Geometry__WEBPACK_IMPORTED_MODULE_2__.A.intersectionRayTriangle(_TMP_NEAR,s,_TMP_V1,_TMP_V3,_TMP_V2,_TMP_INTER)),g>=0&&g<u&&(u=g,gl_matrix__WEBPACK_IMPORTED_MODULE_1__.C(this._interPoint,_TMP_INTER),this._pickedFace=l[h])}return-1!==this._pickedFace?(this._mesh=e,this.updateLocalAndWorldRadius2(),!0):(this._rLocal2=0,!1)}},{key:"pickVerticesInSphere",value:function(e){for(var t=this._mesh,r=t.getVertices(),n=t.getVerticesSculptFlags(),i=this.getIntersectionPoint(),a=t.intersectSphere(i,e,!0),o=t.getVerticesFromFaces(a),s=o.length,l=++misc_Utils__WEBPACK_IMPORTED_MODULE_4__.A.SCULPT_FLAG,u=new Uint32Array(misc_Utils__WEBPACK_IMPORTED_MODULE_4__.A.getMemory(4*s),0,s),c=0,h=i[0],f=i[1],d=i[2],p=0;p<s;++p){var _=o[p],g=3*_,m=h-r[g],v=f-r[g+1],y=d-r[g+2];m*m+v*v+y*y<e&&(n[_]=l,u[c++]=_)}return this._pickedVertices=new Uint32Array(u.subarray(0,c)),this._pickedVertices}},{key:"_isInsideSphere",value:function(e,t,r){if(e===misc_Utils__WEBPACK_IMPORTED_MODULE_4__.A.TRI_INDEX)return!1;var n=3*e;return gl_matrix__WEBPACK_IMPORTED_MODULE_1__.lo(t,this._mesh.getVertices().subarray(n,n+3))<=r}},{key:"pickVerticesInSphereTopological",value:function(e){var t=this._mesh,r=t.getNbVertices(),n=t.getVertices(),i=t.getFaces(),a=t.getVerticesRingVertStartCount(),o=t.getVerticesRingVert(),s=o instanceof Array?o:null,l=t.getVerticesSculptFlags(),u=t.getVerticesTagFlags(),c=++misc_Utils__WEBPACK_IMPORTED_MODULE_4__.A.SCULPT_FLAG,h=++misc_Utils__WEBPACK_IMPORTED_MODULE_4__.A.TAG_FLAG,f=this.getIntersectionPoint(),d=f[0],p=f[1],_=f[2],g=new Uint32Array(misc_Utils__WEBPACK_IMPORTED_MODULE_4__.A.getMemory(4*r),0,r),m=4*this.getPickedFace(),v=1;this._isInsideSphere(i[m],f,e)?g[0]=i[m]:this._isInsideSphere(i[m+1],f,e)?g[0]=i[m+1]:this._isInsideSphere(i[m+2],f,e)?g[0]=i[m+2]:this._isInsideSphere(i[m+3],f,e)?g[0]=i[m+3]:v=0,1===v&&(l[g[0]]=c,u[g[0]]=h);for(var y=0;y<v;++y){var b,A,T=g[y];s?(b=0,A=(o=s[T]).length):A=(b=a[2*T])+a[2*T+1];for(var S=b;S<A;++S){var w=o[S];if(u[w]!==h){u[w]=h;var M=3*w,k=d-n[M],E=p-n[M+1],x=_-n[M+2];k*k+E*E+x*x>e||(l[w]=c,g[v++]=w)}}}return this._pickedVertices=new Uint32Array(g.subarray(0,v)),this._pickedVertices}},{key:"computeWorldRadius2",value:function(e){gl_matrix__WEBPACK_IMPORTED_MODULE_1__.Z0(_TMP_INTER,this.getIntersectionPoint(),this._mesh.getMatrix());var t=this._main.getSculptManager().getCurrentTool().getScreenRadius();e||(t*=misc_Tablet__WEBPACK_IMPORTED_MODULE_3__.A.getPressureRadius());var r=this.project(_TMP_INTER);return gl_matrix__WEBPACK_IMPORTED_MODULE_1__.lo(_TMP_INTER,this.unproject(r[0]+t,r[1],r[2]))}},{key:"updateLocalAndWorldRadius2",value:function(){this._mesh&&(this._rWorld2=this.computeWorldRadius2(),this._rLocal2=this._rWorld2/this._mesh.getScale2())}},{key:"unproject",value:function(e,t,r){return this._main.getCamera().unproject(e,t,r)}},{key:"project",value:function(e){return this._main.getCamera().project(e)}},{key:"computePickedNormal",value:function(){if(this._mesh&&!(this._pickedFace<0))return this.polyLerp(this._mesh.getNormals(),this._pickedNormal),gl_matrix__WEBPACK_IMPORTED_MODULE_1__.S8(this._pickedNormal,this._pickedNormal)}},{key:"polyLerp",value:function(e,t){var r=this._mesh.getVertices(),n=this._mesh.getFaces(),i=4*this._pickedFace,a=3*n[i],o=3*n[i+1],s=3*n[i+2],l=n[i+3],u=l!==misc_Utils__WEBPACK_IMPORTED_MODULE_4__.A.TRI_INDEX;u&&(l*=3);var c=1/gl_matrix__WEBPACK_IMPORTED_MODULE_1__.xg(this._interPoint,r.subarray(a,a+3)),h=1/gl_matrix__WEBPACK_IMPORTED_MODULE_1__.xg(this._interPoint,r.subarray(o,o+3)),f=1/gl_matrix__WEBPACK_IMPORTED_MODULE_1__.xg(this._interPoint,r.subarray(s,s+3)),d=u?1/gl_matrix__WEBPACK_IMPORTED_MODULE_1__.xg(this._interPoint,r.subarray(l,l+3)):0,p=1/(c+h+f+d);return gl_matrix__WEBPACK_IMPORTED_MODULE_1__.hZ(t,0,0,0),gl_matrix__WEBPACK_IMPORTED_MODULE_1__.Ln(t,t,e.subarray(a,a+3),c*p),gl_matrix__WEBPACK_IMPORTED_MODULE_1__.Ln(t,t,e.subarray(o,o+3),h*p),gl_matrix__WEBPACK_IMPORTED_MODULE_1__.Ln(t,t,e.subarray(s,s+3),f*p),u&&gl_matrix__WEBPACK_IMPORTED_MODULE_1__.Ln(t,t,e.subarray(l,l+3),d*p),t}}],[{key:"addAlpha",value:function(t,r,n,i){var a={};a._name=i,a._texture=t,a._ratioX=Math.max(1,r/n),a._ratioY=Math.max(1,n/r),a._ratioMax=Math.max(a._ratioX,a._ratioY),a._width=r,a._height=n;for(var o=1;e.ALPHAS[a._name];)a._name=i+o++;return e.ALPHAS[a._name]=a,e.ALPHAS_NAMES[a._name]=a._name,a}}]),e}();Picking.INIT_ALPHAS_NAMES=[(0,gui_GuiTR__WEBPACK_IMPORTED_MODULE_5__.A)("alphaSquare"),(0,gui_GuiTR__WEBPACK_IMPORTED_MODULE_5__.A)("alphaSkin")],Picking.INIT_ALPHAS_PATHS=["square.jpg","skin.jpg"];var readAlphas=function readAlphas(){if(window.module&&window.module.exports){var fs=eval("require")("fs"),path=eval("require")("path"),directoryPath=path.join(window.__filename,"../resources/alpha");fs.readdir(directoryPath,function(e,t){if(!e)for(var r=0;r<t.length;++r){var n=t[r];"square.jpg"!=n&&"skin.jpg"!=n&&(Picking.INIT_ALPHAS_NAMES.push(n),Picking.INIT_ALPHAS_PATHS.push(n))}})}};readAlphas();var none=(0,gui_GuiTR__WEBPACK_IMPORTED_MODULE_5__.A)("alphaNone");Picking.ALPHAS_NAMES={},Picking.ALPHAS_NAMES[none]=none,Picking.ALPHAS={},Picking.ALPHAS[none]=null;const __WEBPACK_DEFAULT_EXPORT__=Picking},61(){if(window.Map||(window.Map=function(){this.map={}},window.Map.prototype={set:function(e,t){this.map[e]=t},get:function(e){return this.map[e]}}),!Float32Array.prototype.slice){var e=function(e,t){return new this.constructor(this.subarray(e,t))};Int8Array.prototype.slice=e,Uint8Array.prototype.slice=e,Uint8ClampedArray.prototype.slice=e,Int16Array.prototype.slice=e,Uint16Array.prototype.slice=e,Int32Array.prototype.slice=e,Uint32Array.prototype.slice=e,Float32Array.prototype.slice=e,Float64Array.prototype.slice=e}String.prototype.endsWith||(String.prototype.endsWith=function(e){return this.slice(-e.length)===e}),String.prototype.startsWith||(String.prototype.startsWith=function(e){return this.slice(0,e.length)===e});for(var t=["moz","webkit"],r=0;r<t.length&&!window.requestAnimationFrame;++r)window.requestAnimationFrame=window[t[r]+"RequestAnimationFrame"];window.requestAnimationFrame||window.alert("browser is too old. Probably no webgl there anyway")},142(e,t,r){"use strict";r.d(t,{A:()=>i});var n={radiusFactor:.75,intensityFactor:0,pressure:.5,pointerType:"mouse",mouseX:0,mouseY:0,getPressureIntensity:function(){return 1+n.intensityFactor*(2*n.pressure-1)},getPressureRadius:function(){return 1+n.radiusFactor*(2*n.pressure-1)}};const i=n},241(module,exports,__webpack_require__){var __WEBPACK_AMD_DEFINE_FACTORY__,__WEBPACK_AMD_DEFINE_ARRAY__,__WEBPACK_AMD_DEFINE_RESULT__,factory;function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}module=__webpack_require__.nmd(module),window,factory=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===_typeof(e)&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s="./src/yagui.js")}({"./src/GuiMain.js":function srcGuiMainJs(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var containers_Sidebar__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! containers/Sidebar */ \"./src/containers/Sidebar.js\");\n/* harmony import */ var containers_Topbar__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! containers/Topbar */ \"./src/containers/Topbar.js\");\n\n\n\nclass GuiMain {\n\n  constructor(viewport, callbackResize) {\n    this.domMain = document.createElement('div');\n    this.viewport = viewport;\n\n    this.callbackResize = callbackResize;\n    if (this.viewport) {\n      this.viewport.style.width = document.documentElement.clientWidth + 'px';\n      this.viewport.style.height = document.documentElement.clientHeight + 'px';\n    }\n    this.cbResize_ = this._onWindowResize.bind(this);\n\n    document.body.appendChild(this.domMain);\n    this.leftSidebar = undefined;\n    this.rightSidebar = undefined;\n    this.topbar = undefined;\n\n    window.addEventListener('resize', this._onWindowResize.bind(this), false);\n  }\n\n  _onWindowResize() {\n    if (this.viewport) {\n      this.viewport.style.width = document.documentElement.clientWidth + 'px';\n      this.viewport.style.height = document.documentElement.clientHeight + 'px';\n      this.viewport.style.left = '0px';\n      this.viewport.style.top = '0px';\n      if (this.leftSidebar)\n        this.leftSidebar._updateViewportPosition(this.viewport);\n      if (this.rightSidebar)\n        this.rightSidebar._updateViewportPosition(this.viewport);\n      if (this.topbar)\n        this.topbar._updateViewportPosition(this.viewport);\n    }\n    this._updateSidebarsPosition();\n    if (this.callbackResize)\n      this.callbackResize();\n  }\n\n  _updateSidebarsPosition() {\n    if (!this.topbar) return;\n    var off = this.topbar.domTopbar.offsetHeight;\n    if (this.leftSidebar)\n      this.leftSidebar._setTop(off);\n    if (this.rightSidebar)\n      this.rightSidebar._setTop(off);\n  }\n\n  addLeftSidebar() {\n    this.leftSidebar = new containers_Sidebar__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.cbResize_);\n    var domSide = this.leftSidebar.domSidebar;\n    this.domMain.appendChild(domSide);\n    this.domMain.appendChild(this.leftSidebar.domResize);\n\n    this._updateSidebarsPosition();\n    this.leftSidebar._updateViewportPosition(this.viewport);\n    return this.leftSidebar;\n  }\n\n  addRightSidebar() {\n    this.rightSidebar = new containers_Sidebar__WEBPACK_IMPORTED_MODULE_0__[\"default\"](this.cbResize_);\n    var domSide = this.rightSidebar.domSidebar;\n    this.domMain.appendChild(domSide);\n    this.domMain.appendChild(this.rightSidebar.domResize);\n\n    this.rightSidebar._onTheRight();\n    this._updateSidebarsPosition();\n    this.rightSidebar._updateViewportPosition(this.viewport);\n    return this.rightSidebar;\n  }\n\n  addTopbar() {\n    this.topbar = new containers_Topbar__WEBPACK_IMPORTED_MODULE_1__[\"default\"](this.cbResize_);\n    this.domMain.appendChild(this.topbar.domTopbar);\n\n    this._updateSidebarsPosition();\n    this.topbar._updateViewportPosition(this.viewport);\n    return this.topbar;\n  }\n\n  setVisibility(visible) {\n    this.domMain.hidden = !visible;\n    this._onWindowResize();\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (GuiMain);\n\n\n//# sourceURL=webpack://yagui/./src/GuiMain.js?")},"./src/containers/BaseContainer.js":function srcContainersBaseContainerJs(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var widgets_Button__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! widgets/Button */ "./src/widgets/Button.js");\n/* harmony import */ var widgets_Checkbox__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! widgets/Checkbox */ "./src/widgets/Checkbox.js");\n/* harmony import */ var widgets_Color__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! widgets/Color */ "./src/widgets/Color.js");\n/* harmony import */ var widgets_Combobox__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! widgets/Combobox */ "./src/widgets/Combobox.js");\n/* harmony import */ var widgets_Slider__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! widgets/Slider */ "./src/widgets/Slider.js");\n/* harmony import */ var widgets_Title__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! widgets/Title */ "./src/widgets/Title.js");\n\n\n\n\n\n\n\n// label : 36%\n// slider : bar 52% + margin 2% + input 10%\n// combobox : 64%\n// color : 64%\nclass BaseContainer {\n\n  constructor() {}\n\n  _addLine(name) {\n    var domLine = document.createElement(\'li\');\n    domLine.innerHTML = name || \'\';\n    this.domUl.appendChild(domLine);\n    return domLine;\n  }\n\n  _createLabel(name) {\n    var domLabel = document.createElement(\'label\');\n    domLabel.className = \'gui-label-side\';\n    domLabel.innerHTML = name || \'\';\n    return domLabel;\n  }\n\n  _setDomContainer(container) {\n    this.domContainer = container;\n  }\n\n  addTitle(name) {\n    var widget = new widgets_Title__WEBPACK_IMPORTED_MODULE_5__["default"](name);\n    this.domUl.appendChild(widget.domText);\n    return widget;\n  }\n\n  addCheckbox(name, valOrObject, callbackOrKey) {\n    var widget = new widgets_Checkbox__WEBPACK_IMPORTED_MODULE_1__["default"](valOrObject, callbackOrKey);\n    var domLine = this._addLine();\n    domLine.className += \' gui-pointerOnHover gui-glowOnHover\';\n    var domLabel = this._createLabel(name);\n    domLabel.style.overflow = \'visible\';\n    domLabel.className += \' gui-pointerOnHover\';\n    domLine.appendChild(domLabel);\n    domLine.appendChild(widget.domCheckbox);\n    domLine.appendChild(widget.domLabelCheckbox);\n    domLine.addEventListener(\'mousedown\', widget._onMouseDown.bind(widget));\n    widget._setDomContainer(domLine);\n    return widget;\n  }\n\n  addCombobox(name, valOrObject, callbackOrKey, options) {\n    var widget = new widgets_Combobox__WEBPACK_IMPORTED_MODULE_3__["default"](valOrObject, callbackOrKey, options);\n    var domLine = this._addLine();\n    if (name) domLine.appendChild(this._createLabel(name));\n    else widget.domSelect.style.width = \'100%\';\n    domLine.appendChild(widget.domSelect);\n    widget._setDomContainer(domLine);\n    return widget;\n  }\n\n  addSlider(name, valOrObject, callbackOrKey, min, max, step) {\n    var widget = new widgets_Slider__WEBPACK_IMPORTED_MODULE_4__["default"](valOrObject, callbackOrKey, min, max, step);\n    var domLine = this._addLine();\n    if (name) domLine.appendChild(this._createLabel(name));\n    domLine.appendChild(widget.domInputText);\n    domLine.appendChild(widget.domSlider);\n    widget._setDomContainer(domLine);\n    return widget;\n  }\n\n  addColor(name, valOrObject, callbackOrKey) {\n    var widget = new widgets_Color__WEBPACK_IMPORTED_MODULE_2__["default"](valOrObject, callbackOrKey);\n    var domLine = this._addLine();\n    if (name) domLine.appendChild(this._createLabel(name));\n    else widget.domColor.style.width = \'100%\';\n    domLine.appendChild(widget.domColor);\n    widget._setDomContainer(domLine);\n    return widget;\n  }\n\n  addButton(name, callbackOrObject, key) {\n    var widget = new widgets_Button__WEBPACK_IMPORTED_MODULE_0__["default"](name, callbackOrObject, key);\n    var domLine = this._addLine();\n    domLine.appendChild(widget.domButton);\n    widget._setDomContainer(domLine);\n    return widget;\n  }\n\n  addDualButton(name1, name2, callbackOrObject1, callbackOrObject2, key1, key2) {\n    var widget1 = new widgets_Button__WEBPACK_IMPORTED_MODULE_0__["default"](name1, callbackOrObject1, key1);\n    var widget2 = new widgets_Button__WEBPACK_IMPORTED_MODULE_0__["default"](name2, callbackOrObject2, key2);\n    var domLine = this._addLine();\n    domLine.appendChild(widget2.domButton);\n    domLine.appendChild(widget1.domButton);\n    var style1 = widget1.domButton.style;\n    var style2 = widget2.domButton.style;\n    style1.width = style2.width = \'49%\';\n    style1.marginRight = style2.marginLeft = \'1%\';\n    widget1._setDomContainer(domLine);\n    widget2._setDomContainer(domLine);\n    return [widget1, widget2];\n  }\n\n  setVisibility(visible) {\n    if (!this.domContainer) return;\n    this.domContainer.hidden = !visible;\n  }\n}\n\n/* harmony default export */ __webpack_exports__["default"] = (BaseContainer);\n\n\n//# sourceURL=webpack://yagui/./src/containers/BaseContainer.js?')},"./src/containers/Folder.js":function srcContainersFolderJs(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var containers_BaseContainer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! containers/BaseContainer */ \"./src/containers/BaseContainer.js\");\n\n\nclass Folder extends containers_BaseContainer__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n\n  constructor(name) {\n    super();\n\n    this.domUl = document.createElement('ul');\n    this.domUl.setAttribute('opened', true);\n\n    var domTitle = document.createElement('label');\n    domTitle.innerHTML = name || '';\n\n    domTitle.addEventListener('mousedown', this._onMouseDown.bind(this));\n\n    this.domUl.appendChild(domTitle);\n    this.isOpen = true;\n  }\n\n  _onMouseDown() {\n    this.isOpen = !this.isOpen;\n    this.domUl.setAttribute('opened', this.isOpen);\n  }\n\n  open() {\n    this.isOpen = true;\n    this.domUl.setAttribute('opened', true);\n  }\n\n  close() {\n    this.isOpen = false;\n    this.domUl.setAttribute('opened', false);\n  }\n\n  setVisibility(visible) {\n    if (!visible) this.domUl.setAttribute('opened', false);\n    else if (this.isOpen) this.domUl.setAttribute('opened', true);\n    this.domUl.style.height = visible ? 'auto' : '0px';\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Folder);\n\n\n//# sourceURL=webpack://yagui/./src/containers/Folder.js?")},"./src/containers/Menu.js":function srcContainersMenuJs(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var containers_BaseContainer__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! containers/BaseContainer */ "./src/containers/BaseContainer.js");\n/* harmony import */ var widgets_MenuButton__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! widgets/MenuButton */ "./src/widgets/MenuButton.js");\n\n\n\nclass Menu extends containers_BaseContainer__WEBPACK_IMPORTED_MODULE_0__["default"] {\n\n  constructor() {\n    super();\n\n    this.domUl = document.createElement(\'ul\');\n  }\n\n  addButton(name, callbackOrObject, shortcutOrKey, shortcut) {\n    var widget = new widgets_MenuButton__WEBPACK_IMPORTED_MODULE_1__["default"](callbackOrObject, shortcutOrKey, shortcut);\n    var domLine = this._addLine(name);\n    domLine.appendChild(widget.domSpan);\n    widget._setDomContainer(domLine);\n    return widget;\n  }\n\n  addSlider(name, valOrObject, callbackOrKey, min, max, step) {\n    var wid = super.addSlider(name, valOrObject, callbackOrKey, min, max, step);\n    // label 36% + slider ?% + 2% + input 18%\n    wid.domInputText.style.width = \'18%\';\n    wid.domSlider.style.width = name ? \'44%\' : \'80%\';\n    return wid;\n  }\n}\n\n/* harmony default export */ __webpack_exports__["default"] = (Menu);\n\n\n//# sourceURL=webpack://yagui/./src/containers/Menu.js?')},"./src/containers/Sidebar.js":function srcContainersSidebarJs(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var containers_Folder__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! containers/Folder */ \"./src/containers/Folder.js\");\n\n\nclass Sidebar {\n\n  constructor(callbackResize) {\n    this.domSidebar = document.createElement('div');\n    this.domSidebar.className = 'gui-sidebar';\n\n    this.domResize = document.createElement('div');\n    this.domResize.className = 'gui-resize';\n\n    this.isDragging = false;\n    this.mouseX = 0;\n    this.domResize.addEventListener('mousedown', this._onMouseDown.bind(this));\n    window.addEventListener('mousemove', this._onMouseMove.bind(this));\n    window.addEventListener('mouseup', this._onMouseUp.bind(this));\n\n    this.callbackResize = callbackResize;\n    this.isOnTheRight = false;\n  }\n\n  _setTop(nb) {\n    this.domSidebar.style.top = this.domResize.style.top = nb + 'px';\n  }\n\n  _onTheRight() {\n    this.isOnTheRight = true;\n    this.domSidebar.style.right = 0;\n    this.domSidebar.style.borderRight = 0;\n    this.domSidebar.style.borderLeft = 'double';\n    this.domSidebar.style.borderColor = 'rgba(255,255,255,0.3)';\n    this.domResize.style.left = 'auto';\n    this.domResize.style.right = this.domSidebar.offsetWidth + 'px';\n    this.domResize.style.marginRight = '-3px';\n  }\n\n  _onMouseDown(ev) {\n    this.isDragging = true;\n    this.mouseX = ev.clientX;\n  }\n\n  _updateViewportPosition(viewport) {\n    var w = this.domSidebar.hidden ? 0 : this.domSidebar.offsetWidth;\n    if (this.isOnTheRight) {\n      viewport.style.width = (viewport.clientWidth - w) + 'px';\n    } else {\n      viewport.style.left = (this.domSidebar.offsetLeft + w) + 'px';\n      viewport.style.width = (viewport.clientWidth - w) + 'px';\n    }\n  }\n\n  _onMouseMove(ev) {\n    if (this.isDragging === false) return;\n    var mouseX = ev.clientX;\n    var delta = mouseX - this.mouseX;\n    if (this.isOnTheRight) delta = -delta;\n    var widthBar = Math.max(50, this.domSidebar.offsetWidth + delta);\n\n    var val = widthBar + 'px';\n    this.domSidebar.style.width = val;\n    if (this.isOnTheRight) this.domResize.style.right = this.domSidebar.offsetWidth + 'px';\n    else this.domResize.style.left = val;\n\n    this.mouseX = mouseX;\n    this.callbackResize();\n  }\n\n  _onMouseUp() {\n    this.isDragging = false;\n  }\n\n  addMenu(name) {\n    var folder = new containers_Folder__WEBPACK_IMPORTED_MODULE_0__[\"default\"](name);\n    this.domSidebar.appendChild(folder.domUl);\n    return folder;\n  }\n\n  setVisibility(visible) {\n    this.domSidebar.hidden = !visible;\n    this.domResize.hidden = !visible;\n    this.callbackResize();\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Sidebar);\n\n\n//# sourceURL=webpack://yagui/./src/containers/Sidebar.js?")},"./src/containers/Topbar.js":function srcContainersTopbarJs(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var containers_Menu__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! containers/Menu */ "./src/containers/Menu.js");\n/* harmony import */ var utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! utils/EditStyle */ "./src/utils/EditStyle.js");\n\n\n\nclass Topbar {\n\n  constructor(callbackResize) {\n    this.domTopbar = document.createElement(\'div\');\n    this.domTopbar.className = \'gui-topbar\';\n\n    this.domUl = document.createElement(\'ul\');\n    this.domTopbar.appendChild(this.domUl);\n\n    this.callbackResize = callbackResize;\n    this.uiExtra = {};\n  }\n\n  _updateViewportPosition(viewport) {\n    var h = this.domTopbar.hidden ? 0 : this.domTopbar.offsetHeight;\n    viewport.style.top = h + \'px\';\n    viewport.style.height = (viewport.clientHeight - h) + \'px\';\n  }\n\n  _onChangeColor(callback, color) {\n    callback(color);\n    this.uiExtra.overallColor.setValue(utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__["default"]._curWidgetColor, true);\n    this.uiExtra.widgetColor.setValue(utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__["default"]._curWidgetColor, true);\n    this.uiExtra.backColor.setValue(utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__["default"]._curBackgroundColor, true);\n    this.uiExtra.textColor.setValue(utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__["default"]._curTextColor, true);\n  }\n\n  addMenu(name) {\n    var menu = new containers_Menu__WEBPACK_IMPORTED_MODULE_0__["default"]();\n    var li = document.createElement(\'li\');\n    li.setAttribute(\'onclick\', \'void(0)\'); // iOS trick to trigger click on hover\n    li.innerHTML = name || \'\';\n    this.domUl.appendChild(li);\n    li.appendChild(menu.domUl);\n    menu._setDomContainer(li);\n    return menu;\n  }\n\n  addExtra() {\n    var cb = this._onChangeColor;\n    var menu = this.addMenu(\'Extra UI\');\n    var ext = this.uiExtra;\n    menu.addTitle(\'Overall\');\n    ext.overallColor = menu.addColor(\'\', utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__["default"]._curWidgetColor, cb.bind(this, utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__["default"].changeOverallColor));\n\n    menu.addTitle(\'Advanced\');\n    ext.widgetColor = menu.addColor(\'Widget\', utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__["default"]._curWidgetColor, cb.bind(this, utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__["default"].changeWidgetsColor));\n    ext.backColor = menu.addColor(\'Back\', utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__["default"]._curBackgroundColor, cb.bind(this, utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__["default"].changeBackgroundColor));\n    ext.textColor = menu.addColor(\'Text\', utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__["default"]._curTextColor, cb.bind(this, utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__["default"].changeTextColor));\n    ext.showBorder = menu.addCheckbox(\'Border\', utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__["default"]._curShowBorder, utils_EditStyle__WEBPACK_IMPORTED_MODULE_1__["default"].changeDisplayBoorder);\n    return menu;\n  }\n\n  setVisibility(visible) {\n    this.domTopbar.hidden = !visible;\n    this.callbackResize();\n  }\n}\n\n/* harmony default export */ __webpack_exports__["default"] = (Topbar);\n\n\n//# sourceURL=webpack://yagui/./src/containers/Topbar.js?')},"./src/utils/EditStyle.js":function srcUtilsEditStyleJs(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/GuiUtils */ \"./src/utils/GuiUtils.js\");\n\n\nvar EditStyle = {};\n\nEditStyle.refRules = {};\n\nvar yaguiSheet;\nvar findSheet = function () {\n  if (yaguiSheet) return yaguiSheet;\n  var sheets = document.styleSheets;\n  for (var i = 0, nb = sheets.length; i < nb; ++i) {\n    var href = sheets[i].href;\n    if (href && href.indexOf('yagui.css') !== -1) {\n      yaguiSheet = sheets[i];\n      return yaguiSheet;\n    }\n  }\n  return;\n};\n\nvar editStyle = function (selector, key, value) {\n  var sheet = findSheet();\n  if (!sheet)\n    return;\n  var rules = sheet.cssRules || sheet.rules;\n  var rule = EditStyle.refRules[selector];\n  if (!rule) {\n    var i = 0;\n    var len = rules.length;\n    for (i = 0; i < len; ++i) {\n      if (rules[i].selectorText === selector) break;\n    }\n    if (i === len) return false;\n    rule = EditStyle.refRules[selector] = rules[i];\n  }\n  if (rule)\n    rule.style[key] = value;\n};\n\nEditStyle.changeWidgetsColor = function (color) {\n  var str = utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getStrColor(color);\n  // button\n  editStyle('.gui-button', 'background', str);\n  // select\n  editStyle('.gui-select', 'background', str);\n  // slider\n  editStyle('.gui-slider > div', 'background', str);\n  EditStyle._curWidgetColor = color;\n};\n\nEditStyle.changeDisplayBoorder = function (bool) {\n  var str = bool ? '1px solid #000' : '0';\n  editStyle('.gui-button', 'border', str);\n  // select\n  editStyle('.gui-select', 'border', str);\n  // slider\n  editStyle('.gui-slider', 'border', str);\n  editStyle('.gui-input-number', 'border', str);\n  // folder\n  editStyle('.gui-sidebar > ul > label', 'borderTop', str);\n  editStyle('.gui-sidebar > ul > label', 'borderBottom', str);\n  // side bar\n  editStyle('.gui-sidebar', 'borderLeft', str);\n  editStyle('.gui-sidebar', 'borderRight', str);\n  // top bar\n  editStyle('.gui-topbar', 'borderBottom', str);\n  EditStyle._curShowBorder = bool;\n};\n\nEditStyle.changeBackgroundColor = function (color) {\n  // side bar\n  editStyle('.gui-sidebar', 'background', utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getStrColor(color));\n  // top bar\n  var colTop = utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getStrColor(utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getColorMult(color, 0.5));\n  editStyle('.gui-topbar', 'background', colTop);\n  editStyle('.gui-topbar ul > li > ul', 'background', colTop);\n  EditStyle._curBackgroundColor = color;\n};\n\nEditStyle.changeTextColor = function (color) {\n  var strColor = utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getStrColor(color);\n  editStyle('*', 'color', strColor);\n  editStyle('.gui-sidebar > ul > label', 'color', strColor);\n  EditStyle._curTextColor = color;\n};\n\nEditStyle.changeOverallColor = function (color) {\n  EditStyle.changeWidgetsColor(color);\n  var bgCol = utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getColorMult(color, 0.5);\n  bgCol.length = 3;\n  EditStyle.changeBackgroundColor(bgCol);\n\n  var texCol = utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getColorAdd(color, 0.5);\n  for (var i = 0; i < 3; ++i) texCol[i] = Math.min(0.8, texCol[i]);\n  EditStyle.changeTextColor(texCol);\n\n  EditStyle._curWidgetColor = color;\n  EditStyle._curBackgroundColor = bgCol;\n  EditStyle._curTextColor = texCol;\n};\n\n// init value\nEditStyle._curTextColor = [0.73, 0.73, 0.73, 1.0];\nEditStyle._curWidgetColor = [0.32, 0.37, 0.39, 1.0];\nEditStyle._curBackgroundColor = [0.24, 0.24, 0.24];\nEditStyle._curShowBorder = false;\n\nEditStyle.changeOverallColor([0.3, 0.34, 0.4, 1.0]);\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (EditStyle);\n\n\n//# sourceURL=webpack://yagui/./src/utils/EditStyle.js?")},"./src/utils/GuiUtils.js":function srcUtilsGuiUtilsJs(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nvar GuiUtils = {};\n\nGuiUtils.rgbToHsv = function (rgb) {\n  var r = rgb[0];\n  var g = rgb[1];\n  var b = rgb[2];\n  var maxRGB = Math.max(r, g, b);\n  var minRGB = Math.min(r, g, b);\n  if (minRGB === maxRGB) return [0, 0, minRGB];\n  var d = (r === minRGB) ? g - b : ((b === minRGB) ? r - g : b - r);\n  var h = (r === minRGB) ? 3 : ((b === minRGB) ? 1 : 5);\n  return [(h - d / (maxRGB - minRGB)) / 6, (maxRGB - minRGB) / maxRGB, maxRGB];\n};\n\nGuiUtils.hsvToRgb = function (hsv) {\n  var h = hsv[0] * 6;\n  var s = hsv[1];\n  var v = hsv[2];\n  var i = Math.floor(h);\n  var f = h - i;\n  var p = v * (1.0 - s);\n  var q = v * (1.0 - f * s);\n  var t = v * (1.0 - (1.0 - f) * s);\n  var mod = i % 6;\n  if (mod === 0) return [v, t, p];\n  else if (mod === 1) return [q, v, p];\n  else if (mod === 2) return [p, v, t];\n  else if (mod === 3) return [p, q, v];\n  else if (mod === 4) return [t, p, v];\n  else return [v, p, q];\n};\n\nGuiUtils.getValidColor = function (color) {\n  for (var i = 0, len = color.length; i < len; ++i) color[i] = Math.max(0.0, Math.min(1.0, color[i]));\n  return color;\n};\n\nGuiUtils.getStrColor = function (color) {\n  if (color.length === 3) return GuiUtils.rgbToHex(color);\n  return 'rgba(' + Math.round(color[0] * 255) + ',' + Math.round(color[1] * 255) + ',' + Math.round(color[2] * 255) + ',' + color[3] + ')';\n};\n\nGuiUtils.getColorMult = function (color, fac) {\n  var out = [color[0] * fac, color[1] * fac, color[2] * fac];\n  if (color.length === 4) out.push(color[3]);\n  return GuiUtils.getValidColor(out);\n};\n\nGuiUtils.getColorAdd = function (color, add) {\n  var out = [color[0] + add, color[1] + add, color[2] + add];\n  if (color.length === 4) out.push(color[3]);\n  return GuiUtils.getValidColor(out);\n};\n\nGuiUtils.rgbToHex = function (rgb) {\n  var h = '#';\n  for (var i = 0; i < 3; ++i) {\n    var c = Math.round(rgb[i] * 255).toString(16);\n    h += c.length === 1 ? '0' + c : c;\n  }\n  return h;\n};\n\nGuiUtils.hexToRgb = function (hex) {\n  var i = 0;\n  if (hex[0] === '#') hex = hex.slice(1);\n  var h = hex;\n  if (hex.length > 6) h = hex.slice(0, 6);\n  else if (hex.length < 6) {\n    h = '';\n    for (i = 0; i < 3; ++i)\n      h += hex[i] ? hex[i] + hex[i] : '00';\n  }\n  var col = [0, 0, 0];\n  for (i = 0; i < 3; ++i) {\n    var c = parseInt(h[i * 2] + h[i * 2 + 1], 16);\n    col[i] = (c !== c ? 0 : c) / 255;\n  }\n  return col;\n};\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (GuiUtils);\n\n\n//# sourceURL=webpack://yagui/./src/utils/GuiUtils.js?")},"./src/widgets/BaseWidget.js":function srcWidgetsBaseWidgetJs(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\nclass BaseWidget {\n\n  constructor() {}\n\n  _getInitialValue(valOrObject, callbackOrKey) {\n    if (typeof callbackOrKey !== 'string') return valOrObject;\n    return valOrObject[callbackOrKey];\n  }\n\n  _getCheckCallback(valOrObject, callbackOrKey) {\n    if (typeof callbackOrKey !== 'string') return callbackOrKey;\n    return function (val) {\n      valOrObject[callbackOrKey] = val;\n    };\n  }\n\n  _setDomContainer(container) {\n    this.domContainer = container;\n  }\n\n  setCallback(callback) {\n    this.callback = callback;\n  }\n\n  setVisibility(visible) {\n    if (!this.domContainer) return;\n    this.domContainer.hidden = !visible;\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (BaseWidget);\n\n\n//# sourceURL=webpack://yagui/./src/widgets/BaseWidget.js?")},"./src/widgets/Button.js":function srcWidgetsButtonJs(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var widgets_BaseWidget__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! widgets/BaseWidget */ \"./src/widgets/BaseWidget.js\");\n\n\nclass Button extends widgets_BaseWidget__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n\n  constructor(name, callbackOrObject, key) {\n    super();\n\n    var callback = key ? callbackOrObject[key].bind(callbackOrObject) : callbackOrObject;\n\n    this.domButton = document.createElement('button');\n    this.domButton.className = 'gui-button';\n    this.domButton.innerHTML = name || '';\n    this.domButton.addEventListener('click', this._onClick.bind(this));\n\n    this.setCallback(callback);\n  }\n\n  setEnable(bool) {\n    this.domButton.disabled = bool === undefined ? false : !bool;\n  }\n\n  _onClick() {\n    if (this.callback) this.callback();\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Button);\n\n\n//# sourceURL=webpack://yagui/./src/widgets/Button.js?")},"./src/widgets/Checkbox.js":function srcWidgetsCheckboxJs(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var widgets_BaseWidget__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! widgets/BaseWidget */ \"./src/widgets/BaseWidget.js\");\n\n\nclass Checkbox extends widgets_BaseWidget__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n\n  constructor(valOrObject, callbackOrKey) {\n    super();\n\n    var value = this._getInitialValue(valOrObject, callbackOrKey);\n    var callback = this._getCheckCallback(valOrObject, callbackOrKey);\n    this.domCheckbox = document.createElement('input');\n    this.domCheckbox.className = 'gui-input-checkbox';\n    this.domCheckbox.type = 'checkbox';\n\n    this.domLabelCheckbox = document.createElement('label');\n\n    this.setValue(value === undefined ? true : value);\n    this.setCallback(callback);\n  }\n\n  _onMouseDown() {\n    this.setValue(!this.domCheckbox.checked);\n  }\n\n  setValue(val, ignoreCB) {\n    this.domCheckbox.checked = val;\n    if (!ignoreCB && this.callback) this.callback(val);\n  }\n\n  getValue() {\n    return this.domCheckbox.checked;\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Checkbox);\n\n\n//# sourceURL=webpack://yagui/./src/widgets/Checkbox.js?")},"./src/widgets/Color.js":function srcWidgetsColorJs(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! utils/GuiUtils */ \"./src/utils/GuiUtils.js\");\n/* harmony import */ var widgets_BaseWidget__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! widgets/BaseWidget */ \"./src/widgets/BaseWidget.js\");\n\n\n\nvar vendors = ['-moz-', '-o-', '-webkit-', '-ms-', ''];\nvar urlAlpha = 'url(\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAIAAABLbSncAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAChJREFUeNpiPHPmDAMMGBsbw9lMDDgA6RKM%2F%2F%2F%2Fh3POnj1LCzsAAgwAQtYIcFfEyzkAAAAASUVORK5CYII%3D\")';\n\nclass Color extends widgets_BaseWidget__WEBPACK_IMPORTED_MODULE_1__[\"default\"] {\n\n  constructor(valOrObject, callbackOrKey) {\n    super();\n\n    var value = this._getInitialValue(valOrObject, callbackOrKey);\n    var callback = this._getCheckCallback(valOrObject, callbackOrKey);\n    if (value) this.color = utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getValidColor(value.slice());\n    else this.color = [1.0, 0.0, 0.0];\n\n    // container\n    this.domColor = document.createElement('div');\n    this.domColor.className = 'gui-widget-color';\n\n    // input text\n    this.domInputColor = document.createElement('input');\n    this.domPopup = document.createElement('div');\n\n    // hue picker\n    this.domHue = document.createElement('div');\n    this.domHue.className = 'gui-color-hue';\n    this.domHueKnob = document.createElement('div');\n    this.domHueKnob.className = 'gui-knob-hue';\n\n    // saturation picker\n    this.domSaturation = document.createElement('div');\n    this.domSaturation.className = 'gui-color-saturation';\n    var zAlphaSat = document.createElement('div');\n    this.domSaturation.appendChild(zAlphaSat);\n    this.domSaturationKnob = document.createElement('div');\n    this.domSaturationKnob.className = 'gui-knob-saturation';\n\n    this.domHue.appendChild(this.domHueKnob);\n    this.domPopup.appendChild(this.domSaturationKnob);\n    this.domPopup.appendChild(this.domSaturation);\n    this.domPopup.appendChild(this.domHue);\n    this.domColor.appendChild(this.domInputColor);\n    this.domColor.appendChild(this.domPopup);\n\n    this._hueGradient(this.domHue);\n    this._linearGradient(zAlphaSat, 'top', 'rgba(0,0,0,0)', '#000');\n\n    this.domColor.addEventListener('keydown', this._onInputDown.bind(this));\n    this.domSaturation.addEventListener('mousedown', this._onSaturationDown.bind(this));\n    this.domHue.addEventListener('mousedown', this._onHueDown.bind(this));\n    window.addEventListener('mouseup', this._onMouseUp.bind(this));\n    window.addEventListener('mouseout', this._onMouseUp.bind(this));\n    window.addEventListener('mousemove', this._onMouseMove.bind(this));\n\n    // alpha picker\n    this.hasAlpha = this.color.length === 4;\n    this.alpha = 1.0;\n    if (this.hasAlpha) {\n      this.domPopup.style.width = '142px';\n      this.domAlpha = document.createElement('div');\n      this.domAlpha.className = 'gui-color-alpha';\n      this.domAlphaKnob = document.createElement('div');\n      this.domAlphaKnob.className = 'gui-knob-alpha';\n\n      this._alphaGradient(this.domAlpha, 'top', 'rgba(0,0,0,1.0)', 'rgba(0,0,0,0.0)');\n\n      this.domAlpha.addEventListener('mousedown', this._onAlphaDown.bind(this));\n      this.domAlpha.appendChild(this.domAlphaKnob);\n      this.domPopup.appendChild(this.domAlpha);\n    }\n\n    this.editHue = this.editSaturation = this.editAlpha = false;\n    this.widgetHeight = this.widgetWidth = 100;\n    this.setValue(this.color);\n    this.setCallback(callback);\n  }\n\n  _onInputDown(ev) {\n    ev.stopPropagation();\n    if (ev.keyCode === 13)\n      this.setValue(utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].hexToRgb(ev.target.value));\n  }\n\n  _onUpdateSaturation(ev) {\n    var rect = this.domSaturation.getBoundingClientRect();\n    var hsv = utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rgbToHsv(this.getValue());\n    hsv[1] = Math.min(1.0, Math.max(0.0, (ev.clientX - rect.left) / rect.width));\n    hsv[2] = Math.min(1.0, Math.max(0.0, 1.0 - (ev.clientY - rect.top) / rect.width));\n    this.setValue(utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].hsvToRgb(hsv), false, true);\n    this._updateGui();\n  }\n\n  _onUpdateHue(ev) {\n    var rect = this.domHue.getBoundingClientRect();\n    var hsv = utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rgbToHsv(this.getValue());\n    hsv[0] = Math.min(1.0, Math.max(0.0, 1.0 - (ev.clientY - rect.top) / rect.height));\n    this.setValue(utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].hsvToRgb(hsv), false, true);\n    this._updateGui();\n  }\n\n  _onUpdateAlpha(ev) {\n    var rect = this.domAlpha.getBoundingClientRect();\n    var col = this.getValue();\n    col[3] = this.alpha = Math.min(1.0, Math.max(0.0, 1.0 - (ev.clientY - rect.top) / rect.height));\n    this.setValue(col, false, true);\n    this._updateGui();\n  }\n\n  _updateGui() {\n    var color = this.getValue();\n    var hsv = utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rgbToHsv(color);\n\n    this.domSaturationKnob.style.marginLeft = this.widgetWidth * hsv[1] - 7 + 'px';\n    this.domSaturationKnob.style.marginTop = this.widgetHeight * (1.0 - hsv[2]) - 7 + 'px';\n\n    hsv[1] = hsv[2] = 1.0;\n    this._linearGradient(this.domSaturation, 'left', '#fff', utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].getStrColor(utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].hsvToRgb(hsv)));\n\n    this.domHueKnob.style.marginTop = (1.0 - hsv[0]) * this.widgetHeight + 'px';\n\n    if (this.hasAlpha && color[3] !== undefined)\n      this.domAlphaKnob.style.marginTop = (1.0 - this.alpha) * this.widgetHeight + 'px';\n  }\n\n  _onMouseMove(ev) {\n    if (!this.editSaturation && !this.editHue && !this.editAlpha) return;\n    if (this.editSaturation) return this._onUpdateSaturation(ev);\n    if (this.editHue) return this._onUpdateHue(ev);\n    if (this.editAlpha) return this._onUpdateAlpha(ev);\n  }\n\n  _onSaturationDown(ev) {\n    this.editSaturation = true;\n    this._onMouseMove(ev);\n  }\n\n  _onHueDown(ev) {\n    this.editHue = true;\n    this._onMouseMove(ev);\n  }\n\n  _onAlphaDown(ev) {\n    this.editAlpha = true;\n    this._onMouseMove(ev);\n  }\n\n  _onMouseUp() {\n    this.editHue = this.editSaturation = this.editAlpha = false;\n  }\n\n  _hueGradient(dom) {\n    dom.style.background = '';\n    for (var i = 0, l = vendors.length; i < l; ++i)\n      dom.style.cssText += 'background: ' + vendors[i] + 'linear-gradient(top,  #ff0000 0%, #ff00ff 17%, #0000ff 34%, #00ffff 50%, #00ff00 67%, #ffff00 84%, #ff0000 100%);';\n  }\n\n  _alphaGradient(dom, dir, col1, col2) {\n    dom.style.background = '';\n    for (var i = 0, l = vendors.length; i < l; ++i)\n      dom.style.cssText += 'background: ' + vendors[i] + 'linear-gradient(' + dir + ', ' + col1 + ',' + col2 + '),' + urlAlpha + ';';\n  }\n\n  _linearGradient(dom, dir, col1, col2) {\n    dom.style.background = '';\n    for (var i = 0, l = vendors.length; i < l; ++i)\n      dom.style.cssText += 'background: ' + vendors[i] + 'linear-gradient(' + dir + ', ' + col1 + ' 0%, ' + col2 + ' 100%);';\n  }\n\n  setValue(color, ignoreCB, ignoreUI) {\n    var c = this.color;\n    for (var i = 0, nbC = color.length; i < nbC; ++i)\n      c[i] = color[i];\n\n    var hex = utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rgbToHex(color);\n    this.domInputColor.value = hex;\n    if (this.hasAlpha) {\n      if (color.length >= 4) this.alpha = color[3];\n      else color.push(this.alpha);\n      var col = 'rgba(' + parseInt(color[0] * 255, 10) + ',' + parseInt(color[1] * 255, 10) + ',' + parseInt(color[2] * 255, 10) + ',' + this.alpha + ')';\n      this._alphaGradient(this.domInputColor, '0deg', col, col);\n    } else {\n      this.domInputColor.style.background = hex;\n    }\n\n    // color of text\n    var hsv = utils_GuiUtils__WEBPACK_IMPORTED_MODULE_0__[\"default\"].rgbToHsv(color);\n    this.domSaturationKnob.style.borderColor = (hsv[2] < 0.5 || hsv[1] > 0.5) ? '#fff' : '#000';\n    this.domInputColor.style.color = (this.alpha > 0.2 && (hsv[2] < 0.5 || hsv[1] > 0.5)) ? '#fff' : '#000';\n    if (!ignoreUI) this._updateGui();\n    if (!ignoreCB && this.callback) this.callback(color);\n  }\n\n  getValue() {\n    return this.color;\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Color);\n\n\n//# sourceURL=webpack://yagui/./src/widgets/Color.js?")},"./src/widgets/Combobox.js":function srcWidgetsComboboxJs(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var widgets_BaseWidget__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! widgets/BaseWidget */ \"./src/widgets/BaseWidget.js\");\n\n\nclass Combobox extends widgets_BaseWidget__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n\n  constructor(valOrObject, callbackOrKey, options) {\n    super();\n\n    var value = this._getInitialValue(valOrObject, callbackOrKey);\n    var callback = this._getCheckCallback(valOrObject, callbackOrKey);\n    options = options || {};\n    value = value !== undefined ? value : options[0];\n\n    this.isArray = options.length !== undefined;\n\n    this.domSelect = document.createElement('select');\n    this.domSelect.className = 'gui-select';\n    this.addOptions(options);\n\n    this.domSelect.addEventListener('change', this._onChange.bind(this));\n    this.setValue(value);\n    this.setCallback(callback);\n  }\n\n  _parseValue(val) {\n    return this.isArray ? parseInt(val, 10) : val;\n  }\n\n  _onChange(ev) {\n    this.setValue(ev.target.value);\n  }\n\n  addOptions(options) {\n    var keys = Object.keys(options);\n    for (var i = 0; i < keys.length; ++i) {\n      var opt = document.createElement('option');\n      opt.innerHTML = options[keys[i]];\n      opt.value = keys[i];\n      this.domSelect.appendChild(opt);\n    }\n  }\n\n  setValue(val, ignoreCB) {\n    this.domSelect.value = val;\n    if (!ignoreCB && this.callback) this.callback(this._parseValue(val));\n  }\n\n  getValue() {\n    return this._parseValue(this.domSelect.value);\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Combobox);\n\n\n//# sourceURL=webpack://yagui/./src/widgets/Combobox.js?")},"./src/widgets/MenuButton.js":function srcWidgetsMenuButtonJs(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var widgets_BaseWidget__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! widgets/BaseWidget */ \"./src/widgets/BaseWidget.js\");\n\n\nclass MenuButton extends widgets_BaseWidget__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n\n  constructor(callbackOrObject, shortcutOrKey, shortcut) {\n    super();\n\n    var callback = callbackOrObject;\n    if (callback && typeof callback !== 'function') callback = callbackOrObject[shortcutOrKey].bind(callbackOrObject);\n    else shortcut = shortcutOrKey;\n\n    this.domSpan = document.createElement('span');\n    this.domSpan.className = 'shortcut';\n    this.domSpan.innerHTML = shortcut || '';\n\n    this.setCallback(callback);\n  }\n\n  _setDomContainer(container) {\n    this.domContainer = container;\n    container.addEventListener('click', this._onClick.bind(this));\n  }\n\n  _onClick() {\n    if (this.callback) this.callback();\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (MenuButton);\n\n\n//# sourceURL=webpack://yagui/./src/widgets/MenuButton.js?")},"./src/widgets/Slider.js":function srcWidgetsSliderJs(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var widgets_BaseWidget__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! widgets/BaseWidget */ \"./src/widgets/BaseWidget.js\");\n\n\nclass Slider extends widgets_BaseWidget__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n\n  constructor(valOrObject, callbackOrKey, min, max, step) {\n    super();\n\n    var value = this._getInitialValue(valOrObject, callbackOrKey);\n    var callback = this._getCheckCallback(valOrObject, callbackOrKey);\n    value = value !== undefined ? value : 100;\n    min = min !== undefined ? min : 0;\n    max = max !== undefined ? max : 200;\n    step = step !== undefined ? step : 1;\n\n    // slider\n    this.domSlider = document.createElement('div');\n    this.domSlider.className = 'gui-slider';\n    this.domSliderFill = document.createElement('div');\n    this.domSlider.appendChild(this.domSliderFill);\n\n    // text input\n    this.domInputText = document.createElement('input');\n    this.domInputText.className = 'gui-input-number';\n    this.domInputText.type = 'number';\n    this.min = this.domInputText.min = min;\n    this.max = this.domInputText.max = max;\n    this.step = this.domInputText.step = step;\n\n    this.domInputText.addEventListener('keydown', this._onKeyDown.bind(this));\n    this.domInputText.addEventListener('change', this._onInputText.bind(this));\n    this.domInputText.addEventListener('blur', this._onInputText.bind(this));\n    this.domSlider.addEventListener('mousedown', this._onMouseDown.bind(this));\n    window.addEventListener('mouseup', this._onMouseUp.bind(this), true);\n    window.addEventListener('mousemove', this._onMouseMove.bind(this));\n\n    this.lastValue = value;\n    this.isDown = false;\n    this.setValue(value);\n    this.setCallback(callback);\n  }\n\n  _onInputText(ev) {\n    var val = parseFloat(ev.target.value);\n    if (val !== val || val === this.lastValue) return;\n    this.setValue(val);\n  }\n\n  _onKeyDown(ev) {\n    ev.stopPropagation();\n    if (ev.which === 13) // enter\n      this.domInputText.blur();\n  }\n\n  _onMouseMove(ev) {\n    ev.preventDefault();\n    if (!this.isDown)\n      return;\n    var rect = this.domSlider.getBoundingClientRect();\n    var val = this.min + (this.max - this.min) * ((ev.clientX - rect.left) / rect.width);\n    this.setValue(val);\n  }\n\n  _onMouseDown(ev) {\n    this.isDown = true;\n    this._onMouseMove(ev);\n  }\n\n  _onMouseUp() {\n    this.isDown = false;\n  }\n\n  _setDomContainer(container) {\n    this.domContainer = container;\n  }\n\n  getValue() {\n    return parseFloat(this.domInputText.value);\n  }\n\n  setValue(val, ignoreCB) {\n    this.lastValue = val;\n    val = Math.max(Math.min(val, this.max), this.min);\n    val = Math.round(val / this.step) * this.step;\n    this.domInputText.value = val;\n    var per = this.min;\n    if (this.max !== this.min) per = (val - this.min) / (this.max - this.min);\n    this.domSliderFill.style.width = 100 * per + '%';\n    if (!ignoreCB && this.callback) this.callback(val);\n  }\n\n  setMax(max) {\n    this.domInputText.max = this.max = max;\n    return this;\n  }\n\n  setMin(min) {\n    this.min = min;\n    return this;\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Slider);\n\n\n//# sourceURL=webpack://yagui/./src/widgets/Slider.js?")},"./src/widgets/Title.js":function srcWidgetsTitleJs(module,__webpack_exports__,__webpack_require__){"use strict";eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var widgets_BaseWidget__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! widgets/BaseWidget */ \"./src/widgets/BaseWidget.js\");\n\n\nclass Title extends widgets_BaseWidget__WEBPACK_IMPORTED_MODULE_0__[\"default\"] {\n\n  constructor(name) {\n    super();\n\n    this.domText = document.createElement('div');\n    this.domText.innerHTML = name || '';\n    this.domText.className = 'group-title';\n  }\n\n  setText(text) {\n    this.domText.innerHTML = text;\n  }\n\n  setVisibility(visible) {\n    this.domText.hidden = !visible;\n  }\n}\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (Title);\n\n\n//# sourceURL=webpack://yagui/./src/widgets/Title.js?")},"./src/yagui.js":function srcYaguiJs(module,exports,__webpack_require__){eval('var GuiMain = __webpack_require__(/*! GuiMain */ "./src/GuiMain.js").default;\n\nvar yagui = {\n  GuiMain: GuiMain\n};\n\nmodule.exports = yagui;\n\n\n//# sourceURL=webpack://yagui/./src/yagui.js?')}})},"object"===_typeof(exports)&&"object"===_typeof(module)?module.exports=factory():(__WEBPACK_AMD_DEFINE_ARRAY__=[],void 0===(__WEBPACK_AMD_DEFINE_RESULT__="function"==typeof(__WEBPACK_AMD_DEFINE_FACTORY__=factory)?__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports,__WEBPACK_AMD_DEFINE_ARRAY__):__WEBPACK_AMD_DEFINE_FACTORY__)||(module.exports=__WEBPACK_AMD_DEFINE_RESULT__))},263(e,t,r){"use strict";r.d(t,{A:()=>h});var n,i=r(406),a=i.A.KeyAction,o=function(e,t){return void 0===e?t:"false"!==e&&"0"!==e},s=function(e,t,r,n){var i=parseFloat(e);return i||0===i?Math.max(t,Math.min(r,i)):n},l=function(e,t,r,n){var i=parseInt(e,10);return i||0===i?Math.max(t,Math.min(r,i)):n},u=function(e,t,r){if(t){var n=e[t.toUpperCase()];if(void 0!==n)return n}return r},c=function(){if(n)return n;n={};var e=function(){for(var e=window.location.search.substr(1).split("&"),t={},r=0,n=e.length;r<n;r++){var i=e[r].split("=",2);2===i.length&&(t[i[0].toLowerCase()]=i[1])}return t}();return n.language=e.language,n.scalecenter=o(e.scalecenter,!1),n.grid=o(e.grid,!0),n.outline=o(e.outline,!1),n.outlinecolor=function(e,t){if(!e)return t;var r=e.split(",");if(r.length<3)return t;var n=t.slice();return n[0]=parseInt(r[0]||0,10)/255,n[1]=parseInt(r[1]||0,10)/255,n[2]=parseInt(r[2]||0,10)/255,void 0!==r[3]&&(n[3]=parseFloat(r[3])),n}(e.outlinecolor,[.3,0,0,1]),n.mirrorline=o(e.mirrorline,!1),n.darkenunselected=o(e.darkenunselected,!0),n.projection=u(i.A.Projection,e.projection,i.A.Projection.PERSPECTIVE),n.cameramode=u(i.A.CameraMode,e.cameramode,i.A.Projection.ORBIT),n.pivot=o(e.pivot,!0),n.fov=s(e.fov,10,90,45),n.flatshading=o(e.flatshading,!1),n.wireframe=o(e.wireframe,!1),n.curvature=s(e.curvature,0,5,0),n.exposure=s(e.exposure,0,5),n.environment=l(e.environment,0,1/0,0),n.matcap=l(e.matcap,0,1/0,3),n.shader=u(i.A.Shader,e.shader,i.A.Shader.MATCAP),n.filmic=o(e.filmic,!1),n.modelurl=e.modelurl,n.shortcuts=function(e){var t={};if(t["0".charCodeAt(0)]=a.MOVE,t["1".charCodeAt(0)]=a.BRUSH,t["2".charCodeAt(0)]=a.INFLATE,t["3".charCodeAt(0)]=a.TWIST,t["4".charCodeAt(0)]=a.SMOOTH,t["5".charCodeAt(0)]=a.FLATTEN,t["6".charCodeAt(0)]=a.PINCH,t["7".charCodeAt(0)]=a.CREASE,t["8".charCodeAt(0)]=a.DRAG,t["9".charCodeAt(0)]=a.PAINT,t["E".charCodeAt(0)]=a.TRANSFORM,t["C".charCodeAt(0)]=a.INTENSITY,t["X".charCodeAt(0)]=a.RADIUS,t["N".charCodeAt(0)]=a.NEGATIVE,t["S".charCodeAt(0)]=a.PICKER,t[46]=a.DELETE,t["F".charCodeAt(0)]=a.CAMERA_FRONT,t["T".charCodeAt(0)]=a.CAMERA_TOP,t["L".charCodeAt(0)]=a.CAMERA_LEFT,t[32]=a.CAMERA_RESET,t[37]=a.STRIFE_LEFT,t[39]=a.STRIFE_RIGHT,t[38]=a.STRIFE_UP,t[40]=a.STRIFE_DOWN,t["W".charCodeAt(0)]=a.WIREFRAME,t["R".charCodeAt(0)]=a.REMESH,!e)return t;for(var r=e.split(","),n=0,i=r.length;n<i;n++){var o=r[n].split(":",2);if(2===o.length){var s=o[1].toUpperCase(),l=parseInt(s,10);s=l==l&&l>=10?l:s.charCodeAt(0);var u=a[o[0].toUpperCase()];void 0!==u&&(t[s]=u)}}return t}(e.shortcuts),n};c(),c.getShortKey=function(e){return e>=96&&e<=105&&(e-=48),c().shortcuts[e]};const h=c},322(e,t,r){"use strict";r.d(t,{$A:()=>p,C:()=>o,Il:()=>A,Ln:()=>c,Om:()=>d,S8:()=>f,WQ:()=>l,Z0:()=>_,ei:()=>g,fA:()=>a,gL:()=>m,hZ:()=>s,hs:()=>u,jb:()=>v,lo:()=>b,uE:()=>T,vt:()=>i,xg:()=>y,ze:()=>h});var n=r(968);function i(){var e=new n.tb(3);return n.tb!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function a(e,t,r){var i=new n.tb(3);return i[0]=e,i[1]=t,i[2]=r,i}function o(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function s(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e}function l(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e}function u(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e}function c(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e}function h(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function f(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function d(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function p(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],l=r[2];return e[0]=i*l-a*s,e[1]=a*o-n*l,e[2]=n*s-i*o,e}function _(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e}function g(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e}function m(e,t,r){var n=r[0],i=r[1],a=r[2],o=r[3],s=t[0],l=t[1],u=t[2],c=i*u-a*l,h=a*s-n*u,f=n*l-i*s,d=i*f-a*h,p=a*c-n*f,_=n*h-i*c,g=2*o;return c*=g,h*=g,f*=g,d*=2,p*=2,_*=2,e[0]=s+c+d,e[1]=l+h+p,e[2]=u+f+_,e}var v=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e},y=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.hypot(r,n,i)},b=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i},A=function(e){var t=e[0],r=e[1],n=e[2];return Math.hypot(t,r,n)},T=function(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n};i()},406(e,t,r){"use strict";r.d(t,{A:()=>o});var n=r(445),i={Action:{NOTHING:0,MASK_EDIT:1,SCULPT_EDIT:2,CAMERA_ZOOM:3,CAMERA_ROTATE:4,CAMERA_PAN:5,CAMERA_PAN_ZOOM_ALT:6},Tools:{BRUSH:0,INFLATE:1,TWIST:2,SMOOTH:3,FLATTEN:4,PINCH:5,CREASE:6,DRAG:7,PAINT:8,MOVE:9,MASKING:10,LOCALSCALE:11,TRANSFORM:12},Shader:{PBR:0,FLAT:1,NORMAL:2,WIREFRAME:3,UV:4,MATCAP:5,SELECTION:6,BACKGROUND:7,MERGE:8,FXAA:9,CONTOUR:10,PAINTUV:11,BLUR:12},Projection:{PERSPECTIVE:0,ORTHOGRAPHIC:1},CameraMode:{ORBIT:0,SPHERICAL:1,PLANE:2},MultiState:{NONE:0,SCULPT:1,CAMERA:2,PICKING:3}},a=Object.keys(i.Tools).length;i.KeyAction=n.A.extend({INTENSITY:a++,RADIUS:a++,NEGATIVE:a++,PICKER:a++,DELETE:a++,CAMERA_FRONT:a++,CAMERA_TOP:a++,CAMERA_LEFT:a++,CAMERA_RESET:a++,STRIFE_LEFT:a++,STRIFE_RIGHT:a++,STRIFE_UP:a++,STRIFE_DOWN:a++,WIREFRAME:a++,REMESH:a++},i.Tools);const o=i},442(){!function(e){"use strict";var t,r="File format is not recognized.",n="Error while reading zip file.",i="Error while reading file data.",a=524288,o="text/plain";try{t=0===new Blob([new DataView(new ArrayBuffer(0))]).size}catch(e){}function s(){this.crc=-1}function l(){}function u(e,t){var r,n;return r=new ArrayBuffer(e),n=new Uint8Array(r),t&&n.set(t,0),{buffer:r,array:n,view:new DataView(r)}}function c(){}function h(e){var t,r=this;r.size=0,r.init=function(n,i){var a=new Blob([e],{type:o});(t=new d(a)).init(function(){r.size=t.size,n()},i)},r.readUint8Array=function(e,r,n,i){t.readUint8Array(e,r,n,i)}}function f(t){var r,n=this;n.size=0,n.init=function(e){for(var i=t.length;"="==t.charAt(i-1);)i--;r=t.indexOf(",")+1,n.size=Math.floor(.75*(i-r)),e()},n.readUint8Array=function(n,i,a){var o,s=u(i),l=4*Math.floor(n/3),c=4*Math.ceil((n+i)/3),h=e.atob(t.substring(l+r,c+r)),f=n-3*Math.floor(l/4);for(o=f;o<f+i;o++)s.array[o-f]=h.charCodeAt(o);a(s.array)}}function d(e){var t=this;t.size=0,t.init=function(r){t.size=e.size,r()},t.readUint8Array=function(t,r,n,i){var a=new FileReader;a.onload=function(e){n(new Uint8Array(e.target.result))},a.onerror=i;try{a.readAsArrayBuffer(function(e,t,r){if(t<0||r<0||t+r>e.size)throw new RangeError("offset:"+t+", length:"+r+", size:"+e.size);return e.slice?e.slice(t,t+r):e.webkitSlice?e.webkitSlice(t,t+r):e.mozSlice?e.mozSlice(t,t+r):e.msSlice?e.msSlice(t,t+r):void 0}(e,t,r))}catch(e){i(e)}}}function p(){}function _(e){var r,n=this;n.init=function(e){r=new Blob([],{type:o}),e()},n.writeUint8Array=function(e,n){r=new Blob([r,t?e:e.buffer],{type:o}),n()},n.getData=function(t,n){var i=new FileReader;i.onload=function(e){t(e.target.result)},i.onerror=n,i.readAsText(r,e)}}function g(t){var r=this,n="",i="";r.init=function(e){n+="data:"+(t||"")+";base64,",e()},r.writeUint8Array=function(t,r){var a,o=i.length,s=i;for(i="",a=0;a<3*Math.floor((o+t.length)/3)-o;a++)s+=String.fromCharCode(t[a]);for(;a<t.length;a++)i+=String.fromCharCode(t[a]);s.length>2?n+=e.btoa(s):i=s,r()},r.getData=function(t){t(n+e.btoa(i))}}function m(e){var r,n=this;n.init=function(t){r=new Blob([],{type:e}),t()},n.writeUint8Array=function(n,i){r=new Blob([r,t?n:n.buffer],{type:e}),i()},n.getData=function(e){e(r)}}function v(e,t,r,n,i,o,s,l,u,c){var h,f,d,p=0,_=t.sn;function g(){e.removeEventListener("message",m,!1),l(f,d)}function m(t){var r=t.data,i=r.data,a=r.error;if(a)return a.toString=function(){return"Error: "+this.message},void u(a);if(r.sn===_)switch("number"==typeof r.codecTime&&(e.codecTime+=r.codecTime),"number"==typeof r.crcTime&&(e.crcTime+=r.crcTime),r.type){case"append":i?(f+=i.length,n.writeUint8Array(i,function(){v()},c)):v();break;case"flush":d=r.crc,i?(f+=i.length,n.writeUint8Array(i,function(){g()},c)):g();break;case"progress":s&&s(h+r.loaded,o);break;case"importScripts":case"newTask":case"echo":break;default:console.warn("zip.js:launchWorkerProcess: unknown message: ",r)}}function v(){(h=p*a)<o?r.readUint8Array(i+h,Math.min(a,o-h),function(r){s&&s(h,o);var n=0===h?t:{sn:_};n.type="append",n.data=r,e.postMessage(n,[r.buffer]),p++},u):e.postMessage({sn:_,type:"flush"})}f=0,e.addEventListener("message",m,!1),v()}function y(e,t,r,n,i,o,l,u,c,h){var f,d=0,p=0,_="input"===o,g="output"===o,m=new s;!function o(){var s;if((f=d*a)<i)t.readUint8Array(n+f,Math.min(a,i-f),function(t){var n;try{n=e.append(t,function(e){l&&l(f+e,i)})}catch(e){return void c(e)}n?(p+=n.length,r.writeUint8Array(n,function(){d++,setTimeout(o,1)},h),g&&m.append(n)):(d++,setTimeout(o,1)),_&&m.append(t),l&&l(f,i)},c);else{try{s=e.flush()}catch(e){return void c(e)}s?(g&&m.append(s),p+=s.length,r.writeUint8Array(s,function(){u(p,m.get())},h)):u(p,m.get())}}()}function b(t,r,n,i,a,o,s,u,c,h,f){var d="input";e.zip.useWebWorkers&&s?v(t,{sn:r,codecClass:"NOOP",crcType:d},n,i,a,o,c,u,h,f):y(new l,n,i,a,o,d,c,u,h,f)}function A(e){var t,r,n="",i=["","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","_","_","_","","","","","","","","","+","+","","","+","+","-","-","+","-","+","","","+","+","-","-","","-","+","","","","","","","i","","","","+","+","_","_","","","_","","","","","","","","","","","","","","","","","","","_","","","","","","","","","","","","_"," "];for(t=0;t<e.length;t++)n+=(r=255&e.charCodeAt(t))>127?i[r-128]:String.fromCharCode(r);return n}function T(e){return decodeURIComponent(escape(e))}function S(e){var t,r="";for(t=0;t<e.length;t++)r+=String.fromCharCode(e[t]);return r}function w(e,t,r,n,i){e.version=t.view.getUint16(r,!0),e.bitFlag=t.view.getUint16(r+2,!0),e.compressionMethod=t.view.getUint16(r+4,!0),e.lastModDateRaw=t.view.getUint32(r+6,!0),e.lastModDate=function(e){var t=(4294901760&e)>>16,r=65535&e;try{return new Date(1980+((65024&t)>>9),((480&t)>>5)-1,31&t,(63488&r)>>11,(2016&r)>>5,2*(31&r),0)}catch(e){}}(e.lastModDateRaw),1&~e.bitFlag?((n||8&~e.bitFlag)&&(e.crc32=t.view.getUint32(r+10,!0),e.compressedSize=t.view.getUint32(r+14,!0),e.uncompressedSize=t.view.getUint32(r+18,!0)),4294967295!==e.compressedSize&&4294967295!==e.uncompressedSize?(e.filenameLength=t.view.getUint16(r+22,!0),e.extraFieldLength=t.view.getUint16(r+24,!0)):i("File is using Zip64 (4gb+ file size).")):i("File contains encrypted entry.")}function M(e){return unescape(encodeURIComponent(e))}function k(e){var t,r=[];for(t=0;t<e.length;t++)r.push(e.charCodeAt(t));return r}function E(t,r,n,a){var o={},s=[],l=0,c=0;function h(e){n(e||"Error while writing zip file.")}function f(e){n(e||i)}var d={add:function(r,i,d,p,_){var g,m,A,T=this._worker;function S(e,r){var n=u(16);l+=e||0,n.view.setUint32(0,1347094280),void 0!==r&&(g.view.setUint32(10,r,!0),n.view.setUint32(4,r,!0)),i&&(n.view.setUint32(8,e,!0),g.view.setUint32(14,e,!0),n.view.setUint32(12,i.size,!0),g.view.setUint32(18,i.size,!0)),t.writeUint8Array(n.array,function(){l+=16,d()},h)}function w(){var d;_=_||{},r=r.trim(),_.directory&&"/"!=r.charAt(r.length-1)&&(r+="/"),o.hasOwnProperty(r)?n("File already exists."):(m=k(M(r)),s.push(r),A=_.lastModDate||new Date,g=u(26),o[r]={headerArray:g.array,directory:_.directory,filename:m,offset:l,comment:k(M(_.comment||""))},g.view.setUint32(0,335546376),_.version&&g.view.setUint8(0,_.version),a||0===_.level||_.directory||g.view.setUint16(4,2048),g.view.setUint16(6,(A.getHours()<<6|A.getMinutes())<<5|A.getSeconds()/2,!0),g.view.setUint16(8,(A.getFullYear()-1980<<4|A.getMonth()+1)<<5|A.getDate(),!0),g.view.setUint16(22,m.length,!0),(d=u(30+m.length)).view.setUint32(0,1347093252),d.array.set(g.array,4),d.array.set(m,30),l+=d.array.length,t.writeUint8Array(d.array,function(){i?a||0===_.level?b(T,c++,i,t,0,i.size,!0,S,p,f,h):function(t,r,n,i,a,o,s,l,u){var c="input";e.zip.useWebWorkers?v(t,{sn:r,options:{level:a},codecClass:"Deflater",crcType:c},n,i,0,n.size,s,o,l,u):y(new e.zip.Deflater,n,i,0,n.size,c,s,o,l,u)}(T,c++,i,t,_.level,S,p,f,h):S()},h))}i?i.init(w,f):w()},close:function(e){this._worker&&(this._worker.terminate(),this._worker=null);var r,n,i,a=0,c=0;for(n=0;n<s.length;n++)a+=46+(i=o[s[n]]).filename.length+i.comment.length;for(r=u(a+22),n=0;n<s.length;n++)i=o[s[n]],r.view.setUint32(c,1347092738),r.view.setUint16(c+4,5120),r.array.set(i.headerArray,c+6),r.view.setUint16(c+32,i.comment.length,!0),i.directory&&r.view.setUint8(c+38,16),r.view.setUint32(c+42,i.offset,!0),r.array.set(i.filename,c+46),r.array.set(i.comment,c+46+i.filename.length),c+=46+i.filename.length+i.comment.length;r.view.setUint32(c,1347093766),r.view.setUint16(c+8,s.length,!0),r.view.setUint16(c+10,s.length,!0),r.view.setUint32(c+12,a,!0),r.view.setUint32(c+16,l,!0),t.writeUint8Array(r.array,function(){t.getData(e)},h)},_worker:null};e.zip.useWebWorkers?R("deflater",function(e){d._worker=e,r(d)},function(e){n(e)}):r(d)}s.prototype.append=function(e){for(var t=0|this.crc,r=this.table,n=0,i=0|e.length;n<i;n++)t=t>>>8^r[255&(t^e[n])];this.crc=t},s.prototype.get=function(){return~this.crc},s.prototype.table=function(){var e,t,r,n=[];for(e=0;e<256;e++){for(r=e,t=0;t<8;t++)1&r?r=r>>>1^3988292384:r>>>=1;n[e]=r}return n}(),l.prototype.append=function(e,t){return e},l.prototype.flush=function(){},h.prototype=new c,h.prototype.constructor=h,f.prototype=new c,f.prototype.constructor=f,d.prototype=new c,d.prototype.constructor=d,p.prototype.getData=function(e){e(this.data)},_.prototype=new p,_.prototype.constructor=_,g.prototype=new p,g.prototype.constructor=g,m.prototype=new p,m.prototype.constructor=m;var x={deflater:["z-worker.js","deflate.js"],inflater:["z-worker.js","inflate.js"]};function R(t,r,n){if(null===e.zip.workerScripts||null===e.zip.workerScriptsPath){var i,a,o;if(e.zip.workerScripts){if(i=e.zip.workerScripts[t],!Array.isArray(i))return void n(new Error("zip.workerScripts."+t+" is not an array!"));a=i,o=document.createElement("a"),i=a.map(function(e){return o.href=e,o.href})}else(i=x[t].slice(0))[0]=(e.zip.workerScriptsPath||"")+i[0];var s=new Worker(i[0]);s.codecTime=s.crcTime=0,s.postMessage({type:"importScripts",scripts:i.slice(1)}),s.addEventListener("message",function e(t){var i=t.data;if(i.error)return s.terminate(),void n(i.error);"importScripts"===i.type&&(s.removeEventListener("message",e),s.removeEventListener("error",l),r(s))}),s.addEventListener("error",l)}else n(new Error("Either zip.workerScripts or zip.workerScriptsPath may be set, not both."));function l(e){s.terminate(),n(e)}}function C(e){console.error(e)}e.zip={Reader:c,Writer:p,BlobReader:d,Data64URIReader:f,TextReader:h,BlobWriter:m,Data64URIWriter:g,TextWriter:_,createReader:function(t,a,o){o=o||C,t.init(function(){!function(t,a,o){var s=0;function l(){}l.prototype.getData=function(n,a,l,c){var h=this;function f(e,t){c&&!function(e){var t=u(4);return t.view.setUint32(0,e),h.crc32==t.view.getUint32(0)}(t)?o("CRC failed."):n.getData(function(e){a(e)})}function d(e){o(e||i)}function p(e){o(e||"Error while writing file data.")}t.readUint8Array(h.offset,30,function(i){var a,_=u(i.length,i);1347093252==_.view.getUint32(0)?(w(h,_,4,!1,o),a=h.offset+30+h.filenameLength+h.extraFieldLength,n.init(function(){0===h.compressionMethod?b(h._worker,s++,t,n,a,h.compressedSize,c,f,l,d,p):function(t,r,n,i,a,o,s,l,u,c,h){var f=s?"output":"none";e.zip.useWebWorkers?v(t,{sn:r,codecClass:"Inflater",crcType:f},n,i,a,o,u,l,c,h):y(new e.zip.Inflater,n,i,a,o,f,u,l,c,h)}(h._worker,s++,t,n,a,h.compressedSize,c,f,l,d,p)},p)):o(r)},d)};var c={getEntries:function(e){var i=this._worker;!function(e){function i(r,i){t.readUint8Array(t.size-r,r,function(t){for(var r=t.length-22;r>=0;r--)if(80===t[r]&&75===t[r+1]&&5===t[r+2]&&6===t[r+3])return void e(new DataView(t.buffer,r,22));i()},function(){o(n)})}t.size<22?o(r):i(22,function(){i(Math.min(65558,t.size),function(){o(r)})})}(function(a){var s,c;s=a.getUint32(16,!0),c=a.getUint16(8,!0),s<0||s>=t.size?o(r):t.readUint8Array(s,t.size-s,function(t){var n,a,s,h,f=0,d=[],p=u(t.length,t);for(n=0;n<c;n++){if((a=new l)._worker=i,1347092738!=p.view.getUint32(f))return void o(r);w(a,p,f+6,!0,o),a.commentLength=p.view.getUint16(f+32,!0),a.directory=!(16&~p.view.getUint8(f+38)),a.offset=p.view.getUint32(f+42,!0),s=S(p.array.subarray(f+46,f+46+a.filenameLength)),a.filename=2048&~a.bitFlag?A(s):T(s),a.directory||"/"!=a.filename.charAt(a.filename.length-1)||(a.directory=!0),h=S(p.array.subarray(f+46+a.filenameLength+a.extraFieldLength,f+46+a.filenameLength+a.extraFieldLength+a.commentLength)),a.comment=2048&~a.bitFlag?A(h):T(h),d.push(a),f+=46+a.filenameLength+a.extraFieldLength+a.commentLength}e(d)},function(){o(n)})})},close:function(e){this._worker&&(this._worker.terminate(),this._worker=null),e&&e()},_worker:null};e.zip.useWebWorkers?R("inflater",function(e){c._worker=e,a(c)},function(e){o(e)}):a(c)}(t,a,o)},o)},createWriter:function(e,t,r,n){r=r||C,n=!!n,e.init(function(){E(e,t,r,n)},r)},useWebWorkers:!0,workerScriptsPath:null,workerScripts:null}}(this)},445(e,t,r){"use strict";r.d(t,{A:()=>l});var n=r(322),i={SCALE:100,TAG_FLAG:1,SCULPT_FLAG:1,STATE_FLAG:1,TRI_INDEX:4294967295,cursors:{}};i.cursors.dropper="url(resources/dropper.png) 5 25, auto",i.linearToSRGB1=function(e){return e<.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055},i.sRGBToLinear1=function(e){return e<.04045?e*(1/12.92):Math.pow((e+.055)*(1/1.055),2.4)},i.extend=function(e,t){for(var r=Object.keys(t),n=0,i=r.length;n<i;++n){var a=r[n];void 0===e[a]&&(e[a]=t[a])}return e},i.invert=function(e){for(var t=Object.keys(e),r={},n=0,i=t.length;n<i;++n)r[e[t[n]]]=t[n];return r},i.replaceElement=function(e,t,r){for(var n=0,i=e.length;n<i;++n)if(e[n]===t)return void(e[n]=r)},i.removeElement=function(e,t){for(var r=0,n=e.length;r<n;++r)if(e[r]===t)return e[r]=e[n-1],void e.pop()},i.appendArray=function(e,t){var r=e.length,n=t.length;e.length+=n;for(var i=0;i<n;++i)e[r+i]=t[i]},i.isPowerOfTwo=function(e){return 0!==e&&!(e&e-1)},i.nextHighestPowerOfTwo=function(e){--e;for(var t=1;t<32;t<<=1)e|=e>>t;return e+1};var a,o,s=function(e,t){return e-t};i.tidy=function(e){e.sort(s);var t=e.length,r=0,n=0;for(r=1;r<t;++r)e[n]!==e[r]&&(e[++n]=e[r]);r>1&&(e.length=n+1)},i.intersectionArrays=function(e,t){for(var r=0,n=0,i=[],a=e.length,o=t.length;r<a&&n<o;)e[r]<t[n]?r++:e[r]>t[n]?n++:(i.push(e[r]),++r,++n);return i},i.littleEndian=(a=new ArrayBuffer(2),new DataView(a).setInt16(0,256,!0),256===new Int16Array(a)[0]),i.getBytes=function(e,t){return[e[t].charCodeAt(),e[t+1].charCodeAt(),e[t+2].charCodeAt(),e[t+3].charCodeAt()]},i.getUint32=function(e,t){var r=i.getBytes(e,t);return r[0]|r[1]<<8|r[2]<<16|r[3]<<24},i.getFloat32=function(e,t){var r=i.getBytes(e,t),n=1-2*(r[3]>>7),a=(r[3]<<1&255|r[2]>>7)-127,o=(127&r[2])<<16|r[1]<<8|r[0];return 128===a?0!==o?NaN:n*(1/0):-127===a?n*o*Math.pow(2,-149):n*(1+o*Math.pow(2,-23))*Math.pow(2,a)},i.ab2str=function(e){for(var t="",r=new Uint8Array(e),n=65535,i=0,a=r.length;i<a;i+=n){var o=r.subarray(i,n<a-i?n+i:a);t+=String.fromCharCode.apply(null,o)}return t},i.getMemory=(o=new ArrayBuffer(1e5),function(e){return o.byteLength>=e?o:o=new ArrayBuffer(e)}),i.now=Date.now||function(){return(new Date).getTime()},i.throttle=function(e,t){var r,n=[],a=null,o=0,s=function(){o=i.now(),a=null,r=e.apply(e,n)};return function(){for(var l=i.now(),u=t-(l-o),c=n.length=arguments.length,h=0;h<c;++h)n[h]=arguments[h];return u<=0||u>t?(window.clearTimeout(a),a=null,o=l,r=e.apply(e,n)):a||(a=window.setTimeout(s,u)),r}},i.normalizeArrayVec3=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=0,n=e.length/3;r<n;++r){var i=3*r,a=e[i],o=e[i+1],s=e[i+2],l=a*a+o*o+s*s;0!==l?(l=1/Math.sqrt(l),t[i]=a*l,t[i+1]=o*l,t[i+2]=s*l):t[i]=1}return t},i.convertArrayVec3toSRGB=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=0,n=e.length;r<n;++r)t[r]=i.linearToSRGB1(e[r]);return t},i.convertArrayVec3toLinear=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e,r=0,n=e.length;r<n;++r)t[r]=i.sRGBToLinear1(e[r]);return t},i.computeWorldVertices=function(e,t){var r=e.getNbVertices(),i=e.getVertices().subarray(0,3*r);t||(t=new Float32Array(3*r));for(var a=e.getMatrix(),o=n.vt(),s=0;s<r;++s){var l=3*s;n.hZ(o,i[l],i[l+1],i[l+2]),n.Z0(o,o,a),t[l]=o[0],t[l+1]=o[1],t[l+2]=o[2]}return t};const l=i},464(e,t,r){var n,i;function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}void 0===(i="function"==typeof(n=function(){"use strict";function t(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){l(n.response,t,r)},n.onerror=function(){console.error("could not download file")},n.send()}function n(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(r){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var o="object"==("undefined"==typeof window?"undefined":a(window))&&window.window===window?window:"object"==("undefined"==typeof self?"undefined":a(self))&&self.self===self?self:"object"==(void 0===r.g?"undefined":a(r.g))&&r.g.global===r.g?r.g:void 0,s=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),l=o.saveAs||("object"!=("undefined"==typeof window?"undefined":a(window))||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!s?function(e,r,a){var s=o.URL||o.webkitURL,l=document.createElement("a");r=r||e.name||"download",l.download=r,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?i(l):n(l.href)?t(e,r,a):i(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout(function(){s.revokeObjectURL(l.href)},4e4),setTimeout(function(){i(l)},0))}:"msSaveOrOpenBlob"in navigator?function(e,r,o){if(r=r||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=a(t)&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,o),r);else if(n(e))t(e,r,o);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout(function(){i(s)})}}:function(e,r,n,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return t(e,r,n);var a="application/octet-stream"===e.type,l=/constructor/i.test(o.HTMLElement)||o.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||a&&l||s)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=u?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},c.readAsDataURL(e)}else{var h=o.URL||o.webkitURL,f=h.createObjectURL(e);i?i.location=f:location.href=f,i=null,setTimeout(function(){h.revokeObjectURL(f)},4e4)}});o.saveAs=l.saveAs=l,e.exports=l})?n.apply(t,[]):n)||(e.exports=i)},693(e,t,r){"use strict";r.d(t,{A:()=>A});var n,i,a,o,s,l,u,c,h,f,d,p,_,g,m,v,y=r(322),b={normalizedMouse:function(e,t,r,n){return[2*e/r-1,1-2*t/n]},mouseOnUnitSphere:function(e){var t=e[0],r=e[1],n=1-t*t-r*r,i=[t,r,n>0?Math.sqrt(n):0];return y.S8(i,i)}};b.intersectionRayTriangleEdges=(n=1+1e-15,i=-1e-15,a=[0,0,0],o=[0,0,0],s=[0,0,0],function(e,t,r,l,u,c){y.$A(a,t,l);var h=y.Om(r,a);if(h>-1e-15&&h<1e-15)return-1;var f=1/h;y.jb(o,e,u);var d=y.Om(o,a)*f;if(d<i||d>n)return-1;y.$A(s,o,r);var p=y.Om(t,s)*f;if(p<i||d+p>n)return-1;var _=y.Om(l,s)*f;return _<i?-1:(c&&y.Ln(c,e,t,_),_)}),b.intersectionRayTriangle=(l=[0,0,0],u=[0,0,0],function(e,t,r,n,i,a){return y.jb(l,n,r),y.jb(u,i,r),b.intersectionRayTriangleEdges(e,t,l,u,r,a)}),b.distance2PointTriangleEdges=(c=[0,0,0],function(e,t,r,n,i,a,o,s){y.jb(c,n,e);var l,u,h,f,d,p=y.Om(c,t),_=y.Om(c,r),g=y.uE(c),m=Math.abs(i*o-a*a),v=a*_-o*p,b=a*p-i*_,A=4;if(v+b<=m)if(v<0)b<0?(A=4,p<0?(b=0,-p>=i?(v=1,l=i+2*p+g):l=p*(v=-p/i)+g):(v=0,_>=0?(b=0,l=g):-_>=o?(b=1,l=o+2*_+g):l=_*(b=-_/o)+g)):(A=3,v=0,_>=0?(b=0,l=g):-_>=o?(b=1,l=o+2*_+g):l=_*(b=-_/o)+g);else if(b<0)A=5,b=0,p>=0?(v=0,l=g):-p>=i?(v=1,l=i+2*p+g):l=p*(v=-p/i)+g;else{A=0;var T=1/m;l=(v*=T)*(i*v+a*(b*=T)+2*p)+b*(a*v+o*b+2*_)+g}else v<0?(A=2,(h=o+_)>(u=a+p)?(f=h-u)>=(d=i-2*a+o)?(v=1,b=0,l=i+2*p+g):l=(v=f/d)*(i*v+a*(b=1-v)+2*p)+b*(a*v+o*b+2*_)+g:(v=0,h<=0?(b=1,l=o+2*_+g):_>=0?(b=0,l=g):l=_*(b=-_/o)+g)):b<0?(A=6,(h=i+p)>(u=a+_)?(f=h-u)>=(d=i-2*a+o)?(b=1,v=0,l=o+2*_+g):l=(v=1-(b=f/d))*(i*v+a*b+2*p)+b*(a*v+o*b+2*_)+g:(b=0,h<=0?(v=1,l=i+2*p+g):p>=0?(v=0,l=g):l=p*(v=-p/i)+g)):(A=1,(f=o+_-a-p)<=0?(v=0,b=1,l=o+2*_+g):f>=(d=i-2*a+o)?(v=1,b=0,l=i+2*p+g):l=(v=f/d)*(i*v+a*(b=1-v)+2*p)+b*(a*v+o*b+2*_)+g);return l<0&&(l=0),s&&(s[0]=n[0]+v*t[0]+b*r[0],s[1]=n[1]+v*t[1]+b*r[1],s[2]=n[2]+v*t[2]+b*r[2],s[3]=A),l}),b.distance2PointTriangle=function(){var e=[0,0,0],t=[0,0,0];return function(r,n,i,a,o){y.jb(e,i,n),y.jb(t,a,n);var s=y.uE(e),l=y.Om(e,t),u=y.uE(t);return b.distance2PointTriangleEdges(r,e,t,n,s,l,u,o)}}(),b.pointInsideTriangle=(h=[0,0,0],f=[0,0,0],d=[0,0,0],p=[0,0,0],_=[0,0,0],function(e,t,r,n){y.jb(h,t,r),y.jb(f,t,n),y.jb(d,e,r),y.jb(p,e,n);var i=y.Il(y.$A(_,h,f)),a=y.Il(y.$A(_,h,d)),o=y.Il(y.$A(_,f,p)),s=y.Il(y.$A(_,d,p));return Math.abs(i-(a+o+s))<1e-20}),b.triangleInsideSphere=function(e,t,r,n,i){return b.distanceSqToSegment(e,r,n)<t||b.distanceSqToSegment(e,n,i)<t||b.distanceSqToSegment(e,r,i)<t},b.distanceSqToSegment=(g=[0,0,0],m=[0,0,0],function(e,t,r){y.jb(g,e,t),y.jb(m,r,t);var n=y.uE(m),i=y.Om(g,m)/n;return i<0?y.uE(g):i>1?y.uE(y.jb(g,e,r)):(g[0]=e[0]-t[0]-i*m[0],g[1]=e[1]-t[1]-i*m[1],g[2]=e[2]-t[2]-i*m[2],y.uE(g))}),b.signedAngle2d=function(e,t){var r=e[0],n=e[1],i=t[0],a=t[1];return Math.atan2(r*a-n*i,r*i+n*a)},b.pointPlaneDistance=function(){var e=[0,0,0];return function(t,r,n){return y.Om(y.jb(e,t,r),n)}}(),b.mirrorPoint=function(){var e=[0,0,0];return function(t,r,n){return y.jb(t,t,y.hs(e,n,2*b.pointPlaneDistance(t,r,n)))}}(),b.vertexOnLine=(v=[0,0,0],function(e,t,r){y.jb(v,r,t);var n=[0,0,0],i=y.Om(v,y.jb(n,e,t));return y.Ln(n,t,v,i/y.uE(v))}),b.intersectLinePlane=function(e,t,r,n,i){var a=y.Om(y.jb(i,e,r),n),o=y.Om(y.jb(i,t,r),n);if(a===o)return t;var s=-a/(o-a);return y.Ln(i,e,y.jb(i,t,e),s)},b.getPerpendicularVector=function(e){var t=[0,0,0];return 0===e[0]?t[0]=1:0===e[1]?t[1]=1:0===e[2]?t[2]=1:(t[0]=e[2],t[1]=e[2],t[2]=-e[0]-e[1],y.S8(t,t)),t};const A=b},827(e,t,r){"use strict";r.d(t,{B8:()=>s,C:()=>a,D_:()=>o,I0:()=>p,Qr:()=>d,Tl:()=>l,Z8:()=>f,e$:()=>c,eL:()=>h,fN:()=>_,hs:()=>u,lK:()=>v,t5:()=>m,v3:()=>g,vt:()=>i});var n=r(968);function i(){var e=new n.tb(16);return n.tb!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function a(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function o(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function s(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],f=t[10],d=t[11],p=t[12],_=t[13],g=t[14],m=t[15],v=r*s-n*o,y=r*l-i*o,b=r*u-a*o,A=n*l-i*s,T=n*u-a*s,S=i*u-a*l,w=c*_-h*p,M=c*g-f*p,k=c*m-d*p,E=h*g-f*_,x=h*m-d*_,R=f*m-d*g,C=v*R-y*x+b*E+A*k-T*M+S*w;return C?(C=1/C,e[0]=(s*R-l*x+u*E)*C,e[1]=(i*x-n*R-a*E)*C,e[2]=(_*S-g*T+m*A)*C,e[3]=(f*T-h*S-d*A)*C,e[4]=(l*k-o*R-u*M)*C,e[5]=(r*R-i*k+a*M)*C,e[6]=(g*b-p*S-m*y)*C,e[7]=(c*S-f*b+d*y)*C,e[8]=(o*x-s*k+u*w)*C,e[9]=(n*k-r*x-a*w)*C,e[10]=(p*T-_*b+m*v)*C,e[11]=(h*b-c*T-d*v)*C,e[12]=(s*M-o*E-l*w)*C,e[13]=(r*E-n*M+i*w)*C,e[14]=(_*y-p*A-g*v)*C,e[15]=(c*A-h*y+f*v)*C,e):null}function l(e,t,r){var n,i,a,o,s,l,u,c,h,f,d,p,_=r[0],g=r[1],m=r[2];return t===e?(e[12]=t[0]*_+t[4]*g+t[8]*m+t[12],e[13]=t[1]*_+t[5]*g+t[9]*m+t[13],e[14]=t[2]*_+t[6]*g+t[10]*m+t[14],e[15]=t[3]*_+t[7]*g+t[11]*m+t[15]):(n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],f=t[9],d=t[10],p=t[11],e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=u,e[7]=c,e[8]=h,e[9]=f,e[10]=d,e[11]=p,e[12]=n*_+s*g+h*m+t[12],e[13]=i*_+l*g+f*m+t[13],e[14]=a*_+u*g+d*m+t[14],e[15]=o*_+c*g+p*m+t[15]),e}function u(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function c(e,t,r,i){var a,o,s,l,u,c,h,f,d,p,_,g,m,v,y,b,A,T,S,w,M,k,E,x,R=i[0],C=i[1],P=i[2],D=Math.hypot(R,C,P);return D<n.p8?null:(R*=D=1/D,C*=D,P*=D,a=Math.sin(r),s=1-(o=Math.cos(r)),l=t[0],u=t[1],c=t[2],h=t[3],f=t[4],d=t[5],p=t[6],_=t[7],g=t[8],m=t[9],v=t[10],y=t[11],b=R*R*s+o,A=C*R*s+P*a,T=P*R*s-C*a,S=R*C*s-P*a,w=C*C*s+o,M=P*C*s+R*a,k=R*P*s+C*a,E=C*P*s-R*a,x=P*P*s+o,e[0]=l*b+f*A+g*T,e[1]=u*b+d*A+m*T,e[2]=c*b+p*A+v*T,e[3]=h*b+_*A+y*T,e[4]=l*S+f*w+g*M,e[5]=u*S+d*w+m*M,e[6]=c*S+p*w+v*M,e[7]=h*S+_*w+y*M,e[8]=l*k+f*E+g*x,e[9]=u*k+d*E+m*x,e[10]=c*k+p*E+v*x,e[11]=h*k+_*E+y*x,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)}function h(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],c=t[9],h=t[10],f=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+u*n,e[5]=o*i+c*n,e[6]=s*i+h*n,e[7]=l*i+f*n,e[8]=u*i-a*n,e[9]=c*i-o*n,e[10]=h*i-s*n,e[11]=f*i-l*n,e}function f(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],u=t[8],c=t[9],h=t[10],f=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-u*n,e[1]=o*i-c*n,e[2]=s*i-h*n,e[3]=l*i-f*n,e[8]=a*n+u*i,e[9]=o*n+c*i,e[10]=s*n+h*i,e[11]=l*n+f*i,e}function d(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],u=t[4],c=t[5],h=t[6],f=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+u*n,e[1]=o*i+c*n,e[2]=s*i+h*n,e[3]=l*i+f*n,e[4]=u*i-a*n,e[5]=c*i-o*n,e[6]=h*i-s*n,e[7]=f*i-l*n,e}function p(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,l=i+i,u=r*o,c=n*o,h=n*s,f=i*o,d=i*s,p=i*l,_=a*o,g=a*s,m=a*l;return e[0]=1-h-p,e[1]=c+m,e[2]=f-g,e[3]=0,e[4]=c-m,e[5]=1-u-p,e[6]=d+_,e[7]=0,e[8]=f+g,e[9]=d-_,e[10]=1-u-h,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}function _(e,t,r,n,i){var a,o=1/Math.tan(t/2);return e[0]=o/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=o,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,null!=i&&i!==1/0?(a=1/(n-i),e[10]=(i+n)*a,e[14]=2*i*n*a):(e[10]=-1,e[14]=-2*n),e}function g(e,t,r,n,i,a,o){var s=1/(t-r),l=1/(n-i),u=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*l,e[14]=(o+a)*u,e[15]=1,e}function m(e,t,r,i){var a,s,l,u,c,h,f,d,p,_,g=t[0],m=t[1],v=t[2],y=i[0],b=i[1],A=i[2],T=r[0],S=r[1],w=r[2];return Math.abs(g-T)<n.p8&&Math.abs(m-S)<n.p8&&Math.abs(v-w)<n.p8?o(e):(f=g-T,d=m-S,p=v-w,a=b*(p*=_=1/Math.hypot(f,d,p))-A*(d*=_),s=A*(f*=_)-y*p,l=y*d-b*f,(_=Math.hypot(a,s,l))?(a*=_=1/_,s*=_,l*=_):(a=0,s=0,l=0),u=d*l-p*s,c=p*a-f*l,h=f*s-d*a,(_=Math.hypot(u,c,h))?(u*=_=1/_,c*=_,h*=_):(u=0,c=0,h=0),e[0]=a,e[1]=u,e[2]=f,e[3]=0,e[4]=s,e[5]=c,e[6]=d,e[7]=0,e[8]=l,e[9]=h,e[10]=p,e[11]=0,e[12]=-(a*g+s*m+l*v),e[13]=-(u*g+c*m+h*v),e[14]=-(f*g+d*m+p*v),e[15]=1,e)}var v=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],c=t[7],h=t[8],f=t[9],d=t[10],p=t[11],_=t[12],g=t[13],m=t[14],v=t[15],y=r[0],b=r[1],A=r[2],T=r[3];return e[0]=y*n+b*s+A*h+T*_,e[1]=y*i+b*l+A*f+T*g,e[2]=y*a+b*u+A*d+T*m,e[3]=y*o+b*c+A*p+T*v,y=r[4],b=r[5],A=r[6],T=r[7],e[4]=y*n+b*s+A*h+T*_,e[5]=y*i+b*l+A*f+T*g,e[6]=y*a+b*u+A*d+T*m,e[7]=y*o+b*c+A*p+T*v,y=r[8],b=r[9],A=r[10],T=r[11],e[8]=y*n+b*s+A*h+T*_,e[9]=y*i+b*l+A*f+T*g,e[10]=y*a+b*u+A*d+T*m,e[11]=y*o+b*c+A*p+T*v,y=r[12],b=r[13],A=r[14],T=r[15],e[12]=y*n+b*s+A*h+T*_,e[13]=y*i+b*l+A*f+T*g,e[14]=y*a+b*u+A*d+T*m,e[15]=y*o+b*c+A*p+T*v,e}},863(e,t,r){var n,i,a,o;function s(e){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},s(e)}e=r.nmd(e),o=function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){function n(e){if(!e)throw new Error("SketchfabOAuth2 config is missing.");if(e.hasOwnProperty("hostname")||(e.hostname="sketchfab.com"),!e.hasOwnProperty("client_id"))throw new Error("client_id is missing. Please check the config of SketchfabOAuth2.");if(!e.hasOwnProperty("redirect_uri"))throw new Error("redirect_uri is missing. Please check the config of SketchfabOAuth2.");this.config=e}r(5);var i=r(2),a=r(6),o=a.buildQueryString,s=a.parseQueryString;n.prototype.connect=function(e){return new i(function(t,r){if(this.config.client_id)var n={response_type:"token",state:+new Date,client_id:this.config.client_id,redirect_uri:this.config.redirect_uri},i=Object.assign({},n,e),a="https://"+this.config.hostname+"/oauth2/authorize/?"+o(i),l=window.open(a,"loginWindow","width=640,height=400"),u=setInterval(function(){try{var e=l.location.href;if(void 0===e)return clearInterval(u),void r(new Error("Access denied (User closed popup)"));if(-1!==e.indexOf("?error=access_denied"))return clearInterval(u),void r(new Error("Access denied (User canceled)"));if(-1!==e.indexOf(this.config.redirect_uri)){clearInterval(u);var n,i=l.location.hash,a=RegExp("access_token=([^&]+)");return i.match(a)?(n=s(i.substring(1)),void t(n)):void r(new Error("Access denied (missing token)"))}}catch(e){}}.bind(this),1e3);else r(new Error("client_id is missing."))}.bind(this))},e.exports=n},function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(e){if(u===setTimeout)return setTimeout(e,0);if((u===r||!u)&&setTimeout)return u=setTimeout,setTimeout(e,0);try{return u(e,0)}catch(t){try{return u.call(null,e,0)}catch(t){return u.call(this,e,0)}}}function a(){p&&f&&(p=!1,f.length?d=f.concat(d):_=-1,d.length&&o())}function o(){if(!p){var e=i(a);p=!0;for(var t=d.length;t;){for(f=d,d=[];++_<t;)f&&f[_].run();_=-1,t=d.length}f=null,p=!1,function(e){if(c===clearTimeout)return clearTimeout(e);if((c===n||!c)&&clearTimeout)return c=clearTimeout,clearTimeout(e);try{return c(e)}catch(t){try{return c.call(null,e)}catch(t){return c.call(this,e)}}}(e)}}function s(e,t){this.fun=e,this.array=t}function l(){}var u,c,h=e.exports={};!function(){try{u="function"==typeof setTimeout?setTimeout:r}catch(e){u=r}try{c="function"==typeof clearTimeout?clearTimeout:n}catch(e){c=n}}();var f,d=[],p=!1,_=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new s(e,t)),1!==d.length||p||i(o)},s.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=l,h.addListener=l,h.once=l,h.off=l,h.removeListener=l,h.removeAllListeners=l,h.emit=l,h.prependListener=l,h.prependOnceListener=l,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t,r){(function(t){"use strict";function r(){}function n(e){if(!(this instanceof n))throw new TypeError("Promises must be constructed via new");if("function"!=typeof e)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],c(e,this)}function i(e,t){for(;3===e._state;)e=e._value;return 0===e._state?void e._deferreds.push(t):(e._handled=!0,void n._immediateFn(function(){var r=1===e._state?t.onFulfilled:t.onRejected;if(null!==r){var n;try{n=r(e._value)}catch(e){return void o(t.promise,e)}a(t.promise,n)}else(1===e._state?a:o)(t.promise,e._value)}))}function a(e,t){try{if(t===e)throw new TypeError("A promise cannot be resolved with itself.");if(t&&("object"==s(t)||"function"==typeof t)){var r=t.then;if(t instanceof n)return e._state=3,e._value=t,void l(e);if("function"==typeof r)return void c(function(e,t){return function(){e.apply(t,arguments)}}(r,t),e)}e._state=1,e._value=t,l(e)}catch(t){o(e,t)}}function o(e,t){e._state=2,e._value=t,l(e)}function l(e){2===e._state&&0===e._deferreds.length&&n._immediateFn(function(){e._handled||n._unhandledRejectionFn(e._value)});for(var t=0,r=e._deferreds.length;t<r;t++)i(e,e._deferreds[t]);e._deferreds=null}function u(e,t,r){this.onFulfilled="function"==typeof e?e:null,this.onRejected="function"==typeof t?t:null,this.promise=r}function c(e,t){var r=!1;try{e(function(e){r||(r=!0,a(t,e))},function(e){r||(r=!0,o(t,e))})}catch(e){if(r)return;r=!0,o(t,e)}}var h=setTimeout;n.prototype.catch=function(e){return this.then(null,e)},n.prototype.then=function(e,t){var n=new this.constructor(r);return i(this,new u(e,t,n)),n},n.prototype.finally=function(e){var t=this.constructor;return this.then(function(r){return t.resolve(e()).then(function(){return r})},function(r){return t.resolve(e()).then(function(){return t.reject(r)})})},n.all=function(e){return new n(function(t,r){function n(e,o){try{if(o&&("object"==s(o)||"function"==typeof o)){var l=o.then;if("function"==typeof l)return void l.call(o,function(t){n(e,t)},r)}i[e]=o,0===--a&&t(i)}catch(e){r(e)}}if(!e||void 0===e.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(e);if(0===i.length)return t([]);for(var a=i.length,o=0;o<i.length;o++)n(o,i[o])})},n.resolve=function(e){return e&&"object"==s(e)&&e.constructor===n?e:new n(function(t){t(e)})},n.reject=function(e){return new n(function(t,r){r(e)})},n.race=function(e){return new n(function(t,r){for(var n=0,i=e.length;n<i;n++)e[n].then(t,r)})},n._immediateFn="function"==typeof t&&function(e){t(e)}||function(e){h(e,0)},n._unhandledRejectionFn=function(e){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",e)},e.exports=n}).call(t,r(4).setImmediate)},function(e,t,r){(function(e,t){!function(e){"use strict";function r(e){delete o[e]}function n(e){if(s)setTimeout(n,0,e);else{var t=o[e];if(t){s=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{r(e),s=!1}}}}if(!e.setImmediate){var i,a=1,o={},s=!1,l=e.document,u=Object.getPrototypeOf&&Object.getPrototypeOf(e);u=u&&u.setTimeout?u:e,"[object process]"==={}.toString.call(e.process)?i=function(e){t.nextTick(function(){n(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?function(){var t="setImmediate$"+Math.random()+"$",r=function(r){r.source===e&&"string"==typeof r.data&&0===r.data.indexOf(t)&&n(+r.data.slice(t.length))};e.addEventListener?e.addEventListener("message",r,!1):e.attachEvent("onmessage",r),i=function(r){e.postMessage(t+r,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){n(e.data)},i=function(t){e.port2.postMessage(t)}}():l&&"onreadystatechange"in l.createElement("script")?function(){var e=l.documentElement;i=function(t){var r=l.createElement("script");r.onreadystatechange=function(){n(t),r.onreadystatechange=null,e.removeChild(r),r=null},e.appendChild(r)}}():i=function(e){setTimeout(n,0,e)},u.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var n={callback:e,args:t};return o[a]=n,i(a),a++},u.clearImmediate=r}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,function(){return this}(),r(1))},function(e,t,r){(function(e){function n(e,t){this._id=e,this._clearFn=t}var i=Function.prototype.apply;t.setTimeout=function(){return new n(i.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new n(i.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r(3),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(t,function(){return this}())},function(e,t){"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var r=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(null!=i)for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(r[a]=i[a])}return r},writable:!0,configurable:!0})},function(e,t){e.exports={parseQueryString:function(e){var t={};return e.split("&").forEach(function(e){var r=e.split("=");t[r[0]]=decodeURIComponent(r[1])}),t},buildQueryString:function(e){for(var t=Object.keys(e),r=[],n=0,i=t.length;n<i;n++)r.push(t[n]+"="+encodeURIComponent(e[t[n]]));return r.join("&")}}}])},"object"==s(t)&&"object"==s(e)?e.exports=o():(i=[],void 0===(a="function"==typeof(n=o)?n.apply(t,i):n)||(e.exports=a))},865(e,t,r){"use strict";r.d(t,{A:()=>c});var n=r(263);var i;function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function o(e,t,r){return(t=function(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=a(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var s=(o(i={backgroundTitle:"",backgroundReset:"",backgroundImport:" (jpg, png...)",backgroundFill:"",cameraTitle:"",cameraReset:"",cameraCenter:" ()",cameraFront:" (F)",cameraLeft:" (L)",cameraTop:" (T)",cameraMode:"",cameraOrbit:" ()",cameraSpherical:" ()",cameraPlane:" ()",cameraProjection:"",cameraPerspective:"",cameraOrthographic:"",cameraFov:"",cameraPivot:"",fileTitle:" (/)",fileImportTitle:"",fileAdd:" (obj, sgl, ply, stl)",fileAutoMatrix:"",fileVertexSRGB:"sRGB ",fileExportSceneTitle:"",fileExportAll:"",fileExportSGL:" .sgl (SculptGL)",fileExportOBJ:" .obj",fileExportPLY:" .ply",fileExportSTL:" .stl",fileExportTextureTitle:null,fileExportTextureSize:null,fileExportColor:null,fileExportRoughness:null,fileExportMetalness:null,sceneTitle:"",sceneReset:"",sceneResetConfirm:"",sceneAddSphere:"",sceneAddCube:"",sceneAddCylinder:"",sceneAddTorus:"",sceneSelection:"",sceneMerge:"",sceneDuplicate:""},"sceneDuplicate",null),o(i,"meshTitle",""),o(i,"meshNbVertices"," : "),o(i,"meshNbFaces"," : "),o(i,"topologyTitle","()"),o(i,"multiresTitle",""),o(i,"multiresSubdivide",""),o(i,"multiresReverse",""),o(i,"multiresResolution",""),o(i,"multiresNoLower",""),o(i,"multiresNoHigher",""),o(i,"multiresDelHigher",""),o(i,"multiresDelLower",""),o(i,"multiresSelectLowest",""),o(i,"multiresSelectHighest",""),o(i,"multiresWarnBigMesh",function(e){return" "+e+" \n"}),o(i,"multiresNotReversible","\n (loop-catmull) "),o(i,"remeshTitle",""),o(i,"remeshRemesh",""),o(i,"remeshResolution",""),o(i,"remeshBlock",""),o(i,"dynamicTitle",""),o(i,"dynamicActivated"," ()"),o(i,"dynamicSubdivision",""),o(i,"dynamicDecimation",""),o(i,"dynamicLinear",""),o(i,"sculptTitle",""),o(i,"sculptBrush",""),o(i,"sculptInflate",""),o(i,"sculptTwist",""),o(i,"sculptSmooth"," (-Shift)"),o(i,"sculptFlatten",""),o(i,"sculptPinch",""),o(i,"sculptCrease",""),o(i,"sculptDrag",""),o(i,"sculptPaint",""),o(i,"sculptMasking"," (-Ctrl)"),o(i,"sculptMove",""),o(i,"sculptLocalScale",""),o(i,"sculptTransform"," (E)"),o(i,"sculptCommon",""),o(i,"sculptTool",""),o(i,"sculptSymmetry",""),o(i,"sculptContinuous",""),o(i,"sculptRadius"," (-X)"),o(i,"sculptIntensity"," (-C)"),o(i,"sculptHardness",""),o(i,"sculptCulling"," ()"),o(i,"sculptAlphaTitle"," (Alpha)"),o(i,"sculptLockPositon",""),o(i,"sculptAlphaTex",""),o(i,"sculptImportAlpha"," alpha  (jpg, png...)"),o(i,"sculptNegative"," (N  -Alt)"),o(i,"sculptColor",""),o(i,"sculptRoughness",""),o(i,"sculptMetallic",""),o(i,"sculptClay",""),o(i,"sculptAccumulate"," ()"),o(i,"sculptColorGlobal",""),o(i,"sculptPickColor"," (-S)"),o(i,"sculptTangentialSmoothing",""),o(i,"sculptTopologicalCheck",""),o(i,"sculptMoveAlongNormal"," (N  -Alt)"),o(i,"sculptMaskingClear"," (-Ctrl + )"),o(i,"sculptMaskingInvert"," (-Ctrl + )"),o(i,"sculptMaskingBlur",""),o(i,"sculptMaskingSharpen",""),o(i,"sculptPBRTitle","PBR "),o(i,"sculptPaintAll",""),o(i,"sculptExtractTitle",""),o(i,"sculptExtractThickness",""),o(i,"sculptExtractAction"," !"),o(i,"stateTitle",""),o(i,"stateUndo",""),o(i,"stateRedo",""),o(i,"stateMaxStack",""),o(i,"pressureTitle",""),o(i,"pressureRadius",""),o(i,"pressureIntensity",""),o(i,"renderingTitle",""),o(i,"renderingGrid",""),o(i,"renderingSymmetryLine",""),o(i,"renderingMatcap"," (Matcap)"),o(i,"renderingCurvature",""),o(i,"renderingPBR","(PBR)"),o(i,"renderingTransparency",""),o(i,"renderingNormal",""),o(i,"renderingUV","UV "),o(i,"renderingShader",""),o(i,"renderingMaterial",""),o(i,"renderingImportUV"," (jpg, png...)"),o(i,"renderingImportMatcap"," (jpg, png...)"),o(i,"renderingExtra",""),o(i,"renderingFlat",""),o(i,"renderingWireframe"," (W)"),o(i,"renderingExposure",""),o(i,"renderingEnvironment",""),o(i,"renderingIsolate","/ (I)"),o(i,"renderingFilmic",""),o(i,"contour",""),o(i,"contourShow",""),o(i,"contourColor",""),o(i,"darkenUnselected",""),o(i,"resolution",""),o(i,"matcapPearl",""),o(i,"matcapClay",""),o(i,"matcapSkin",""),o(i,"matcapGreen",""),o(i,"matcapWhite",""),o(i,"sketchfabTitle"," Sketchfab !"),o(i,"sketchfabUpload",""),o(i,"sketchfabUploadMessage",' sketchfab API .\n "guest" \n()'),o(i,"sketchfabUploadError",function(e){return"Sketchfab  :\n"+e}),o(i,"sketchfabUploadSuccess"," !\n :"),o(i,"sketchfabAbort"," ?"),o(i,"sketchfabUploadProcessing","...\n"),o(i,"about",""),o(i,"alphaNone",""),o(i,"alphaSquare",""),o(i,"alphaSkin",""),i),l=function e(t){var r=e.languages[e.select][t]||e.languages.english[t];return"string"==typeof r?r:"function"==typeof r?r.apply(this,Array.prototype.slice.call(arguments,1)):(console.error("No TR found for : "+t),t)};l.languages={english:{backgroundTitle:"Background",backgroundReset:"Reset",backgroundImport:"Import (jpg, png...)",backgroundFill:"Fill",cameraTitle:"Camera",cameraReset:"View",cameraCenter:"Reset (bar)",cameraFront:"Front (F)",cameraLeft:"Left (L)",cameraTop:"Top (T)",cameraMode:"Mode",cameraOrbit:"Orbit (Turntable)",cameraSpherical:"Spherical (Trackball)",cameraPlane:"Plane (Trackball)",cameraProjection:"Projection",cameraPerspective:"Perspective",cameraOrthographic:"Orthographic",cameraFov:"Fov",cameraPivot:"Picking pivot",fileTitle:"Files (import/export)",fileImportTitle:"Import",fileAdd:"Add (obj, sgl, ply, stl)",fileAutoMatrix:"Scale and center",fileVertexSRGB:"sRGB vertex color",fileExportSceneTitle:"Export Scene",fileExportAll:"Export all",fileExportSGL:"Save .sgl (SculptGL)",fileExportOBJ:"Save .obj",fileExportPLY:"Save .ply",fileExportSTL:"Save .stl",fileExportTextureTitle:"Export textures",fileExportTextureSize:"Size",fileExportColor:"Save diffuse",fileExportRoughness:"Save roughness",fileExportMetalness:"Save metalness",sceneTitle:"Scene",sceneReset:"Clear scene",sceneResetConfirm:"Confirm clear scene",sceneAddSphere:"Add sphere",sceneAddCube:"Add cube",sceneAddCylinder:"Add cylinder",sceneAddTorus:"Add torus",sceneSelection:"Selection",sceneMerge:"Merge selection",sceneDuplicate:"Copy selection",sceneDelete:"Delete selection",meshTitle:"Mesh",meshNbVertices:"Vertex : ",meshNbFaces:"Faces : ",topologyTitle:"Topology",multiresTitle:"Multiresolution",multiresSubdivide:"Subdivide",multiresReverse:"Reverse",multiresResolution:"Resolution",multiresNoLower:"There is no lower resolution level.",multiresNoHigher:"There is no higher resolution level.",multiresDelHigher:"Delete higher",multiresDelLower:"Delete lower",multiresSelectLowest:"Select the lowest resolution before reversing.",multiresSelectHighest:"Select the highest resolution before subdividing.",multiresWarnBigMesh:function(e){return"The next subdivision level will reach "+e+' faces.\nIf you know what you are doing, click again on "subdivide".'},multiresNotReversible:"Sorry it is not possile to reverse this mesh.\nThe mesh is not a product of a (loop-catmull) subdivision surface on a manifold mesh.",remeshTitle:"Voxel remeshing (quads)",remeshRemesh:"Remesh",remeshResolution:"Resolution",remeshBlock:"Block",dynamicTitle:"Dynamic Topology",dynamicActivated:"Activated (no quads)",dynamicSubdivision:"Subdivision",dynamicDecimation:"Decimation",dynamicLinear:"Linear subdivision",sculptTitle:"Sculpting & Painting",sculptBrush:"Brush",sculptInflate:"Inflate",sculptTwist:"Twist",sculptSmooth:"Smooth (-Shift)",sculptFlatten:"Flatten",sculptPinch:"Pinch",sculptCrease:"Crease",sculptDrag:"Drag",sculptPaint:"Paint",sculptMasking:"Masking (-Ctrl)",sculptMove:"Move",sculptLocalScale:"Local scale",sculptTransform:"Transform (E)",sculptCommon:"Common",sculptTool:"Tool",sculptSymmetry:"Symmetry",sculptContinuous:"Continuous",sculptRadius:"Radius (-X)",sculptIntensity:"Intensity (-C)",sculptHardness:"Hardness",sculptCulling:"Thin surface (front vertex only)",sculptAlphaTitle:"Alpha",sculptLockPositon:"Lock position",sculptAlphaTex:"Texture",sculptImportAlpha:"Import alpha tex (jpg, png...)",sculptNegative:"Negative (N or -Alt)",sculptColor:"Albedo",sculptRoughness:"Roughness",sculptMetallic:"Metallic",sculptClay:"Clay",sculptAccumulate:"Accumulate (no limit per stroke)",sculptColorGlobal:"Global",sculptPickColor:"Material / Color picker (-S)",sculptTangentialSmoothing:"Relax only",sculptTopologicalCheck:"Topological check",sculptMoveAlongNormal:"Move along normal (N or -Alt)",sculptMaskingClear:"Clear (-Ctrl + Drag)",sculptMaskingInvert:"Invert (-Ctrl + Click)",sculptMaskingBlur:"Blur",sculptMaskingSharpen:"Sharpen",sculptPBRTitle:"PBR materials",sculptPaintAll:"Paint all",sculptExtractTitle:"Extract",sculptExtractThickness:"Thickness",sculptExtractAction:"Extract !",stateTitle:"History",stateUndo:"Undo",stateRedo:"Redo",stateMaxStack:"Max Stack",pressureTitle:"Tablet pressure",pressureRadius:"Pressure radius",pressureIntensity:"Pressure intensity",renderingTitle:"Rendering",renderingGrid:"Show grid",renderingSymmetryLine:"Show mirror line",renderingMatcap:"Matcap",renderingCurvature:"Curvature",renderingPBR:"PBR",renderingTransparency:"Transparency",renderingNormal:"Normal shader",renderingUV:"UV shader",renderingShader:"Shader",renderingMaterial:"Material",renderingImportUV:"Import (jpg, png...)",renderingImportMatcap:"Import (jpg, png...)",renderingExtra:"Extra",renderingFlat:"Flat shading",renderingWireframe:"Wireframe (W)",renderingExposure:"Exposure",renderingEnvironment:"Environment",renderingIsolate:"Isolate/Show (I)",renderingFilmic:"Filmic tonemapping",contour:"Contour",contourShow:"Show contour",contourColor:"Color",darkenUnselected:"Darken unselected",resolution:"Resolution",matcapPearl:"Pearl",matcapClay:"Clay",matcapSkin:"Skin",matcapGreen:"Green",matcapWhite:"White",sketchfabTitle:"Go to Sketchfab !",sketchfabUpload:"Upload",sketchfabUploadMessage:'Please enter your sketchfab API Key.\nYou can also leave "guest" to upload anonymously.\n(a new window will pop up when the uploading and processing is finished)',sketchfabUploadError:function(e){return"Sketchfab upload error :\n"+e},sketchfabUploadSuccess:"Upload success !\nHere is your link :",sketchfabAbort:"Abort the last upload ?",sketchfabUploadProcessing:"Processing...\nYour model will be available at :",about:"About & Help",alphaNone:"None",alphaSquare:"Square",alphaSkin:"Skin",remeshTitleMC:"Voxel remeshing (manifold tris)",remeshRemeshMC:"Remesh",remeshSmoothingMC:"Relax topology"},:{backgroundTitle:"",backgroundReset:"",backgroundImport:"  (jpg, png...)",backgroundFill:null,cameraTitle:"",cameraReset:"View",cameraCenter:null,cameraFront:null,cameraLeft:null,cameraTop:null,cameraMode:"",cameraOrbit:null,cameraSpherical:" (Trackball)",cameraPlane:" (Trackball)",cameraProjection:"",cameraPerspective:"",cameraOrthographic:"",cameraFov:"",cameraPivot:"",fileTitle:" (/)",fileImportTitle:null,fileAdd:"Add (obj, sgl, ply, stl)",fileAutoMatrix:null,fileVertexSRGB:null,fileExportSceneTitle:null,fileExportAll:null,fileExportSGL:null,fileExportOBJ:null,fileExportPLY:null,fileExportSTL:null,fileExportTextureTitle:null,fileExportTextureSize:null,fileExportColor:null,fileExportRoughness:null,fileExportMetalness:null,sceneTitle:null,sceneReset:null,sceneAddSphere:null,sceneAddCube:null,sceneAddCylinder:null,sceneAddTorus:null,sceneSelection:null,sceneMerge:null,sceneDuplicate:null,meshTitle:"",meshNbVertices:null,meshNbFaces:null,topologyTitle:null,multiresTitle:null,multiresSubdivide:null,multiresReverse:null,multiresResolution:null,multiresNoLower:null,multiresNoHigher:null,multiresDelHigher:null,multiresDelLower:null,multiresSelectLowest:null,multiresSelectHighest:null,multiresWarnBigMesh:null,multiresNotReversible:null,remeshTitle:null,remeshRemesh:null,remeshResolution:null,remeshBlock:null,dynamicTitle:null,dynamicActivated:null,dynamicSubdivision:null,dynamicDecimation:null,dynamicLinear:null,sculptTitle:null,sculptBrush:"",sculptInflate:"",sculptTwist:"",sculptSmooth:" (-Shift)",sculptFlatten:"",sculptPinch:"",sculptCrease:"",sculptDrag:"",sculptPaint:"",sculptMasking:null,sculptMove:null,sculptLocalScale:null,sculptTransform:null,sculptCommon:null,sculptTool:"",sculptSymmetry:"",sculptContinuous:"",sculptRadius:" (-X)",sculptIntensity:" (-C)",sculptHardness:null,sculptCulling:null,sculptAlphaTitle:null,sculptLockPositon:null,sculptAlphaTex:null,sculptImportAlpha:null,sculptNegative:" (N or -Alt)",sculptColor:null,sculptRoughness:null,sculptMetallic:null,sculptClay:"",sculptAccumulate:null,sculptColorGlobal:null,sculptPickColor:null,sculptTangentialSmoothing:null,sculptTopologicalCheck:null,sculptMoveAlongNormal:null,sculptMaskingClear:null,sculptMaskingInvert:null,sculptMaskingBlur:null,sculptMaskingSharpen:null,sculptPBRTitle:null,sculptPaintAll:null,sculptExtractTitle:null,sculptExtractThickness:null,sculptExtractAction:null,stateTitle:"",stateUndo:"",stateRedo:"",stateMaxStack:null,pressureTitle:"",pressureRadius:"",pressureIntensity:"",renderingTitle:null,renderingGrid:null,renderingSymmetryLine:null,renderingMatcap:null,renderingCurvature:null,renderingPBR:null,renderingTransparency:"",renderingNormal:"",renderingUV:null,renderingShader:"",renderingMaterial:null,renderingImportUV:null,renderingImportMatcap:null,renderingExtra:null,renderingFlat:"",renderingWireframe:" (W)",renderingExposure:null,renderingEnvironment:null,renderingIsolate:null,renderingFilmic:null,contour:null,contourShow:null,contourColor:null,darkenUnselected:null,resolution:null,matcapPearl:null,matcapClay:"",matcapSkin:"",matcapGreen:null,matcapWhite:null,sketchfabTitle:"Sketchfab",sketchfabUpload:"",sketchfabUploadMessage:null,sketchfabUploadError:null,sketchfabUploadSuccess:null,sketchfabAbort:null,sketchfabUploadProcessing:null,about:null,alphaNone:null,alphaSquare:null,alphaSkin:null},:s,:{backgroundTitle:"",backgroundReset:"",backgroundImport:" (jpg, png...)",backgroundFill:"  ",cameraTitle:"",cameraReset:"",cameraCenter:" (bar)",cameraFront:" (F)",cameraLeft:" (L)",cameraTop:" (T)",cameraMode:"",cameraOrbit:" (Turntable)",cameraSpherical:" (Trackball)",cameraPlane:" (Trackball)",cameraProjection:"",cameraPerspective:"",cameraOrthographic:"",cameraFov:"",cameraPivot:" ",fileTitle:" (/)",fileImportTitle:"",fileAdd:" (obj, sgl, ply, stl)",fileAutoMatrix:"  ",fileVertexSRGB:"sRGB  ",fileExportSceneTitle:" ",fileExportAll:" ",fileExportSGL:".sgl  ",fileExportOBJ:".obj  ",fileExportPLY:".ply  ",fileExportSTL:".stl  ",fileExportTextureTitle:null,fileExportTextureSize:null,fileExportColor:null,fileExportRoughness:null,fileExportMetalness:null,sceneTitle:"",sceneReset:" ",sceneResetConfirm:"  ",sceneAddSphere:" ",sceneAddCube:" ",sceneAddCylinder:" ",sceneAddTorus:" ",sceneSelection:"",sceneMerge:" ",sceneDuplicate:null,sceneDelete:"  ",meshTitle:"",meshNbVertices:"  : ",meshNbFaces:"  : ",topologyTitle:"",multiresTitle:" ",multiresSubdivide:"",multiresReverse:"",multiresResolution:"",multiresNoLower:"    .",multiresNoHigher:"    .",multiresDelHigher:"  ",multiresDelLower:"  ",multiresSelectLowest:"      .",multiresSelectHighest:"      ",multiresWarnBigMesh:function(e){return"     "+e+'   .\n      ""   .'},multiresNotReversible:"     .\n    (loop-catmull)  .",remeshTitle:" ",remeshRemesh:"",remeshResolution:"",remeshBlock:"",dynamicTitle:" ",dynamicActivated:" (  )",dynamicSubdivision:"",dynamicDecimation:"",dynamicLinear:" ",sculptTitle:" & ",sculptBrush:"",sculptInflate:"",sculptTwist:"",sculptSmooth:" (-Shift)",sculptFlatten:"",sculptPinch:"",sculptCrease:"",sculptDrag:"",sculptPaint:"",sculptMasking:" (-Ctrl)",sculptMove:"",sculptLocalScale:" ",sculptTransform:" (E)",sculptCommon:"",sculptTool:"",sculptSymmetry:"",sculptContinuous:"",sculptRadius:" (-X)",sculptIntensity:" (-C)",sculptHardness:"",sculptCulling:"  (  )",sculptAlphaTitle:"",sculptLockPositon:" ",sculptAlphaTex:"",sculptImportAlpha:"   (jpg, png...)",sculptNegative:" (N  -Alt)",sculptColor:"",sculptRoughness:"",sculptMetallic:"",sculptClay:"",sculptAccumulate:" (   )",sculptColorGlobal:null,sculptPickColor:" /   (-S)",sculptTangentialSmoothing:" ",sculptTopologicalCheck:" ",sculptMoveAlongNormal:"  ",sculptMaskingClear:" (-Ctrl + Drag)",sculptMaskingInvert:" (-Ctrl + Click)",sculptMaskingBlur:"",sculptMaskingSharpen:"",sculptPBRTitle:"PBR ",sculptPaintAll:" ",sculptExtractTitle:"",sculptExtractThickness:"",sculptExtractAction:"!",stateTitle:"",stateUndo:" ",stateRedo:" ",stateMaxStack:"  ",pressureTitle:"",pressureRadius:"",pressureIntensity:" ",renderingTitle:"",renderingGrid:" ",renderingSymmetryLine:" ",renderingMatcap:"",renderingCurvature:" ",renderingPBR:"PBR",renderingTransparency:"",renderingNormal:" ",renderingUV:"UV ",renderingShader:"",renderingMaterial:"",renderingImportUV:" (jpg, png...)",renderingImportMatcap:" (jpg, png...)",renderingExtra:" ",renderingFlat:" ",renderingWireframe:" (W)",renderingExposure:"",renderingEnvironment:"",renderingIsolate:"/ (I)",renderingFilmic:"(filmic) ",contour:"",contourShow:" ",contourColor:"",darkenUnselected:" ",resolution:"",matcapPearl:"",matcapClay:"",matcapSkin:"",matcapGreen:"",matcapWhite:"",sketchfabTitle:"Sketchfab ",sketchfabUpload:"",sketchfabUploadMessage:null,sketchfabUploadError:null,sketchfabUploadSuccess:null,sketchfabAbort:null,sketchfabUploadProcessing:null,about:"SculptGL ",alphaNone:null,alphaSquare:null,alphaSkin:null},:{backgroundTitle:"",backgroundReset:"",backgroundImport:" (jpg, png...)",backgroundFill:"",cameraTitle:"",cameraReset:"",cameraCenter:" (bar)",cameraFront:" (F)",cameraLeft:" (L)",cameraTop:" (T)",cameraMode:" ",cameraOrbit:" ()",cameraSpherical:" ()",cameraPlane:" ()",cameraProjection:"",cameraPerspective:"",cameraOrthographic:"",cameraFov:" ",cameraPivot:" ",fileTitle:"",fileImportTitle:"",fileAdd:"(obj,sgl,ply,stl)",fileAutoMatrix:"-",fileVertexSRGB:"  sRGB",fileExportSceneTitle:" ",fileExportAll:" ",fileExportSGL:" .sgl",fileExportOBJ:" .obj",fileExportPLY:" .ply",fileExportSTL:" .stl",fileExportTextureTitle:null,fileExportTextureSize:null,fileExportColor:null,fileExportRoughness:null,fileExportMetalness:null,sceneTitle:"",sceneReset:" ",sceneResetConfirm:"  ",sceneAddSphere:" ",sceneAddCube:" ",sceneAddCylinder:" ",sceneAddTorus:" ",sceneSelection:"",sceneMerge:"",sceneDuplicate:null,sceneDelete:" ",meshTitle:"",meshNbVertices:" : ",meshNbFaces:" : ",topologyTitle:"",multiresTitle:"",multiresSubdivide:"",multiresReverse:"",multiresResolution:"",multiresNoLower:"   .",multiresNoHigher:"   .",multiresDelHigher:" ",multiresDelLower:" ",multiresSelectLowest:"   .",multiresSelectHighest:"   .",multiresWarnBigMesh:function(e){return"  "+e+' faces.\n  ,    "".'},multiresNotReversible:"    ,    .\n  .",remeshTitle:" ",remeshRemesh:"",remeshResolution:"",remeshBlock:"-",dynamicTitle:" ",dynamicActivated:" ( )",dynamicSubdivision:"",dynamicDecimation:"",dynamicLinear:" ",sculptTitle:"  ",sculptBrush:"3D ",sculptInflate:"3D ",sculptTwist:"3D ",sculptSmooth:"3D  (-Shift)",sculptFlatten:"3D ",sculptPinch:"3D ",sculptCrease:"3D ",sculptDrag:"3D ",sculptMove:"3D ",sculptLocalScale:"3D ",sculptPaint:"2D ",sculptMasking:"2D  (-Ctrl)",sculptTransform:"",sculptCommon:"",sculptTool:"",sculptSymmetry:"",sculptContinuous:"",sculptRadius:" (-X)",sculptIntensity:" (-C)",sculptHardness:"",sculptCulling:" ( )",sculptAlphaTitle:"",sculptLockPositon:"",sculptAlphaTex:"",sculptImportAlpha:"   (jpg, png...)",sculptNegative:" (N  -Alt)",sculptColor:"",sculptRoughness:"",sculptMetallic:"",sculptClay:"  ",sculptAccumulate:"  ",sculptColorGlobal:"",sculptPickColor:"  (-S)",sculptTangentialSmoothing:"  ",sculptTopologicalCheck:" ",sculptMoveAlongNormal:"  ",sculptMaskingClear:" (-Ctrl + Drag)",sculptMaskingInvert:" (-Ctrl + Click)",sculptMaskingBlur:"",sculptMaskingSharpen:"",sculptPBRTitle:"PBR ",sculptPaintAll:"",sculptExtractTitle:"",sculptExtractThickness:"",sculptExtractAction:"!",stateTitle:"",stateUndo:"",stateRedo:"",stateMaxStack:" ",pressureTitle:" pressure",pressureRadius:"-",pressureIntensity:"-",renderingTitle:"",renderingGrid:" ",renderingSymmetryLine:" ",renderingMatcap:null,renderingCurvature:"",renderingPBR:"PBR",renderingTransparency:"",renderingNormal:" ",renderingUV:"UV",renderingShader:"",renderingMaterial:"",renderingImportUV:" (jpg, png...)",renderingImportMatcap:" (jpg, png...)",renderingExtra:"",renderingFlat:"",renderingWireframe:" (W)",renderingExposure:"",renderingEnvironment:"",renderingIsolate:" /  (I)",renderingFilmic:"",contour:"",contourShow:" ",contourColor:"",darkenUnselected:" ",resolution:"",matcapPearl:"",matcapClay:"",matcapSkin:"",matcapGreen:"",matcapWhite:"",sketchfabTitle:" Sketchfab.com ",sketchfabUpload:"",sketchfabUploadMessage:" API- sketchfab.\n  guest,    .\n(       )",sketchfabUploadError:function(e){return"   Sketchfab :\n"+e},sketchfabUploadSuccess:"  !\n :",sketchfabAbort:" ?",sketchfabUploadProcessing:"...\n    :",about:" ",alphaNone:"",alphaSquare:"",alphaSkin:""},turkish:{backgroundTitle:"Arka plan",backgroundReset:"Temizle",backgroundImport:"e Aktar (jpg, png...)",backgroundFill:"Doldur",cameraTitle:"Kamera",cameraReset:"Grnm",cameraCenter:"Temizle (boluk)",cameraFront:"n (F)",cameraLeft:"Sol (L)",cameraTop:"st (T)",cameraMode:"Mod",cameraOrbit:"Eksen (Dner Tabla)",cameraSpherical:"Kresel (Trackball)",cameraPlane:"Dzlem (Trackball)",cameraProjection:"z Dm",cameraPerspective:"Perspektif",cameraOrthographic:"Orthografik",cameraFov:"Gr Alan",cameraPivot:"Eksen",fileTitle:"Dosyalar (ieri/dar)",fileImportTitle:"e Aktar",fileAdd:"Aktar (obj, sgl, ply, stl)",fileAutoMatrix:"lekle ve ortala",fileVertexSRGB:"sRGB verteks renk",fileExportSceneTitle:"Sahneyi Da Aktar",fileExportAll:"tmn ver",fileExportSGL:"Kaydet .sgl (SculptGL)",fileExportOBJ:"Kaydet .obj",fileExportPLY:"Kaydet .ply",fileExportSTL:"Kaydet .stl",fileExportTextureTitle:null,fileExportTextureSize:null,fileExportColor:null,fileExportRoughness:null,fileExportMetalness:null,sceneTitle:"Sahne",sceneReset:"Sahneyi temizle",sceneResetConfirm:"Net sahneyi dorulayn",sceneAddSphere:"Kre ekle",sceneAddCube:"Kp ekle",sceneAddCylinder:"Silindir ekle",sceneAddTorus:"Halka ekle",sceneSelection:"Seim",sceneMerge:"Seimi birletir",sceneDuplicate:null,sceneDelete:"Seimi sil",meshTitle:"Nesne",meshNbVertices:"Verteks : ",meshNbFaces:"Cephe : ",topologyTitle:"Topoloji",multiresTitle:"oklu znrlk",multiresSubdivide:"Bl",multiresReverse:"Ters",multiresResolution:"znrlk",multiresNoLower:"Daha dk znrlk yok.",multiresNoHigher:"Daha yksek znrlk yok.",multiresDelHigher:"st znrl sil",multiresDelLower:"Alt znrl sil",multiresSelectLowest:"Tersine evirmeden nce en dk znrl se.",multiresSelectHighest:"Tesine evirmeden nce en yksek znrl se.",multiresWarnBigMesh:function(e){return"Sonraki znrlk "+e+' cepheden oluacak.\nEer devam etmek istiyorsanz, tekrar "bl" butonuna basn.'},multiresNotReversible:"Malesef bu nesneyi tersine evirmek mmkn deil.\nThe mesh is not a product of a (loop-catmull) subdivision surface on a manifold mesh.",remeshTitle:"Voksel Remeshing",remeshRemesh:"Remesh",remeshResolution:"znrlk",remeshBlock:"Engelle",dynamicTitle:"Dinamik Topoloji",dynamicActivated:"Aktifletirildi (no quads)",dynamicSubdivision:"Altblm",dynamicDecimation:"stblm",dynamicLinear:"Dorusal altblm",sculptTitle:"Oyma & Boyama",sculptBrush:"Fra",sculptInflate:"iir",sculptTwist:"Bklme",sculptSmooth:"Yumuat (-Shift)",sculptFlatten:"Dzletir",sculptPinch:"imdik",sculptCrease:"Kvrm",sculptDrag:"Srkle",sculptPaint:"Boya",sculptMasking:"Maskeleme (-Ctrl)",sculptMove:"Ta",sculptLocalScale:"Yerel lek",sculptTransform:"Transform (E)",sculptCommon:"Genel",sculptTool:"Ara",sculptSymmetry:"Simetri",sculptContinuous:"Srekli",sculptRadius:"Yara (-X)",sculptIntensity:"Younluk (-C)",sculptHardness:"Sertlik",sculptCulling:"nce yzey (front vertex only)",sculptAlphaTitle:"Alfa",sculptLockPositon:"Pozisyonu kilitle",sculptAlphaTex:"Kaplama",sculptImportAlpha:"Alfa kaplama ykle (jpg, png...)",sculptNegative:"Negatif (N or -Alt)",sculptColor:"Aklk",sculptRoughness:"Przllk",sculptMetallic:"Metalik",sculptClay:"Kil",sculptAccumulate:"Biriktir (limitsiz)",sculptColorGlobal:"Evrensel",sculptPickColor:"Materyal / Renk seici (-S)",sculptTangentialSmoothing:"Rahatlat",sculptTopologicalCheck:"Topoloji kontrol",sculptMoveAlongNormal:"Normal boyunca ta (N or -Alt)",sculptMaskingClear:"Temizle (-Ctrl + Drag)",sculptMaskingInvert:"Tersine evir (-Ctrl + Click)",sculptMaskingBlur:"Bulanklatr",sculptMaskingSharpen:"Keskinletir",sculptPBRTitle:"PBR materyali",sculptPaintAll:"Tmn boya",sculptExtractTitle:"kar",sculptExtractThickness:"Kalnlk",sculptExtractAction:"kar !",stateTitle:"Gemi",stateUndo:"Geri Al",stateRedo:"leri Al",stateMaxStack:"Maksimum Yn",pressureTitle:"Tablet pressure",pressureRadius:"Basn ap",pressureIntensity:"Basn hassasiyeti",renderingTitle:"Sahneleme",renderingGrid:"Izgaray gster",renderingSymmetryLine:"aynalama izgisini gster",renderingMatcap:"Matcap",renderingCurvature:"Erilik",renderingPBR:"PBR",renderingTransparency:"Transparanlk",renderingNormal:"Normal shader",renderingUV:"UV shader",renderingShader:"Shader",renderingMaterial:"Materyal",renderingImportUV:"e AKtar (jpg, png...)",renderingImportMatcap:"e AKtar (jpg, png...)",renderingExtra:"Ekstra",renderingFlat:"Dz glgeleme",renderingWireframe:"Tel kafes (W)",renderingExposure:"Teir",renderingEnvironment:"Ortam",renderingIsolate:"zole/Gster (I)",renderingFilmic:"Film Ton Elemesi",contour:"Kontr",contourShow:"Kontr gster",contourColor:"Renk",darkenUnselected:"Seilmeyenleri koyu yap",resolution:"znrlk",matcapPearl:"nci",matcapClay:"Kil",matcapSkin:"Deri",matcapGreen:"Yeil",matcapWhite:"Beyaz",sketchfabTitle:"Sketchfab'a git !",sketchfabUpload:"Ykle",sketchfabUploadMessage:'Ltfen sketchfab entegrasyon anahtarn giriniz.\nAnonim olarak kullanmak iin "guest" olarak braknz.\n(leme ve ykleme tamamlandnda yeni bir pencere alacak)',sketchfabUploadError:function(e){return"Sketchfab ykleme hatas :\n"+e},sketchfabUploadSuccess:"Ykleme baarl !\nAdresiniz burada :",sketchfabAbort:"Son yklemeyi iptal et ?",sketchfabUploadProcessing:"Hesaplanyor...\nModeliniz u adreste olacak :",about:"Hakknda & Yardm",alphaNone:"Hi Biri",alphaSquare:"Kare",alphaSkin:"Deri"},svenska:{backgroundTitle:"Bakgrund",backgroundReset:"terstll",backgroundImport:"Importera (jpg, png...)",backgroundFill:"Fyll",cameraTitle:"Kamera",cameraReset:"Vy",cameraCenter:"terstll (bar)",cameraFront:"Fram (F)",cameraLeft:"Vnster (L)",cameraTop:"ver (T)",cameraMode:"Lge",cameraOrbit:"Omloppsbana (skivtallrik)",cameraSpherical:"Sfrisk (trackball)",cameraPlane:"Plan (trackball)",cameraProjection:"Projektion",cameraPerspective:"Perspektiv",cameraOrthographic:"Ortografisk",cameraFov:"Fov",cameraPivot:"Plocka pivot",fileTitle:"Filer (import/export)",fileImportTitle:"Importera",fileAdd:"Lgg till (obj, sgl, ply, stl)",fileAutoMatrix:"Skala och centrera",fileVertexSRGB:"sRGB vertexfrg",fileExportSceneTitle:"Exportera Scen",fileExportAll:"Exportera alla",fileExportSGL:"Spara .sgl (SculptGL)",fileExportOBJ:"Spara .obj",fileExportPLY:"Spara .ply",fileExportSTL:"Spara .stl",fileExportTextureTitle:null,fileExportTextureSize:null,fileExportColor:null,fileExportRoughness:null,fileExportMetalness:null,sceneTitle:"Scen",sceneReset:"Rensa scen",sceneResetConfirm:"Bekrfta klar scen",sceneAddSphere:"Lgg till sfr",sceneAddCube:"Lgg till kub",sceneAddCylinder:"Lgg till cylinder",sceneAddTorus:"Lgg till torus",sceneSelection:"Urval",sceneMerge:"Sammanfoga urval",sceneDuplicate:null,sceneDelete:"Radera valet",meshTitle:"Mesh",meshNbVertices:"Vertex : ",meshNbFaces:"Faces : ",topologyTitle:"Topologi",multiresTitle:"Upplsningar",multiresSubdivide:"Dela upp yta",multiresReverse:"Omvnd",multiresResolution:"Upplsning",multiresNoLower:"Det finns ingen lgre upplsningsniv.",multiresNoHigher:"Det finns ingen hgre upplsningsniv.",multiresDelHigher:"Ta bort hgre",multiresDelLower:"Ta bort lgre",multiresSelectLowest:"Vlj den lgsta upplsningen innan omvndning.",multiresSelectHighest:"Vlj den hgsta upplsningen innan uppdelning.",multiresWarnBigMesh:function(e){return"Nsta underavdelning niv kommer att ha "+e+' faces.\nOm du vet vad du gr, klicka igen p "dela upp yta".'},multiresNotReversible:"Tyvrr, det gr inte att omvnda denna mesh.\nMeshen r inte en produkt av en (loop-calmull) mngfaldsytindelning.",remeshTitle:"Voxel Meshombyggnation",remeshRemesh:"Bygg om mesh",remeshResolution:"Upplsning",remeshBlock:"Kuber",dynamicTitle:"Dynamisk Topologi",dynamicActivated:"Aktiverad (inga quads)",dynamicSubdivision:"Ytindelning",dynamicDecimation:"Decimering",dynamicLinear:"Linjr ytindelning",sculptTitle:"Skulptering & Mleri",sculptBrush:"Pensel",sculptInflate:"Bls upp",sculptTwist:"Tvista",sculptSmooth:"Jmna ut (-Shift)",sculptFlatten:"Platta till",sculptPinch:"Nyp",sculptCrease:"Vecka",sculptDrag:"Dra",sculptPaint:"Mla",sculptMasking:"Maskera (-Ctrl)",sculptMove:"Flytta",sculptLocalScale:"Skala lokalt",sculptTransform:"Transformera (E)",sculptCommon:"Generellt",sculptTool:"Verktyg",sculptSymmetry:"Symmetri",sculptContinuous:"Kontinuerlig",sculptRadius:"Radie (-X)",sculptIntensity:"Intensitet (-C)",sculptHardness:"Hrdhet",sculptCulling:"Tunn yta (endast frmre vertex)",sculptAlphaTitle:"Alfa",sculptLockPositon:"Ls position",sculptAlphaTex:"Textur",sculptImportAlpha:"Importera alfatextur (jpg, png...)",sculptNegative:"Negativ (N or -Alt)",sculptColor:"Albedo",sculptRoughness:"Ytjmnhet",sculptMetallic:"Metallisk",sculptClay:"Lera",sculptAccumulate:"Ackumulera (ingen grns per strykning)",sculptColorGlobal:"Global",sculptPickColor:"Material / Frgvlgare (-S)",sculptTangentialSmoothing:"Tangentiell utjmning",sculptTopologicalCheck:"Topologisk check",sculptMoveAlongNormal:"Flytta lngsmed normal (N or -Alt)",sculptMaskingClear:"Rensa (-Ctrl + Drag)",sculptMaskingInvert:"Invertera (-Ctrl + Click)",sculptMaskingBlur:"Gr suddig",sculptMaskingSharpen:"Gr skarp",sculptPBRTitle:"PBR-material",sculptPaintAll:"Mla allt",sculptExtractTitle:"Extrahera",sculptExtractThickness:"Tjocklek",sculptExtractAction:"Extrahera!",stateTitle:"Historia",stateUndo:"ngra",stateRedo:"Gr om",stateMaxStack:"gra antal steg",pressureTitle:"pressureplatta",pressureRadius:"Tryckradie",pressureIntensity:"Tryckintensitet",renderingTitle:"Rendering",renderingGrid:"Visa rutnt",renderingSymmetryLine:"Visa speglingslinje",renderingMatcap:"MatCap",renderingCurvature:"Kurvatur",renderingPBR:"PBR",renderingTransparency:"Genomskinlighet",renderingNormal:"Normal shader",renderingUV:"UV-shader",renderingShader:"Shader",renderingMaterial:"Material",renderingImportUV:"Importera (jpg, png...)",renderingImportMatcap:"Importera (jpg, png...)",renderingExtra:"Extra",renderingFlat:"Platt shading",renderingWireframe:"Wireframe (W)",renderingExposure:"Exponering",renderingEnvironment:"Milj",renderingIsolate:"Isolera/Visa (I)",renderingFilmic:"Filmiska frgtoner",contour:"Kontur",contourShow:"Visa kontur",contourColor:"Frg",darkenUnselected:"Skym ej valda",resolution:"Upplsning",matcapPearl:"Prla",matcapClay:"Lera",matcapSkin:"Hud",matcapGreen:"Grn",matcapWhite:"Vit",sketchfabTitle:"G till Sketchfab!",sketchfabUpload:"Ladda upp",sketchfabUploadMessage:'Vnligen fyll i din sketchfab API-nyckel.\nDu kan ven ange "guest" fr att ladda upp anonymt.\n(ett nytt fnster kommer att ppnas nr uppladdning och bearbetning r klar)',sketchfabUploadError:function(e){return"Sketchfab uppladdningsfel:\n"+e},sketchfabUploadSuccess:"Uppladdning lyckades!\nHr r din lnk:",sketchfabAbort:"Avbryta senaste uppladdningen?",sketchfabUploadProcessing:"Bearbetar...\nDin modell kommer bli tillgnglig hr:",about:"Om & Hjlp",alphaNone:"Ingen",alphaSquare:"Fyrkant",alphaSkin:"Hud"},franais:{backgroundTitle:"Fond d'cran",backgroundReset:"Rinitialiser",backgroundImport:"Importer (jpg, png...)",backgroundFill:"Remplir",cameraTitle:"Camra",cameraReset:"Vue",cameraCenter:"Reset (bar)",cameraFront:"De face (F)",cameraLeft:"De gauche (L)",cameraTop:"De haut (T)",cameraMode:"Mode",cameraOrbit:"Orbite (Turntable)",cameraSpherical:"Spherique (Trackball)",cameraPlane:"Planaire (Trackball)",cameraProjection:"Projection",cameraPerspective:"Perspective",cameraOrthographic:"Orthographique",cameraFov:"Champs de vision",cameraPivot:"Point de pivot",fileTitle:"Fichiers (importer/exporter)",fileImportTitle:"Importer",fileAdd:"Ajouter (obj, sgl, ply, stl)",fileAutoMatrix:"Mise a l'chelle et centrage",fileVertexSRGB:"Couleur de vertex en sRGB",fileExportSceneTitle:"Exporter Scene",fileExportAll:"Tout exporter",fileExportSGL:"Sauver .sgl (SculptGL)",fileExportOBJ:"Sauver .obj",fileExportPLY:"Sauver .ply",fileExportSTL:"Sauver .stl",fileExportTextureTitle:null,fileExportTextureSize:null,fileExportColor:null,fileExportRoughness:null,fileExportMetalness:null,sceneTitle:"Scne",sceneReset:"Rinitialiser scne",sceneResetConfirm:"Confirmer rinitialiser la scne?",sceneAddSphere:"Ajouter sphere",sceneAddCube:"Ajouter cube",sceneAddCylinder:"Ajouter cylindre",sceneAddTorus:"Ajouter tore",sceneSelection:"Slection",sceneMerge:"Fusionner selection",sceneDuplicate:null,sceneDelete:"Supprimer la slection",meshTitle:"Mesh",meshNbVertices:"Vertex : ",meshNbFaces:"Faces : ",topologyTitle:"Topologie",multiresTitle:"Multirsolution",multiresSubdivide:"Subdiviser",multiresReverse:"Inverser",multiresResolution:"Rsolution",multiresNoLower:"Il n'y a pas de niveau de rsolution infrieur.",multiresNoHigher:"Il n'y a pas de niveau de rsolution plus lev.",multiresDelHigher:"Suppression suprieur",multiresDelLower:"Suppression infrieur",multiresSelectLowest:"Slectionnez la rsolution la plus basse avant d'inverser.",multiresSelectHighest:"Slectionnez la rsolution la plus leve avant de subdiviser.",multiresWarnBigMesh:function(e){return"Le prochain niveau de subdivision atteindra "+e+' faces.\nSi vous savez ce que vous faites, cliquez de nouveau sur "subdiviser".'},multiresNotReversible:"Dsol, il n'est pas possible d'inverser ce maillage.\nLe mesh n'est pas un produit d'une surface de subdivision (loop-catmull) provenant manifold.",remeshTitle:"Remaillage volumtrique",remeshRemesh:"Remaillage",remeshResolution:"Rsolution",remeshBlock:"Bloc",dynamicTitle:"Topologie dynamique",dynamicActivated:"Activat (pas quads)",dynamicSubdivision:"Subdivision",dynamicDecimation:"Dcimation",dynamicLinear:"Subdivision linaire",sculptTitle:"Sculpture & Painture",sculptBrush:"Brosse",sculptInflate:"Gonfler",sculptTwist:"Tordre",sculptSmooth:"Lisser (-Shift)",sculptFlatten:"Aplatir",sculptPinch:"Pincer",sculptCrease:"Plier",sculptDrag:"Tirer",sculptPaint:"Peindre",sculptMasking:"Masquer (-Ctrl)",sculptMove:"Bouger",sculptLocalScale:"Mise  l'chelle locale",sculptTransform:"Transformer (E)",sculptCommon:"Commun",sculptTool:"Outil",sculptSymmetry:"Symtrie",sculptContinuous:"Continu",sculptRadius:"Rayon (-X)",sculptIntensity:"Intensit (-C)",sculptHardness:"Duret",sculptCulling:"Surface fine (vertex de face uniquement)",sculptAlphaTitle:"Alpha",sculptLockPositon:"Bloquer position",sculptAlphaTex:"Texture",sculptImportAlpha:"Importer texture alpha (jpg, png...)",sculptNegative:"Ngatif (N ou -Alt)",sculptColor:"Albedo",sculptRoughness:"Rugosit",sculptMetallic:"Mtallique",sculptClay:"Argile",sculptAccumulate:"Accumuler effet",sculptColorGlobal:"Global",sculptPickColor:"Matriau / selection de couleur (-S)",sculptTangentialSmoothing:"Relaxer uniquement",sculptTopologicalCheck:"Vrification topologique",sculptMoveAlongNormal:"Extruder suivant la normale (N ou -Alt)",sculptMaskingClear:"Reset (-Ctrl + Drag)",sculptMaskingInvert:"Inverser (-Ctrl + Click)",sculptMaskingBlur:"Brouiller",sculptMaskingSharpen:"Aiguiser",sculptPBRTitle:"Matriaux physiques (PBR)",sculptPaintAll:"Peindre tout",sculptExtractTitle:"Extraire",sculptExtractThickness:"Epaisseur",sculptExtractAction:"Extraire !",stateTitle:"Historique",stateUndo:"Annuler",stateRedo:"Refaire",stateMaxStack:"Nombre maximale d'action",pressureTitle:"Pression de la tablette",pressureRadius:"Pression sur le rayon",pressureIntensity:"Pression sur l'intensit",renderingTitle:"Rendu",renderingGrid:"Afficher grille",renderingSymmetryLine:"Afficher ligne de symtrie",renderingMatcap:"Matcap",renderingCurvature:"Courbure",renderingPBR:"PBR",renderingTransparency:"Transparence",renderingNormal:"Normal shader",renderingUV:"UV shader",renderingShader:"Shader",renderingMaterial:"Matriau",renderingImportUV:"Importer (jpg, png...)",renderingImportMatcap:"Importer (jpg, png...)",renderingExtra:"Extra",renderingFlat:"Ombrage plat",renderingWireframe:"Fil de fer (W)",renderingExposure:"Exposition",renderingEnvironment:"Environment",renderingIsolate:"Isoler/Afficher (I)",renderingFilmic:"Tonemapping filmique",contour:"Contour",contourShow:"Afficher les contours",contourColor:"Couleur",darkenUnselected:"Assombrir non slction",resolution:"Rsolution",matcapPearl:"Perle",matcapClay:"Argile",matcapSkin:"Peau",matcapGreen:"Vert",matcapWhite:"Blanc",sketchfabTitle:"Vers Sketchfab !",sketchfabUpload:"Uploader",sketchfabUploadMessage:"Entrez votre cl d'API sketchfab.\n",sketchfabUploadError:function(e){return"Sketchfab upload error :\n"+e},sketchfabUploadSuccess:"Tlchargement fini !\nVoici le lien :",sketchfabAbort:"Annuler le dernier tlchargement ?",sketchfabUploadProcessing:"En traitement...\nLe modle sera disponible sur :",about:"A propos & aide",alphaNone:"Vide",alphaSquare:"Carr",alphaSkin:"Peau",remeshTitleMC:"Remaillage surfacique (manifold tris)",remeshRemeshMC:"Remaillage",remeshSmoothingMC:"Lisser topologie"},deutsch:{backgroundTitle:"Hintergrund",backgroundReset:"Zurcksetzen",backgroundImport:"Importieren (jpg, png...)",backgroundFill:"Fllen",cameraTitle:"Kamera",cameraReset:"Ansicht",cameraCenter:"Reset (space)",cameraFront:"Front (F)",cameraLeft:"Links (L)",cameraTop:"Oben (T)",cameraMode:"Modus",cameraOrbit:"Orbit (Drehscheibe)",cameraSpherical:"Sphrisch (Rollkugel)",cameraPlane:"Ebene (Rollkugel)",cameraProjection:"Projektion",cameraPerspective:"Perspektivisch",cameraOrthographic:"Orthographisch",cameraFov:"Sichtfeld (fov)",cameraPivot:"Pivot auswhlen",fileTitle:"Datei (import/export)",fileImportTitle:"Importieren",fileAdd:"Hinzufgen (obj, sgl, ply, stl)",fileAutoMatrix:"Skalieren und zentrieren",fileVertexSRGB:"Vertexfarbe sRGB",fileExportSceneTitle:"Exportieren",fileExportAll:"Alles Exportieren",fileExportSGL:"Speichern .sgl (SculptGL)",fileExportOBJ:"Speichern .obj",fileExportPLY:"Speichern .ply",fileExportSTL:"Speichern .stl",fileExportTextureTitle:"Texturen exportieren",fileExportTextureSize:"Gre",fileExportColor:"Farben speichern",fileExportRoughness:"Rauheit speichern",fileExportMetalness:"Metallisches speichern",sceneTitle:"Szene",sceneReset:"Szene lschen",sceneResetConfirm:"Besttige das Lschen der aktuellen Szene",sceneAddSphere:"Kugel hinzufgen",sceneAddCube:"Wrfel hinzufgen",sceneAddCylinder:"Zylinder hinzufgen",sceneAddTorus:"Torus hinzufgen",sceneSelection:"Auswahl",sceneMerge:"Auswahl zusammenfhren",sceneDuplicate:"Auswahl kopieren",sceneDelete:"Auswahl lschen",meshTitle:"Mesh",meshNbVertices:"Vertex : ",meshNbFaces:"Faces : ",topologyTitle:"Topologie",multiresTitle:"Mehrfachauflsung",multiresSubdivide:"Aufteilen",multiresReverse:"Umkehren",multiresResolution:"Auflsung",multiresNoLower:"Es gibt keine kleinere Auflsung.",multiresNoHigher:"Es gibt keine hhere Auflsung.",multiresDelHigher:"Hhere lschen",multiresDelLower:"Niedrigere lschen",multiresSelectLowest:"Whlen Sie vor dem Umkehren die kleinste Auflsung aus.",multiresSelectHighest:"Whlen Sie vor dem Umkehren die hchste Auflsung aus.",multiresWarnBigMesh:function(e){return"Die nchste Unterteilungsebene wird "+e+' Flchen erreichen\nWenn Sie wissen, was Sie tun, dann klicken Sie nocheinmal auf "umkehren".'},multiresNotReversible:"Es ist leider nicht mglich dieses Netz umzukehren.\nDas Netz ist kein Produkt einer (loop/catmull) Unterteilungsflche auf eines mannigfaltigen Netzes",remeshTitle:"Voxel remeshing (Vierecke)",remeshRemesh:"Remesh",remeshResolution:"Auflsung",remeshBlock:"Block",dynamicTitle:"Dynamische Topologie",dynamicActivated:"Aktiviert (ohne Vierecke)",dynamicSubdivision:"Aufteilung",dynamicDecimation:"Dezimierung",dynamicLinear:"Lineare Aufteilung",sculptTitle:"Modellieren & Bemalen",sculptBrush:"Pinsel",sculptInflate:"Aufblasen",sculptTwist:"Verdrehen",sculptSmooth:"Gltten (-Shift)",sculptFlatten:"Ebnen",sculptPinch:"Kneifen",sculptCrease:"Falten",sculptDrag:"Ziehen",sculptPaint:"Malen",sculptMasking:"Maskieren (-Strg)",sculptMove:"Bewegen",sculptLocalScale:"Lokales Skalieren",sculptTransform:"Transformieren (E)",sculptCommon:"Allgemein",sculptTool:"Werkzeuge",sculptSymmetry:"Symmetrie",sculptContinuous:"Kontinuierlich",sculptRadius:"Radius (-X)",sculptIntensity:"Intensitt (-C)",sculptHardness:"Hrte",sculptCulling:"Dnne Oberflche (nur vorderer vertex)",sculptAlphaTitle:"Alpha",sculptLockPositon:"Verriegelungsposition",sculptAlphaTex:"Textur",sculptImportAlpha:"Alpha tex importieren(jpg, png...)",sculptNegative:"Negativ (N or -Alt)",sculptColor:"Albedo",sculptRoughness:"Rauheit",sculptMetallic:"Metallisches",sculptClay:"Lehm",sculptAccumulate:"Akkumulieren (Kein Limit pro Anschlag)",sculptColorGlobal:"Global",sculptPickColor:"Material / Farb Auswahl (-S)",sculptTangentialSmoothing:"Tangentiale Glttung",sculptTopologicalCheck:"Topologischer Check",sculptMoveAlongNormal:"Normal weiterlaufen (N or -Alt)",sculptMaskingClear:"Lschen (-Ctrl + Drag)",sculptMaskingInvert:"Invertieren (-Ctrl + Click)",sculptMaskingBlur:"Verwischen",sculptMaskingSharpen:"Schrfen",sculptPBRTitle:"PBR Materialen",sculptPaintAll:"Alles Anmalen",sculptExtractTitle:"Extrahieren",sculptExtractThickness:"Dicke",sculptExtractAction:"Extrahieren !",stateTitle:"Verlauf",stateUndo:"Rckgngig",stateRedo:"Wiederholen",stateMaxStack:"Max. Schritte",pressureTitle:"Tablet Druck",pressureRadius:"Druckradius",pressureIntensity:"Druckintensitt",renderingTitle:"Rendering",renderingGrid:"Gitter anzeigen",renderingSymmetryLine:"Spiegellinie anzeigen",renderingMatcap:"Matcap",renderingCurvature:"Krmmung",renderingPBR:"PBR",renderingTransparency:"Transparenz",renderingNormal:"Normale Shader",renderingUV:"UV shader",renderingShader:"Shader",renderingMaterial:"Material",renderingImportUV:"Importieren (jpg, png...)",renderingImportMatcap:"Importieren (jpg, png...)",renderingExtra:"Extra",renderingFlat:"Flaches Schattieren",renderingWireframe:"Drahtgitter (W)",renderingExposure:"Belichtung",renderingEnvironment:"Umgebung",renderingIsolate:"Isoliert/Zeige (I)",renderingFilmic:"Filmische Tonzuordnung",contour:"Kontur",contourShow:"Kontur anzeigen",contourColor:"Farbe",darkenUnselected:"Nicht markiertes abdunkeln",resolution:"Auflsung",matcapPearl:"Perle",matcapClay:"Ton",matcapSkin:"Haut",matcapGreen:"Grn",matcapWhite:"Wei",sketchfabTitle:"Hier gehts zu Sketchfab !",sketchfabUpload:"Hochladen",sketchfabUploadMessage:'Please enter your sketchfab API Key.\nYou can also leave "guest" to upload anonymously.\n(a new window will pop up when the uploading and processing is finished)',sketchfabUploadError:function(e){return"Sketchfab upload error :\n"+e},sketchfabUploadSuccess:"Upload success !\nHere is your link :",sketchfabAbort:"Abort the last upload ?",sketchfabUploadProcessing:"Processing...\nYour model will be available at :",about:"ber & Hilfe (Englisch)",alphaNone:"None",alphaSquare:"Wrfel",alphaSkin:"Haut",remeshTitleMC:"Voxel remeshing (mannigfaltige Dreiecke)",remeshRemeshMC:"Remesh",remeshSmoothingMC:"Topologie entspannen"},italiano:{backgroundTitle:"Sfondo",backgroundReset:"Resetta",backgroundImport:"Importa (jpg, png...)",backgroundFill:"Riempi",cameraTitle:"Camera",cameraReset:"Vista",cameraCenter:"Resetta (bar)",cameraFront:"Fronte (F)",cameraLeft:"Sinistra (L)",cameraTop:"Sopra (T)",cameraMode:"Modalit",cameraOrbit:"Orbita (Ruota intorno)",cameraSpherical:"Sferica (Trackball)",cameraPlane:"Planare (Trackball)",cameraProjection:"Proiezione",cameraPerspective:"Prospettiva",cameraOrthographic:"Ortografica",cameraFov:"Fov",cameraPivot:"Seleziona pivot",fileTitle:"Files (importa/esporta)",fileImportTitle:"Importa",fileAdd:"Aggiungi (obj, sgl, ply, stl)",fileAutoMatrix:"Scala e centra",fileVertexSRGB:"sRGB vertex color",fileExportSceneTitle:"Esporta Scena",fileExportAll:"Exporta tutto",fileExportSGL:"Salva .sgl (SculptGL)",fileExportOBJ:"Salva .obj",fileExportPLY:"Salva .ply",fileExportSTL:"Salva .stl",fileExportTextureTitle:"Esporta textures",fileExportTextureSize:"Dimensione",fileExportColor:"Salva diffuse",fileExportRoughness:"Salva roughness",fileExportMetalness:"Salva metalness",sceneTitle:"Scena",sceneReset:"Pulisci scena",sceneResetConfirm:"Conferma pulitura scena",sceneAddSphere:"Aggiungi sfera",sceneAddCube:"Aggiungi cubo",sceneAddCylinder:"Aggiungi cilindro",sceneAddTorus:"Aggiungi toroide",sceneSelection:"Selezione",sceneMerge:"Unisci selezione",sceneDuplicate:"Copia selezione",sceneDelete:"Elimina selezione",meshTitle:"Mesh",meshNbVertices:"Vertex : ",meshNbFaces:"Faces : ",topologyTitle:"Topologia",multiresTitle:"Multirisoluzione",multiresSubdivide:"Suddivisione",multiresReverse:"Invertire",multiresResolution:"Risoluzione",multiresNoLower:"Non esiste un livello di risoluzione inferiore.",multiresNoHigher:"Non esiste un livello di risoluzione pi alto.",multiresDelHigher:"Elimina superiore",multiresDelLower:"Elimina inferiore",multiresSelectLowest:"Selezionare la risoluzione pi bassa prima di invertire.",multiresSelectHighest:"Seleziona la risoluzione pi alta prima di suddividere.",multiresWarnBigMesh:function(e){return"Il livello di suddivisione successivo raggiunger "+e+' facce.\nSe sai cosa stai facendo, clicca di nuovo su "Suddividi".'},multiresNotReversible:"Spiacenti, non  possibile invertire questa mesh.\nLa mesh non  un prodotto di una superficie di suddivisione (loop-catmull) su una mesh collettore.",remeshTitle:"Voxel remeshing (quads)",remeshRemesh:"Remesh",remeshResolution:"Risolutione",remeshBlock:"Blocca",dynamicTitle:"Topologia Dinamica",dynamicActivated:"Attivata (no quads)",dynamicSubdivision:"Suddivisione",dynamicDecimation:"Decimazione",dynamicLinear:"Suddivisione Lineare",sculptTitle:"Scalpisci & Dipingi",sculptBrush:"Spazzola",sculptInflate:"Gonfia",sculptTwist:"Torci",sculptSmooth:"Ammorbidisci (-Shift)",sculptFlatten:"Appiattisci",sculptPinch:"Pizzica",sculptCrease:"Piega",sculptDrag:"Trascina",sculptPaint:"Dipingi",sculptMasking:"Maschera (-Ctrl)",sculptMove:"Muovi",sculptLocalScale:"Scala Locale",sculptTransform:"Trasformazioni (E)",sculptCommon:"Comune",sculptTool:"Strumento",sculptSymmetry:"Simmetria",sculptContinuous:"Continua",sculptRadius:"Raggio (-X)",sculptIntensity:"Intensit (-C)",sculptHardness:"Durezza",sculptCulling:"Superficie sottile (solo vertici frontali)",sculptAlphaTitle:"Alpha",sculptLockPositon:"Blocca posizione",sculptAlphaTex:"Texture",sculptImportAlpha:"Importa alpha tex (jpg, png...)",sculptNegative:"Negativo (N or -Alt)",sculptColor:"Albedo",sculptRoughness:"Rugosit",sculptMetallic:"Metallico",sculptClay:"Clay",sculptAccumulate:"Accumulazione (no limit per stroke)",sculptColorGlobal:"Globale",sculptPickColor:"Materiale / Color picker (-S)",sculptTangentialSmoothing:"Solo Relax",sculptTopologicalCheck:"Controllo Topologia",sculptMoveAlongNormal:"Muovi lungo la normale (N o -Alt)",sculptMaskingClear:"Pulisci (-Ctrl + Drag)",sculptMaskingInvert:"Inverti (-Ctrl + Click)",sculptMaskingBlur:"Sfoca",sculptMaskingSharpen:"Nitidezza",sculptPBRTitle:"Materiali PBR",sculptPaintAll:"Dipingi tutto",sculptExtractTitle:"Estrazione",sculptExtractThickness:"Assottigliamento",sculptExtractAction:"Estrai !",stateTitle:"Story",stateUndo:"Indietro",stateRedo:"Avanti",stateMaxStack:"Pila massima",pressureTitle:"Pressione tavoletta",pressureRadius:"Raggio pressione",pressureIntensity:"Intensit pressione",renderingTitle:"Rendering",renderingGrid:"Vedi Griglia",renderingSymmetryLine:"Vedi linea di specchiatura",renderingMatcap:"Matcap",renderingCurvature:"Curvature",renderingPBR:"PBR",renderingTransparency:"Trasparenza",renderingNormal:"Normal shader",renderingUV:"UV shader",renderingShader:"Shader",renderingMaterial:"Materiale",renderingImportUV:"Importa (jpg, png...)",renderingImportMatcap:"Importa (jpg, png...)",renderingExtra:"Extra",renderingFlat:"Shading piatto",renderingWireframe:"Wireframe (W)",renderingExposure:"Esposizione",renderingEnvironment:"Ambiente",renderingIsolate:"Isola/Vedi (I)",renderingFilmic:"Coloritura tipo Film",contour:"Contorno",contourShow:"Vedi contorno",contourColor:"Colore",darkenUnselected:"Scurisci i non selezionati",resolution:"Risolutione",matcapPearl:"Perla",matcapClay:"Argilla",matcapSkin:"Pelle",matcapGreen:"Verde",matcapWhite:"Bianco",sketchfabTitle:"Vai su Sketchfab !",sketchfabUpload:"Upload",sketchfabUploadMessage:'Inserisci la tua chiave API di sketchfab.\nPuoi anche lasciare "guest" per caricare in modo anonimo.\n(verr visualizzata una nuova finestra al termine del caricamento e dell\'elaborazione)',sketchfabUploadError:function(e){return"Sketchfab errore upload :\n"+e},sketchfabUploadSuccess:"Caricato con successo !\nEcco il tuo link :",sketchfabAbort:"Annulla l'ultimo caricamento?",sketchfabUploadProcessing:"Processing...\nIl tuo modello sar disponibile su :",about:"Informazioni & Aiuto",alphaNone:"Nessuno",alphaSquare:"Quadrata",alphaSkin:"Pelle",remeshTitleMC:"Voxel remeshing (manifold tris)",remeshRemeshMC:"Remesh",remeshSmoothingMC:"Relax topology"}},l.select="english";var u=window.navigator.language||window.navigator.userLanguage;switch(u&&(u=u.substr(0,2)),"ja"===u?l.select="":"zh"===u?l.select="":"ko"===u?l.select="":"tr"===u?l.select="turkish":"sv"===u?l.select="svenska":"fr"===u?l.select="franais":"de"===u&&(l.select="deutsch"),(0,n.A)().language){case"english":l.select="english";break;case"chinese":l.select="";break;case"korean":l.select="";break;case"japanese":l.select="";break;case"russian":l.select="";break;case"turkish":l.select="turkish";break;case"swedish":l.select="svenska";break;case"french":l.select="franais";break;case"german":l.select="deutsch";break;case"italian":l.select="italiano"}const c=l},952(e,t,r){"use strict";function n(e){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(e)}function i(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function a(e){return function(){var t=this,r=arguments;return new Promise(function(n,a){var o=e.apply(t,r);function s(e){i(o,n,a,s,l,"next",e)}function l(e){i(o,n,a,s,l,"throw",e)}s(void 0)})}}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,s(n.key),n)}}function s(e){var t=function(e){if("object"!=n(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==n(t)?t:t+""}function l(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=c(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function u(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,i,a,o,s=[],l=!0,u=!1;try{if(a=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=a.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,i=e}finally{try{if(!l&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw i}}return s}}(e,t)||c(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){if(e){if("string"==typeof e)return h(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?h(e,t):void 0}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function f(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=document.createElement(e),i=0,a=Object.entries(t);i<a.length;i++){var o=u(a[i],2),s=o[0],c=o[1];"class"===s?n.className=c:"text"===s?n.textContent=c:"html"===s?n.innerHTML=c:s.startsWith("on")&&"function"==typeof c?n.addEventListener(s.slice(2),c):n.setAttribute(s,c)}var h,f=l(r);try{for(f.s();!(h=f.n()).done;){var d=h.value;null!=d&&n.appendChild("string"==typeof d?document.createTextNode(d):d)}}catch(e){f.e(e)}finally{f.f()}return n}r.d(t,{A:()=>p});var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._pm=null,this._overlay=null,this._panel=null,this._list=null}var t,r,n,i,s,u,c;return t=e,r=[{key:"open",value:function(e){this._pm=e,this._overlay||this._create(),this._overlay.style.display="block",this._render()}},{key:"close",value:function(){this._overlay&&(this._overlay.style.display="none")}},{key:"_create",value:function(){var e=this,t=this._overlay=f("div",{class:"sgl-plugin-overlay"});t.addEventListener("click",function(r){r.target===t&&e.close()});var r=this._panel=f("div",{class:"sgl-plugin-panel",role:"dialog","aria-modal":"true"}),n=f("div",{class:"sgl-plugin-header"},[f("div",{class:"sgl-plugin-title",text:"Plugins (Add-ons)"}),f("button",{class:"sgl-plugin-close",type:"button",text:"",onclick:function(){return e.close()}})]),i=f("div",{class:"sgl-plugin-hint",text:'Nota: habilitar/deshabilitar y desinstalar se aplican al reiniciar. "Limpiar todo" recarga la pgina.'}),a=f("div",{class:"sgl-plugin-actions"},[f("button",{type:"button",text:"Instalar desde URL",onclick:function(){return e._installFromUrl()}}),f("button",{type:"button",text:"Instalar desde archivo",onclick:function(){return e._installFromFile()}}),f("button",{type:"button",text:"Refrescar",onclick:function(){return e._render()}}),f("button",{type:"button",class:"danger",text:"Limpiar todo",onclick:function(){return e._clearAll()}})]);this._list=f("div",{class:"sgl-plugin-list"}),r.appendChild(n),r.appendChild(i),r.appendChild(a),r.appendChild(this._list),t.appendChild(r),document.body.appendChild(t),this._ensureStyles()}},{key:"_ensureStyles",value:function(){if(!document.getElementById("sgl-plugin-panel-style")){var e=document.createElement("style");e.id="sgl-plugin-panel-style",e.textContent="\n      .sgl-plugin-overlay{position:fixed;inset:0;background:rgba(0,0,0,.55);z-index:99999;display:none;}\n      .sgl-plugin-panel{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:min(680px,92vw);max-height:82vh;overflow:auto;background:#1b1f26;color:#e6e6e6;border:1px solid rgba(255,255,255,.12);border-radius:10px;box-shadow:0 12px 40px rgba(0,0,0,.5);font:14px/1.4 sans-serif;}\n      .sgl-plugin-header{display:flex;align-items:center;justify-content:space-between;padding:12px 14px;border-bottom:1px solid rgba(255,255,255,.10);}\n      .sgl-plugin-title{font-size:16px;font-weight:600;}\n      .sgl-plugin-close{background:transparent;border:0;color:#e6e6e6;font-size:22px;line-height:1;cursor:pointer;padding:0 6px;}\n      .sgl-plugin-hint{padding:10px 14px;color:rgba(230,230,230,.8);}\n      .sgl-plugin-actions{display:flex;flex-wrap:wrap;gap:8px;padding:0 14px 12px;}\n      .sgl-plugin-actions button{background:#2a313d;border:1px solid rgba(255,255,255,.12);color:#e6e6e6;padding:8px 10px;border-radius:8px;cursor:pointer;}\n      .sgl-plugin-actions button.danger{background:#3a2020;border-color:rgba(255,120,120,.25);}\n      .sgl-plugin-list{padding:0 14px 14px;}\n      .sgl-plugin-row{display:flex;align-items:center;justify-content:space-between;gap:10px;padding:10px 10px;border:1px solid rgba(255,255,255,.10);border-radius:10px;margin-top:10px;background:#202634;}\n      .sgl-plugin-meta{min-width:0;}\n      .sgl-plugin-name{font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}\n      .sgl-plugin-sub{color:rgba(230,230,230,.75);font-size:12px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}\n      .sgl-plugin-buttons{display:flex;gap:8px;flex-shrink:0;}\n      .sgl-plugin-buttons button{background:#2a313d;border:1px solid rgba(255,255,255,.12);color:#e6e6e6;padding:7px 9px;border-radius:8px;cursor:pointer;}\n    ",document.head.appendChild(e)}}},{key:"_render",value:function(){var e=this;if(this._pm&&this._list){var t=this._pm.listInstalled();if(this._list.innerHTML="",t.length){var r,n=l(t);try{var i=function(){var t=r.value,n=(t.name||t.id||"plugin").toString(),i="url"===t.type?t.source||"":"Instalado desde archivo",a=t.enabled?"ON":"OFF",o=f("div",{class:"sgl-plugin-row"},[f("div",{class:"sgl-plugin-meta"},[f("div",{class:"sgl-plugin-name",text:"[".concat(a,"] ").concat(n)}),f("div",{class:"sgl-plugin-sub",text:i})]),f("div",{class:"sgl-plugin-buttons"},[f("button",{type:"button",text:t.enabled?"Deshabilitar":"Habilitar",onclick:function(){return e._toggle(t.id)}}),f("button",{type:"button",text:"Desinstalar",onclick:function(){return e._remove(t.id)}})])]);e._list.appendChild(o)};for(n.s();!(r=n.n()).done;)i()}catch(e){n.e(e)}finally{n.f()}}else this._list.appendChild(f("div",{class:"sgl-plugin-row"},[f("div",{class:"sgl-plugin-meta"},[f("div",{class:"sgl-plugin-name",text:"(No hay plugins instalados)"}),f("div",{class:"sgl-plugin-sub",text:"Instal uno desde URL o desde archivo."})])]))}}},{key:"_toggle",value:(c=a(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._pm){e.next=2;break}return e.abrupt("return");case 2:if(r=this._pm.listInstalled(),n=r.find(function(e){return e.id===t})){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,this._pm.setEnabled(t,!n.enabled);case 8:this._render();case 9:case"end":return e.stop()}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"_remove",value:(u=a(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._pm){e.next=2;break}return e.abrupt("return");case 2:if(window.confirm("Desinstalar este plugin? (Se aplica al reiniciar)")){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this._pm.uninstall(t);case 6:this._render();case 7:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"_clearAll",value:(s=a(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._pm){e.next=2;break}return e.abrupt("return");case 2:if(window.confirm("Esto borrar TODOS los plugins instalados y recargar la pgina. Continuar?")){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this._pm.clearAll();case 6:window.location.reload();case 7:case"end":return e.stop()}},e,this)})),function(){return s.apply(this,arguments)})},{key:"_installFromUrl",value:(i=a(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._pm){e.next=2;break}return e.abrupt("return");case 2:if(t=window.prompt("URL del plugin (ES module con CORS o script que exponga window.SculptGLPlugin):")){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,this._pm.installFromUrl(t);case 8:e.next=14;break;case 10:e.prev=10,e.t0=e.catch(5),console.error(e.t0),window.alert("No se pudo instalar el plugin desde URL. Verific que sea ES module con CORS o defina window.SculptGLPlugin.");case 14:this._render();case 15:case"end":return e.stop()}},e,this,[[5,10]])})),function(){return i.apply(this,arguments)})},{key:"_installFromFile",value:(n=a(regeneratorRuntime.mark(function e(){var t,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._pm){e.next=2;break}return e.abrupt("return");case 2:(t=document.createElement("input")).type="file",t.accept=".js,.mjs,text/javascript,application/javascript",t.style.display="none",document.body.appendChild(t),t.onchange=a(regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.files&&t.files[0],document.body.removeChild(t),n){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,r._pm.installFromFile(n);case 7:e.next=13;break;case 9:e.prev=9,e.t0=e.catch(4),console.error(e.t0),window.alert("No se pudo instalar el plugin desde archivo. Asegurate de exportar default o definir window.SculptGLPlugin.");case 13:r._render();case 14:case"end":return e.stop()}},e,null,[[4,9]])})),t.click();case 9:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})}],r&&o(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();const p=new d},968(e,t,r){"use strict";r.d(t,{p8:()=>n,tb:()=>i});var n=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array;Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var e=0,t=arguments.length;t--;)e+=arguments[t]*arguments[t];return Math.sqrt(e)})}},__webpack_module_cache__={};function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var r=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(r.exports,r,r.exports,__webpack_require__),r.loaded=!0,r.exports}__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},__webpack_require__.d=(e,t)=>{for(var r in t)__webpack_require__.o(t,r)&&!__webpack_require__.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e);var __webpack_exports__={};return(()=>{"use strict";__webpack_require__(61);var e=__webpack_require__(406),t=__webpack_require__(445);function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,i(n.key),n)}}function i(e){var t=function(e){if("object"!=r(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=r(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==r(t)?t:t+""}var a={LINEAR:!1},o=function(){function e(t,r,n,i){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._vArOut=r,this._cArOut=n,this._mArOut=i,this._vAr=t.getVertices(),this._cAr=t.getColors(),this._mAr=t.getMaterials(),this._eAr=t.getEdges(),this._nbVertices=t.getNbVertices(),this._tagEdges=new Int32Array(t.getNbEdges())}var t,r;return t=e,(r=[{key:"computeTriangleEdgeVertex",value:function(e,t,r,n){var i=this._vAr,o=this._cAr,s=this._mAr,l=this._eAr,u=this._vArOut,c=this._cArOut,h=this._mArOut,f=this._tagEdges,d=3*e,p=3*t,_=3*r,g=f[n]-1,m=-1===g?this._nbVertices++:g,v=3*m,y=l[n];if(1===y||y>=3||a.LINEAR){if(-1!==g)return m;f[n]=m+1,u[v]=.5*(i[d]+i[p]),u[v+1]=.5*(i[d+1]+i[p+1]),u[v+2]=.5*(i[d+2]+i[p+2]),c[v]=.5*(o[d]+o[p]),c[v+1]=.5*(o[d+1]+o[p+1]),c[v+2]=.5*(o[d+2]+o[p+2]),h[v]=.5*(s[d]+s[p]),h[v+1]=.5*(s[d+1]+s[p+1]),h[v+2]=.5*(s[d+2]+s[p+2])}else-1===g?(f[n]=m+1,u[v]=.125*i[_]+.375*(i[d]+i[p]),u[v+1]=.125*i[_+1]+.375*(i[d+1]+i[p+1]),u[v+2]=.125*i[_+2]+.375*(i[d+2]+i[p+2]),c[v]=.125*o[_]+.375*(o[d]+o[p]),c[v+1]=.125*o[_+1]+.375*(o[d+1]+o[p+1]),c[v+2]=.125*o[_+2]+.375*(o[d+2]+o[p+2]),h[v]=.125*s[_]+.375*(s[d]+s[p]),h[v+1]=.125*s[_+1]+.375*(s[d+1]+s[p+1]),h[v+2]=.125*s[_+2]+.375*(s[d+2]+s[p+2])):(u[v]+=.125*i[_],u[v+1]+=.125*i[_+1],u[v+2]+=.125*i[_+2],c[v]+=.125*o[_],c[v+1]+=.125*o[_+1],c[v+2]+=.125*o[_+2],h[v]+=.125*s[_],h[v+1]+=.125*s[_+1],h[v+2]+=.125*s[_+2]);return m}},{key:"computeQuadEdgeVertex",value:function(e,t,r,n,i){var o=this._vAr,s=this._cAr,l=this._mAr,u=this._eAr,c=this._vArOut,h=this._cArOut,f=this._mArOut,d=this._tagEdges,p=3*e,_=3*t,g=3*r,m=3*n,v=d[i]-1,y=-1===v?this._nbVertices++:v,b=3*y,A=u[i];if(1===A||A>=3||a.LINEAR){if(-1!==v)return y;d[i]=y+1,c[b]=.5*(o[p]+o[_]),c[b+1]=.5*(o[p+1]+o[_+1]),c[b+2]=.5*(o[p+2]+o[_+2]),h[b]=.5*(s[p]+s[_]),h[b+1]=.5*(s[p+1]+s[_+1]),h[b+2]=.5*(s[p+2]+s[_+2]),f[b]=.5*(l[p]+l[_]),f[b+1]=.5*(l[p+1]+l[_+1]),f[b+2]=.5*(l[p+2]+l[_+2])}else-1===v?(d[i]=y+1,c[b]=.0625*(o[g]+o[m])+.375*(o[p]+o[_]),c[b+1]=.0625*(o[g+1]+o[m+1])+.375*(o[p+1]+o[_+1]),c[b+2]=.0625*(o[g+2]+o[m+2])+.375*(o[p+2]+o[_+2]),h[b]=.0625*(s[g]+s[m])+.375*(s[p]+s[_]),h[b+1]=.0625*(s[g+1]+s[m+1])+.375*(s[p+1]+s[_+1]),h[b+2]=.0625*(s[g+2]+s[m+2])+.375*(s[p+2]+s[_+2]),f[b]=.0625*(l[g]+l[m])+.375*(l[p]+l[_]),f[b+1]=.0625*(l[g+1]+l[m+1])+.375*(l[p+1]+l[_+1]),f[b+2]=.0625*(l[g+2]+l[m+2])+.375*(l[p+2]+l[_+2])):(c[b]+=.0625*(o[g]+o[m]),c[b+1]+=.0625*(o[g+1]+o[m+1]),c[b+2]+=.0625*(o[g+2]+o[m+2]),h[b]+=.0625*(s[g]+s[m]),h[b+1]+=.0625*(s[g+1]+s[m+1]),h[b+2]+=.0625*(s[g+2]+s[m+2]),f[b]+=.0625*(l[g]+l[m]),f[b+1]+=.0625*(l[g+1]+l[m+1]),f[b+2]+=.0625*(l[g+2]+l[m+2]));return y}},{key:"computeFaceVertex",value:function(e,t,r,n){var i=3*e,a=3*t,o=3*r,s=3*n,l=this._vAr,u=this._cAr,c=this._mAr,h=this._vArOut,f=this._cArOut,d=this._mArOut,p=this._nbVertices++,_=3*p;return h[_]=.25*(l[i]+l[a]+l[o]+l[s]),h[_+1]=.25*(l[i+1]+l[a+1]+l[o+1]+l[s+1]),h[_+2]=.25*(l[i+2]+l[a+2]+l[o+2]+l[s+2]),f[_]=.25*(u[i]+u[a]+u[o]+u[s]),f[_+1]=.25*(u[i+1]+u[a+1]+u[o+1]+u[s+1]),f[_+2]=.25*(u[i+2]+u[a+2]+u[o+2]+u[s+2]),d[_]=.25*(c[i]+c[a]+c[o]+c[s]),d[_+1]=.25*(c[i+1]+c[a+1]+c[o+1]+c[s+1]),d[_+2]=.25*(c[i+2]+c[a+2]+c[o+2]+c[s+2]),p}}])&&n(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),s=function(e,r,n,i){var o=e.getNbVertices();n.set(e.getColors().subarray(0,3*o)),i.set(e.getMaterials().subarray(0,3*o));for(var s=e.getVertices(),l=e.getFaces(),u=e.getEdges(),c=e.getFaceEdges(),h=e.getVerticesOnEdge(),f=e.getVerticesRingVertStartCount(),d=e.getVerticesRingVert(),p=e.getVerticesRingFaceStartCount(),_=e.getVerticesRingFace(),g=e.hasOnlyTriangles(),m=0;m<o;++m){var v=3*m,y=0,b=0,A=0,T=0,S=0,w=0,M=0;if(h[m]||a.LINEAR){var k=p[2*m],E=k+p[2*m+1];for(w=k;w<E;++w){var x=4*_[w],R=l[x],C=l[x+1],P=l[x+2],D=l[x+3],O=D===t.A.TRI_INDEX;M=t.A.TRI_INDEX,R===m?1===u[c[x]]?M=C:1===u[c[O?x+2:x+3]]&&(M=O?P:D):C===m?1===u[c[x]]?M=R:1===u[c[x+1]]&&(M=P):P===m?1===u[c[x+1]]?M=C:1===u[c[x+2]]&&(M=O?R:D):D===m&&(1===u[c[x+2]]?M=P:1===u[c[x+3]]&&(M=R)),M!==t.A.TRI_INDEX&&(y+=s[M*=3],b+=s[M+1],A+=s[M+2],T++)}T<2?(r[v]=s[v],r[v+1]=s[v+1],r[v+2]=s[v+2]):(T=.25/T,S=.75,r[v]=s[v]*S+y*T,r[v+1]=s[v+1]*S+b*T,r[v+2]=s[v+2]*S+A*T)}else{var I=f[2*m],F=f[2*m+1],L=I+F;for(w=I;w<L;++w)y+=s[M=3*d[w]],b+=s[M+1],A+=s[M+2];if(g)6===F?(T=.0625,S=.625):3===F?(T=.1875,S=.4375):(T=.375/F,S=.625),r[v]=s[v]*S+y*T,r[v+1]=s[v+1]*S+b*T,r[v+2]=s[v+2]*S+A*T;else{var V=0,N=0,B=0,U=0,j=p[2*m],G=j+p[2*m+1],W=0;for(w=j;w<G;++w){var z=l[3+(M=4*_[w])];if(z!==t.A.TRI_INDEX){W++;var X,K=l[M],H=l[M+1],Y=l[M+2];V+=s[X=K===m?3*Y:H===m?3*z:Y===m?3*K:3*H],N+=s[X+1],B+=s[X+2]}}W!==G-j?0!==W?(T=.5*(S=1/(1+.5*F+.25*W)),U=.25*S,r[v]=s[v]*S+y*T+V*U,r[v+1]=s[v+1]*S+b*T+N*U,r[v+2]=s[v+2]*S+A*T+B*U):(6===F?(T=.0625,S=.625):3===F?(T=.1875,S=.4375):(T=.375/F,S=.625),r[v]=s[v]*S+y*T,r[v+1]=s[v+1]*S+b*T,r[v+2]=s[v+2]*S+A*T):(4===F?(S=.5625,T=.09375,U=.015625):S=1-((T=1.5/(F*F))+(U=.25/(F*F)))*F,r[v]=s[v]*S+y*T+V*U,r[v+1]=s[v+1]*S+b*T+N*U,r[v+2]=s[v+2]*S+A*T+B*U)}}}},l=function(e,r,n,i,a){for(var s=e.getFaces(),l=e.getFaceEdges(),u=new o(e,r,n,i),c=0,h=e.getNbFaces();c<h;++c){var f,d,p,_,g,m=4*c,v=s[m],y=s[m+1],b=s[m+2],A=s[m+3],T=A!==t.A.TRI_INDEX;T?(f=u.computeQuadEdgeVertex(v,y,b,A,l[m]),d=u.computeQuadEdgeVertex(y,b,A,v,l[m+1]),p=u.computeQuadEdgeVertex(b,A,v,y,l[m+2]),_=u.computeQuadEdgeVertex(A,v,y,b,l[m+3]),g=u.computeFaceVertex(v,y,b,A)):(f=u.computeTriangleEdgeVertex(v,y,b,l[m]),d=u.computeTriangleEdgeVertex(y,b,v,l[m+1]),p=u.computeTriangleEdgeVertex(b,v,y,l[m+2])),a&&(m*=4,T?(a[m+1]=a[m+4]=f,a[m+6]=a[m+9]=d,a[m+11]=a[m+14]=p,a[m+3]=a[m+12]=_,a[m+2]=a[m+7]=a[m+8]=a[m+13]=g,a[m]=v,a[m+5]=y,a[m+10]=b,a[m+15]=A):(a[m]=a[m+5]=a[m+8]=f,a[m+1]=a[m+10]=a[m+12]=d,a[m+2]=a[m+6]=a[m+14]=p,a[m+3]=a[m+7]=a[m+11]=a[m+15]=t.A.TRI_INDEX,a[m+4]=v,a[m+9]=y,a[m+13]=b))}return u._tagEdges};a.fullSubdivision=function(e,r){var n=e.getNbVertices()+e.getNbEdges()+e.getNbQuads();r.setVertices(new Float32Array(3*n)),r.setColors(new Float32Array(3*n)),r.setMaterials(new Float32Array(3*n)),r.setFaces(new Uint32Array(4*e.getNbFaces()*4)),s(e,r.getVertices(),r.getColors(),r.getMaterials());var i=l(e,r.getVertices(),r.getColors(),r.getMaterials(),r.getFaces());e.hasUV()&&function(e,r,n){var i=r.getNbVertices(),a=new Uint32Array(2*i);a.set(e.getVerticesDuplicateStartCount());var o=e.getFaces(),s=e.getFacesTexCoord(),l=3*r.getNbFaces(),u=e.getTexCoords(),c=new Float32Array(t.A.getMemory(4*l*2),0,2*l),h=0,f=e.getNbVertices(),d=i-f;for(h=0;h<f;++h){var p=a[2*h];p>0&&(a[2*h]=p+d)}c.set(u),c.set(u.subarray(2*f),2*(f+d));var _=d+e.getNbTexCoords(),g=e.getFaceEdges(),m=new Uint32Array(n.length),v=new Uint32Array(n.length);for(f=o.length,h=0;h<f;++h){var y=g[h];if(y!==t.A.TRI_INDEX){var b=(h+1)%4==0?h-3:h+1,A=s[h],T=s[b];T===t.A.TRI_INDEX&&(T=s[h-2]);var S=n[y]-1,w=v[y],M=A>T?A:T,k=A<T?A:T;0!==w?w===M&&m[y]===k||(c[2*_]=.5*(u[2*A]+u[2*T]),c[2*_+1]=.5*(u[2*A+1]+u[2*T+1]),a[2*S]=_++,a[2*S+1]=1):(c[2*S]=.5*(u[2*A]+u[2*T]),c[2*S+1]=.5*(u[2*A+1]+u[2*T+1]),m[y]=k,v[y]=M)}}var E=new Float32Array(2*_);E.set(c.subarray(0,2*_)),r.setTexCoords(E),r.setVerticesDuplicateStartCount(a),function(e,r,n){for(var i=e.getFacesTexCoord(),a=r.getFaces(),o=new Uint32Array(a.length),s=e.getFaceEdges(),l=e.getNbVertices(),u=r.getNbVertices()-l,c=r.getVerticesDuplicateStartCount(),h=r.getTexCoords(),f=0,d=e.getNbFaces();f<d;++f){var p=4*f,_=i[p],g=i[p+1],m=i[p+2],v=i[p+3];_>=l&&(_+=u),g>=l&&(g+=u),m>=l&&(m+=u),v!==t.A.TRI_INDEX&&v>=l&&(v+=u);var y=s[p],b=n[y]-1;b<0?b=c[2*(-b-1)]:c[2*b]>0&&(n[y]=-b);var A=n[y=s[p+1]]-1;A<0?A=c[2*(-A-1)]:c[2*A]>0&&(n[y]=-A);var T=n[y=s[p+2]]-1;if(T<0?T=c[2*(-T-1)]:c[2*T]>0&&(n[y]=-T),p*=4,v!==t.A.TRI_INDEX){var S=n[y=s[4*f+3]]-1;S<0?S=c[2*(-S-1)]:c[2*S]>0&&(n[y]=-S),o[p+1]=o[p+4]=b,o[p+6]=o[p+9]=A,o[p+11]=o[p+14]=T,o[p+3]=o[p+12]=S,o[p+2]=o[p+7]=o[p+8]=o[p+13]=a[p+2],o[p]=_,o[p+5]=g,o[p+10]=m,o[p+15]=v;var w=2*a[p+2];h[w]=.25*(h[2*_]+h[2*g]+h[2*m]+h[2*v]),h[w+1]=.25*(h[2*_+1]+h[2*g+1]+h[2*m+1]+h[2*v+1])}else o[p]=o[p+5]=o[p+8]=b,o[p+1]=o[p+10]=o[p+12]=A,o[p+2]=o[p+6]=o[p+14]=T,o[p+3]=o[p+7]=o[p+11]=o[p+15]=t.A.TRI_INDEX,o[p+4]=_,o[p+9]=g,o[p+13]=m}r.setFacesTexCoord(o)}(e,r,n)}(e,r,i),r.allocateArrays()},a.partialSubdivision=function(e,t,r,n){s(e,t,r,n),l(e,t,r,n)};const u=a;var c=__webpack_require__(322),h=__webpack_require__(968);function f(){var e=new h.tb(9);return h.tb!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[5]=0,e[6]=0,e[7]=0),e[0]=1,e[4]=1,e[8]=1,e}function d(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e}function p(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e}function _(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],c=t[8],h=t[9],f=t[10],d=t[11],p=t[12],_=t[13],g=t[14],m=t[15],v=r*s-n*o,y=r*l-i*o,b=r*u-a*o,A=n*l-i*s,T=n*u-a*s,S=i*u-a*l,w=c*_-h*p,M=c*g-f*p,k=c*m-d*p,E=h*g-f*_,x=h*m-d*_,R=f*m-d*g,C=v*R-y*x+b*E+A*k-T*M+S*w;return C?(C=1/C,e[0]=(s*R-l*x+u*E)*C,e[1]=(l*k-o*R-u*M)*C,e[2]=(o*x-s*k+u*w)*C,e[3]=(i*x-n*R-a*E)*C,e[4]=(r*R-i*k+a*M)*C,e[5]=(n*k-r*x-a*w)*C,e[6]=(_*S-g*T+m*A)*C,e[7]=(g*b-p*S-m*y)*C,e[8]=(p*T-_*b+m*v)*C,e):null}var g=__webpack_require__(827);function m(e){return m="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},m(e)}function v(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,y(n.key),n)}}function y(e){var t=function(e){if("object"!=m(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=m(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==m(t)?t:t+""}var b=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._parent=t||null,this._depth=t?t._depth+1:0,this._children=[],this._aabbLoose=[1/0,1/0,1/0,-1/0,-1/0,-1/0],this._aabbSplit=[1/0,1/0,1/0,-1/0,-1/0,-1/0],this._iFaces=[],this._flag=0}var t,r;return t=e,(r=[{key:"resetNbFaces",value:function(e){var t=this._iFaces;t.length=e;for(var r=0;r<e;++r)t[r]=r}},{key:"build",value:function(t){var r=0,n=e.STACK;n[0]=this;for(var i=1,a=[];i>0;){var o=n[--i],s=o._iFaces.length;if(s>e.MAX_FACES&&o._depth<e.MAX_DEPTH){o.constructChildren(t);var l=o._children;for(r=0;r<8;++r)n[i+r]=l[r];i+=8}else s>0&&a.push(o)}var u=a.length;for(r=0;r<u;++r)a[r].constructLeaf(t)}},{key:"constructLeaf",value:function(e){for(var t=this._iFaces,r=t.length,n=1/0,i=1/0,a=1/0,o=-1/0,s=-1/0,l=-1/0,u=e.getFaceBoxes(),c=e.getFacePosInLeaf(),h=e.getFaceLeaf(),f=0;f<r;++f){var d=t[f];h[d]=this,c[d]=f;var p=u[d*=6],_=u[d+1],g=u[d+2],m=u[d+3],v=u[d+4],y=u[d+5];p<n&&(n=p),m>o&&(o=m),_<i&&(i=_),v>s&&(s=v),g<a&&(a=g),y>l&&(l=y)}this.expandsAabbLoose(n,i,a,o,s,l)}},{key:"constructChildren",value:function(t){for(var r=this._aabbSplit,n=r[0],i=r[1],a=r[2],o=r[3],s=r[4],l=r[5],u=.5*(o-n),c=.5*(s-i),h=.5*(l-a),f=.5*(o+n),d=.5*(s+i),p=.5*(l+a),_=new e(this),g=new e(this),m=new e(this),v=new e(this),y=new e(this),b=new e(this),A=new e(this),T=new e(this),S=_._iFaces,w=g._iFaces,M=m._iFaces,k=v._iFaces,E=y._iFaces,x=b._iFaces,R=A._iFaces,C=T._iFaces,P=t.getFaceCenters(),D=this._iFaces,O=D.length,I=0;I<O;++I){var F=D[I],L=3*F,V=P[L],N=P[L+1],B=P[L+2];V>f?N>d?B>p?R.push(F):x.push(F):B>p?M.push(F):w.push(F):N>d?B>p?C.push(F):E.push(F):B>p?k.push(F):S.push(F)}_.setAabbSplit(n,i,a,f,d,p),g.setAabbSplit(n+u,i,a,f+u,d,p),m.setAabbSplit(f,d-c,p,o,s-c,l),v.setAabbSplit(n,i,a+h,f,d,p+h),y.setAabbSplit(n,i+c,a,f,d+c,p),b.setAabbSplit(f,d,p-h,o,s,l-h),A.setAabbSplit(f,d,p,o,s,l),T.setAabbSplit(f-u,d,p,o-u,s,l),this._children.length=0,this._children.push(_,g,m,v,y,b,A,T),D.length=0}},{key:"setAabbSplit",value:function(e,t,r,n,i,a){var o=this._aabbSplit;o[0]=e,o[1]=t,o[2]=r,o[3]=n,o[4]=i,o[5]=a}},{key:"setAabbLoose",value:function(e,t,r,n,i,a){var o=this._aabbLoose;o[0]=e,o[1]=t,o[2]=r,o[3]=n,o[4]=i,o[5]=a}},{key:"collectIntersectRay",value:function(t,r,n,i){var a=t[0],o=t[1],s=t[2],l=1/r[0],u=1/r[1],c=1/r[2],h=0,f=e.STACK;f[0]=this;for(var d=1;d>0;){var p=f[--d],_=p._aabbLoose,g=(_[0]-a)*l,m=(_[3]-a)*l,v=(_[1]-o)*u,y=(_[4]-o)*u,b=(_[2]-s)*c,A=(_[5]-s)*c,T=Math.max(Math.min(g,m),Math.min(v,y),Math.min(b,A)),S=Math.min(Math.max(g,m),Math.max(v,y),Math.max(b,A));if(!(S<0||T>S)){var w=p._children;if(8===w.length){for(var M=0;M<8;++M)f[d+M]=w[M];d+=8}else{i&&i.push(p);var k=p._iFaces;n.set(k,h),h+=k.length}}}return new Uint32Array(n.subarray(0,h))}},{key:"collectIntersectSphere",value:function(t,r,n,i){var a=t[0],o=t[1],s=t[2],l=0,u=e.STACK;u[0]=this;for(var c=1;c>0;){var h,f,d,p=u[--c],_=p._aabbLoose;if(!((h=_[0]>a?_[0]-a:_[3]<a?_[3]-a:0)*h+(f=_[1]>o?_[1]-o:_[4]<o?_[4]-o:0)*f+(d=_[2]>s?_[2]-s:_[5]<s?_[5]-s:0)*d>r)){var g=p._children;if(8===g.length){for(var m=0;m<8;++m)u[c+m]=g[m];c+=8}else{i&&i.push(p);var v=p._iFaces;n.set(v,l),l+=v.length}}}return new Uint32Array(n.subarray(0,l))}},{key:"addFace",value:function(t,r,n,i,a,o,s,l,u,c){var h=e.STACK;h[0]=this;for(var f=1;f>0;){var d=h[--f],p=d._aabbSplit;if(!(l<=p[0]||u<=p[1]||c<=p[2]||l>p[3]||u>p[4]||c>p[5])){var _=d._aabbLoose;r<_[0]&&(_[0]=r),n<_[1]&&(_[1]=n),i<_[2]&&(_[2]=i),a>_[3]&&(_[3]=a),o>_[4]&&(_[4]=o),s>_[5]&&(_[5]=s);var g=d._children;if(8!==g.length)return d._iFaces.push(t),d;for(var m=0;m<8;++m)h[f+m]=g[m];f+=8}}}},{key:"pruneIfPossible",value:function(){for(var e=this;e._parent;){var t=e._parent,r=t._children;if(0===r.length)return;for(var n=0;n<8;++n){var i=r[n];if(i._iFaces.length>0||8===i._children.length)return}r.length=0,e=t}}},{key:"expandsAabbLoose",value:function(e,t,r,n,i,a){for(var o=this;o;){var s=o._aabbLoose,l=!1;e<s[0]&&(s[0]=e,l=!0),t<s[1]&&(s[1]=t,l=!0),r<s[2]&&(s[2]=r,l=!0),n>s[3]&&(s[3]=n,l=!0),i>s[4]&&(s[4]=i,l=!0),a>s[5]&&(s[5]=a,l=!0),o=l?o._parent:null}}}])&&v(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();b.FLAG=0,b.MAX_DEPTH=8,b.MAX_FACES=100,function(){for(var e=1+7*b.MAX_DEPTH,t=b.STACK=new Array(e),r=0;r<e;++r)t[r]=null}();const A=b;var T=__webpack_require__(263);function S(e){return S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},S(e)}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,M(n.key),n)}}function M(e){var t=function(e){if("object"!=S(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=S(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==S(t)?t:t+""}const k=function(){function e(t,r,n,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._gl=t,this._location=t.getAttribLocation(r,n),this._size=i,this._type=a}var t,r;return t=e,(r=[{key:"unbind",value:function(){this._gl.disableVertexAttribArray(this._location)}},{key:"bindToBuffer",value:function(e){var t=this._gl;e.bind(),t.enableVertexAttribArray(this._location),t.vertexAttribPointer(this._location,this._size,this._type,!1,0,0)}}])&&w(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),E="// reference\n// https://www.khronos.org/registry/gles/extensions/EXT/EXT_sRGB.txt\n\n#define LIN_SRGB(x) x < 0.0031308 ? x * 12.92 : 1.055 * pow(x, 1.0/2.4) - 0.055\nfloat linearTosRGB(const in float c) {\n    return LIN_SRGB(c);\n}\nvec3 linearTosRGB(const in vec3 c) {\n    return vec3(LIN_SRGB(c.r), LIN_SRGB(c.g), LIN_SRGB(c.b));\n}\nvec4 linearTosRGB(const in vec4 c) {\n    return vec4(LIN_SRGB(c.r), LIN_SRGB(c.g), LIN_SRGB(c.b), c.a);\n}\n\n#define SRGB_LIN(x) x < 0.04045 ? x * (1.0 / 12.92) : pow((x + 0.055) * (1.0 / 1.055), 2.4)\nfloat sRGBToLinear(const in float c) {\n    return SRGB_LIN(c);\n}\nvec3 sRGBToLinear(const in vec3 c) {\n    return vec3(SRGB_LIN(c.r), SRGB_LIN(c.g), SRGB_LIN(c.b));\n}\nvec4 sRGBToLinear(const in vec4 c) {\n    return vec4(SRGB_LIN(c.r), SRGB_LIN(c.g), SRGB_LIN(c.b), c.a);\n}\n\n#define RANGE 5.0\n// http://graphicrants.blogspot.fr/2009/04/rgbm-color-encoding.html\nvec4 encodeRGBM(const in vec3 col) {\n    vec4 rgbm;\n    vec3 color = col / RANGE;\n    rgbm.a = clamp( max( max( color.r, color.g ), max( color.b, 1e-6 ) ), 0.0, 1.0 );\n    rgbm.a = ceil( rgbm.a * 255.0 ) / 255.0;\n    rgbm.rgb = color / rgbm.a;\n    return rgbm;\n}\n\nvec3 decodeRGBM(const in vec4 col) {\n  return RANGE * col.rgb * col.a;\n}\n";var x={vertexName:"VertexName",fragmentName:"FragmentName",activeAttributes:{vertex:!0,normal:!0,material:!0,color:!0}};x.showSymmetryLine=(0,T.A)().mirrorline,x.darkenUnselected=(0,T.A)().darkenunselected,x.uniformNames={},x.uniformNames.commonUniforms=["uMV","uMVP","uN","uEM","uEN","uFlat","uPlaneO","uPlaneN","uSym","uCurvature","uAlpha","uFov","uDarken"],x.strings={},x.strings.colorSpaceGLSL=E,x.strings.vertUniforms=["uniform mat4 uMV;","uniform mat4 uMVP;","uniform mat3 uN;","uniform mat4 uEM;","uniform mat3 uEN;","uniform float uAlpha;"].join("\n"),x.strings.fragColorUniforms=["uniform vec3 uPlaneN;","uniform vec3 uPlaneO;","uniform int uSym;","uniform int uDarken;","uniform float uCurvature;","uniform float uFov;","varying float vMasking;","uniform int uFlat;"].join("\n"),x.strings.fragColorFunction=["// http://madebyevan.com/shaders/curvature/\n#extension GL_OES_standard_derivatives : enable\nvec3 computeCurvature( const in vec3 vertex, const in vec3 normal, const in vec3 color, const in float str, const in float fov) {\n  if(str < 1e-3)\n    return color;\n#ifndef GL_OES_standard_derivatives\n    return color * pow(length(normal), str * 100.0);\n#else\n  vec3 n = normalize(normal);\n  // Compute curvature\n  vec3 dx = dFdx(n);\n  vec3 dy = dFdy(n);\n  vec3 xneg = n - dx;\n  vec3 xpos = n + dx;\n  vec3 yneg = n - dy;\n  vec3 ypos = n + dy;\n  // fov < 0.0 means ortho\n  float depth = fov > 0.0 ? length(vertex) * fov : -fov;\n  float cur = (cross(xneg, xpos).y - cross(yneg, ypos).x) * str * 80.0 / depth;\n  return mix(mix(color, color * 0.3, clamp(-cur * 15.0, 0.0, 1.0)), color * 2.0, clamp(cur * 25.0, 0.0, 1.0));\n#endif\n}\n",E,"#extension GL_OES_standard_derivatives : enable","vec3 getNormal() {","  #ifndef GL_OES_standard_derivatives","    return normalize(gl_FrontFacing ? vNormal : -vNormal);","  #else","    return uFlat == 0 ? normalize(gl_FrontFacing ? vNormal : -vNormal) : -normalize(cross(dFdy(vVertex), dFdx(vVertex)));","  #endif","}","vec4 encodeFragColor(const in vec3 frag, const in float alpha) {","  vec3 col = computeCurvature(vVertex, vNormal, frag, uCurvature, uFov);","  if(uDarken == 1) col *= 0.3;","  col *= (0.3 + 0.7 * vMasking);","  if(uSym == 1 && abs(dot(uPlaneN, vVertex - uPlaneO)) < 0.15)","      col = min(col * 1.5, 1.0);","  return alpha != 1.0 ? vec4(col * alpha, alpha) : encodeRGBM(col);","}"].join("\n");var R,C=function(e){var t="",r=e.match(/^\s*(#extension).*/gm);if(r)for(var n={},i=0,a=r.length;i<a;++i){var o=r[i].substr(r[i].indexOf("#extension"));e=e.replace(r[i],""),n[o]||(n[o]=!0,t+=o+"\n")}var s="";-1===e.indexOf("#version")&&(s+="#version 100\n");var l="";return/precision\s+(high|low|medium)p\s+float/.test(e)||(l+="#ifdef GL_FRAGMENT_PRECISION_HIGH\n  precision highp float;\n#else\n  precision mediump float;\n#endif\n"),s+t+l+e};x.getOrCreate=function(e){if(this.program)return this;var t="\n#define SHADER_NAME "+this.vertexName+"\n",r="\n#define SHADER_NAME "+this.fragmentName+"\n",n=e.createShader(e.VERTEX_SHADER);e.shaderSource(n,C(this.vertex+t)),e.compileShader(n);var i=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(i,C(this.fragment+r)),e.compileShader(i);var a=this.program=e.createProgram();e.attachShader(a,n),e.attachShader(a,i),e.linkProgram(a),e.useProgram(a);var o=e.getShaderInfoLog(n),s=e.getShaderInfoLog(i),l=e.getProgramInfoLog(a);return o&&console.warn(this.vertexName+" (vertex)\n"+o),s&&console.warn(this.fragmentName+" (fragment)\n"+s),l&&console.warn(this.fragmentName+" (program)\n"+l),this.initAttributes(e),this.initUniforms(e),this},x.initUniforms=function(e){for(var t=this.program,r=this.uniformNames,n=this.uniforms,i=0,a=r.length;i<a;++i){var o=r[i];n[o]=e.getUniformLocation(t,o)}},x.updateUniforms=(R=[0,0,0],function(e,t){var r=e.getGL(),n=x.darkenUnselected&&t.getIndexSelectMesh(e)<0,i=x.showSymmetryLine&&e.getID()===t.getMesh().getID()&&t.getSculptManager().getSymmetry(),a=this.uniforms;r.uniformMatrix4fv(a.uEM,!1,e.getEditMatrix()),r.uniformMatrix3fv(a.uEN,!1,e.getEN()),r.uniformMatrix4fv(a.uMV,!1,e.getMV()),r.uniformMatrix4fv(a.uMVP,!1,e.getMVP()),r.uniformMatrix3fv(a.uN,!1,e.getN()),r.uniform1i(a.uDarken,n?1:0),r.uniform1i(a.uFlat,e.getFlatShading()),r.uniform3fv(a.uPlaneO,c.Z0(R,e.getSymmetryOrigin(),e.getMV())),r.uniform3fv(a.uPlaneN,c.S8(R,c.ei(R,e.getSymmetryNormal(),e.getN()))),r.uniform1i(a.uSym,i?1:0),r.uniform1f(a.uAlpha,e.getOpacity()),r.uniform1f(a.uCurvature,e.getCurvature());var o=t.getCamera();r.uniform1f(a.uFov,o.isOrthographic()?25*-Math.abs(o._trans[2]):o.getFov())}),x.draw=function(e,t){e.getGL().useProgram(this.program),this.bindAttributes(e),this.updateUniforms(e,t),this.drawBuffer(e)},x.drawBuffer=function(e){var t=e.getGL();e.isUsingDrawArrays()?t.drawArrays(e.getMode(),0,e.getCount()):(e.getIndexBuffer().bind(),t.drawElements(e.getMode(),e.getCount(),t.UNSIGNED_INT,0)),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),this.unbindAttributes()},x.setTextureParameters=function(e,r){e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MAG_FILTER,e.LINEAR),t.A.isPowerOfTwo(r.width)&&t.A.isPowerOfTwo(r.height)?(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR_MIPMAP_LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.REPEAT),e.generateMipmap(e.TEXTURE_2D)):(e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE))},x.onLoadTexture0=function(e,t,r){this.texture0=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this.texture0),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),x.setTextureParameters(e,t),e.bindTexture(e.TEXTURE_2D,null),r&&r.render()},x.getDummyTexture=function(e){return this._dummyTex||(this._dummyTex=e.createTexture(),e.bindTexture(e.TEXTURE_2D,this._dummyTex),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),e.bindTexture(e.TEXTURE_2D,null)),this._dummyTex},x.getOrCreateTexture0=function(e,t,r){if(void 0!==this.texture0)return this.texture0;this.texture0=null;var n=new Image;return n.src=t,n.onload=this.onLoadTexture0.bind(this,e,n,r),!1},x.initAttributes=function(e){var t=this.program,r=this.attributes;r.aVertex=new k(e,t,"aVertex",3,e.FLOAT),r.aNormal=new k(e,t,"aNormal",3,e.FLOAT),r.aColor=new k(e,t,"aColor",3,e.FLOAT),r.aMaterial=new k(e,t,"aMaterial",3,e.FLOAT)},x.bindAttributes=function(e){var t=this.attributes,r=this.activeAttributes;r.vertex&&t.aVertex.bindToBuffer(e.getVertexBuffer()),r.normal&&t.aNormal.bindToBuffer(e.getNormalBuffer()),r.color&&t.aColor.bindToBuffer(e.getColorBuffer()),r.material&&t.aMaterial.bindToBuffer(e.getMaterialBuffer())},x.unbindAttributes=function(){var e=this.attributes,t=this.activeAttributes;t.vertex&&e.aVertex.unbind(),t.normal&&e.aNormal.unbind(),t.color&&e.aColor.unbind(),t.material&&e.aMaterial.unbind()},x.getCopy=function(){for(var e=Object.keys(x),t={},r=0,n=e.length;r<n;++r)t[e[r]]=this[e[r]];return t.program=null,t};const P=x,D="#define PI 3.1415926535897932384626433832795\n#define PI_2 (2.0 * 3.1415926535897932384626433832795)\n#define INV_PI 1.0 / PI\n#define INV_LOG2 1.4426950408889634073599246810019\n\nuniform sampler2D uTexture0;\nuniform float uExposure;\nuniform mat3 uIblTransform;\nuniform vec3 uSPH[9];\n\nuniform vec2 uEnvSize;\n#define LIMIT_LOD 5.0\n\n// https://mynameismjp.wordpress.com/2008/12/12/logluv-encoding-for-hdr/\nconst mat3 LUVInverse = mat3(6.0013, -2.700, -1.7995, -1.332, 3.1029, -5.7720,\n                             0.3007, -1.088, 5.6268);\nvec3 decodeLUV(const in vec4 logLuv) {\n  float Le = logLuv.z * 255.0 + logLuv.w;\n  vec3 xp;\n  xp.y = exp2((Le - 127.0) / 2.0);\n  xp.z = xp.y / logLuv.y;\n  xp.x = logLuv.x * xp.z;\n  return max(LUVInverse * xp, 0.0);\n}\n\nvec2 toUVMipmap(const in float lod, const in vec2 uv) {\n  float widthForLevel = uEnvSize.x / exp2(lod);\n  vec2 uvSpaceLocal = vec2(1.0) + uv * (widthForLevel - 2.0);\n  uvSpaceLocal.y += uEnvSize.y - widthForLevel * 2.0;\n  return uvSpaceLocal / uEnvSize;\n}\n\nvec2 directionToUV(const in vec3 dir) {\n  vec3 signOct = sign(dir);\n  vec3 uvOct = dir / dot(dir, signOct);\n  if (uvOct.z < 0.0) {\n    uvOct.xy = signOct.xy * (1.0 - abs(uvOct)).yx;\n  }\n  return uvOct.xy * 0.5 + 0.5;\n}\n\nvec3 texturePanoramaLod(const in vec3 direction, const in float rLinear) {\n  float lod = rLinear * (LIMIT_LOD - 1.0);\n  vec2 uvBase = directionToUV(direction);\n  return decodeLUV(mix(texture2D(uTexture0, toUVMipmap(floor(lod), uvBase)),\n                       texture2D(uTexture0, toUVMipmap(ceil(lod), uvBase)),\n                       fract(lod)));\n}\n\nvec3 integrateBRDFApprox(const in vec3 specular, float roughness, float NoV) {\n  const vec4 c0 = vec4(-1, -0.0275, -0.572, 0.022);\n  const vec4 c1 = vec4(1, 0.0425, 1.04, -0.04);\n  vec4 r = roughness * c0 + c1;\n  float a004 = min(r.x * r.x, exp2(-9.28 * NoV)) * r.x + r.y;\n  vec2 AB = vec2(-1.04, 1.04) * a004 + r.zw;\n  return specular * AB.x + AB.y;\n}\n\nvec3 getSpecularDominantDir(const in vec3 N, const in vec3 R,\n                            const in float realRoughness) {\n  float smoothness = 1.0 - realRoughness;\n  return mix(N, R, smoothness * (sqrt(smoothness) + realRoughness));\n}\n\nvec3 approximateSpecularIBL(const in vec3 specularColor, float rLinear,\n                            const in vec3 N, const in vec3 V) {\n  float NoV = clamp(dot(N, V), 0.0, 1.0);\n  vec3 R = normalize((2.0 * NoV) * N - V);\n  R = getSpecularDominantDir(N, R, rLinear);\n  vec3 prefilteredColor = texturePanoramaLod(uIblTransform * R, rLinear);\n  return prefilteredColor * integrateBRDFApprox(specularColor, rLinear, NoV);\n}\n\n// expect shCoefs uniform\n// https://github.com/cedricpinson/envtools/blob/master/Cubemap.cpp#L523\nvec3 sphericalHarmonics(const in vec3 N) {\n  float x = N.x;\n  float y = N.y;\n  float z = -N.z;\n  vec3 result = uSPH[0] + uSPH[1] * y + uSPH[2] * z + uSPH[3] * x +\n                uSPH[4] * y * x + uSPH[5] * y * z +\n                uSPH[6] * (3.0 * z * z - 1.0) + uSPH[7] * (z * x) +\n                uSPH[8] * (x * x - y * y);\n  return max(result, vec3(0.0));\n}\n\nvec3 computeIBL_UE4(const in vec3 N, const in vec3 V, const in vec3 albedo,\n                    const in float roughness, const in vec3 specular) {\n  vec3 color = albedo * sphericalHarmonics(uIblTransform * N);\n  color += approximateSpecularIBL(specular, roughness, N, V);\n  return color;\n}\n";var O=P.getCopy();O.vertexName=O.fragmentName="ShadingPBR",O.textures={};var I="resources/environments/";O.environments=[{path:I+"mpumalanga_veld_1k.png",sph:[.136819,.174125,.253762,.027778,.056838,.131221,.074356,.086793,.099181,-.07904,-.091269,-.102346,-.02755,-.0323,-.039217,.031822,.034773,.039945,.017235,.021044,.026136,-.106608,-.11864,-.132761,.041,.049794,.061183],exposure:2.5,name:"Mpumalanga veld"},{path:I+"venetian_crossroads_1k.png",sph:[.200626,.198426,.209579,.090452,.127807,.18839,.093188,.103245,.106131,.033349,.054751,.067044,.07435,.08167,.079716,.063127,.08594,.10171,.007751,.00571,-791e-6,.104134,.103979,.094236,-.022747,-.028166,-.037714],exposure:2.5,name:"Venetian crossroads"},{path:I+"studio_small_01_1k.png",sph:[.534107,.589985,.617478,.119999,.13048,.128019,.089872,.088707,.088017,.099999,.151282,.138458,.005015,.035588,.027592,.114999,.116739,.120579,-.057997,-.069532,-.070401,.385123,.411714,.454725,.303242,.333004,.35027],exposure:.5,name:"Studio small 01"},{path:I+"moonless_golf_1k.png",sph:[.137579,.112906,.09347,.070711,.066043,.065337,-.029564,-.02072,-.007737,-.037254,-.03327,-.028294,-.023847,-.021208,-.018767,-.007873,-.002587,.003955,.009241,.007711,.006063,.017917,.011733,.007669,.036859,.026285,.01474],exposure:1,name:"Moonless golf"},{path:I+"winter_river_1k.png",sph:[.560145,.554695,.513523,-.213105,-.15519,-.063568,.135182,.114211,.069349,.172852,.15182,.105477,.065753,.06405,.052622,.096352,.086557,.063826,.02183,.01656,.008804,.186193,.16372,.119627,.025363,.022278,.014461],exposure:.5,name:"Winter river"}];var F=(0,T.A)();O.idEnv=Math.min(F.environment,O.environments.length-1),O.exposure=void 0===F.exposure?O.environments[O.idEnv].exposure:Math.min(F.exposure,5),O.uniforms={},O.attributes={},O.uniformNames=["uIblTransform","uTexture0","uAlbedo","uRoughness","uMetallic","uExposure","uSPH","uEnvSize"],Array.prototype.push.apply(O.uniformNames,P.uniformNames.commonUniforms),O.vertex=["attribute vec3 aVertex;","attribute vec3 aNormal;","attribute vec3 aColor;","attribute vec3 aMaterial;",P.strings.vertUniforms,"uniform float uRoughness;","uniform float uMetallic;","uniform vec3 uAlbedo;","varying vec3 vVertex;","varying vec3 vNormal;","varying vec3 vAlbedo;","varying float vRoughness;","varying float vMetallic;","varying float vMasking;","void main() {","  vAlbedo = uAlbedo.x >= 0.0 ? uAlbedo : aColor;","  vRoughness = uRoughness >= 0.0 ? uRoughness : aMaterial.x;","  vMetallic = uMetallic >= 0.0 ? uMetallic : aMaterial.y;","  vMasking = aMaterial.z;","  vNormal = mix(aNormal, uEN * aNormal, vMasking);","  vNormal = normalize(uN * vNormal);","  vec4 vertex4 = vec4(aVertex, 1.0);","  vertex4 = mix(vertex4, uEM * vertex4, vMasking);","  vVertex = vec3(uMV * vertex4);","  gl_Position = uMVP * vertex4;","}"].join("\n"),O.fragment=["varying vec3 vVertex;","varying vec3 vNormal;","varying vec3 vAlbedo;","varying float vRoughness;","varying float vMetallic;","uniform float uAlpha;",P.strings.fragColorUniforms,P.strings.fragColorFunction,D,"","void main(void) {","  vec3 normal = getNormal();","  float roughness = max( 0.0001, vRoughness );","  vec3 linColor = sRGBToLinear(vAlbedo);","  vec3 albedo = linColor * (1.0 - vMetallic);","  vec3 specular = mix( vec3(0.04), linColor, vMetallic);","","  vec3 color = uExposure * computeIBL_UE4( normal, -normalize(vVertex), albedo, roughness, specular );","  gl_FragColor = encodeFragColor(color, uAlpha);","}"].join("\n"),O.onLoadEnvironment=function(e,t,r,n){if(!e.status||200===e.status||e.response&&e.response.byteLength){var i=e.width||Math.sqrt(e.response.byteLength/8),a=2*i;n.size=[i,a],n.texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,n.texture),e.response?t.texImage2D(t.TEXTURE_2D,0,t.RGBA,i,a,0,t.RGBA,t.UNSIGNED_BYTE,new Uint8Array(e.response)):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.REPEAT),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.REPEAT),t.bindTexture(t.TEXTURE_2D,null),r&&r.render()}},O.getOrCreateEnvironment=function(e,t,r){if(void 0!==r.texture)return r.texture;if(r.texture=null,r.path.endsWith("png")){var n=new Image;return n.src=r.path,n.onload=O.onLoadEnvironment.bind(this,n,e,t,r),null}var i=new XMLHttpRequest;return i.open("GET",r.path,!0),i.responseType="arraybuffer",i.onload=O.onLoadEnvironment.bind(this,i,e,t,r),i.send(null),null};var L=f();O.updateUniforms=function(e,t){var r=e.getGL(),n=this.uniforms;d(L,t.getCamera().getView()),r.uniformMatrix3fv(n.uIblTransform,!1,p(L,L)),r.uniform3fv(n.uAlbedo,e.getAlbedo()),r.uniform1f(n.uRoughness,e.getRoughness()),r.uniform1f(n.uMetallic,e.getMetallic()),r.uniform1f(n.uExposure,O.exposure);var i=O.environments[O.idEnv];r.uniform3fv(n.uSPH,i.sph),i.size&&r.uniform2fv(n.uEnvSize,i.size),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,O.getOrCreateEnvironment(r,t,i)||this.getDummyTexture(r)),r.uniform1i(n.uTexture0,0),P.updateUniforms.call(this,e,t)};const V=O;var N=__webpack_require__(865),B=P.getCopy();B.vertexName=B.fragmentName="Matcap",B.textures={},B.createTexture=function(e,t,r){var n=e.createTexture();e.bindTexture(e.TEXTURE_2D,n),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,t),B.setTextureParameters(e,t),e.bindTexture(e.TEXTURE_2D,null),B.textures[r]=n};var U="resources/matcaps/";B.matcaps=[{path:U+"matcapFV.jpg",name:"matcap FV"},{path:U+"redClay.jpg",name:"Red clay"},{path:U+"skinHazardousarts.jpg",name:"Skin hazardousarts"},{path:U+"skinHazardousarts2.jpg",name:"Skin Hazardousarts2"},{path:U+"pearl.jpg",name:(0,N.A)("matcapPearl")},{path:U+"clay.jpg",name:(0,N.A)("matcapClay")},{path:U+"skin.jpg",name:(0,N.A)("matcapSkin")},{path:U+"green.jpg",name:(0,N.A)("matcapGreen")},{path:U+"white.jpg",name:(0,N.A)("matcapWhite")}],B.uniforms={},B.attributes={},B.uniformNames=["uTexture0","uAlbedo"],Array.prototype.push.apply(B.uniformNames,P.uniformNames.commonUniforms),B.vertex=["attribute vec3 aVertex;","attribute vec3 aNormal;","attribute vec3 aColor;","attribute vec3 aMaterial;",P.strings.vertUniforms,"varying vec3 vVertex;","varying vec3 vNormal;","varying vec3 vColor;","varying float vMasking;","varying vec3 vVertexPres;","uniform vec3 uAlbedo;","void main() {","  vColor = uAlbedo.x >= 0.0 ? uAlbedo : aColor;","  vMasking = aMaterial.z;","  vNormal = mix(aNormal, uEN * aNormal, vMasking);","  vNormal = normalize(uN * vNormal);","  vec4 vertex4 = vec4(aVertex, 1.0);","  vertex4 = mix(vertex4, uEM * vertex4, vMasking);","  vVertex = vec3(uMV * vertex4);","  vVertexPres = vVertex / max(1.0, abs(uMV[3][2]));","  gl_Position = uMVP * vertex4;","}"].join("\n"),B.fragment=["uniform sampler2D uTexture0;","varying vec3 vVertex;","varying vec3 vVertexPres;","varying vec3 vNormal;","varying vec3 vColor;","uniform float uAlpha;",P.strings.fragColorUniforms,P.strings.fragColorFunction,"void main() {","  vec3 normal = getNormal();","  vec3 nm_z = normalize(vVertexPres);","  vec3 nm_x = vec3(-nm_z.z, 0.0, nm_z.x);","  vec3 nm_y = cross(nm_x, nm_z);","  vec2 texCoord = 0.5 + 0.5 * vec2(dot(normal, nm_x), dot(normal, nm_y));","  vec3 color = sRGBToLinear(texture2D(uTexture0, texCoord).rgb) * sRGBToLinear(vColor);","  gl_FragColor = encodeFragColor(color, uAlpha);","}"].join("\n"),B.updateUniforms=function(e,t){var r=e.getGL(),n=this.uniforms;r.activeTexture(r.TEXTURE0),e.setTexture0(B.textures[e.getMatcap()]),r.bindTexture(r.TEXTURE_2D,e.getTexture0()||this.getDummyTexture(r)),r.uniform1i(n.uTexture0,0),r.uniform3fv(n.uAlbedo,e.getAlbedo()),P.updateUniforms.call(this,e,t)};const j=B;var G=P.getCopy();G.vertexName=G.fragmentName="ShowNormal",G.uniforms={},G.attributes={},G.activeAttributes={vertex:!0,normal:!0,material:!0},G.uniformNames=[],Array.prototype.push.apply(G.uniformNames,P.uniformNames.commonUniforms),G.vertex=["attribute vec3 aVertex;","attribute vec3 aNormal;","attribute vec3 aMaterial;",P.strings.vertUniforms,"varying vec3 vVertex;","varying vec3 vNormal;","varying float vMasking;","void main() {","  vMasking = aMaterial.z;","  vNormal = mix(aNormal, uEN * aNormal, vMasking);","  vNormal = normalize(uN * vNormal);","  vec4 vertex4 = vec4(aVertex, 1.0);","  vertex4 = mix(vertex4, uEM *vertex4, vMasking);","  vVertex = vec3(uMV * vertex4);","  gl_Position = uMVP * vertex4;","}"].join("\n"),G.fragment=["varying vec3 vVertex;","varying vec3 vNormal;","uniform float uAlpha;",P.strings.fragColorUniforms,P.strings.fragColorFunction,"void main() {","  gl_FragColor = encodeFragColor(sRGBToLinear(getNormal() * 0.5 + 0.5), uAlpha);","}"].join("\n");const W=G;var z=P.getCopy();z.vertexName=z.fragmentName="ShowUV",z.texPath="resources/uv.png",z.uniforms={},z.attributes={},z.uniformNames=["uTexture0","uAlbedo"],Array.prototype.push.apply(z.uniformNames,P.uniformNames.commonUniforms),z.vertex=["attribute vec3 aVertex;","attribute vec3 aNormal;","attribute vec3 aColor;","attribute vec2 aTexCoord;","attribute vec3 aMaterial;",P.strings.vertUniforms,"varying vec3 vVertex;","varying vec3 vNormal;","varying vec3 vColor;","varying vec2 vTexCoord;","varying float vMasking;","uniform vec3 uAlbedo;","void main() {","  vColor = uAlbedo.x >= 0.0 ? uAlbedo : aColor;","  vTexCoord = aTexCoord;","  vMasking = aMaterial.z;","  vNormal = mix(aNormal, uEN * aNormal, vMasking);","  vNormal = normalize(uN * vNormal);","  vec4 vertex4 = vec4(aVertex, 1.0);","  vertex4 = mix(vertex4, uEM *vertex4, vMasking);","  vVertex = vec3(uMV * vertex4);","  gl_Position = uMVP * vertex4;","}"].join("\n"),z.fragment=["uniform sampler2D uTexture0;","varying vec3 vVertex;","varying vec3 vNormal;","varying vec3 vColor;","varying vec2 vTexCoord;","uniform float uAlpha;",P.strings.fragColorUniforms,P.strings.fragColorFunction,"void main() {","  vec3 color = sRGBToLinear(texture2D(uTexture0, vTexCoord).rgb) * sRGBToLinear(vColor);","  gl_FragColor = encodeFragColor(color, uAlpha);","}"].join("\n"),z.draw=P.draw,z.drawBuffer=P.drawBuffer,z.getOrCreate=P.getOrCreate,z.initUniforms=P.initUniforms,z.initAttributes=function(e){P.initAttributes.call(this,e),z.attributes.aTexCoord=new k(e,z.program,"aTexCoord",2,e.FLOAT)},z.bindAttributes=function(e){P.bindAttributes.call(this,e),z.attributes.aTexCoord.bindToBuffer(e.getTexCoordBuffer())},z.updateUniforms=function(e,t){var r=e.getGL(),n=this.uniforms;r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,this.getOrCreateTexture0(r,z.texPath,t)||this.getDummyTexture(r)),r.uniform1i(n.uTexture0,0),r.uniform3fv(n.uAlbedo,e.getAlbedo()),P.updateUniforms.call(this,e,t)};const X=z;var K=P.getCopy();K.vertexName=K.fragmentName="Wireframe",K.uniforms={},K.attributes={},K.activeAttributes={vertex:!0,material:!0},K.uniformNames=["uMVP","uEM"],K.vertex=["attribute vec3 aVertex;","attribute vec3 aMaterial;","uniform mat4 uMVP;","uniform mat4 uEM;","void main() {","  vec4 vertex4 = vec4(aVertex, 1.0);","  vec4 pos = uMVP * mix(vertex4, uEM * vertex4, aMaterial.z);","  pos[3] += 0.0001;","  gl_Position = pos;","}"].join("\n"),K.fragment=["void main() {","  gl_FragColor = vec4(0.0, 0.0, 0.0, 0.4);","}"].join("\n"),K.getOrCreate=P.getOrCreate,K.draw=function(e){var t=e.getGL();t.useProgram(this.program),this.bindAttributes(e),this.updateUniforms(e),e.getWireframeBuffer().bind(),t.drawElements(t.LINES,2*e.getRenderNbEdges(),t.UNSIGNED_INT,0)},K.updateUniforms=function(e){var t=e.getGL();t.uniformMatrix4fv(this.uniforms.uMVP,!1,e.getMVP()),t.uniformMatrix4fv(this.uniforms.uEM,!1,e.getEditMatrix())};const H=K;var Y=P.getCopy();Y.vertexName=Y.fragmentName="FlatColor",Y.uniforms={},Y.attributes={},Y.activeAttributes={vertex:!0,material:!0},Y.uniformNames=["uColor"],Array.prototype.push.apply(Y.uniformNames,P.uniformNames.commonUniforms),Y.vertex=["attribute vec3 aVertex;","attribute vec3 aMaterial;",P.strings.vertUniforms,"varying vec3 vVertex;","void main() {","  vec4 vertex4 = vec4(aVertex, 1.0);","  gl_Position = uMVP * mix(vertex4, uEM * vertex4, aMaterial.z);","}"].join("\n"),Y.fragment=["uniform vec3 uColor;","void main() {","  gl_FragColor = vec4(uColor, 1.0);","}"].join("\n"),Y.updateUniforms=function(e,t){e.getGL().uniform3fv(this.uniforms.uColor,e.getFlatColor()),P.updateUniforms.call(this,e,t)};const q=Y;var Z=P.getCopy();Z.vertexName=Z.fragmentName="ShowSelection",Z.uniforms={},Z.attributes={},Z.activeAttributes={vertex:!0},Z.uniformNames=["uMVP","uColor"],Z.vertex=["attribute vec3 aVertex;","uniform mat4 uMVP;","void main() {","  gl_Position = uMVP * vec4(aVertex, 1.0);","}"].join("\n"),Z.fragment=["uniform vec3 uColor;","void main() {","  gl_FragColor = vec4(uColor, 1.0);","}"].join("\n"),Z.draw=function(e,t,r){var n=e.getGL();n.useProgram(this.program),n.uniform3fv(this.uniforms.uColor,e.getColor()),t&&(n.uniformMatrix4fv(this.uniforms.uMVP,!1,e.getCircleMVP()),Z.attributes.aVertex.bindToBuffer(e.getCircleBuffer()),n.drawArrays(n.LINE_LOOP,0,e.getCircleBuffer()._size/3)),n.uniformMatrix4fv(this.uniforms.uMVP,!1,e.getDotMVP()),Z.attributes.aVertex.bindToBuffer(e.getDotBuffer()),n.drawArrays(n.TRIANGLE_FAN,0,e.getDotBuffer()._size/3),r&&(n.uniformMatrix4fv(this.uniforms.uMVP,!1,e.getDotSymmetryMVP()),n.drawArrays(n.TRIANGLE_FAN,0,e.getDotBuffer()._size/3))};const J=Z;var Q=P.getCopy();Q.vertexName=Q.fragmentName="Background",Q.uniforms={},Q.attributes={},Q.uniformNames=["uTexture0","uBackgroundType","uIblTransform","uSPH","uBlur","uEnvSize"],Q.vertex=["attribute vec2 aVertex;","attribute vec2 aTexCoord;","varying vec2 vTexCoord;","void main() {","  vTexCoord = aTexCoord;","  gl_Position = vec4(aVertex, 1.0, 1.0);","}"].join("\n"),Q.fragment=["varying vec2 vTexCoord;",P.strings.colorSpaceGLSL,D,"uniform int uBackgroundType;\nuniform float uBlur;\n\nvoid main() {\n  vec3 color;\n  if (uBackgroundType == 0) {\n    color = sRGBToLinear(texture2D(uTexture0, vTexCoord).rgb);\n  } else {\n    vec3 dir = uIblTransform * vec3(vTexCoord.xy * 2.0 - 1.0, -1.0);\n    dir = normalize(dir);\n    if (uBackgroundType == 1) {\n      color = texturePanoramaLod(dir, uBlur * uBlur);\n    } else {\n      color = sphericalHarmonics(dir);\n    }\n  }\n  gl_FragColor = encodeRGBM(color);\n}\n"].join("\n"),Q.draw=function(e){var t=e.getGL();t.useProgram(this.program),this.bindAttributes(e),this.updateUniforms(e),t.drawArrays(t.TRIANGLE_STRIP,0,4)},Q.initAttributes=function(e){var t=Q.program,r=Q.attributes;r.aVertex=new k(e,t,"aVertex",2,e.FLOAT),r.aTexCoord=new k(e,t,"aTexCoord",2,e.FLOAT)},Q.bindAttributes=function(e){var t=Q.attributes;t.aVertex.bindToBuffer(e.getVertexBuffer()),t.aTexCoord.bindToBuffer(e.getTexCoordBuffer())};var $=f();Q.updateUniforms=function(e){var t,r=this.uniforms,n=e._main,i=V.environments[V.idEnv],a=e.getGL();a.uniform1i(r.uBackgroundType,e.getType()),t=0===e.getType()?e.getTexture():V.getOrCreateEnvironment(a,n,i)||e.getTexture(),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,t),a.uniform1i(r.uTexture0,0),d($,n.getCamera().getView()),a.uniformMatrix3fv(r.uIblTransform,!1,p($,$)),a.uniform3fv(r.uSPH,i.sph),i.size&&a.uniform2fv(r.uEnvSize,i.size),a.uniform1f(r.uBlur,e.getBlur())};const ee=Q;var te=P.getCopy();te.vertexName=te.fragmentName="Merge",te.FILMIC=(0,T.A)().filmic,te.uniforms={},te.attributes={},te.uniformNames=["uTexture0","uTexture1","uFilmic"],te.vertex=["attribute vec2 aVertex;","varying vec2 vTexCoord;","void main() {","  vTexCoord = aVertex * 0.5 + 0.5;","  gl_Position = vec4(aVertex, 0.5, 1.0);","}"].join("\n"),te.fragment=["uniform sampler2D uTexture0;","uniform sampler2D uTexture1;","uniform int uFilmic;","varying vec2 vTexCoord;",P.strings.colorSpaceGLSL,"void main() {","  vec4 transparent = texture2D(uTexture1, vTexCoord);","  vec3 color = decodeRGBM(texture2D(uTexture0, vTexCoord))*(1.0-transparent.a) + transparent.rgb;","  if(uFilmic == 1){","    vec3 x = max(vec3(0.0), color - vec3(0.004));","    gl_FragColor = vec4((x*(6.2*x+0.5))/(x*(6.2*x+1.7)+0.06), 1.0);","  }else{","    gl_FragColor = vec4(linearTosRGB(color), 1.0);","  }","}"].join("\n"),te.draw=function(e,t){var r=e.getGL();r.useProgram(this.program),te.attributes.aVertex.bindToBuffer(e.getVertexBuffer()),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,t._rttOpaque.getTexture()),r.uniform1i(this.uniforms.uTexture0,0),r.activeTexture(r.TEXTURE1),r.bindTexture(r.TEXTURE_2D,t._rttTransparent.getTexture()),r.uniform1i(this.uniforms.uTexture1,1),r.uniform1i(this.uniforms.uFilmic,te.FILMIC),r.drawArrays(r.TRIANGLES,0,3)},te.initAttributes=function(e){te.attributes.aVertex=new k(e,te.program,"aVertex",2,e.FLOAT)};const re=te;var ne=P.getCopy();ne.vertexName=ne.fragmentName="Fxaa",ne.FILMIC=(0,T.A)().filmic,ne.uniforms={},ne.attributes={},ne.uniformNames=["uTexture0","uInvSize"],ne.vertex=["attribute vec2 aVertex;","uniform vec2 uInvSize;","varying vec2 vUVNW;","varying vec2 vUVNE;","varying vec2 vUVSW;","varying vec2 vUVSE;","varying vec2 vUVM;","void main() {","  vUVM = aVertex * 0.5 + 0.5;","  vUVNW = vUVM + vec2(-1.0, -1.0) * uInvSize;","  vUVNE = vUVM + vec2(1.0, -1.0) * uInvSize;","  vUVSW = vUVM + vec2(-1.0, 1.0) * uInvSize;","  vUVSE = vUVM + vec2(1.0, 1.0) * uInvSize;","  gl_Position = vec4(aVertex, 0.5, 1.0);","}"].join("\n"),ne.fragment=["uniform sampler2D uTexture0;","uniform vec2 uInvSize;","varying vec2 vUVNW;","varying vec2 vUVNE;","varying vec2 vUVSW;","varying vec2 vUVSE;","varying vec2 vUVM;","// https://github.com/mattdesl/glsl-fxaa\n#define FXAA_REDUCE_MIN (1.0/ 128.0)\n#define FXAA_REDUCE_MUL (1.0 / 8.0)\n#define FXAA_SPAN_MAX 8.0\n\nvec3 fxaa(const in sampler2D tex, const in vec2 uvNW, const in vec2 uvNE, const in vec2 uvSW, const in vec2 uvSE, const in vec2 uvM, const in vec2 invRes) {\n    const vec3 luma = vec3(0.299, 0.587, 0.114);\n    float lumaNW = dot(texture2D(tex, uvNW).xyz, luma);\n    float lumaNE = dot(texture2D(tex, uvNE).xyz, luma);\n    float lumaSW = dot(texture2D(tex, uvSW).xyz, luma);\n    float lumaSE = dot(texture2D(tex, uvSE).xyz, luma);\n    float lumaM  = dot(texture2D(tex, uvM).xyz,  luma);\n    float lumaMin = min(lumaM, min(min(lumaNW, lumaNE), min(lumaSW, lumaSE)));\n    float lumaMax = max(lumaM, max(max(lumaNW, lumaNE), max(lumaSW, lumaSE)));\n\n    vec2 dir = vec2(-((lumaNW + lumaNE) - (lumaSW + lumaSE)), ((lumaNW + lumaSW) - (lumaNE + lumaSE)));\n    float dirReduce = max((lumaNW + lumaNE + lumaSW + lumaSE) * (0.25 * FXAA_REDUCE_MUL), FXAA_REDUCE_MIN);\n    float rcpDirMin = 1.0 / (min(abs(dir.x), abs(dir.y)) + dirReduce);\n    dir = min(vec2(FXAA_SPAN_MAX, FXAA_SPAN_MAX), max(vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX), dir * rcpDirMin)) * invRes;\n    \n    vec3 rgbA = 0.5 * ( texture2D(tex, uvM + dir * (1.0 / 3.0 - 0.5)).xyz + texture2D(tex, uvM + dir * (2.0 / 3.0 - 0.5)).xyz);\n    vec3 rgbB = rgbA * 0.5 + 0.25 * ( texture2D(tex, uvM - dir * 0.5).xyz + texture2D(tex, uvM + dir * 0.5).xyz);\n    \n    float lumaB = dot(rgbB, luma);\n    if((lumaB < lumaMin) || (lumaB > lumaMax))\n      return rgbA;\n    return rgbB;\n}",P.strings.colorSpaceGLSL,"void main() {","  gl_FragColor = vec4(fxaa(uTexture0, vUVNW, vUVNE, vUVSW, vUVSE, vUVM, uInvSize), 1.0);","}"].join("\n"),ne.draw=function(e,t){var r=e.getGL();r.useProgram(this.program),ne.attributes.aVertex.bindToBuffer(e.getVertexBuffer()),r.activeTexture(r.TEXTURE0),r.bindTexture(r.TEXTURE_2D,t._rttMerge.getTexture()),r.uniform1i(this.uniforms.uTexture0,0),r.uniform2fv(this.uniforms.uInvSize,e.getInverseSize()),r.drawArrays(r.TRIANGLES,0,3)},ne.initAttributes=function(e){ne.attributes.aVertex=new k(e,ne.program,"aVertex",2,e.FLOAT)};const ie=ne;var ae=P.getCopy();ae.vertexName=ae.fragmentName="SobelContour",ae.color=(0,T.A)().outlinecolor,ae.uniforms={},ae.attributes={},ae.uniformNames=["uTexture0","uColor","uInvSize"],ae.vertex=["attribute vec2 aVertex;","varying vec2 vTexCoord;","void main() {","  vTexCoord = aVertex * 0.5 + 0.5;","  gl_Position = vec4(aVertex, 0.0, 1.0);","}"].join("\n"),ae.fragment=["#extension GL_OES_standard_derivatives : enable","uniform sampler2D uTexture0;","uniform vec4 uColor;","varying vec2 vTexCoord;","uniform vec2 uInvSize;","\nfloat outlineDistance( const in vec2 uv, const in sampler2D tex, const in vec2 invSize ) {\n  float fac0 = 2.0;\n  float fac1 = 1.0;\n  float ox = invSize.x;\n  float oy = invSize.y;\n  vec4 texel0 = texture2D(tex, uv + vec2(ox, oy));\n  vec4 texel1 = texture2D(tex, uv + vec2(ox, 0.0));\n  vec4 texel2 = texture2D(tex, uv + vec2(ox, -oy));\n  vec4 texel3 = texture2D(tex, uv + vec2(0.0, -oy));\n  vec4 texel4 = texture2D(tex, uv + vec2(-ox, -oy));\n  vec4 texel5 = texture2D(tex, uv + vec2(-ox, 0.0));\n  vec4 texel6 = texture2D(tex, uv + vec2(-ox, oy));\n  vec4 texel7 = texture2D(tex, uv + vec2(0.0, oy));\n  vec4 rowx = -fac0 * texel5 + fac0 * texel1 + -fac1 * texel6 + fac1 * texel0 + -fac1 * texel4 + fac1 * texel2;\n  vec4 rowy = -fac0 * texel3 + fac0 * texel7 + -fac1 * texel4 + fac1 * texel6 + -fac1 * texel2 + fac1 * texel0;\n  return dot(rowy, rowy) + dot(rowx, rowx);\n}\n",P.strings.colorSpaceGLSL,"void main() {","  float mag = outlineDistance(vTexCoord, uTexture0, uInvSize);","  if (mag < 1.5) discard;","  gl_FragColor = vec4(sRGBToLinear(uColor.rgb) * uColor.a, uColor.a);","}"].join("\n"),ae.draw=function(e){var t=e.getGL();t.useProgram(this.program),ae.attributes.aVertex.bindToBuffer(e.getVertexBuffer()),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,e.getTexture()),t.uniform1i(this.uniforms.uTexture0,0),t.uniform4fv(this.uniforms.uColor,ae.color),t.uniform2fv(this.uniforms.uInvSize,e.getInverseSize()),t.drawArrays(t.TRIANGLES,0,3)},ae.initAttributes=function(e){ae.attributes.aVertex=new k(e,ae.program,"aVertex",2,e.FLOAT)};const oe=ae;var se=P.getCopy();se.CHANNEL_VALUE=0,se.vertexName=se.fragmentName="PaintUV",se.uniforms={},se.attributes={},se.uniformNames=["uChannelPaint"],se.activeAttributes={color:!0,material:!0},se.vertex=["attribute vec2 aTexCoord;","attribute vec3 aColor;","attribute vec3 aMaterial;","varying vec3 vColor;","varying vec2 vMaterial;","void main() {","  vColor = aColor;","  vMaterial = aMaterial.xy;","  gl_Position = vec4((aTexCoord * 2.0 - 1.0) * vec2(1.0, -1.0), 0.5, 1.0);","}"].join("\n"),se.fragment=["varying vec3 vColor;","varying vec2 vMaterial;","uniform int uChannelPaint;","void main() {","  gl_FragColor = vec4(uChannelPaint == 0 ? vColor : uChannelPaint == 1 ? vMaterial.xxx : vMaterial.yyy, 1.0);","}"].join("\n"),se.initAttributes=function(e){P.initAttributes.call(this,e),se.attributes.aTexCoord=new k(e,se.program,"aTexCoord",2,e.FLOAT)},se.bindAttributes=function(e){P.bindAttributes.call(this,e),se.attributes.aTexCoord.bindToBuffer(e.getTexCoordBuffer())},se.updateUniforms=function(e){e.getGL().uniform1i(this.uniforms.uChannelPaint,se.CHANNEL_VALUE)};const le=se;var ue=P.getCopy();ue.vertexName=ue.fragmentName="Blur",ue.INPUT_TEXTURE=null,ue.uniforms={},ue.attributes={},ue.uniformNames=["uTexture0","uInvSize"],ue.vertex=["attribute vec2 aVertex;","varying vec2 vTexCoord;","void main() {","  vTexCoord = aVertex * 0.5 + 0.5;","  gl_Position = vec4(aVertex, 0.5, 1.0);","}"].join("\n"),ue.fragment=["uniform sampler2D uTexture0;","varying vec2 vTexCoord;","uniform vec2 uInvSize;",P.strings.colorSpaceGLSL,"void main() {","    const int KER_SIZE = 8;","    vec4 avg = texture2D(uTexture0, vTexCoord);","    if (avg.a < 0.1) {","        for (int i = -KER_SIZE; i <= KER_SIZE; ++i) {","            for (int j = -KER_SIZE; j <= KER_SIZE; ++j) {","                if (i == 0 && j == 0) continue;","                vec4 fetch = texture2D(uTexture0, vTexCoord + vec2(i, j) * uInvSize);","                avg.rgb += sRGBToLinear(fetch.rgb) * fetch.a;","                avg.a += fetch.a;","            }","        }","        avg.rgb = avg.a == 0.0 ? vec3(0.0) : linearTosRGB(avg.rgb / avg.a);","    }","    gl_FragColor = vec4(avg.rgb, 1.0);","}"].join("\n"),ue.draw=function(e){var t=e.getGL();t.useProgram(this.program),ue.attributes.aVertex.bindToBuffer(e.getVertexBuffer()),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,ue.INPUT_TEXTURE.getTexture()),t.uniform1i(this.uniforms.uTexture0,0),t.uniform2fv(this.uniforms.uInvSize,ue.INPUT_TEXTURE.getInverseSize()),t.drawArrays(t.TRIANGLES,0,3)},ue.initAttributes=function(e){ue.attributes.aVertex=new k(e,ue.program,"aVertex",2,e.FLOAT)};const ce=ue;var he=[];he[e.A.Shader.PBR]=V,he[e.A.Shader.MATCAP]=j,he[e.A.Shader.NORMAL]=W,he[e.A.Shader.UV]=X,he[e.A.Shader.WIREFRAME]=H,he[e.A.Shader.FLAT]=q,he[e.A.Shader.SELECTION]=J,he[e.A.Shader.BACKGROUND]=ee,he[e.A.Shader.MERGE]=re,he[e.A.Shader.FXAA]=ie,he[e.A.Shader.CONTOUR]=oe,he[e.A.Shader.PAINTUV]=le,he[e.A.Shader.BLUR]=ce;const fe=he;function de(e){return de="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},de(e)}function pe(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_e(n.key),n)}}function _e(e){var t=function(e){if("object"!=de(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=de(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==de(t)?t:t+""}const ge=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._gl=t,this._buffer=t.createBuffer(),this._type=r,this._hint=n,this._size=0}var t,r;return t=e,(r=[{key:"bind",value:function(){this._buffer||(this._buffer=this._gl.createBuffer()),this._gl.bindBuffer(this._type,this._buffer)}},{key:"release",value:function(){this._gl.deleteBuffer(this._buffer),this._buffer=null,this._size=0}},{key:"update",value:function(e,t){this.bind(),void 0!==t&&t!==e.length&&(e=e.subarray(0,t)),e.length>this._size?(this._gl.bufferData(this._type,e,this._hint),this._size=e.length):this._gl.bufferSubData(this._type,0,e)}}])&&pe(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();var me=function(e){var t=(0,T.A)();return{_gl:e,_shaderType:t.shader,_flatShading:t.flatshading,_showWireframe:t.wireframe,_matcap:Math.min(t.matcap,j.matcaps.length-1),_curvature:Math.min(t.curvature,5),_texture0:null,_useDrawArrays:!1,_vertexBuffer:new ge(e,e.ARRAY_BUFFER,e.DYNAMIC_DRAW),_normalBuffer:new ge(e,e.ARRAY_BUFFER,e.DYNAMIC_DRAW),_colorBuffer:new ge(e,e.ARRAY_BUFFER,e.DYNAMIC_DRAW),_materialBuffer:new ge(e,e.ARRAY_BUFFER,e.DYNAMIC_DRAW),_texCoordBuffer:new ge(e,e.ARRAY_BUFFER,e.STATIC_DRAW),_indexBuffer:new ge(e,e.ELEMENT_ARRAY_BUFFER,e.STATIC_DRAW),_wireframeBuffer:new ge(e,e.ELEMENT_ARRAY_BUFFER,e.STATIC_DRAW),_albedo:new Float32Array([-1,-1,-1]),_roughness:-.18,_metallic:-.78,_alpha:1,_flatColor:new Float32Array([1,0,0]),_mode:e.TRIANGLES}};me.ONLY_DRAW_ARRAYS=!1;const ve=me;function ye(e){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ye(e)}function be(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ae(n.key),n)}}function Ae(e){var t=function(e){if("object"!=ye(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ye(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ye(t)?t:t+""}var Te=function(){function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this._id=r.ID++,this._meshData=null,this._transformData=null,this._renderData=null,this._isVisible=!0}var n,i,a;return n=r,i=[{key:"setID",value:function(e){this._id=e}},{key:"isVisible",value:function(){return this._isVisible}},{key:"setVisible",value:function(e){this._isVisible=e}},{key:"setVertices",value:function(e){this._meshData._verticesXYZ=e,this._meshData._nbVertices=e.length/3}},{key:"setFaces",value:function(e){this._meshData._facesABCD=e,this._meshData._nbFaces=e.length/4}},{key:"setTexCoords",value:function(e){this._meshData._texCoordsST=e,this._meshData._nbTexCoords=e.length/2}},{key:"setColors",value:function(e){this._meshData._colorsRGB=e}},{key:"setMaterials",value:function(e){this._meshData._materialsPBR=e}},{key:"setVerticesDuplicateStartCount",value:function(e){this._meshData._duplicateStartCount=e}},{key:"setFacesTexCoord",value:function(e){this._meshData._UVfacesABCD=e}},{key:"setMeshData",value:function(e){this._meshData=e}},{key:"setRenderData",value:function(e){this._renderData=e}},{key:"setTransformData",value:function(e){this._transformData=e}},{key:"setNbVertices",value:function(e){this._meshData._nbVertices=e}},{key:"setNbFaces",value:function(e){this._meshData._nbFaces=e}},{key:"getID",value:function(){return this._id}},{key:"getRenderData",value:function(){return this._renderData}},{key:"getMeshData",value:function(){return this._meshData}},{key:"getTransformData",value:function(){return this._transformData}},{key:"getNbVertices",value:function(){return this._meshData._nbVertices}},{key:"getNbFaces",value:function(){return this._meshData._nbFaces}},{key:"getNbQuads",value:function(){return this.getNbTriangles()-this.getNbFaces()}},{key:"getNbTriangles",value:function(){return this._meshData._trianglesABC.length/3}},{key:"getNbTexCoords",value:function(){return this._meshData._nbTexCoords}},{key:"hasUV",value:function(){return null!==this._meshData._texCoordsST}},{key:"getVertices",value:function(){return this._meshData._verticesXYZ}},{key:"getColors",value:function(){return this._meshData._colorsRGB}},{key:"getNormals",value:function(){return this._meshData._normalsXYZ}},{key:"getMaterials",value:function(){return this._meshData._materialsPBR}},{key:"getVerticesTagFlags",value:function(){return this._meshData._vertTagFlags}},{key:"getVerticesSculptFlags",value:function(){return this._meshData._vertSculptFlags}},{key:"getVerticesStateFlags",value:function(){return this._meshData._vertStateFlags}},{key:"getVerticesRingVertStartCount",value:function(){return this._meshData._vrvStartCount}},{key:"getVerticesRingVert",value:function(){return this._meshData._vertRingVert}},{key:"getVerticesRingFaceStartCount",value:function(){return this._meshData._vrfStartCount}},{key:"getVerticesRingFace",value:function(){return this._meshData._vertRingFace}},{key:"getVerticesOnEdge",value:function(){return this._meshData._vertOnEdge}},{key:"getVerticesProxy",value:function(){return this._meshData._vertProxy}},{key:"getFaces",value:function(){return this._meshData._facesABCD}},{key:"hasOnlyTriangles",value:function(){return this.getNbTriangles()===this.getNbFaces()}},{key:"hasOnlyQuads",value:function(){return this.getNbTriangles()===2*this.getNbFaces()}},{key:"getFaceNormals",value:function(){return this._meshData._faceNormalsXYZ}},{key:"getFaceBoxes",value:function(){return this._meshData._faceBoxes}},{key:"getFaceCenters",value:function(){return this._meshData._faceCentersXYZ}},{key:"getFacesTagFlags",value:function(){return this._meshData._facesTagFlags}},{key:"getFaceEdges",value:function(){return this._meshData._faceEdges}},{key:"getFacesToTriangles",value:function(){return this._meshData._facesToTriangles}},{key:"getTrianglesTexCoord",value:function(){return this._meshData._UVtrianglesABC}},{key:"getTriangles",value:function(){return this._meshData._trianglesABC}},{key:"getEdges",value:function(){return this._meshData._edges}},{key:"getNbEdges",value:function(){return this._meshData._edges.length}},{key:"getTexCoords",value:function(){return this._meshData._texCoordsST}},{key:"getVerticesDuplicateStartCount",value:function(){return this._meshData._duplicateStartCount}},{key:"getFacesTexCoord",value:function(){return this._meshData._UVfacesABCD}},{key:"getVerticesDrawArrays",value:function(){return this._meshData._DAverticesXYZ||this.updateDrawArrays(),this._meshData._DAverticesXYZ}},{key:"getNormalsDrawArrays",value:function(){return this._meshData._DAnormalsXYZ}},{key:"getColorsDrawArrays",value:function(){return this._meshData._DAcolorsRGB}},{key:"getMaterialsDrawArrays",value:function(){return this._meshData._DAmaterialsPBR}},{key:"getTexCoordsDrawArrays",value:function(){return this._meshData._DAtexCoordsST}},{key:"getOctree",value:function(){return this._meshData._octree}},{key:"getCenter",value:function(){return this._transformData._center}},{key:"getMV",value:function(){return this._transformData._lastComputedMV}},{key:"getMVP",value:function(){return this._transformData._lastComputedMVP}},{key:"getN",value:function(){return this._transformData._lastComputedN}},{key:"getEN",value:function(){return this._transformData._lastComputedEN}},{key:"getDepth",value:function(){return this._transformData._lastComputedDepth}},{key:"getMatrix",value:function(){return this._transformData._matrix}},{key:"getEditMatrix",value:function(){return this._transformData._editMatrix}},{key:"getScale2",value:function(){var e=this._transformData._matrix;return e[0]*e[0]+e[4]*e[4]+e[8]*e[8]}},{key:"getScale",value:function(){return Math.sqrt(this.getScale2())}},{key:"getSymmetryOrigin",value:function(){var e=c.vt(),t=this._transformData,r=t._symmetryOffset*this.computeLocalRadius();return c.Ln(e,t._center,t._symmetryNormal,r)}},{key:"getSymmetryOffset",value:function(){return this._transformData._symmetryOffset}},{key:"setSymmetryOffset",value:function(e){this._transformData._symmetryOffset=e}},{key:"getSymmetryNormal",value:function(){return this._transformData._symmetryNormal}},{key:"getFacePosInLeaf",value:function(){return this._meshData._facePosInLeaf}},{key:"getFaceLeaf",value:function(){return this._meshData._faceLeaf}},{key:"getLeavesToUpdate",value:function(){return this._meshData._leavesToUpdate}},{key:"getLocalBound",value:function(){return this._meshData._octree._aabbLoose}},{key:"getRenderNbEdges",value:function(){return this.getNbEdges()}},{key:"init",value:function(){this.initColorsAndMaterials(),this.allocateArrays(),this.initTopology(),this.updateGeometry(),this._renderData&&this.updateDuplicateColorsAndMaterials(),this.updateCenter()}},{key:"initTopology",value:function(){this.initFaceRings(),this.optimize(),this.initEdges(),this.initVertexRings(),this.initRenderTriangles()}},{key:"updateGeometry",value:function(e,t){this.updateFacesAabbAndNormal(e),this.updateVerticesNormal(t),this.updateOctree(e),this._renderData&&(this.updateDuplicateGeometry(t),this.updateDrawArrays(e))}},{key:"allocateArrays",value:function(){var e=this.getNbVertices();if(this.hasUV()){var t=this._meshData._texCoordsST.length/2,r=new Float32Array(3*t);r.set(this._meshData._verticesXYZ),this._meshData._verticesXYZ=r,this._meshData._normalsXYZ=new Float32Array(3*t),r=new Float32Array(3*t),this._meshData._colorsRGB&&r.set(this._meshData._colorsRGB),this._meshData._colorsRGB=r,r=new Float32Array(3*t),this._meshData._materialsPBR&&r.set(this._meshData._materialsPBR),this._meshData._materialsPBR=r}else this._meshData._normalsXYZ=this._meshData._normalsXYZ||new Float32Array(3*e),this._meshData._colorsRGB=this._meshData._colorsRGB||new Float32Array(3*e),this._meshData._materialsPBR=this._meshData._materialsPBR||new Float32Array(3*e);this._meshData._vertOnEdge=new Uint8Array(e),this._meshData._vrvStartCount=new Uint32Array(2*e),this._meshData._vrfStartCount=new Uint32Array(2*e),this._meshData._vertTagFlags=new Int32Array(e),this._meshData._vertSculptFlags=new Int32Array(e),this._meshData._vertStateFlags=new Int32Array(e),this._meshData._vertProxy=new Float32Array(3*e);var n=this.getNbFaces();this._meshData._faceEdges=new Uint32Array(4*n),this._meshData._facesToTriangles=new Uint32Array(n),this._meshData._faceBoxes=new Float32Array(6*n),this._meshData._faceNormalsXYZ=new Float32Array(3*n),this._meshData._faceCentersXYZ=new Float32Array(3*n),this._meshData._facesTagFlags=new Int32Array(n),this._meshData._facePosInLeaf=new Uint32Array(n);var i=this._meshData._faceLeaf;i.length=n;for(var a=0;a<n;++a)i[a]=null}},{key:"initColorsAndMaterials",value:function(){var e=this.getNbVertices(),t=0,r=3*e;if(!this._meshData._colorsRGB||this._meshData._colorsRGB.length!==r){var n=this._meshData._colorsRGB=new Float32Array(r);for(t=0;t<r;++t)n[t]=1}if(!this._meshData._materialsPBR||this._meshData._materialsPBR.length!==r){var i=this._meshData._materialsPBR=new Float32Array(r);for(t=0;t<e;++t){var a=3*t;i[a]=.18,i[a+1]=.08,i[a+2]=1}}}},{key:"initFaceRings",value:function(){var e=this.getFaces(),r=this.getNbVertices(),n=this.getNbFaces(),i=0,a=0,o=new Uint32Array(r);for(i=0;i<n;++i){o[e[a=4*i]]++,o[e[a+1]]++,o[e[a+2]]++;var s=e[a+3];s!==t.A.TRI_INDEX&&o[s]++}var l=this.getVerticesRingFaceStartCount(),u=0;for(i=0;i<r;++i){var c=o[i];l[2*i]=u,l[2*i+1]=c,u+=c}var h=new Uint32Array(t.A.getMemory(4*n*6),0,6*n);for(u=0,i=0;i<n;++i){var f=e[a=4*i],d=e[a+1],p=e[a+2],_=e[a+3];h[l[2*f]+--o[f]]=i,h[l[2*d]+--o[d]]=i,h[l[2*p]+--o[p]]=i,_!==t.A.TRI_INDEX&&(h[l[2*_]+--o[_]]=i,++u)}this._meshData._vertRingFace=new Uint32Array(h.subarray(0,3*n+u))}},{key:"updateVerticesNormal",value:function(e){for(var t=this.getVerticesRingFaceStartCount(),r=this.getVerticesRingFace(),n=r instanceof Array?r:null,i=this.getNormals(),a=this.getFaceNormals(),o=void 0===e,s=o?this.getNbVertices():e.length,l=0;l<s;++l){var u,c,h=o?l:e[l];n?(u=0,c=(r=n[h]).length):c=(u=t[2*h])+t[2*h+1];for(var f=0,d=0,p=0,_=u;_<c;++_){var g=3*r[_];f+=a[g],d+=a[g+1],p+=a[g+2]}var m=c-u;0!==m&&(m=1/m),i[h*=3]=f*m,i[h+1]=d*m,i[h+2]=p*m}}},{key:"initVertexRings",value:function(){for(var e=this.getVerticesRingVertStartCount(),r=this._meshData._vertRingVert=new Uint32Array(2*this.getNbEdges()),n=this.getVerticesRingFaceStartCount(),i=this.getVerticesRingFace(),a=this.getVerticesTagFlags(),o=this.getVerticesOnEdge(),s=this.getFaces(),l=0,u=0,c=this.getNbVertices();u<c;++u){for(var h=++t.A.TAG_FLAG,f=n[2*u],d=f+n[2*u+1],p=0,_=f;_<d;++_){var g=4*i[_],m=s[g],v=s[g+1],y=s[g+2],b=s[g+3];m===u?m=b!==t.A.TRI_INDEX?b:y:v===u||b===u?v=y:y===u&&b!==t.A.TRI_INDEX&&(m=b),a[m]!==h&&(r[l+p++]=m,a[m]=h),a[v]!==h&&(r[l+p++]=v,a[v]=h)}e[2*u]=l,e[2*u+1]=p,l+=p,d-f!==p&&(o[u]=1)}}},{key:"expandsVertices",value:function(e,r){var n=++t.A.TAG_FLAG,i=e.length,a=this.getVerticesRingVertStartCount(),o=this.getVerticesRingVert(),s=o instanceof Array?o:null,l=this.getVerticesTagFlags(),u=i,c=this.getNbVertices(),h=new Uint32Array(t.A.getMemory(4*c),0,c);h.set(e);var f=0;for(f=0;f<i;++f)l[h[f]]=n;for(var d=0;r;){for(--r,f=d;f<i;++f){var p,_,g=h[f];s?(p=0,_=(o=s[g]).length):_=(p=a[2*g])+a[2*g+1];for(var m=p;m<_;++m){var v=o[m];l[v]!==n&&(l[v]=n,h[u++]=v)}}d=i,i=u}return new Uint32Array(h.subarray(0,u))}},{key:"getVerticesFromFaces",value:function(e){for(var r=++t.A.TAG_FLAG,n=e.length,i=this.getVerticesTagFlags(),a=this.getFaces(),o=0,s=new Uint32Array(t.A.getMemory(4*e.length*4),0,4*e.length),l=0;l<n;++l){var u=4*e[l],c=a[u],h=a[u+1],f=a[u+2],d=a[u+3];i[c]!==r&&(i[c]=r,s[o++]=c),i[h]!==r&&(i[h]=r,s[o++]=h),i[f]!==r&&(i[f]=r,s[o++]=f),d!==t.A.TRI_INDEX&&i[d]!==r&&(i[d]=r,s[o++]=d)}return new Uint32Array(s.subarray(0,o))}},{key:"updateFacesAabbAndNormal",value:function(e){for(var r=this.getFaceNormals(),n=this.getFaceBoxes(),i=this.getFaceCenters(),a=this.getVertices(),o=this.getFaces(),s=void 0===e,l=s?this.getNbFaces():e.length,u=0;u<l;++u){var c=s?u:e[u],h=3*c,f=4*c,d=6*c,p=3*o[f],_=3*o[f+1],g=3*o[f+2],m=o[f+3],v=m!==t.A.TRI_INDEX;v&&(m*=3);var y=a[p],b=a[p+1],A=a[p+2],T=a[_],S=a[_+1],w=a[_+2],M=a[g],k=a[g+1],E=a[g+2],x=T-y,R=S-b,C=w-A,P=M-y,D=k-b,O=E-A,I=R*O-C*D,F=C*P-x*O,L=x*D-R*P,V=y<T?y<M?y:M:T<M?T:M,N=y>T?y>M?y:M:T>M?T:M,B=b<S?b<k?b:k:S<k?S:k,U=b>S?b>k?b:k:S>k?S:k,j=A<w?A<E?A:E:w<E?w:E,G=A>w?A>E?A:E:w>E?w:E;if(v){var W=a[m],z=a[m+1],X=a[m+2];W<V&&(V=W),W>N&&(N=W),z<B&&(B=z),z>U&&(U=z),X<j&&(j=X),X>G&&(G=X),I+=(R=k-z)*O-(C=E-X)*D,F+=C*P-(x=M-W)*O,L+=x*D-R*P}r[h]=I,r[h+1]=F,r[h+2]=L,n[d]=V,n[d+1]=B,n[d+2]=j,n[d+3]=N,n[d+4]=U,n[d+5]=G,i[h]=.5*(V+N),i[h+1]=.5*(B+U),i[h+2]=.5*(j+G)}}},{key:"expandsFaces",value:function(e,r){var n=++t.A.TAG_FLAG,i=e.length,a=this.getVerticesRingFaceStartCount(),o=this.getVerticesRingFace(),s=o instanceof Array?o:null,l=this.getFacesTagFlags(),u=this.getFaces(),c=i,h=new Uint32Array(t.A.getMemory(4*this.getNbFaces()),0,this.getNbFaces());h.set(e);var f=0;for(f=0;f<i;++f)l[h[f]]=n;for(var d=0;r;){for(--r,f=d;f<i;++f)for(var p=4*h[f],_=0;_<4;++_){var g=u[p+_];if(g!==t.A.TRI_INDEX){var m,v;s?(m=0,v=(o=s[g]).length):v=(m=a[2*g])+a[2*g+1];for(var y=m;y<v;++y){var b=o[y];l[b]!==n&&(l[b]=n,h[c++]=b)}}}d=i,i=c}return new Uint32Array(h.subarray(0,c))}},{key:"getFacesFromVertices",value:function(e){for(var r=++t.A.TAG_FLAG,n=e.length,i=this.getVerticesRingFaceStartCount(),a=this.getVerticesRingFace(),o=a instanceof Array?a:null,s=this.getFacesTagFlags(),l=0,u=new Uint32Array(t.A.getMemory(4*this.getNbFaces()),0,this.getNbFaces()),c=0;c<n;++c){var h,f,d=e[c];o?(h=0,f=(a=o[d]).length):f=(h=i[2*d])+i[2*d+1];for(var p=h;p<f;++p){var _=a[p];s[_]!==r&&(s[_]=r,u[l++]=_)}}return new Uint32Array(u.subarray(0,l))}},{key:"initRenderTriangles",value:function(){this.hasUV()&&(this._meshData._UVtrianglesABC=this.computeTrianglesFromFaces(this.getFacesTexCoord())),this._meshData._trianglesABC=this.computeTrianglesFromFaces(this.getFaces())}},{key:"computeTrianglesFromFaces",value:function(e){for(var r=this.getNbFaces(),n=this.getFacesToTriangles(),i=new Uint32Array(t.A.getMemory(4*r*6),0,6*r),a=0,o=0;o<r;++o){n[o]=a;var s=4*o,l=e[s],u=e[s+1],c=e[s+2],h=e[s+3],f=3*a;i[f]=l,i[f+1]=u,i[f+2]=c,++a,h!==t.A.TRI_INDEX&&(i[f=3*a]=l,i[f+1]=c,i[f+2]=h,++a)}return new Uint32Array(i.subarray(0,3*a))}},{key:"initEdges",value:function(){for(var e=this.getFaces(),r=this.getFaceEdges(),n=0,i=new Uint32Array(this.getNbVertices()),a=this.getVerticesRingFaceStartCount(),o=this.getVerticesRingFace(),s=0,l=this.getNbVertices();s<l;++s)for(var u=a[2*s],c=u+a[2*s+1],h=n,f=u;f<c;++f){var d=4*o[f],p=e[d],_=e[d+1],g=e[d+2],m=e[d+3],v=0,y=0;m===t.A.TRI_INDEX?(s>p&&(y=d+(s===_?0:2),(v=i[p])<=h?(r[y]=n,i[p]=++n):r[y]=v-1),s>_&&(y=d+(s===p?0:1),(v=i[_])<=h?(r[y]=n,i[_]=++n):r[y]=v-1),s>g&&(y=d+(s===p?2:1),(v=i[g])<=h?(r[y]=n,i[g]=++n):r[y]=v-1),r[d+3]=t.A.TRI_INDEX):(s>p&&s!==g&&(y=d+(s===_?0:3),(v=i[p])<=h?(r[y]=n,i[p]=++n):r[y]=v-1),s>_&&s!==m&&(y=d+(s===p?0:1),(v=i[_])<=h?(r[y]=n,i[_]=++n):r[y]=v-1),s>g&&s!==p&&(y=d+(s===_?1:2),(v=i[g])<=h?(r[y]=n,i[g]=++n):r[y]=v-1),s>m&&s!==_&&(y=d+(s===p?3:2),(v=i[m])<=h?(r[y]=n,i[m]=++n):r[y]=v-1))}for(var b=this._meshData._edges=new Uint8ClampedArray(n),A=0,T=this.getNbFaces();A<T;++A){var S=4*A;b[r[S]]++,b[r[S+1]]++,b[r[S+2]]++;var w=r[S+3];w!==t.A.TRI_INDEX&&b[w]++}}},{key:"getWireframe",value:function(){var e,r=this.getNbEdges(),n=this.isUsingDrawArrays();if(n){if(this._meshData._drawArraysWireframe&&this._meshData._drawArraysWireframe.length===2*r)return this._meshData._drawArraysWireframe;e=this._meshData._drawArraysWireframe=new Uint32Array(2*r)}else{if(this._meshData._drawElementsWireframe&&this._meshData._drawElementsWireframe.length===2*r)return this._meshData._drawElementsWireframe;e=this._meshData._drawElementsWireframe=new Uint32Array(2*r)}for(var i=this.getFaces(),a=this.getFaceEdges(),o=this.getNbFaces(),s=this.getFacesToTriangles(),l=0,u=new Uint8Array(r),c=0;c<o;++c){var h,f,d,p=4*c,_=i[p+3],g=_!==t.A.TRI_INDEX;if(n){var m=3*s[c];h=m,f=m+1,d=m+2,g&&(_=m+5)}else h=i[p],f=i[p+1],d=i[p+2];var v=a[p],y=a[p+1],b=a[p+2],A=a[p+3];0===u[v]&&(u[v]=1,e[2*l]=h,e[2*l+1]=f,l++),0===u[y]&&(u[y]=1,e[2*l]=f,e[2*l+1]=d,l++),0===u[b]&&(u[b]=1,e[2*l]=d,e[2*l+1]=g?_:h,l++),g&&0===u[A]&&(u[A]=1,e[2*l]=_,e[2*l+1]=h,l++)}return n?this._meshData._drawArraysWireframe:this._meshData._drawElementsWireframe}},{key:"updateDuplicateGeometry",value:function(e){if(this.isUsingTexCoords()&&this.hasUV())for(var t=this.getVertices(),r=this.getColors(),n=this.getMaterials(),i=this.getNormals(),a=this.getVerticesDuplicateStartCount(),o=void 0===e,s=o?this.getNbVertices():e.length,l=0;l<s;++l){var u=o?l:e[l],c=a[2*u];if(0!==c)for(var h=c+a[2*u+1],f=3*u,d=t[f],p=t[f+1],_=t[f+2],g=i[f],m=i[f+1],v=i[f+2],y=r[f],b=r[f+1],A=r[f+2],T=n[f],S=n[f+1],w=n[f+2],M=c;M<h;++M){var k=3*M;t[k]=d,t[k+1]=p,t[k+2]=_,i[k]=g,i[k+1]=m,i[k+2]=v,r[k]=y,r[k+1]=b,r[k+2]=A,n[k]=T,n[k+1]=S,n[k+2]=w}}}},{key:"updateDuplicateColorsAndMaterials",value:function(e){if(this.isUsingTexCoords()&&this.hasUV())for(var t=this.getColors(),r=this.getMaterials(),n=this.getVerticesDuplicateStartCount(),i=void 0===e,a=i?this.getNbVertices():e.length,o=0;o<a;++o){var s=i?o:e[o],l=n[2*s];if(0!==l)for(var u=l+n[2*s+1],c=3*s,h=t[c],f=t[c+1],d=t[c+2],p=r[c],_=r[c+1],g=r[c+2],m=l;m<u;++m){var v=3*m;t[v]=h,t[v+1]=f,t[v+2]=d,r[v]=p,r[v+1]=_,r[v+2]=g}}}},{key:"initTexCoordsDataFromOBJData",value:function(e,r){var n=this.getFaces(),i=n.length;if(i==r.length){var a=e.length/2;for(s=0;s<i;++s)r[s]>=a&&(r[s]=n[s]);var o=this.getNbVertices(),s=0,l=0,u=0,c=0,h=new Int32Array(o),f=new Float32Array(t.A.getMemory(4*o*2),0,2*o),d=[],p=0,_=0;for(s=0;s<i;++s)if((u=n[s])!==t.A.TRI_INDEX){var g=r[s];if((c=h[u])!==g+1)if(0!==c)if(c>0)h[u]=--p,d.push([g]),++_;else{var m=d[-c-1],v=m.length;for(l=0;l<v&&m[l]!==g;++l);l===v&&(++_,m.push(g))}else h[u]=g+1,f[2*u]=e[2*g],f[2*u+1]=e[2*g+1]}var y=new Float32Array(2*(o+_));y.set(f);var b=this._meshData._duplicateStartCount=new Uint32Array(2*o);for(p=0,s=0;s<o;++s)if(!((c=h[s])>=0)){var A=d[-c-1],T=A.length,S=o+p;for(b[2*s]=S,b[2*s+1]=T,p+=T,l=0;l<T;++l){var w=2*A[l],M=2*(S+l);y[M]=e[w],y[M+1]=e[w+1]}}var k=new Uint32Array(n);for(i=n.length,s=0;s<i;++s)if((u=k[s])!==t.A.TRI_INDEX&&!((c=h[u])>0)){var E=r[s],x=d[-c-1],R=x.length;for(l=0;l<R;++l)if(E===x[l]){k[s]=b[2*u]+l;break}}this.setTexCoords(y),this.setFacesTexCoord(k)}}},{key:"setAlreadyDrawArrays",value:function(){this._meshData._DAverticesXYZ=this.getVertices(),this._meshData._DAnormalsXYZ=this.getNormals(),this._meshData._DAcolorsRGB=this.getColors(),this._meshData._DAmaterialsPBR=this.getMaterials()}},{key:"updateDrawArrays",value:function(e){if(this.isUsingDrawArrays()){var r=this.getVertices(),n=this.getNormals(),i=this.getColors(),a=this.getMaterials(),o=this.getFaces(),s=this.getNbTriangles(),l=this.hasOnlyTriangles()?null:this.getFacesToTriangles(),u=void 0===e,c=this._meshData._DAverticesXYZ,h=this._meshData._DAnormalsXYZ,f=this._meshData._DAcolorsRGB,d=this._meshData._DAmaterialsPBR;(!c||c.length<9*s)&&(c=this._meshData._DAverticesXYZ=new Float32Array(9*s),h=this._meshData._DAnormalsXYZ=new Float32Array(9*s),f=this._meshData._DAcolorsRGB=new Float32Array(9*s),d=this._meshData._DAmaterialsPBR=new Float32Array(9*s));for(var p=u?this.getNbFaces():e.length,_=0;_<p;++_){var g=u?_:e[_],m=9*(l?l[g]:g),v=3*o[g*=4],y=3*o[g+1],b=3*o[g+2];c[m]=r[v],c[m+1]=r[v+1],c[m+2]=r[v+2],c[m+3]=r[y],c[m+4]=r[y+1],c[m+5]=r[y+2],c[m+6]=r[b],c[m+7]=r[b+1],c[m+8]=r[b+2],f[m]=i[v],f[m+1]=i[v+1],f[m+2]=i[v+2],f[m+3]=i[y],f[m+4]=i[y+1],f[m+5]=i[y+2],f[m+6]=i[b],f[m+7]=i[b+1],f[m+8]=i[b+2],d[m]=a[v],d[m+1]=a[v+1],d[m+2]=a[v+2],d[m+3]=a[y],d[m+4]=a[y+1],d[m+5]=a[y+2],d[m+6]=a[b],d[m+7]=a[b+1],d[m+8]=a[b+2],h[m]=n[v],h[m+1]=n[v+1],h[m+2]=n[v+2],h[m+3]=n[y],h[m+4]=n[y+1],h[m+5]=n[y+2],h[m+6]=n[b],h[m+7]=n[b+1],h[m+8]=n[b+2];var A=o[g+3];A!==t.A.TRI_INDEX&&(A*=3,c[m+=9]=r[v],c[m+1]=r[v+1],c[m+2]=r[v+2],c[m+3]=r[b],c[m+4]=r[b+1],c[m+5]=r[b+2],c[m+6]=r[A],c[m+7]=r[A+1],c[m+8]=r[A+2],f[m]=i[v],f[m+1]=i[v+1],f[m+2]=i[v+2],f[m+3]=i[b],f[m+4]=i[b+1],f[m+5]=i[b+2],f[m+6]=i[A],f[m+7]=i[A+1],f[m+8]=i[A+2],d[m]=a[v],d[m+1]=a[v+1],d[m+2]=a[v+2],d[m+3]=a[b],d[m+4]=a[b+1],d[m+5]=a[b+2],d[m+6]=a[A],d[m+7]=a[A+1],d[m+8]=a[A+2],h[m]=n[v],h[m+1]=n[v+1],h[m+2]=n[v+2],h[m+3]=n[b],h[m+4]=n[b+1],h[m+5]=n[b+2],h[m+6]=n[A],h[m+7]=n[A+1],h[m+8]=n[A+2])}this.isUsingTexCoords()&&this.updateDrawArraysTexCoord(e)}}},{key:"updateDrawArraysTexCoord",value:function(e){var r=this.getNbTriangles(),n=this.getFacesToTriangles(),i=void 0===e,a=this._meshData._DAtexCoordsST;a&&a.length===6*r||(a=this._meshData._DAtexCoordsST=new Float32Array(6*r));for(var o=this.getTexCoords(),s=this.getFacesTexCoord(),l=i?this.getNbFaces():e.length,u=0;u<l;++u){var c=i?u:e[u],h=6*n[c],f=2*s[c*=4],d=2*s[c+1],p=2*s[c+2];a[h]=o[f],a[h+1]=o[f+1],a[h+2]=o[d],a[h+3]=o[d+1],a[h+4]=o[p],a[h+5]=o[p+1];var _=s[c+3];_!==t.A.TRI_INDEX&&(_*=3,a[h+=6]=o[f],a[h+1]=o[f+1],a[h+2]=o[p],a[h+3]=o[p+1],a[h+4]=o[_],a[h+5]=o[_+1])}}},{key:"updateCenter",value:function(){var e=this.getLocalBound();c.hZ(this._transformData._center,.5*(e[0]+e[3]),.5*(e[1]+e[4]),.5*(e[2]+e[5]))}},{key:"updateMatrices",value:function(e){_(this._transformData._lastComputedEN,this._transformData._editMatrix),g.lK(this._transformData._lastComputedMV,e.getView(),this._transformData._matrix),_(this._transformData._lastComputedN,this._transformData._lastComputedMV),g.lK(this._transformData._lastComputedMVP,e.getProjection(),this._transformData._lastComputedMV);var t=this._transformData._center,r=this._transformData._lastComputedMVP;this._transformData._lastComputedDepth=r[2]*t[0]+r[6]*t[1]+r[10]*t[2]+r[14]}},{key:"computeLocalRadius",value:function(){var e=this.getLocalBound();return.5*c.xg([e[0],e[1],e[2]],[e[3],e[4],e[5]])}},{key:"normalizeSize",value:function(){var e=t.A.SCALE/(2*this.computeLocalRadius());g.hs(this._transformData._matrix,this._transformData._matrix,[e,e,e])}},{key:"computeWorldBound",value:function(){var e=this._meshData._worldBound,t=this.getLocalBound(),r=this.getMatrix();e[0]=e[3]=r[12],e[1]=e[4]=r[13],e[2]=e[5]=r[14];for(var n=0;n<3;++n)for(var i=4*n,a=t[n],o=t[n+3],s=0;s<3;++s){var l=r[i+s],u=l*o,c=l*a;u<c?(e[s]+=u,e[s+3]+=c):(e[s]+=c,e[s+3]+=u)}return e}},{key:"intersectRay",value:function(e,r,n){var i=this.getNbFaces(),a=new Uint32Array(t.A.getMemory(4*i),0,i);return this._meshData._octree.collectIntersectRay(e,r,a,n?this._meshData._leavesToUpdate:void 0)}},{key:"intersectSphere",value:function(e,r,n){var i=this.getNbFaces(),a=new Uint32Array(t.A.getMemory(4*i),0,i);return this._meshData._octree.collectIntersectSphere(e,r,a,n?this._meshData._leavesToUpdate:void 0)}},{key:"updateOctree",value:function(e){e?this.updateOctreeAdd(this.updateOctreeRemove(e)):this.computeOctree()}},{key:"computeAabb",value:function(){for(var e=this.getNbVertices(),t=this.getVertices(),r=1/0,n=1/0,i=1/0,a=-1/0,o=-1/0,s=-1/0,l=0;l<e;++l){var u=3*l,c=t[u],h=t[u+1],f=t[u+2];c<r&&(r=c),c>a&&(a=c),h<n&&(n=h),h>o&&(o=h),f<i&&(i=f),f>s&&(s=f)}return[r,n,i,a,o,s]}},{key:"computeOctree",value:function(){var e=this.computeAabb(),t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=i-t,l=a-r,u=o-n,c=.2*Math.sqrt(s*s+l*l+u*u),h=1e-16;i-t<h&&(t-=c,i+=c),a-r<h&&(r-=c,a+=c),o-n<h&&(n-=c,o+=c);var f=.3*s,d=.3*l,p=.3*u,_=t-f,g=i+f,m=r-d,v=a+d,y=n-p,b=o+p,T=this._meshData._octree=new A;T.resetNbFaces(this.getNbFaces()),T.setAabbLoose(t,r,n,i,a,o),T.setAabbSplit(_,m,y,g,v,b),T.build(this)}},{key:"updateOctreeRemove",value:function(e){for(var r=this.getFaceCenters(),n=this.getFaceBoxes(),i=this._meshData._facePosInLeaf,a=this._meshData._faceLeaf,o=e.length,s=0,l=new Uint32Array(t.A.getMemory(4*o),0,o),u=0;u<o;++u){var c=e[u],h=6*c,f=3*c,d=a[c],p=d._aabbSplit,_=r[f],g=r[f+1],m=r[f+2];if(_<=p[0]||g<=p[1]||m<=p[2]||_>p[3]||g>p[4]||m>p[5]){l[s++]=e[u];var v=d._iFaces;if(v.length>0){var y=v[v.length-1],b=i[c];v[b]=y,i[y]=b,v.pop()}}else d.expandsAabbLoose(n[h],n[h+1],n[h+2],n[h+3],n[h+4],n[h+5])}return new Uint32Array(l.subarray(0,s))}},{key:"updateOctreeAdd",value:function(e){for(var t=this.getFaceCenters(),r=this.getFaceBoxes(),n=this._meshData._facePosInLeaf,i=this._meshData._faceLeaf,a=e.length,o=this._meshData._octree,s=o._aabbSplit,l=s[0],u=s[1],c=s[2],h=s[3],f=s[4],d=s[5],p=0;p<a;++p){var _=e[p],g=6*_,m=r[g],v=r[g+1],y=r[g+2],b=r[g+3],A=r[g+4],T=r[g+5];if(m>h||b<l||v>f||A<u||y>d||T<c){this.computeOctree(),this._meshData._leavesToUpdate.length=0;break}var S=3*_,w=o.addFace(_,m,v,y,b,A,T,t[S],t[S+1],t[S+2]);if(w)n[_]=w._iFaces.length-1,i[_]=w;else{var M=i[_]._iFaces;n[_]=M.length,M.push(e[p])}}}},{key:"balanceOctree",value:function(){++A.FLAG;for(var e=this._meshData._leavesToUpdate,t=e.length,r=0;r<t;++r){var n=e[r];n._flag!==A.FLAG&&(0===n._iFaces.length?n.pruneIfPossible():n._iFaces.length>A.MAX_FACES&&n._depth<A.MAX_DEPTH&&n.build(this),n._flag=A.FLAG)}e.length=0}},{key:"setFlatColor",value:function(e){this.getFlatColor().set(e)}},{key:"setAlbedo",value:function(e){this.getAlbedo().set(e)}},{key:"setMode",value:function(e){this._renderData._mode=e}},{key:"setRoughness",value:function(e){this._renderData._roughness=e}},{key:"setMetallic",value:function(e){this._renderData._metallic=e}},{key:"setOpacity",value:function(e){this._renderData._alpha=e}},{key:"setTexture0",value:function(e){this._renderData._texture0=e}},{key:"setMatcap",value:function(e){this._renderData._matcap=e}},{key:"setCurvature",value:function(e){this._renderData._curvature=e}},{key:"setFlatShading",value:function(e){this._renderData._flatShading=e}},{key:"setShowWireframe",value:function(e){this._renderData._showWireframe=!ve.ONLY_DRAW_ARRAYS&&e,this.updateWireframeBuffer()}},{key:"setUseDrawArrays",value:function(e){this._renderData._useDrawArrays=e}},{key:"getGL",value:function(){return this._renderData._gl}},{key:"getCount",value:function(){var e=this.getGL();return this.getMode()===e.TRIANGLES?3*this.getNbTriangles():this.getMode()===e.LINES?this.getNbVertices():0}},{key:"getVertexBuffer",value:function(){return this._renderData._vertexBuffer}},{key:"getNormalBuffer",value:function(){return this._renderData._normalBuffer}},{key:"getColorBuffer",value:function(){return this._renderData._colorBuffer}},{key:"getMaterialBuffer",value:function(){return this._renderData._materialBuffer}},{key:"getTexCoordBuffer",value:function(){return this._renderData._texCoordBuffer}},{key:"getIndexBuffer",value:function(){return this._renderData._indexBuffer}},{key:"getWireframeBuffer",value:function(){return this._renderData._wireframeBuffer}},{key:"getRoughness",value:function(){return this._renderData._roughness}},{key:"getMetallic",value:function(){return this._renderData._metallic}},{key:"getOpacity",value:function(){return this._renderData._alpha}},{key:"getFlatColor",value:function(){return this._renderData._flatColor}},{key:"getMode",value:function(){return this._renderData._mode}},{key:"getAlbedo",value:function(){return this._renderData._albedo}},{key:"getTexture0",value:function(){return this._renderData._texture0}},{key:"getMatcap",value:function(){return this._renderData._matcap}},{key:"getCurvature",value:function(){return this._renderData._curvature}},{key:"getFlatShading",value:function(){return this._renderData._flatShading}},{key:"getShowWireframe",value:function(){return this._renderData._showWireframe}},{key:"isUsingDrawArrays",value:function(){return this._renderData._useDrawArrays||ve.ONLY_DRAW_ARRAYS}},{key:"isUsingTexCoords",value:function(){var t=this._renderData._shaderType;return t===e.A.Shader.UV||t===e.A.Shader.PAINTUV}},{key:"isTransparent",value:function(){return this._renderData._alpha<.99}},{key:"getShaderType",value:function(){return this._renderData._shaderType}},{key:"setShaderType",value:function(t){var r=this.hasUV();if(t===e.A.Shader.UV&&!r){if(this._renderData._shaderType!==e.A.Shader.UV)return;t=e.A.Shader.MATCAP}this._renderData._shaderType=t,r&&(this.updateDuplicateGeometry(),this.updateDrawArrays()),this.updateBuffers()}},{key:"initRender",value:function(){this.setShaderType(this._renderData._shaderType),this.setShowWireframe(this.getShowWireframe())}},{key:"render",value:function(e){this.isVisible()&&fe[this.getShaderType()].getOrCreate(this.getGL()).draw(this,e)}},{key:"renderWireframe",value:function(t){this.isVisible()&&fe[e.A.Shader.WIREFRAME].getOrCreate(this.getGL()).draw(this,t)}},{key:"renderFlatColor",value:function(t){this.isVisible()&&fe[e.A.Shader.FLAT].getOrCreate(this.getGL()).draw(this,t)}},{key:"getRenderNbVertices",value:function(){return this.isUsingDrawArrays()?this.getCount():this.isUsingTexCoords()?this.getNbTexCoords():this.getNbVertices()}},{key:"updateVertexBuffer",value:function(){var e=this.isUsingDrawArrays()?this.getVerticesDrawArrays():this.getVertices();this.getVertexBuffer().update(e,3*this.getRenderNbVertices())}},{key:"updateNormalBuffer",value:function(){var e=this.isUsingDrawArrays()?this.getNormalsDrawArrays():this.getNormals();this.getNormalBuffer().update(e,3*this.getRenderNbVertices())}},{key:"updateColorBuffer",value:function(){var e=this.isUsingDrawArrays()?this.getColorsDrawArrays():this.getColors();this.getColorBuffer().update(e,3*this.getRenderNbVertices())}},{key:"updateMaterialBuffer",value:function(){var e=this.isUsingDrawArrays()?this.getMaterialsDrawArrays():this.getMaterials();this.getMaterialBuffer().update(e,3*this.getRenderNbVertices())}},{key:"updateTexCoordBuffer",value:function(){if(this.isUsingTexCoords()){var e=this.isUsingDrawArrays()?this.getTexCoordsDrawArrays():this.getTexCoords();this.getTexCoordBuffer().update(e,2*this.getRenderNbVertices())}}},{key:"updateIndexBuffer",value:function(){if(!this.isUsingDrawArrays()){var e=this.isUsingTexCoords()?this.getTrianglesTexCoord():this.getTriangles();this.getIndexBuffer().update(e,3*this.getNbTriangles())}}},{key:"updateWireframeBuffer",value:function(){this.getShowWireframe()&&this.getWireframeBuffer().update(this.getWireframe(),2*this.getNbEdges())}},{key:"updateGeometryBuffers",value:function(){this.updateVertexBuffer(),this.updateNormalBuffer()}},{key:"updateBuffers",value:function(){this.updateGeometryBuffers(),this.updateColorBuffer(),this.updateMaterialBuffer(),this.updateTexCoordBuffer(),this.updateIndexBuffer(),this.updateWireframeBuffer()}},{key:"release",value:function(){this.getTexture0()&&this.getGL().deleteTexture(this.getTexture0()),this.getVertexBuffer().release(),this.getNormalBuffer().release(),this.getColorBuffer().release(),this.getMaterialBuffer().release(),this.getIndexBuffer().release(),this.getWireframeBuffer().release()}},{key:"copyRenderConfig",value:function(e){this.setFlatShading(e.getFlatShading()),this.setShowWireframe(e.getShowWireframe()),this.setShaderType(e.getShaderType()),this.setMatcap(e.getMatcap()),this.setTexture0(e.getTexture0()),this.setCurvature(e.getCurvature()),this.setOpacity(e.getOpacity())}},{key:"copyTransformData",value:function(e){c.C(this.getCenter(),e.getCenter()),g.C(this.getMatrix(),e.getMatrix()),g.C(this.getEditMatrix(),e.getEditMatrix()),c.C(this.getSymmetryNormal(),e.getSymmetryNormal())}},{key:"copyData",value:function(e){this.setVertices(e.getVertices().slice()),this.setFaces(e.getFaces().slice()),this.setColors(e.getColors().slice()),this.setMaterials(e.getMaterials().slice()),e.hasUV()&&this.initTexCoordsDataFromOBJData(e.getTexCoords(),e.getFacesTexCoord()),this.init(),this.initRender(),this.copyTransformData(e),this.copyRenderConfig(e)}},{key:"optimize",value:function(){0!==this.getNbFaces()&&r.OPTIMIZE&&(this.optimizePostTransform(),this.optimizePreTransform(),this.initFaceRings())}},{key:"computeCacheScore",value:function(){var e=this.getFaces(),r=this.getNbFaces(),n=[];n.length=32;for(var i=0,a=0,o=0;o<r;++o)for(var s=3*o,l=e[s+3]!==t.A.TRI_INDEX?4:3,u=0;u<l;++u){var c=e[s+u];for(a=0;a<32;++a){if(void 0===n[a]){n[a]=c,i++;break}if(n[a]===c)break}32===a&&(i++,n.shift(),n.push(c))}return{ACMR:i/r,ACTVR:i/this.getNbVertices()}}},{key:"optimizePostTransform",value:function(){var e=0,r=this.hasUV(),n=this.getFaces(),i=r?this.getFacesTexCoord():n,a=this.getNbFaces(),o=this.getNbVertices(),s=r?this.getNbTexCoords():o,l=this.getVerticesDuplicateStartCount(),u=new Uint32Array(s-o);if(r)for(e=0;e<s;++e)for(var c=l[2*e],h=c+l[2*e+1],f=c;f<h;++f)u[f-o]=e;var d=this.getVerticesRingFaceStartCount(),p=this.getVerticesRingFace(),_=new Int32Array(s);for(e=0;e<o;++e)_[e]=d[2*e+1];for(e=o;e<s;++e)_[e]=d[2*u[e-o]+1];for(var g=new Uint32Array(s),m=33,v=0,y=new Uint32Array(t.A.getMemory(4*a*4),0,4*a),b=0,A=new Uint8Array(a),T=new Uint32Array(4*a),S=r?new Uint32Array(4*a):T,w=0,M=0;M>=0;){var k=[],E=M>=o?u[M-o]:M,x=d[2*E],R=x+d[2*E+1];for(e=x;e<R;++e){var C=p[e];if(!A[C]){A[C]=1;var P=4*C,D=y[b++]=T[w++]=i[P],O=y[b++]=T[w++]=i[P+1],I=y[b++]=T[w++]=i[P+2],F=T[w++]=i[P+3],L=F!==t.A.TRI_INDEX;r&&(S[w-4]=n[P],S[w-3]=n[P+1],S[w-2]=n[P+2],S[w-1]=n[P+3]),k.push(D,O,I),--_[D],--_[O],--_[I],m-g[D]>32&&(g[D]=m++),m-g[O]>32&&(g[O]=m++),m-g[I]>32&&(g[I]=m++),L&&(y[b++]=F,k.push(F),--_[F],m-g[F]>32&&(g[F]=m++))}}M=-1;var V=-1,N=k.length;for(e=0;e<N;++e){var B=k[e],U=_[B];if(!(U<=0)){var j=0,G=m-g[B];G+2*U<=32&&(j=G),j>V&&(V=j,M=B)}}if(-1===M){for(;b>0;){var W=y[--b];if(_[W]>0){M=W;break}}if(-1===M)for(;v<s;)if(_[v++]>0){M=v-1;break}}}i.set(T.subarray(0,4*a)),r&&n.set(S.subarray(0,4*a))}},{key:"optimizePreTransform",value:function(){var e=this.getVertices(),r=this.getColors(),n=this.getMaterials(),i=this.getNbVertices(),a=this.getFaces(),o=4*this.getNbFaces(),s=new Float32Array(3*i),l=new Float32Array(3*i),u=new Float32Array(3*i),c=new Uint32Array(i),h=0,f=0;for(f=0;f<o;++f){var d=a[f];if(d!==t.A.TRI_INDEX){var p=c[d]-1;if(-1===p){var _=3*h,g=3*d;s[_]=e[g],s[_+1]=e[g+1],s[_+2]=e[g+2],l[_]=r[g],l[_+1]=r[g+1],l[_+2]=r[g+2],u[_]=n[g],u[_+1]=n[g+1],u[_+2]=n[g+2],p=h++,c[d]=p+1}a[f]=p}}var m=i-h;if(m>0&&this.setNbVertices(h),this.hasUV()){var v=this.getFacesTexCoord();for(f=0;f<o;++f){var y=v[f];y<i?v[f]=c[y]-1:y!==t.A.TRI_INDEX&&(v[f]-=m)}var b=this.getNbTexCoords(),A=this.getNbTexCoords()-m,T=this.getTexCoords(),S=new Float32Array(2*A),w=new Uint32Array(2*h),M=this.getVerticesDuplicateStartCount();for(f=0;f<i;++f){var k=2*f,E=M[k],x=2*(c[f]-1);x<0||(E>0&&(w[x]=E-m,w[x+1]=M[k+1]),S[x]=T[k],S[x+1]=T[k+1])}for(f=i;f<b;++f){var R=2*f,C=2*(f-m);S[C]=T[R],S[C+1]=T[R+1]}this.setVerticesDuplicateStartCount(w),this.setTexCoords(S)}e.set(s),r.set(l),n.set(u)}}],a=[{key:"sortFunction",value:function(e,t){var r=e.isTransparent(),n=t.isTransparent();return r&&!n?1:!r&&n?-1:(t.getDepth()-e.getDepth())*(r&&n?1:-1)}}],i&&be(n.prototype,i),a&&be(n,a),Object.defineProperty(n,"prototype",{writable:!1}),r}();Te.OPTIMIZE=!0,Te.ID=0;const Se=Te,we=function(){return{_nbVertices:0,_nbFaces:0,_nbTexCoords:0,_verticesXYZ:null,_normalsXYZ:null,_colorsRGB:null,_materialsPBR:null,_vertOnEdge:null,_vertRingFace:null,_vrfStartCount:null,_vrvStartCount:null,_vertRingVert:null,_vertTagFlags:null,_vertSculptFlags:null,_vertStateFlags:null,_vertProxy:null,_facesABCD:null,_faceEdges:null,_faceNormalsXYZ:null,_facesToTriangles:null,_trianglesABC:null,_facesTagFlags:null,_edges:null,_drawArraysWireframe:null,_drawElementsWireframe:null,_texCoordsST:null,_duplicateStartCount:null,_UVfacesABCD:null,_UVtrianglesABC:null,_DAverticesXYZ:null,_DAnormalsXYZ:null,_DAcolorsRGB:null,_DAmaterialsPBR:null,_DAtexCoordsST:null,_octree:null,_faceBoxes:null,_faceCentersXYZ:null,_facePosInLeaf:null,_faceLeaf:[],_leavesToUpdate:[],_worldBound:[1/0,1/0,1/0,-1/0,-1/0,-1/0]}};function Me(e){return Me="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Me(e)}function ke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ee(n.key),n)}}function Ee(e){var t=function(e){if("object"!=Me(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Me(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Me(t)?t:t+""}function xe(e,t){return xe=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xe(e,t)}function Re(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Re=function(){return!!e})()}function Ce(e){return Ce=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ce(e)}var Pe=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xe(e,t)}(a,e);var r,n,i=function(e){var t=Re();return function(){var r,n=Ce(e);if(t){var i=Ce(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==Me(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(a);function a(e,t){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(r=i.call(this)).setID(e.getID()),r.setMeshData(t?e.getMeshData():{_nbVertices:0,_nbFaces:0,_nbTexCoords:0,_verticesXYZ:null,_normalsXYZ:null,_colorsRGB:null,_materialsPBR:null,_vertOnEdge:null,_vertRingFace:null,_vrfStartCount:null,_vrvStartCount:null,_vertRingVert:null,_vertTagFlags:null,_vertSculptFlags:null,_vertStateFlags:null,_vertProxy:null,_facesABCD:null,_faceEdges:null,_faceNormalsXYZ:null,_facesToTriangles:null,_trianglesABC:null,_facesTagFlags:null,_edges:null,_drawArraysWireframe:null,_drawElementsWireframe:null,_texCoordsST:null,_duplicateStartCount:null,_UVfacesABCD:null,_UVtrianglesABC:null,_DAverticesXYZ:null,_DAnormalsXYZ:null,_DAcolorsRGB:null,_DAmaterialsPBR:null,_DAtexCoordsST:null,_octree:null,_faceBoxes:null,_faceCentersXYZ:null,_facePosInLeaf:null,_faceLeaf:[],_leavesToUpdate:[],_worldBound:[1/0,1/0,1/0,-1/0,-1/0,-1/0]}),r.setRenderData(e.getRenderData()),r.setTransformData(e.getTransformData()),r._detailsXYZ=null,r._detailsRGB=null,r._detailsPBR=null,r._vertMapping=null,r._evenMapping=!1,r}return r=a,n=[{key:"optimize",value:function(){}},{key:"getEvenMapping",value:function(){return this._evenMapping}},{key:"getVerticesMapping",value:function(){return this._vertMapping}},{key:"setVerticesMapping",value:function(e){this._vertMapping=e}},{key:"setEvenMapping",value:function(e){this._evenMapping=e}},{key:"higherSynthesis",value:function(e){e.computePartialSubdivision(this.getVertices(),this.getColors(),this.getMaterials(),this.getNbVertices()),this.applyDetails()}},{key:"lowerAnalysis",value:function(e){this.copyDataFromHigherRes(e);var t=e.getNbVertices(),r=new Float32Array(3*t),n=new Float32Array(3*t),i=new Float32Array(3*t);this.computePartialSubdivision(r,n,i,t),e.computeDetails(r,n,i,t)}},{key:"copyDataFromHigherRes",value:function(e){var t=this.getVertices(),r=this.getColors(),n=this.getMaterials(),i=this.getNbVertices(),a=e.getVertices(),o=e.getColors(),s=e.getMaterials();if(!1===this.getEvenMapping())t.set(a.subarray(0,3*i)),r.set(o.subarray(0,3*i)),n.set(s.subarray(0,3*i));else for(var l=this.getVerticesMapping(),u=0;u<i;++u){var c=3*u,h=3*l[u];t[c]=a[h],t[c+1]=a[h+1],t[c+2]=a[h+2],r[c]=o[h],r[c+1]=o[h+1],r[c+2]=o[h+2],n[c]=s[h],n[c+1]=s[h+1],n[c+2]=s[h+2]}}},{key:"computePartialSubdivision",value:function(e,t,r,n){var i=this.getVerticesMapping();if(i){var a=new Float32Array(3*n),o=new Float32Array(3*n),s=new Float32Array(3*n);u.partialSubdivision(this,a,o,s);var l=!0===this.getEvenMapping()?0:this.getNbVertices();l>0&&(e.set(a.subarray(0,3*l)),t.set(o.subarray(0,3*l)),r.set(s.subarray(0,3*l)));for(var c=l;c<n;++c){var h=3*c,f=3*i[c];e[f]=a[h],e[f+1]=a[h+1],e[f+2]=a[h+2],t[f]=o[h],t[f+1]=o[h+1],t[f+2]=o[h+2],r[f]=s[h],r[f+1]=s[h+1],r[f+2]=s[h+2]}}else u.partialSubdivision(this,e,t,r)}},{key:"applyDetails",value:function(){var e=this.getVerticesRingVertStartCount(),r=this.getVerticesRingVert(),n=this.getVertices(),i=this.getNormals(),a=this.getColors(),o=this.getMaterials(),s=this.getNbVertices(),l=new Float32Array(t.A.getMemory(3*s*4),0,3*s);l.set(n.subarray(0,3*s));for(var u=this._detailsXYZ,c=this._detailsRGB,h=this._detailsPBR,f=Math.min,d=Math.max,p=0;p<s;++p){var _=3*p;a[_]=f(1,d(0,a[_]+c[_])),a[_+1]=f(1,d(0,a[_+1]+c[_+1])),a[_+2]=f(1,d(0,a[_+2]+c[_+2])),o[_]=f(1,d(0,o[_]+h[_])),o[_+1]=f(1,d(0,o[_+1]+h[_+1])),o[_+2]=f(1,d(0,o[_+2]+h[_+2]));var g=l[_],m=l[_+1],v=l[_+2],y=i[_],b=i[_+1],A=i[_+2],T=y*y+b*b+A*A;if(0!==T){y*=T=1/Math.sqrt(T),b*=T,A*=T;var S=3*r[e[2*p]],w=l[S]-g,M=l[S+1]-m,k=l[S+2]-v;if(0!==(T=(w-=y*(T=w*y+M*b+k*A))*w+(M-=b*T)*M+(k-=A*T)*k)){var E=b*(k*=T=1/Math.sqrt(T))-A*(M*=T),x=A*(w*=T)-y*k,R=y*M-b*w,C=u[_],P=u[_+1],D=u[_+2];n[_]=g+y*C+w*P+E*D,n[_+1]=m+b*C+M*P+x*D,n[_+2]=v+A*C+k*P+R*D}}}}},{key:"computeDetails",value:function(e,t,r,n){for(var i=this.getVerticesRingVertStartCount(),a=this.getVerticesRingVert(),o=this.getVertices(),s=this.getNormals(),l=this.getColors(),u=this.getMaterials(),c=this.getNbVertices(),h=this._detailsXYZ=new Float32Array(3*n),f=this._detailsRGB=new Float32Array(3*n),d=this._detailsPBR=new Float32Array(3*n),p=0;p<c;++p){var _=3*p;f[_]=l[_]-t[_],f[_+1]=l[_+1]-t[_+1],f[_+2]=l[_+2]-t[_+2],d[_]=u[_]-r[_],d[_+1]=u[_+1]-r[_+1],d[_+2]=u[_+2]-r[_+2];var g=s[_],m=s[_+1],v=s[_+2],y=g*g+m*m+v*v;if(0!==y){g*=y=1/Math.sqrt(y),m*=y,v*=y;var b=3*a[i[2*p]],A=e[b]-e[_],T=e[b+1]-e[_+1],S=e[b+2]-e[_+2];if(0!==(y=(A-=g*(y=A*g+T*m+S*v))*A+(T-=m*y)*T+(S-=v*y)*S)){var w=m*(S*=y=1/Math.sqrt(y))-v*(T*=y),M=v*(A*=y)-g*S,k=g*T-m*A,E=o[_]-e[_],x=o[_+1]-e[_+1],R=o[_+2]-e[_+2];h[_]=g*E+m*x+v*R,h[_+1]=A*E+T*x+S*R,h[_+2]=w*E+M*x+k*R}}}}}],n&&ke(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(Se);const De=Pe;var Oe={},Ie=function(e,r,n){var i=++t.A.TAG_FLAG,a=e.getVerticesTagFlags(),o=e.getVerticesRingVertStartCount(),s=e.getVerticesRingVert(),l=e.getVerticesOnEdge(),u=function(e,t,r){var n=0,i=e.getNbVertices();for(n=0;n<i;++n)if(0===t[n]&&1===r[n])return n;var a=e.getVerticesOnEdge();for(n=0;n<i&&(0!==t[n]||1===a[n]);++n);if(n===i)return-1;for(n=0;n<i;++n)if(0===t[n])return n;return-1}(e,n,r);if(u<0)return!1;n[u]=1;var c=new Uint32Array(t.A.getMemory(4*e.getNbVertices()),0,e.getNbVertices());c[0]=u;for(var h=1;h>0;){var f=c[--h],d=o[2*f],p=d+o[2*f+1],_=0,g=++i;for(_=d;_<p;++_){var m=s[_];if(a[m]=g,1===n[m])return t.A.TAG_FLAG=i,!1;n[m]=-1,a[m]=g}for(g=++i,_=d;_<p;++_){var v=s[_];if(0!==r[v]&&!l[v])return t.A.TAG_FLAG=i,!1;for(var y=o[2*v],b=y+o[2*v+1],A=y;A<b;++A){var T=s[A];if(T!==f&&!(a[T]>=g-1)&&(a[T]=g,0===n[T])){for(var S=o[2*T],w=S+o[2*T+1],M=0,k=S;k<w;++k)a[s[k]]===g-1&&M++;2===M?n[T]=-1:(n[T]=1,c[h++]=T)}}}}return t.A.TAG_FLAG=i,!0};Oe.computeReverse=function(e,r){var n=e.getNbFaces();if(n%4!=0)return!1;var i=new Int8Array(e.getNbVertices());if(!function(e,r){for(var n=e.getNbVertices(),i=function(e){for(var r=e.getNbVertices(),n=e.getFaces(),i=e.getVerticesOnEdge(),a=e.getVerticesRingVertStartCount(),o=e.getVerticesRingFace(),s=e.getVerticesRingFaceStartCount(),l=new Int8Array(r),u=0;u<r;++u){for(var c=2*u,h=a[c+1],f=s[c],d=s[c+1],p=i[u],_=0,g=f,m=f+d;g<m;++g)_+=n[4*o[g]+3]===t.A.TRI_INDEX?0:1;0===_?(!p&&6!==h||p&&4!==h)&&(l[u]=1):_===d?(!p&&4!==h||p&&3!==h)&&(l[u]=1):(p||5!==h)&&(l[u]=1)}return l}(e),a=!0;a;){if(!Ie(e,i,r))return!1;a=!1;for(var o=0;o<n;++o)if(0===r[o]){a=!0;break}}return!0}(e,i))return!1;var a=new Int32Array(n/4);return!!function(e,r,n,i){var a=e.getFaceEdges(),o=e.getFaces(),s=new Int32Array(e.getNbEdges()),l=0,u=e.getNbFaces(),c=0,h=new Uint32Array(e.getNbVertices()),f=new Uint32Array(u);for(l=0;l<u;++l)f[l]=t.A.TRI_INDEX;for(l=0;l<u;++l){var d=4*l,p=o[d],_=o[d+1],g=o[d+2],m=o[d+3],v=n[p],y=n[_],b=n[g];if(m!==t.A.TRI_INDEX){var A=0,T=0,S=0;1===v?(A=p,T=g,S=s[a[d+1]]-1,s[a[d+2]]=p+1):1===y?(A=_,T=m,S=s[a[d+2]]-1,s[a[d+3]]=_+1):1===b?(A=g,T=p,S=s[a[d+3]]-1,s[a[d]]=g+1):(A=m,T=_,S=s[a[d]]-1,s[a[d+1]]=m+1);var w=h[T]-1;if(w<0)i[c]=-T-1,f[4*c+3]=A,h[T]=++c;else{var M=4*w;S<0?f[M+2]>=t.A.TRI_INDEX-1?(f[M+2]=A,f[M]=t.A.TRI_INDEX-1):f[M]===t.A.TRI_INDEX?f[M+1]=A:(f[M+1]=f[M+2],f[M+2]=A):f[M+1]===S?f[M]=A:(f[M]=f[M+1],f[M+2]===S?f[M+1]=A:(f[M+1]=f[M+2],f[M+2]=A))}}else{if(v+y+b===-3){i[c++]=l;continue}1===v?s[a[d+1]]=p+1:1===y?s[a[d+2]]=_+1:1===b&&(s[a[d]]=g+1)}}for(u/=4,l=0;l<u;++l){var k=i[l],E=4*l;if(k<0){var x=t.A.TRI_INDEX-1;if(f[E]>=x||f[E+1]>=t.A.TRI_INDEX||f[E+2]>=t.A.TRI_INDEX)return!1}else{var R=4*k;f[E]=s[a[R]]-1,f[E+1]=s[a[R+1]]-1,f[E+2]=s[a[R+2]]-1}}return r.setFaces(f),!0}(e,r,i,a)&&(function(e,r,n){var i=0,a=new Uint32Array(e.getNbVertices());r.setVerticesMapping(a);var o=r.getFaces(),s=new Int32Array(e.getNbVertices()),l=0,u=4*r.getNbFaces();for(l=0;l<u;++l){var c=o[l];if(c!==t.A.TRI_INDEX){var h=s[c]-1;-1===h&&(h=i++,s[c]=h+1,a[h]=c),o[l]=h}}r.setVertices(new Float32Array(3*i));var f=e.getFaces(),d=e.getVerticesRingFace(),p=e.getVerticesRingFaceStartCount(),_=new Uint8Array(e.getNbVertices());for(u/=4,l=0;l<u;++l){var g,m,v,y,b,A,T,S,w,M,k=n[l];if(k>=0){var E=4*k;g=f[E+1],m=f[E+2],v=f[E],y=t.A.TRI_INDEX,b=t.A.TRI_INDEX}else{b=-k-1;for(var x=4*l,R=a[o[x]],C=a[o[x+1]],P=a[o[x+2]],D=a[o[x+3]],O=p[2*b],I=O+4,F=O;F<I;++F){var L=4*d[F],V=f[L],N=f[L+1],B=f[L+2],U=f[L+3];V===R?g=N:N===R?g=B:B===R?g=U:U===R&&(g=V),V===C?m=N:N===C?m=B:B===C?m=U:U===C&&(m=V),V===P?v=N:N===P?v=B:B===P?v=U:U===P&&(v=V),V===D?y=N:N===D?y=B:B===D?y=U:U===D&&(y=V)}}A=_[g],T=_[m],S=_[v],w=y!==t.A.TRI_INDEX?_[y]:-1,M=b!==t.A.TRI_INDEX?_[b]:-1,0===A&&(_[g]=1,a[i++]=g),0===T&&(_[m]=1,a[i++]=m),0===S&&(_[v]=1,a[i++]=v),0===w&&(_[y]=1,a[i++]=y),0===M&&(_[b]=1,a[i++]=b)}}(e,r,a),function(e,r){var n=e.getVertices(),i=e.getColors(),a=e.getMaterials(),o=r.getVertices(),s=new Float32Array(o.length),l=new Float32Array(o.length);r.setColors(s),r.setMaterials(l);var u=r.getVerticesMapping(),c=0,h=r.getNbVertices();for(c=0;c<h&&!(u[c]>=h);++c);if(c===h){var f=r.getFaces(),d=f.length;for(c=0;c<d;++c){var p=f[c];p!==t.A.TRI_INDEX&&(f[c]=u[p])}for(c=0;c<h;++c)u[c]=c;o.set(n.subarray(0,3*h)),s.set(i.subarray(0,3*h)),l.set(a.subarray(0,3*h))}else for(r.setEvenMapping(!0),c=0;c<h;++c){var _=3*c,g=3*u[c];o[_]=n[g],o[_+1]=n[g+1],o[_+2]=n[g+2],s[_]=i[g],s[_+1]=i[g+1],s[_+2]=i[g+2],l[_]=a[g],l[_+1]=a[g+1],l[_+2]=a[g+2]}}(e,r),e.hasUV()&&function(e,r,n){for(var i=e.getVerticesDuplicateStartCount(),a=r.getNbVertices(),o=new Uint32Array(2*a),s=r.getVerticesMapping(),l=e.getTexCoords(),u=new Float32Array(t.A.getMemory(4*e.getNbTexCoords()*2),0,2*e.getNbTexCoords()),c=new Uint32Array(a),h=a,f=0;f<a;++f){var d=s[f],p=i[2*d];if(u[2*f]=l[2*d],u[2*f+1]=l[2*d+1],0!==p){for(var _=c[f]=p-h,g=i[2*d+1],m=h,v=h+g;m<v;++m)u[2*m]=l[2*(_+m)],u[2*m+1]=l[2*(_+m)+1];o[2*f]=h,o[2*f+1]=g,h+=g}}r.setTexCoords(new Float32Array(u.subarray(0,2*h))),r.setVerticesDuplicateStartCount(o),function(e,r,n,i){for(var a=e.getFaces(),o=e.getFacesTexCoord(),s=e.getVerticesRingFaceStartCount(),l=e.getVerticesRingFace(),u=e.getVerticesDuplicateStartCount(),c=r.getFaces(),h=new Uint32Array(c),f=r.getVerticesMapping(),d=0,p=c.length;d<p;++d){var _=c[d];if(_!==t.A.TRI_INDEX){var g=f[_];if(0!==u[2*g]){var m=d%4,v=n[(d-m)/4],y=t.A.TRI_INDEX;if(v>=0){var b,A,T=4*v;0===m?(b=a[T+1],A=a[T]):1===m?(b=a[T+2],A=a[T+1]):(b=a[T],A=a[T+2]);for(var S=s[2*g],w=S+s[2*g+1],M=S;M<w;++M){var k=4*l[M],E=a[k],x=a[k+1],R=a[k+2];if(E===b?x===A&&(y=o[k+2]):x===b?R===A&&(y=o[k]):R===b&&E===A&&(y=o[k+1]),y!==t.A.TRI_INDEX)break}}else for(var C=s[2*(v=-v-1)],P=C+4,D=C;D<P;++D){var O=4*l[D];if(a[O]===g?y=o[O]:a[O+1]===g?y=o[O+1]:a[O+2]===g?y=o[O+2]:a[O+3]===g&&(y=o[O+3]),y!==t.A.TRI_INDEX)break}h[d]=y===g?y:y-i[_]}}}r.setFacesTexCoord(h)}(e,r,n,c)}(e,r,a),r.allocateArrays(),!0)};const Fe=Oe;function Le(e){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Le(e)}function Ve(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ne(n.key),n)}}function Ne(e){var t=function(e){if("object"!=Le(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Le(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Le(t)?t:t+""}function Be(){return Be="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Ge(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Be.apply(null,arguments)}function Ue(e,t){return Ue=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ue(e,t)}function je(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(je=function(){return!!e})()}function Ge(e){return Ge=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Ge(e)}var We=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ue(e,t)}(a,e);var t,r,n,i=function(e){var t=je();return function(){var r,n=Ge(e);if(t){var i=Ge(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==Le(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(a);function a(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this)).setID(e.getID()),t.setRenderData(e.getRenderData()),t.setTransformData(e.getTransformData()),t._meshes=[new De(e,!0)],t.setSelection(0);var r=e.getGL();return t._indexBuffer=new ge(r,r.ELEMENT_ARRAY_BUFFER,r.STATIC_DRAW),t._wireframeBuffer=new ge(r,r.ELEMENT_ARRAY_BUFFER,r.STATIC_DRAW),t}return t=a,n=[{key:"NONE",get:function(){return 0}},{key:"SCULPT",get:function(){return 1}},{key:"CAMERA",get:function(){return 2}},{key:"PICKING",get:function(){return 3}}],(r=[{key:"getCurrentMesh",value:function(){return this._meshes[this._sel]}},{key:"setSelection",value:function(e){this._sel=e,this.setMeshData(this.getCurrentMesh().getMeshData())}},{key:"addLevel",value:function(){if(this._meshes.length-1!==this._sel)return this.getCurrentMesh();var e=this.getCurrentMesh().getNbFaces(),t="addLevel : "+e+" -> "+4*e;console.time(t);var r=this.getCurrentMesh(),n=new De(r);return r.setVerticesMapping(void 0),u.fullSubdivision(r,n),n.initTopology(),this.pushMesh(n),this.initRender(),console.timeEnd(t),n}},{key:"computeReverse",value:function(){if(0!==this._sel)return this.getCurrentMesh();var e=this.getCurrentMesh(),t=new De(e);return Fe.computeReverse(e,t)?(t.initTopology(),this.unshiftMesh(t),this.initRender(),t):void 0}},{key:"lowerLevel",value:function(){return 0===this._sel?this._meshes[0]:(this._meshes[this._sel-1].lowerAnalysis(this.getCurrentMesh()),this.setSelection(this._sel-1),this.updateResolution(),this.getCurrentMesh())}},{key:"higherLevel",value:function(){return this._sel===this._meshes.length-1||(this._meshes[this._sel+1].higherSynthesis(this.getCurrentMesh()),this.setSelection(this._sel+1),this.updateResolution()),this.getCurrentMesh()}},{key:"updateResolution",value:function(){this.updateGeometry(),this.updateDuplicateColorsAndMaterials(),this.updateBuffers();var e=this._meshes[this.getLowIndexRender()];this._indexBuffer.update(e.getTriangles()),this._wireframeBuffer.update(e.getWireframe())}},{key:"selectResolution",value:function(e){for(;this._sel>e;)this.lowerLevel();for(;this._sel<e;)this.higherLevel()}},{key:"findIndexFromMesh",value:function(e){for(var t=this._meshes,r=0,n=t.length;r<n;++r)if(e===t[r])return r}},{key:"selectMesh",value:function(e){var t=this.findIndexFromMesh(e);this.selectResolution(t)}},{key:"pushMesh",value:function(e){this._meshes.push(e),this.setSelection(this._meshes.length-1),this.updateResolution()}},{key:"unshiftMesh",value:function(e){this._meshes.unshift(e),this.setSelection(1),this.lowerLevel()}},{key:"popMesh",value:function(){this._meshes.pop(),this.setSelection(this._meshes.length-1),this.updateResolution()}},{key:"shiftMesh",value:function(){this._meshes.shift(),this.setSelection(0),this.updateResolution()}},{key:"deleteLower",value:function(){this._meshes.splice(0,this._sel),this.setSelection(0)}},{key:"deleteHigher",value:function(){this._meshes.splice(this._sel+1)}},{key:"getLowIndexRender",value:function(){for(var e=this._sel;e>=0;){var t=this._meshes[e];if(!0===t.getEvenMapping())return e===this._sel?e:e+1;if(t.getNbTriangles()<5e5)return e;--e}return 0}},{key:"_renderLow",value:function(e){var t=this.getRenderData(),r=this._sel,n=this.getIndexBuffer();this.setSelection(this.getLowIndexRender()),t._indexBuffer=this._indexBuffer,Be(Ge(a.prototype),"render",this).call(this,e),t._indexBuffer=n,this.setSelection(r)}},{key:"_renderWireframeLow",value:function(e){var t=this.getRenderData(),r=this._sel,n=this.getWireframeBuffer();this.setSelection(this.getLowIndexRender()),t._wireframeBuffer=this._wireframeBuffer,Be(Ge(a.prototype),"renderWireframe",this).call(this,e),t._wireframeBuffer=n,this.setSelection(r)}},{key:"_canUseLowRender",value:function(e){return!(this.isUsingTexCoords()||this.isUsingDrawArrays()||a.RENDER_HINT===a.PICKING||a.RENDER_HINT===a.NONE||e.getMesh()===this&&a.RENDER_HINT!==a.CAMERA||this.getLowIndexRender()===this._sel)}},{key:"render",value:function(e){return this._canUseLowRender(e)?this._renderLow(e):Be(Ge(a.prototype),"render",this).call(this,e)}},{key:"renderWireframe",value:function(e){return this._canUseLowRender(e)?this._renderWireframeLow(e):Be(Ge(a.prototype),"renderWireframe",this).call(this,e)}}])&&Ve(t.prototype,r),n&&Ve(t,n),Object.defineProperty(t,"prototype",{writable:!1}),a}(Se);We.RENDER_HINT=0;const ze=We;function Xe(e){return Xe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Xe(e)}function Ke(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,He(n.key),n)}}function He(e){var t=function(e){if("object"!=Xe(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Xe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Xe(t)?t:t+""}var Ye=g.vt(),qe=g.vt(),Ze=[0,0,0],Je=[0,0,0],Qe=[0,0,1];const $e=function(){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._gl=e,this._circleBuffer=new ge(e,e.ARRAY_BUFFER,e.STATIC_DRAW),this._dotBuffer=new ge(e,e.ARRAY_BUFFER,e.STATIC_DRAW),this._cacheDotMVP=g.vt(),this._cacheDotSymMVP=g.vt(),this._cacheCircleMVP=g.vt(),this._color=new Float32Array([.8,0,0]),this._offsetX=0,this._isEditMode=!1,this.init()}var r,n;return r=t,n=[{key:"getGL",value:function(){return this._gl}},{key:"getCircleBuffer",value:function(){return this._circleBuffer}},{key:"getDotBuffer",value:function(){return this._dotBuffer}},{key:"getCircleMVP",value:function(){return this._cacheCircleMVP}},{key:"getDotMVP",value:function(){return this._cacheDotMVP}},{key:"getDotSymmetryMVP",value:function(){return this._cacheDotSymMVP}},{key:"getColor",value:function(){return this._color}},{key:"setIsEditMode",value:function(e){this._isEditMode=e}},{key:"getIsEditMode",value:function(){return this._isEditMode}},{key:"setOffsetX",value:function(e){this._offsetX=e}},{key:"getOffsetX",value:function(){return this._offsetX}},{key:"init",value:function(){this.getCircleBuffer().update(this._getCircleVertices(1)),this.getDotBuffer().update(this._getDotVertices(.05,10))}},{key:"release",value:function(){this.getCircleBuffer().release(),this.getDotBuffer().release()}},{key:"_getCircleVertices",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:50,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=2*Math.PI,i=r?1:0,a=r?t+2:t,o=new Float32Array(3*a),s=i;s<a;++s){var l=3*s,u=n*s/t;o[l]=Math.cos(u)*e,o[l+1]=Math.sin(u)*e}return o}},{key:"_getDotVertices",value:function(e,t){return this._getCircleVertices(e,t,!0)}},{key:"_updateMatricesBackground",value:function(e,t){var r=t.getSculptManager().getCurrentTool().getScreenRadius(),n=.5*e._width,i=.5*e._height;g.v3(Ye,-n,n,-i,i,-10,10),g.D_(qe),g.Tl(qe,qe,c.hZ(Ze,-n+t._mouseX+this._offsetX,i-t._mouseY,0)),g.hs(this._cacheCircleMVP,qe,c.hZ(Ze,r,r,r)),g.lK(this._cacheCircleMVP,Ye,this._cacheCircleMVP),g.hs(this._cacheDotMVP,qe,c.hZ(Ze,50,50,50)),g.lK(this._cacheDotMVP,Ye,this._cacheDotMVP),g.hs(this._cacheDotSymMVP,this._cacheDotSymMVP,[0,0,0])}},{key:"_updateMatricesMesh",value:function(e,t){var r=t.getPicking(),n=t.getPickingSymmetry(),i=Math.sqrt(r.computeWorldRadius2(!0)),a=t.getSculptManager().getCurrentTool().getScreenRadius(),o=r.getMesh(),s=i/a*50;r.polyLerp(o.getNormals(),Je),c.ei(Je,Je,_(qe,o.getMatrix())),c.S8(Je,Je);var l=Math.acos(c.Om(Qe,Je));c.$A(Je,Qe,Je),g.D_(qe),g.Tl(qe,qe,c.Z0(Ze,r.getIntersectionPoint(),o.getMatrix())),g.e$(qe,qe,l,Je),g.lK(Ye,e.getProjection(),e.getView()),g.hs(this._cacheCircleMVP,qe,c.hZ(Ze,i,i,i)),g.lK(this._cacheCircleMVP,Ye,this._cacheCircleMVP),g.hs(this._cacheDotMVP,qe,c.hZ(Ze,s,s,s)),g.lK(this._cacheDotMVP,Ye,this._cacheDotMVP),c.Z0(Ze,n.getIntersectionPoint(),o.getMatrix()),g.D_(qe),g.Tl(qe,qe,Ze),g.e$(qe,qe,l,Je),g.hs(qe,qe,c.hZ(Ze,s,s,s)),g.lK(this._cacheDotSymMVP,Ye,qe)}},{key:"render",value:function(t){var r=t.getPicking().getMesh()&&!this._isEditMode;r?this._updateMatricesMesh(t.getCamera(),t):this._updateMatricesBackground(t.getCamera(),t);var n=t._action===e.A.Action.NOTHING;c.hZ(this._color,.8,n&&r?0:.4,0),fe[e.A.Shader.SELECTION].getOrCreate(this._gl).draw(this,n,t.getSculptManager().getSymmetry()),this._isEditMode=!1}}],n&&Ke(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();var et=__webpack_require__(142);function tt(e){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tt(e)}function rt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nt(n.key),n)}}function nt(e){var t=function(e){if("object"!=tt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==tt(t)?t:t+""}var it=function(){function r(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this._main=e,this._cbContinuous=this.updateContinuous.bind(this),this._lastMouseX=0,this._lastMouseY=0}var n,i;return n=r,i=[{key:"setToolMesh",value:function(e){this._forceToolMesh=e}},{key:"getMesh",value:function(){return this._forceToolMesh||this._main.getMesh()}},{key:"start",value:function(e){var t=this._main,r=t.getPicking();if(!r.intersectionMouseMeshes())return!1;var n=t.setOrUnsetMesh(r.getMesh(),e);if(!n)return!1;r.initAlpha();var i=t.getSculptManager().getSymmetry()?t.getPickingSymmetry():null;return i&&(i.intersectionMouseMesh(n),i.initAlpha()),this.pushState(),this._lastMouseX=t._mouseX,this._lastMouseY=t._mouseY,this.startSculpt(),!0}},{key:"end",value:function(){this.getMesh()&&this.getMesh().balanceOctree()}},{key:"pushState",value:function(){this._main.getStateManager().pushStateGeometry(this.getMesh())}},{key:"startSculpt",value:function(){!0!==this._lockPosition&&this.sculptStroke()}},{key:"preUpdate",value:function(t){var r=this._main,n=r.getPicking(),i=r._action===e.A.Action.SCULPT_EDIT;if(!i||t){i?n.intersectionMouseMesh():n.intersectionMouseMeshes();var a=n.getMesh();a&&r.getSculptManager().getSymmetry()&&r.getPickingSymmetry().intersectionMouseMesh(a)}}},{key:"update",value:function(e){if(!0===this._lockPosition)return this.updateSculptLock(e);this.sculptStroke()}},{key:"updateSculptLock",value:function(e){var t=this._main;e||this._main.getStateManager().getCurrentState().undo();var r=t.getPicking(),n=this._radius,i=t.getSculptManager().getSymmetry()?t.getPickingSymmetry():null,a=t._mouseX-this._lastMouseX,o=t._mouseY-this._lastMouseY;this._radius=Math.sqrt(a*a+o*o);var s=a/this._radius,l=o/this._radius;this.makeStroke(this._lastMouseX+.001*s,this._lastMouseY+.001*l,r,i),this._radius=n,this.updateRender(),t.setCanvasCursor("default")}},{key:"sculptStroke",value:function(){var e=this._main,t=e.getPicking(),r=e.getSculptManager().getSymmetry()?e.getPickingSymmetry():null,n=e._mouseX-this._lastMouseX,i=e._mouseY-this._lastMouseY,a=Math.sqrt(n*n+i*i),o=.15*this._radius*e.getPixelRatio();if(!(a<=o)){var s=1/Math.floor(a/o);n*=s,i*=s;for(var l=this._lastMouseX+n,u=this._lastMouseY+i,c=s;c<=1&&this.makeStroke(l,u,t,r);c+=s)l+=n,u+=i;this.updateRender(),this._lastMouseX=e._mouseX,this._lastMouseY=e._mouseY}}},{key:"updateRender",value:function(){this.updateMeshBuffers(),this._main.render()}},{key:"makeStroke",value:function(e,t,r,n){var i=this.getMesh();r.intersectionMouseMesh(i,e,t);var a=r.getMesh();a&&(r.pickVerticesInSphere(r.getLocalRadius2()),r.computePickedNormal());var o,s=i.isDynamic&&!this._lockPosition;return s&&a&&this.stroke(r,!1),n&&(n.intersectionMouseMesh(i,e,t),(o=n.getMesh())&&(n.setLocalRadius2(r.getLocalRadius2()),n.pickVerticesInSphere(n.getLocalRadius2()),n.computePickedNormal())),!s&&a&&this.stroke(r,!1),o&&this.stroke(n,!0),a||o}},{key:"updateMeshBuffers",value:function(){var e=this.getMesh();e.isDynamic?e.updateBuffers():e.updateGeometryBuffers()}},{key:"updateContinuous",value:function(){if(this._lockPosition)return this.update(!0);var e=this._main,t=e.getPicking(),r=e.getSculptManager().getSymmetry()?e.getPickingSymmetry():null;this.makeStroke(e._mouseX,e._mouseY,t,r),this.updateRender()}},{key:"getFrontVertices",value:function(e,r){for(var n=e.length,i=new Uint32Array(t.A.getMemory(4*n),0,n),a=0,o=this.getMesh().getNormals(),s=r[0],l=r[1],u=r[2],c=0;c<n;++c){var h=e[c],f=3*h;o[f]*s+o[f+1]*l+o[f+2]*u<=0&&(i[a++]=h)}return new Uint32Array(i.subarray(0,a))}},{key:"areaNormal",value:function(e){for(var t=this.getMesh(),r=t.getNormals(),n=t.getMaterials(),i=0,a=0,o=0,s=0,l=e.length;s<l;++s){var u=3*e[s],c=n[u+2];i+=r[u]*c,a+=r[u+1]*c,o+=r[u+2]*c}var h=Math.sqrt(i*i+a*a+o*o);if(0!==h)return[i*(h=1/h),a*h,o*h]}},{key:"areaCenter",value:function(e){for(var t=this.getMesh(),r=t.getVertices(),n=t.getMaterials(),i=e.length,a=0,o=0,s=0,l=0,u=0;u<i;++u){var c=3*e[u],h=n[c+2];l+=h,a+=r[c]*h,o+=r[c+1]*h,s+=r[c+2]*h}return[a/l,o/l,s/l]}},{key:"updateProxy",value:function(e){var r=this.getMesh(),n=r.getVertices(),i=r.getVerticesProxy();if(n!==i)for(var a=r.getVerticesStateFlags(),o=t.A.STATE_FLAG,s=0,l=e.length;s<l;++s){var u=e[s];if(a[u]!==o){var c=3*u;i[c]=n[c],i[c+1]=n[c+1],i[c+2]=n[c+2]}}}},{key:"laplacianSmooth",value:function(e,t,r){for(var n=this.getMesh(),i=n.getVerticesRingVertStartCount(),a=n.getVerticesRingVert(),o=a instanceof Array?a:null,s=n.getVerticesOnEdge(),l=r||n.getVertices(),u=e.length,c=0;c<u;++c){var h,f,d=3*c,p=e[c];o?(h=0,f=(a=o[p]).length):f=(h=i[2*p])+i[2*p+1];var _=0,g=f-h;if(g<=2)_=3*p,t[d]=l[_],t[d+1]=l[_+1],t[d+2]=l[_+2];else{var m=0,v=0,y=0,b=0;if(1===s[p]){var A=0;for(b=h;b<f;++b)1===s[_=a[b]]&&(m+=l[_*=3],v+=l[_+1],y+=l[_+2],++A);if(A>=2){t[d]=m/A,t[d+1]=v/A,t[d+2]=y/A;continue}m=v=y=0}for(b=h;b<f;++b)m+=l[_=3*a[b]],v+=l[_+1],y+=l[_+2];t[d]=m/g,t[d+1]=v/g,t[d+2]=y/g}}}},{key:"dynamicTopology",value:function(e){var r=this.getMesh(),n=e.getPickedVertices();if(!r.isDynamic)return n;var i=r.getSubdivisionFactor(),a=r.getDecimationFactor();if(0===i&&0===a)return n;0===n.length&&(n=r.getVerticesFromFaces([e.getPickedFace()]),this._main.getStateManager().pushVertices(n));var o=r.getFacesFromVertices(n),s=e.getLocalRadius2(),l=e.getIntersectionPoint(),u=s*(1.1-i)*.2,c=u/4.2025*a;this._main.getStateManager().pushFaces(o),i&&(o=r.subdivide(o,l,s,u,this._main.getStateManager())),a&&(o=r.decimate(o,l,s,c,this._main.getStateManager()));for(var h=(n=r.getVerticesFromFaces(o)).length,f=t.A.SCULPT_FLAG,d=r.getVerticesSculptFlags(),p=new Uint32Array(t.A.getMemory(4*h),0,h),_=0,g=0;g<h;++g){var m=n[g];d[m]===f&&(p[_++]=m)}return p=new Uint32Array(p.subarray(0,_)),r.updateTopology(o,n),r.updateGeometry(o,n),p}},{key:"getUnmaskedVertices",value:function(){return this.filterMaskedVertices(0,1/0)}},{key:"getMaskedVertices",value:function(){return this.filterMaskedVertices(-1/0,1)}},{key:"filterMaskedVertices",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1/0,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0,n=this.getMesh(),i=n.getMaterials(),a=n.getNbVertices(),o=new Uint32Array(t.A.getMemory(4*a),0,a),s=0,l=0;l<a;++l){var u=i[3*l+2];u>e&&u<r&&(o[s++]=l)}return new Uint32Array(o.subarray(0,s))}},{key:"postRender",value:function(e){e.render(this._main)}},{key:"addSculptToScene",value:function(){}},{key:"getScreenRadius",value:function(){return(this._radius||1)*this._main.getPixelRatio()}}],i&&rt(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),r}();const at=it;function ot(e){return ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ot(e)}function st(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,lt(n.key),n)}}function lt(e){var t=function(e){if("object"!=ot(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ot(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ot(t)?t:t+""}function ut(e,t){return ut=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ut(e,t)}function ct(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ct=function(){return!!e})()}function ht(e){return ht=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},ht(e)}var ft=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ut(e,t)}(i,e);var t,r,n=function(e){var t=ct();return function(){var r,n=ht(e);if(t){var i=ht(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==ot(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this,e))._radius=50,t._intensity=.75,t._negative=!0,t._culling=!1,t._idAlpha=0,t._lockPosition=!1,t}return t=i,r=[{key:"stroke",value:function(e){var t=e.getPickedVertices(),r=this._intensity*et.A.getPressureIntensity();this._main.getStateManager().pushVertices(t),t=this.dynamicTopology(e);var n=this.getFrontVertices(t,e.getEyeDirection());this._culling&&(t=n);var i=this.areaNormal(n);if(i){var a=this.areaCenter(n);e.updateAlpha(this._lockPosition),e.setIdAlpha(this._idAlpha),this.flatten(t,i,a,e.getIntersectionPoint(),e.getLocalRadius2(),r,e);var o=this.getMesh();o.updateGeometry(o.getFacesFromVertices(t),t)}}},{key:"flatten",value:function(e,t,r,n,i,a,o){for(var s=this.getMesh(),l=s.getVertices(),u=s.getMaterials(),c=Math.sqrt(i),h=!1===this._accumulate&&!1===this._lockPosition?s.getVerticesProxy():l,f=n[0],d=n[1],p=n[2],_=r[0],g=r[1],m=r[2],v=t[0],y=t[1],b=t[2],A=this._negative?-1:1,T=0,S=e.length;T<S;++T){var w=3*e[T],M=l[w],k=l[w+1],E=l[w+2],x=(M-_)*v+(k-g)*y+(E-m)*b;if(!(x*A>0)){var R=h[w]-f,C=h[w+1]-d,P=h[w+2]-p,D=Math.sqrt(R*R+C*C+P*P)/c;if(!(D>=1)){var O=D*D;O=3*O*O-4*O*D+1,O*=x*a*u[w+2]*o.getAlpha(M,k,E),l[w]-=v*O,l[w+1]-=y*O,l[w+2]-=b*O}}}}}],r&&st(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(at);const dt=ft;function pt(e){return pt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},pt(e)}function _t(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,gt(n.key),n)}}function gt(e){var t=function(e){if("object"!=pt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=pt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==pt(t)?t:t+""}function mt(e,t){return mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},mt(e,t)}function vt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(vt=function(){return!!e})()}function yt(e){return yt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},yt(e)}var bt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&mt(e,t)}(i,e);var t,r,n=function(e){var t=vt();return function(){var r,n=yt(e);if(t){var i=yt(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==pt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this,e))._radius=50,t._intensity=.5,t._negative=!1,t._clay=!0,t._culling=!1,t._accumulate=!0,t._idAlpha=0,t._lockPosition=!1,t}return t=i,r=[{key:"stroke",value:function(e){var t=e.getPickedVertices(),r=this._intensity*et.A.getPressureIntensity();this._accumulate||this._lockPosition||this.updateProxy(t),this._main.getStateManager().pushVertices(t),this._lockPosition||(t=this.dynamicTopology(e));var n=this.getFrontVertices(t,e.getEyeDirection());this._culling&&(t=n);var i=e.getLocalRadius2();if(e.updateAlpha(this._lockPosition),e.setIdAlpha(this._idAlpha),this._clay){var a=this.areaNormal(n);if(!a)return;var o=this._lockPosition?e.getIntersectionPoint():this.areaCenter(n),s=.1*Math.sqrt(i);c.Ln(o,o,a,this._negative?-s:s),dt.prototype.flatten.call(this,t,a,o,e.getIntersectionPoint(),i,r,e)}else this.brush(t,e.getPickedNormal(),e.getIntersectionPoint(),i,r,e);var l=this.getMesh();l.updateGeometry(l.getFacesFromVertices(t),t)}},{key:"brush",value:function(e,t,r,n,i,a){var o=this.getMesh(),s=o.getVertices(),l=o.getMaterials(),u=this._accumulate||this._lockPosition?s:o.getVerticesProxy(),c=Math.sqrt(n),h=i*c*.1;this._negative&&(h=-h);for(var f=r[0],d=r[1],p=r[2],_=t[0],g=t[1],m=t[2],v=0,y=e.length;v<y;++v){var b=3*e[v],A=u[b]-f,T=u[b+1]-d,S=u[b+2]-p,w=Math.sqrt(A*A+T*T+S*S)/c;if(!(w>=1)){var M=s[b],k=s[b+1],E=s[b+2],x=w*w;x=3*x*x-4*x*w+1,x*=l[b+2]*h*a.getAlpha(M,k,E),s[b]=M+_*x,s[b+1]=k+g*x,s[b+2]=E+m*x}}}}],r&&_t(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(at);const At=bt;function Tt(e){return Tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Tt(e)}function St(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,wt(n.key),n)}}function wt(e){var t=function(e){if("object"!=Tt(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Tt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Tt(t)?t:t+""}function Mt(e,t){return Mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Mt(e,t)}function kt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(kt=function(){return!!e})()}function Et(e){return Et=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Et(e)}var xt=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Mt(e,t)}(i,e);var t,r,n=function(e){var t=kt();return function(){var r,n=Et(e);if(t){var i=Et(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==Tt(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this,e))._radius=50,t._intensity=.3,t._negative=!1,t._culling=!1,t._idAlpha=0,t._lockPosition=!1,t}return t=i,r=[{key:"stroke",value:function(e){var t=e.getPickedVertices(),r=this._intensity*et.A.getPressureIntensity();this.updateProxy(t),this._main.getStateManager().pushVertices(t),t=this.dynamicTopology(e),this._culling&&(t=this.getFrontVertices(t,e.getEyeDirection())),e.updateAlpha(this._lockPosition),e.setIdAlpha(this._idAlpha),this.inflate(t,e.getIntersectionPoint(),e.getLocalRadius2(),r,e);var n=this.getMesh();n.updateGeometry(n.getFacesFromVertices(t),t)}},{key:"inflate",value:function(e,t,r,n,i){var a=this.getMesh(),o=a.getVertices(),s=a.getMaterials(),l=a.getVerticesProxy(),u=a.getNormals(),c=Math.sqrt(r),h=n*c*.1;this._negative&&(h=-h);for(var f=t[0],d=t[1],p=t[2],_=0,g=e.length;_<g;++_){var m=3*e[_],v=l[m]-f,y=l[m+1]-d,b=l[m+2]-p,A=Math.sqrt(v*v+y*y+b*b)/c;if(!(A>=1)){var T=A*A;T=3*T*T-4*T*A+1,T*=h;var S=o[m],w=o[m+1],M=o[m+2],k=u[m],E=u[m+1],x=u[m+2];T/=Math.sqrt(k*k+E*E+x*x),T*=s[m+2]*i.getAlpha(S,w,M),o[m]=S+k*T,o[m+1]=w+E*T,o[m+2]=M+x*T}}}}],r&&St(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(at);const Rt=xt;function Ct(e,t,r){return e[0]=t,e[1]=r,e}function Pt(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e}function Dt(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function Ot(e,t){return e[0]*t[0]+e[1]*t[1]}var It,Ft=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e},Lt=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.hypot(r,n)};function Vt(){var e=new h.tb(4);return h.tb!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e[3]=1,e}function Nt(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e}function Bt(e,t,r){r*=.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e}function Ut(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=n*l+o*s,e[1]=i*l+a*s,e[2]=a*l-i*s,e[3]=o*l-n*s,e}function jt(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=n*l-a*s,e[1]=i*l+o*s,e[2]=a*l+n*s,e[3]=o*l-i*s,e}It=new h.tb(2),h.tb!=Float32Array&&(It[0]=0,It[1]=0),function(){var e=new h.tb(4);h.tb!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0)}();var Gt=function(e,t,r,n){var i=new h.tb(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i},Wt=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],l=r[1],u=r[2],c=r[3];return e[0]=n*c+o*s+i*u-a*l,e[1]=i*c+o*l+a*s-n*u,e[2]=a*c+o*u+n*l-i*s,e[3]=o*c-n*s-i*l-a*u,e},zt=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},Xt=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o)),e[0]=r*o,e[1]=n*o,e[2]=i*o,e[3]=a*o,e},Kt=(c.vt(),c.fA(1,0,0),c.fA(0,1,0),Vt(),Vt(),f(),__webpack_require__(693));function Ht(e){return Ht="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ht(e)}function Yt(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,qt(n.key),n)}}function qt(e){var t=function(e){if("object"!=Ht(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ht(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ht(t)?t:t+""}function Zt(e,t){return Zt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Zt(e,t)}function Jt(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Jt=function(){return!!e})()}function Qt(e){return Qt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Qt(e)}var $t=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Zt(e,t)}(i,e);var t,r,n=function(e){var t=Jt();return function(){var r,n=Qt(e);if(t){var i=Qt(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==Ht(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this,e))._radius=75,t._culling=!1,t._twistData={normal:[0,0,0],center:[0,0]},t._twistDataSym={normal:[0,0,0],center:[0,0]},t._idAlpha=0,t}return t=i,r=[{key:"startSculpt",value:function(){var e=this._main,t=e._mouseX,r=e._mouseY,n=e.getPicking();if(this.initTwistData(n,t,r,this._twistData),e.getSculptManager().getSymmetry()){var i=e.getPickingSymmetry();i.intersectionMouseMesh(),i.setLocalRadius2(n.getLocalRadius2()),i.getMesh()&&this.initTwistData(i,t,r,this._twistDataSym)}}},{key:"initTwistData",value:function(e,t,r,n){e.pickVerticesInSphere(e.getLocalRadius2()),c.ze(n.normal,e.getEyeDirection()),Ct(n.center,t,r)}},{key:"sculptStroke",value:function(){var e=this._main,t=e._mouseX,r=e._mouseY,n=e._lastMouseX,i=e._lastMouseY,a=e.getPicking(),o=a.getLocalRadius2();if(a.pickVerticesInSphere(o),this.stroke(a,t,r,n,i,this._twistData),e.getSculptManager().getSymmetry()){var s=e.getPickingSymmetry();s.getMesh()&&(s.pickVerticesInSphere(o),this.stroke(s,n,i,t,r,this._twistDataSym))}this.updateRender(),e.setCanvasCursor("default")}},{key:"stroke",value:function(e,t,r,n,i,a){var o=e.getPickedVertices();this._main.getStateManager().pushVertices(o),o=this.dynamicTopology(e),this._culling&&(o=this.getFrontVertices(o,e.getEyeDirection())),e.updateAlpha(!1),e.setIdAlpha(this._idAlpha),this.twist(o,e.getIntersectionPoint(),e.getLocalRadius2(),t,r,n,i,a,e);var s=this.getMesh();s.updateGeometry(s.getFacesFromVertices(o),o)}},{key:"twist",value:function(e,t,r,n,i,a,o,s,l){var u,h,f,d=this.getMesh(),p=s.center,_=[n-p[0],i-p[1]];if(h=(u=_)[0],f=u[1],!(Math.hypot(h,f)<30)){Dt(_,_);var g=s.normal,m=[0,0,0,0],v=[a-p[0],o-p[1]];Dt(v,v);for(var y=Kt.A.signedAngle2d(_,v),b=d.getVertices(),A=d.getMaterials(),T=1/Math.sqrt(r),S=t[0],w=t[1],M=t[2],k=[0,0,0],E=0,x=e.length;E<x;++E){var R=3*e[E],C=b[R],P=b[R+1],D=b[R+2],O=C-S,I=P-w,F=D-M,L=Math.sqrt(O*O+I*I+F*F)*T,V=L*L;V=3*V*V-4*V*L+1,Bt(m,g,V*=y*A[R+2]*l.getAlpha(C,P,D)),c.hZ(k,C,P,D),c.jb(k,k,t),c.gL(k,k,m),c.WQ(k,k,t),b[R]=k[0],b[R+1]=k[1],b[R+2]=k[2]}}}}],r&&Yt(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(at);const er=$t;function tr(e){return tr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},tr(e)}function rr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,nr(n.key),n)}}function nr(e){var t=function(e){if("object"!=tr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=tr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==tr(t)?t:t+""}function ir(e,t){return ir=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ir(e,t)}function ar(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ar=function(){return!!e})()}function or(e){return or=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},or(e)}var sr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&ir(e,t)}(a,e);var r,n,i=function(e){var t=ar();return function(){var r,n=or(e);if(t){var i=or(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==tr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._radius=50,t._intensity=.75,t._culling=!1,t._tangent=!1,t._idAlpha=0,t._lockPosition=!1,t}return r=a,n=[{key:"stroke",value:function(e){var t=e.getPickedVertices(),r=this._intensity*et.A.getPressureIntensity();this._main.getStateManager().pushVertices(t),this._culling&&(t=this.getFrontVertices(t,e.getEyeDirection())),e.updateAlpha(this._lockPosition),e.setIdAlpha(this._idAlpha),this._tangent?this.smoothTangent(t,r,e):this.smooth(t,r,e);var n=this.getMesh();n.updateGeometry(n.getFacesFromVertices(t),t)}},{key:"smooth",value:function(e,r,n){var i=this.getMesh(),a=i.getVertices(),o=i.getMaterials(),s=e.length,l=new Float32Array(t.A.getMemory(4*s*3),0,3*s);this.laplacianSmooth(e,l);for(var u=0;u<s;++u){var c=3*e[u],h=a[c],f=a[c+1],d=a[c+2],p=3*u,_=r*o[c+2];n&&(_*=n.getAlpha(h,f,d));var g=1-_;a[c]=h*g+l[p]*_,a[c+1]=f*g+l[p+1]*_,a[c+2]=d*g+l[p+2]*_}}},{key:"smoothTangent",value:function(e,r,n){var i=this.getMesh(),a=i.getVertices(),o=i.getMaterials(),s=i.getNormals(),l=e.length,u=new Float32Array(t.A.getMemory(4*l*3),0,3*l);this.laplacianSmooth(e,u);for(var c=0;c<l;++c){var h=3*e[c],f=a[h],d=a[h+1],p=a[h+2],_=s[h],g=s[h+1],m=s[h+2],v=_*_+g*g+m*m;if(0!==v){_*=v=1/Math.sqrt(v),g*=v,m*=v;var y=3*c,b=u[y],A=u[y+1],T=u[y+2],S=_*(b-f)+g*(A-d)+m*(T-p),w=r*o[h+2];n&&(w*=n.getAlpha(f,d,p)),a[h]=f+(b-_*S-f)*w,a[h+1]=d+(A-g*S-d)*w,a[h+2]=p+(T-m*S-p)*w}}}},{key:"smoothAlongNormals",value:function(e,r,n){var i=this.getMesh(),a=i.getVertices(),o=i.getMaterials(),s=i.getNormals(),l=e.length,u=new Float32Array(t.A.getMemory(4*l*3),0,3*l);this.laplacianSmooth(e,u);for(var c=0;c<l;++c){var h=3*e[c],f=a[h],d=a[h+1],p=a[h+2],_=s[h],g=s[h+1],m=s[h+2],v=3*c,y=1/(_*_+g*g+m*m),b=_*(u[v]-f)+g*(u[v+1]-d)+m*(u[v+2]-p);b*=y*r*o[h+2],n&&(b*=n.getAlpha(f,d,p)),a[h]=f+_*b,a[h+1]=d+g*b,a[h+2]=p+m*b}}}],n&&rr(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(at);const lr=sr;function ur(e){return ur="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ur(e)}function cr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,hr(n.key),n)}}function hr(e){var t=function(e){if("object"!=ur(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ur(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ur(t)?t:t+""}function fr(e,t){return fr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},fr(e,t)}function dr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(dr=function(){return!!e})()}function pr(e){return pr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},pr(e)}var _r=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fr(e,t)}(i,e);var t,r,n=function(e){var t=dr();return function(){var r,n=pr(e);if(t){var i=pr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==ur(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this,e))._radius=50,t._intensity=.75,t._negative=!1,t._culling=!1,t._idAlpha=0,t._lockPosition=!1,t}return t=i,r=[{key:"stroke",value:function(e){var t=e.getPickedVertices(),r=this._intensity*et.A.getPressureIntensity();this._main.getStateManager().pushVertices(t),t=this.dynamicTopology(e),this._culling&&(t=this.getFrontVertices(t,e.getEyeDirection())),e.updateAlpha(this._lockPosition),e.setIdAlpha(this._idAlpha),this.pinch(t,e.getIntersectionPoint(),e.getLocalRadius2(),r,e);var n=this.getMesh();n.updateGeometry(n.getFacesFromVertices(t),t)}},{key:"pinch",value:function(e,t,r,n,i){var a=this.getMesh(),o=a.getVertices(),s=a.getMaterials(),l=Math.sqrt(r),u=t[0],c=t[1],h=t[2],f=.05*n;this._negative&&(f=-f);for(var d=0,p=e.length;d<p;++d){var _=3*e[d],g=o[_],m=o[_+1],v=o[_+2],y=u-g,b=c-m,A=h-v,T=Math.sqrt(y*y+b*b+A*A)/l,S=T*T;S=3*S*S-4*S*T+1,S*=f*s[_+2]*i.getAlpha(g,m,v),o[_]=g+y*S,o[_+1]=m+b*S,o[_+2]=v+A*S}}}],r&&cr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(at);const gr=_r;function mr(e){return mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mr(e)}function vr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,yr(n.key),n)}}function yr(e){var t=function(e){if("object"!=mr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=mr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==mr(t)?t:t+""}function br(e,t){return br=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},br(e,t)}function Ar(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ar=function(){return!!e})()}function Tr(e){return Tr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Tr(e)}var Sr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&br(e,t)}(i,e);var t,r,n=function(e){var t=Ar();return function(){var r,n=Tr(e);if(t){var i=Tr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==mr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this,e))._radius=25,t._intensity=.75,t._negative=!0,t._culling=!1,t._idAlpha=0,t._lockPosition=!1,t}return t=i,r=[{key:"stroke",value:function(e){var t=e.getPickedVertices(),r=this._intensity*et.A.getPressureIntensity();this.updateProxy(t),this._main.getStateManager().pushVertices(t),t=this.dynamicTopology(e),this._culling&&(t=this.getFrontVertices(t,e.getEyeDirection())),e.updateAlpha(this._lockPosition),e.setIdAlpha(this._idAlpha),this.crease(t,e.getPickedNormal(),e.getIntersectionPoint(),e.getLocalRadius2(),r,e);var n=this.getMesh();n.updateGeometry(n.getFacesFromVertices(t),t)}},{key:"crease",value:function(e,t,r,n,i,a){var o=this.getMesh(),s=o.getVertices(),l=o.getMaterials(),u=o.getVerticesProxy(),c=Math.sqrt(n),h=r[0],f=r[1],d=r[2],p=t[0],_=t[1],g=t[2],m=.07*i,v=m*c;this._negative&&(v=-v);for(var y=0,b=e.length;y<b;++y){var A=3*e[y],T=h-u[A],S=f-u[A+1],w=d-u[A+2],M=Math.sqrt(T*T+S*S+w*w)/c;if(!(M>=1)){var k=s[A],E=s[A+1],x=s[A+2],R=M*M;R=3*R*R-4*R*M+1,R*=l[A+2]*a.getAlpha(k,E,x);var C=Math.pow(R,5)*v;R*=m,s[A]=k+T*R+p*C,s[A+1]=E+S*R+_*C,s[A+2]=x+w*R+g*C}}}}],r&&vr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(at);const wr=Sr;function Mr(e){return Mr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Mr(e)}function kr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Er(n.key),n)}}function Er(e){var t=function(e){if("object"!=Mr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Mr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Mr(t)?t:t+""}function xr(e,t){return xr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},xr(e,t)}function Rr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Rr=function(){return!!e})()}function Cr(e){return Cr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Cr(e)}var Pr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&xr(e,t)}(i,e);var t,r,n=function(e){var t=Rr();return function(){var r,n=Cr(e);if(t){var i=Cr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==Mr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this,e))._radius=150,t._dragDir=[0,0,0],t._dragDirSym=[0,0,0],t._idAlpha=0,t}return t=i,r=[{key:"sculptStroke",value:function(){var e=this._main,t=this.getMesh(),r=e.getPicking(),n=e.getSculptManager().getSymmetry()?e.getPickingSymmetry():null,i=e._mouseX-this._lastMouseX,a=e._mouseY-this._lastMouseY,o=Math.sqrt(i*i+a*a),s=.15*this._radius,l=1/Math.floor(o/s);i*=l,a*=l;var u=this._lastMouseX,h=this._lastMouseY;if(r.getMesh()){r._mesh=t,n&&(n._mesh=t,c.C(n.getIntersectionPoint(),r.getIntersectionPoint()),Kt.A.mirrorPoint(n.getIntersectionPoint(),t.getSymmetryOrigin(),t.getSymmetryNormal()));for(var f=0;f<1&&this.makeStroke(u,h,r,n);f+=l)u+=i,h+=a;this.updateRender(),this._lastMouseX=e._mouseX,this._lastMouseY=e._mouseY}}},{key:"makeStroke",value:function(e,t,r,n){var i=this.getMesh();return this.updateDragDir(r,e,t),r.pickVerticesInSphere(r.getLocalRadius2()),r.computePickedNormal(),i.isDynamic&&this.stroke(r,!1),n&&(this.updateDragDir(n,e,t,!0),n.setLocalRadius2(r.getLocalRadius2()),n.pickVerticesInSphere(n.getLocalRadius2())),i.isDynamic||this.stroke(r,!1),n&&this.stroke(n,!0),!0}},{key:"stroke",value:function(e,t){var r=e.getPickedVertices();this._main.getStateManager().pushVertices(r),r=this.dynamicTopology(e),e.updateAlpha(this._lockPosition),e.setIdAlpha(this._idAlpha),this.drag(r,e.getIntersectionPoint(),e.getLocalRadius2(),t,e);var n=this.getMesh();n.updateGeometry(n.getFacesFromVertices(r),r)}},{key:"drag",value:function(e,t,r,n,i){for(var a=this.getMesh(),o=a.getVertices(),s=a.getMaterials(),l=Math.sqrt(r),u=t[0],c=t[1],h=t[2],f=n?this._dragDirSym:this._dragDir,d=f[0],p=f[1],_=f[2],g=0,m=e.length;g<m;++g){var v=3*e[g],y=o[v],b=o[v+1],A=o[v+2],T=y-u,S=b-c,w=A-h,M=Math.sqrt(T*T+S*S+w*w)/l,k=M*M;k=3*k*k-4*k*M+1,k*=s[v+2]*i.getAlpha(y,b,A),o[v]=y+d*k,o[v+1]=b+p*k,o[v+2]=A+_*k}}},{key:"updateDragDir",value:function(e,t,r,n){var i=this.getMesh(),a=e.unproject(t,r,0),o=e.unproject(t,r,.1),s=g.vt();g.B8(s,i.getMatrix()),c.Z0(a,a,s),c.Z0(o,o,s);var l=this._dragDir;if(n){l=this._dragDirSym;var u=i.getSymmetryOrigin(),h=i.getSymmetryNormal();Kt.A.mirrorPoint(a,u,h),Kt.A.mirrorPoint(o,u,h)}var f=e.getIntersectionPoint();e.setIntersectionPoint(Kt.A.vertexOnLine(f,a,o)),c.jb(l,e.getIntersectionPoint(),f),e._mesh=i,e.updateLocalAndWorldRadius2();var d=e.getEyeDirection();c.jb(d,o,a),c.S8(d,d)}}],r&&kr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(at);const Dr=Pr;function Or(e){return Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Or(e)}function Ir(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Fr(n.key),n)}}function Fr(e){var t=function(e){if("object"!=Or(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Or(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Or(t)?t:t+""}function Lr(){return Lr="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Br(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Lr.apply(null,arguments)}function Vr(e,t){return Vr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Vr(e,t)}function Nr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Nr=function(){return!!e})()}function Br(e){return Br=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Br(e)}var Ur=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Vr(e,t)}(i,e);var t,r,n=function(e){var t=Nr();return function(){var r,n=Br(e);if(t){var i=Br(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==Or(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this,e))._radius=50,t._hardness=.75,t._intensity=.75,t._culling=!1,t._color=c.fA(1,.766,.336),t._material=c.fA(.3,.95,0),t._pickColor=!1,t._pickCallback=null,t._idAlpha=0,t._lockPosition=!1,t._writeAlbedo=!0,t._writeRoughness=!0,t._writeMetalness=!0,t}return t=i,r=[{key:"end",value:function(){this._pickColor=!1,Lr(Br(i.prototype),"end",this).call(this)}},{key:"pushState",value:function(e){this._pickColor&&!e||this._main.getStateManager().pushStateColorAndMaterial(this.getMesh())}},{key:"startSculpt",value:function(){if(this._pickColor)return this.pickColor(this._main.getPicking());Lr(Br(i.prototype),"startSculpt",this).call(this)}},{key:"update",value:function(e){if(!0===this._pickColor)return this.updatePickColor();Lr(Br(i.prototype),"update",this).call(this,e)}},{key:"updateContinuous",value:function(){if(!0===this._pickColor)return this.updatePickColor();Lr(Br(i.prototype),"updateContinuous",this).call(this)}},{key:"updateMeshBuffers",value:function(){var e=this.getMesh();e.isDynamic?e.updateBuffers():(e.updateColorBuffer(),e.updateMaterialBuffer())}},{key:"updatePickColor",value:function(){var e=this._main.getPicking();e.intersectionMouseMesh()&&this.pickColor(e)}},{key:"setPickCallback",value:function(e){this._pickCallback=e}},{key:"pickColor",value:function(e){var t=this.getMesh(),r=this._color;e.polyLerp(t.getMaterials(),r);var n=r[0],i=r[1];e.polyLerp(t.getColors(),r),this._pickCallback(r,n,i)}},{key:"stroke",value:function(e){var t=e.getPickedVertices(),r=this._intensity*et.A.getPressureIntensity();this._main.getStateManager().pushVertices(t),t=this.dynamicTopology(e),this._culling&&(t=this.getFrontVertices(t,e.getEyeDirection())),e.updateAlpha(this._lockPosition),e.setIdAlpha(this._idAlpha),this.paint(t,e.getIntersectionPoint(),e.getLocalRadius2(),r,this._hardness,e);var n=this.getMesh();n.updateDuplicateColorsAndMaterials(t),n.isUsingDrawArrays()&&n.updateDrawArrays(n.getFacesFromVertices(t))}},{key:"paint",value:function(e,t,r,n,i,a){for(var o=this.getMesh(),s=o.getVertices(),l=o.getColors(),u=o.getMaterials(),c=this._color,h=this._material[0],f=this._material[1],d=Math.sqrt(r),p=c[0],_=c[1],g=c[2],m=t[0],v=t[1],y=t[2],b=2*(1-i),A=0,T=e.length;A<T;++A){var S=3*e[A],w=s[S],M=s[S+1],k=s[S+2],E=w-m,x=M-v,R=k-y,C=Math.sqrt(E*E+x*x+R*R)/d;C>1&&(C=1);var P=Math.pow(1-C,b),D=1-(P*=n*u[S+2]*a.getAlpha(w,M,k));this._writeAlbedo&&(l[S]=l[S]*D+p*P,l[S+1]=l[S+1]*D+_*P,l[S+2]=l[S+2]*D+g*P),this._writeRoughness&&(u[S]=u[S]*D+h*P),this._writeMetalness&&(u[S+1]=u[S+1]*D+f*P)}}},{key:"paintAll",value:function(){var e=this.getMesh(),t=this.getUnmaskedVertices();if(0!==t.length){this.pushState(!0),this._main.getStateManager().pushVertices(t);for(var r=e.getColors(),n=e.getMaterials(),i=this._color,a=this._material[0],o=this._material[1],s=i[0],l=i[1],u=i[2],c=0,h=t.length;c<h;++c){var f=3*t[c],d=n[f+2],p=1-d;this._writeAlbedo&&(r[f]=r[f]*p+s*d,r[f+1]=r[f+1]*p+l*d,r[f+2]=r[f+2]*p+u*d),this._writeRoughness&&(n[f]=n[f]*p+a*d),this._writeMetalness&&(n[f+1]=n[f+1]*p+o*d)}e.updateDuplicateColorsAndMaterials(),e.updateDrawArrays(),this.updateRender()}}}],r&&Ir(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(at);const jr=Ur;function Gr(e){return Gr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Gr(e)}function Wr(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,zr(n.key),n)}}function zr(e){var t=function(e){if("object"!=Gr(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Gr(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Gr(t)?t:t+""}function Xr(e,t){return Xr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Xr(e,t)}function Kr(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Kr=function(){return!!e})()}function Hr(e){return Hr=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Hr(e)}var Yr=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Xr(e,t)}(i,e);var t,r,n=function(e){var t=Kr();return function(){var r,n=Hr(e);if(t){var i=Hr(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==Gr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this,e))._radius=150,t._intensity=1,t._topoCheck=!0,t._negative=!1,t._moveData={center:[0,0,0],dir:[0,0],vProxy:null},t._moveDataSym={center:[0,0,0],dir:[0,0],vProxy:null},t._idAlpha=0,t}return t=i,r=[{key:"startSculpt",value:function(){var e=this._main,t=e.getPicking();if(this.initMoveData(t,this._moveData),e.getSculptManager().getSymmetry()){var r=e.getPickingSymmetry();r.intersectionMouseMesh(),r.setLocalRadius2(t.getLocalRadius2()),r.getMesh()&&this.initMoveData(r,this._moveDataSym)}}},{key:"initMoveData",value:function(e,t){this._topoCheck?e.pickVerticesInSphereTopological(e.getLocalRadius2()):e.pickVerticesInSphere(e.getLocalRadius2()),c.C(t.center,e.getIntersectionPoint());var r=e.getPickedVertices();this._main.getStateManager().pushVertices(r);for(var n=e.getMesh().getVertices(),i=r.length,a=t.vProxy=new Float32Array(3*i),o=0;o<i;++o){var s=3*r[o],l=3*o;a[l]=n[s],a[l+1]=n[s+1],a[l+2]=n[s+2]}}},{key:"copyVerticesProxy",value:function(e,t){for(var r=e.getPickedVertices(),n=this.getMesh().getVertices(),i=t.vProxy,a=0,o=r.length;a<o;++a){var s=3*r[a],l=3*a;n[s]=i[l],n[s+1]=i[l+1],n[s+2]=i[l+2]}}},{key:"sculptStroke",value:function(){var e=this._main,t=e.getPicking(),r=e.getPickingSymmetry(),n=e.getSculptManager().getSymmetry()&&r.getMesh();t.updateAlpha(this._lockPosition),t.setIdAlpha(this._idAlpha),n&&(r.updateAlpha(!1),r.setIdAlpha(this._idAlpha)),this.copyVerticesProxy(t,this._moveData),n&&this.copyVerticesProxy(r,this._moveDataSym);var i=e._mouseX,a=e._mouseY;this.updateMoveDir(t,i,a),this.move(t.getPickedVertices(),t.getIntersectionPoint(),t.getLocalRadius2(),this._moveData,t),n&&(this.updateMoveDir(r,i,a,!0),this.move(r.getPickedVertices(),r.getIntersectionPoint(),r.getLocalRadius2(),this._moveDataSym,r));var o=this.getMesh();o.updateGeometry(o.getFacesFromVertices(t.getPickedVertices()),t.getPickedVertices()),n&&o.updateGeometry(o.getFacesFromVertices(r.getPickedVertices()),r.getPickedVertices()),this.updateRender(),e.setCanvasCursor("default")}},{key:"move",value:function(e,t,r,n,i){for(var a=this.getMesh(),o=a.getVertices(),s=a.getMaterials(),l=Math.sqrt(r),u=n.vProxy,c=t[0],h=t[1],f=t[2],d=n.dir,p=d[0],_=d[1],g=d[2],m=0,v=e.length;m<v;++m){var y=3*e[m],b=3*m,A=u[b],T=u[b+1],S=u[b+2],w=A-c,M=T-h,k=S-f,E=Math.sqrt(w*w+M*M+k*k)/l,x=E*E;x=3*x*x-4*x*E+1,x*=s[y+2]*i.getAlpha(A,T,S),o[y]+=p*x,o[y+1]+=_*x,o[y+2]+=g*x}}},{key:"updateMoveDir",value:function(e,t,r,n){var i=this.getMesh(),a=e.unproject(t,r,0),o=e.unproject(t,r,.1),s=g.vt();g.B8(s,i.getMatrix()),c.Z0(a,a,s),c.Z0(o,o,s);var l=n?this._moveDataSym:this._moveData;if(n){var u=i.getSymmetryOrigin(),h=i.getSymmetryNormal();Kt.A.mirrorPoint(a,u,h),Kt.A.mirrorPoint(o,u,h)}if(this._negative){var f=c.xg(Kt.A.vertexOnLine(l.center,a,o),l.center);c.S8(l.dir,e.computePickedNormal()),c.hs(l.dir,l.dir,t<this._lastMouseX?-f:f)}else c.jb(l.dir,Kt.A.vertexOnLine(l.center,a,o),l.center);c.hs(l.dir,l.dir,this._intensity);var d=e.getEyeDirection();c.jb(d,o,a),c.S8(d,d)}}],r&&Wr(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(at);const qr=Yr,Zr=function(){return{_center:c.vt(),_matrix:g.vt(),_editMatrix:g.vt(),_symmetryNormal:[1,0,0],_symmetryOffset:0,_lastComputedMV:g.vt(),_lastComputedMVP:g.vt(),_lastComputedN:f(),_lastComputedEN:f(),_lastComputedDepth:0,_lastWorldBound:[1/0,1/0,1/0,-1/0,-1/0,-1/0]}};function Jr(e){return Jr="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jr(e)}function Qr(e,t){return Qr=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Qr(e,t)}function $r(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function en(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(en=function(){return!!e})()}function tn(e){return tn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},tn(e)}const rn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Qr(e,t)}(i,e);var t,r,n=(t=i,r=en(),function(){var e,n=tn(t);if(r){var i=tn(this).constructor;e=Reflect.construct(n,arguments,i)}else e=n.apply(this,arguments);return function(e,t){if(t&&("object"==Jr(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return $r(e)}(this,e)});function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this))._id=Se.ID++,e&&(t._renderData=new ve(e,$r(t))),t._meshData=new we,t._transformData=new Zr,t}return i}(Se);function nn(e){return nn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nn(e)}function an(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,on(n.key),n)}}function on(e){var t=function(e){if("object"!=nn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=nn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==nn(t)?t:t+""}function sn(e,t){return sn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},sn(e,t)}function ln(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ln=function(){return!!e})()}function un(e){return un=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},un(e)}var cn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&sn(e,t)}(a,e);var r,n,i=function(e){var t=ln();return function(){var r,n=un(e);if(t){var i=un(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==nn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(a);function a(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this,e))._radius=50,t._hardness=.25,t._intensity=1,t._negative=!0,t._culling=!1,t._idAlpha=0,t._lockPosition=!1,t._thickness=1,t}return r=a,n=[{key:"pushState",value:function(){this._main.getStateManager().pushStateColorAndMaterial(this.getMesh())}},{key:"updateMeshBuffers",value:function(){var e=this.getMesh();e.isDynamic?e.updateBuffers():e.updateMaterialBuffer()}},{key:"stroke",value:function(e){jr.prototype.stroke.call(this,e)}},{key:"dynamicTopology",value:function(e){return e.getPickedVertices()}},{key:"paint",value:function(e,t,r,n,i,a){for(var o=this.getMesh(),s=o.getVertices(),l=o.getMaterials(),u=Math.sqrt(r),c=t[0],h=t[1],f=t[2],d=2*(1-i),p=this._negative?-n:n,_=0,g=e.length;_<g;++_){var m=3*e[_],v=s[m],y=s[m+1],b=s[m+2],A=v-c,T=y-h,S=b-f,w=Math.sqrt(A*A+T*T+S*S)/u;w>1&&(w=1);var M=Math.pow(1-w,d);M*=p*a.getAlpha(v,y,b),l[m+2]=Math.min(Math.max(l[m+2]+M,0),1)}}},{key:"updateAndRenderMask",value:function(){var e=this.getMesh();e.updateDuplicateColorsAndMaterials(),e.updateDrawArrays(),this.updateRender()}},{key:"blur",value:function(){var e=this.getMesh(),t=this.getMaskedVertices();if(0!==t.length){t=e.expandsVertices(t,1),this.pushState(),this._main.getStateManager().pushVertices(t);var r=e.getMaterials(),n=t.length,i=new Float32Array(3*n);this.laplacianSmooth(t,i,r);for(var a=0;a<n;++a)r[3*t[a]+2]=i[3*a+2];this.updateAndRenderMask()}}},{key:"sharpen",value:function(){var e=this.getMesh(),t=this.getMaskedVertices();if(0!==t.length){this.pushState(),this._main.getStateManager().pushVertices(t);for(var r=e.getMaterials(),n=t.length,i=0;i<n;++i){var a=3*t[i]+2,o=r[a];r[a]=o>.5?Math.min(o+.1,1):Math.max(o-1,0)}this.updateAndRenderMask()}}},{key:"clear",value:function(){var e=this.getMesh(),t=this.getMaskedVertices();if(0!==t.length){this.pushState(),this._main.getStateManager().pushVertices(t);for(var r=e.getMaterials(),n=0,i=t.length;n<i;++n)r[3*t[n]+2]=1;this.updateAndRenderMask()}}},{key:"invert",value:function(e,t){var r=t;r||(r=this.getMesh()),e||this._main.getStateManager().pushStateCustom(this.invert.bind(this,!0,r));for(var n=r.getMaterials(),i=0,a=r.getNbVertices();i<a;++i)n[3*i+2]=1-n[3*i+2];this.updateAndRenderMask()}},{key:"remapAndMirrorIndices",value:function(e,r,n){var i=this.getMesh().getNbVertices(),a=new Uint32Array(t.A.getMemory(4*i),0,i),o=0,s=0,l=n.length;for(o=0;o<l;++o)a[n[o]]=o;var u=2*r;for(o=0;o<u;++o){var c=o<r?0:l;e[s=4*o]=a[e[s]]+c,e[s+1]=a[e[s+1]]+c,e[s+2]=a[e[s+2]]+c;var h=e[s+3];h!==t.A.TRI_INDEX&&(e[s+3]=a[h]+c)}var f=e.length/4;for(o=u;o<f;++o)e[s=4*o]=a[e[s]],e[s+1]=a[e[s+1]],e[s+2]=a[e[s+2]]+l,e[s+3]=a[e[s+3]]+l}},{key:"invertFaces",value:function(e){for(var t=0,r=e.length/4;t<r;++t){var n=4*t,i=e[n];e[n]=e[n+2],e[n+2]=i}}},{key:"extractFaces",value:function(e,r,n){for(var i=this.getMesh(),a=i.getFaces(),o=i.getMaterials(),s=i.getVerticesOnEdge(),l=0===this._thickness,u=e.length,c=new Uint32Array(t.A.getMemory(4*u*4*3),0,4*u*3),h=l?u:2*u,f=0;f<u;++f){var d=4*f,p=4*e[f],_=c[d]=a[p],g=c[d+1]=a[p+1],m=c[d+2]=a[p+2],v=c[d+3]=a[p+3];if(!l){var y=v!==t.A.TRI_INDEX,b=o[3*_+2]>=n||s[_]>=1,A=o[3*g+2]>=n||s[g]>=1,T=o[3*m+2]>=n||s[m]>=1,S=!!y&&(o[3*v+2]>=n||s[v]>=1);c[d+=4*u]=m,c[d+1]=g,c[d+2]=_,c[d+3]=v,A&&(b&&(c[d=4*h++]=c[d+3]=g,c[d+1]=c[d+2]=_),T&&(c[d=4*h++]=c[d+3]=m,c[d+1]=c[d+2]=g)),y?S&&(b&&(c[d=4*h++]=c[d+3]=_,c[d+1]=c[d+2]=v),T&&(c[d=4*h++]=c[d+3]=v,c[d+1]=c[d+2]=m)):b&&T&&(c[d=4*h++]=c[d+3]=_,c[d+1]=c[d+2]=m)}}var w=new Uint32Array(c.subarray(0,4*h));return this.remapAndMirrorIndices(w,u,r),this._thickness>0&&this.invertFaces(w),w}},{key:"extractVertices",value:function(e){var t=this.getMesh(),r=t.getVertices(),n=t.getNormals(),i=t.getMatrix(),a=_(f(),i),o=e.length,s=new Float32Array(2*o*3),l=[0,0,0],u=[0,0,0],h=3*o,d=this._thickness,p=.01;d<0&&(p=-p);for(var g=0;g<o;++g){var m=3*g,v=3*e[g];l[0]=r[v],l[1]=r[v+1],l[2]=r[v+2],u[0]=n[v],u[1]=n[v+1],u[2]=n[v+2],c.ei(u,u,a),c.S8(u,u),c.Z0(l,l,i),c.Ln(l,l,u,p),s[m]=l[0],s[m+1]=l[1],s[m+2]=l[2],c.Ln(l,l,u,d),s[m+=h]=l[0],s[m+1]=l[1],s[m+2]=l[2]}return s}},{key:"smoothBorder",value:function(e,t){for(var r=2*t.length,n=new Uint32Array(e.getNbFaces()-r),i=0,a=n.length;i<a;++i)n[i]=r+i;var o=e.expandsVertices(e.getVerticesFromFaces(n),1),s=new lr;s.setToolMesh(e),s.smooth(o,1),s.smooth(o,1),s.smooth(o,1)}},{key:"extract",value:function(){var e=this.getMesh(),t=this.filterMaskedVertices(-1/0,.5);if(0!==t.length){var r=e.getFacesFromVertices(t);t=e.getVerticesFromFaces(r);var n=this.extractFaces(r,t,.5),i=this.extractVertices(t),a=new rn(e.getGL());a.setVertices(i),a.setFaces(n),a.initColorsAndMaterials(),a.allocateArrays(),a.initTopology(),0!==this._thickness&&this.smoothBorder(a,r),a.updateGeometry(),a.updateDuplicateColorsAndMaterials(),a.copyRenderConfig(e),a.initRender();var o=this._main;o.addNewMesh(a),o.setMesh(e)}}}],n&&an(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(at);const hn=cn;function fn(e){return fn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fn(e)}function dn(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,pn(n.key),n)}}function pn(e){var t=function(e){if("object"!=fn(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=fn(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==fn(t)?t:t+""}function _n(e,t){return _n=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_n(e,t)}function gn(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(gn=function(){return!!e})()}function mn(e){return mn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},mn(e)}var vn=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_n(e,t)}(i,e);var t,r,n=function(e){var t=gn();return function(){var r,n=mn(e);if(t){var i=mn(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==fn(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this,e))._radius=50,t._culling=!1,t._idAlpha=0,t}return t=i,r=[{key:"startSculpt",value:function(){var e=this._main;if(e.getSculptManager().getSymmetry()){var t=e.getPickingSymmetry();t.intersectionMouseMesh(),t.setLocalRadius2(e.getPicking().getLocalRadius2())}}},{key:"sculptStroke",value:function(){var e=this._main,t=e._mouseX-e._lastMouseX,r=e.getPicking(),n=r.getLocalRadius2();if(r.pickVerticesInSphere(n),this.stroke(r,t),e.getSculptManager().getSymmetry()){var i=e.getPickingSymmetry();i.getMesh()&&(i.pickVerticesInSphere(n),this.stroke(i,t))}this.updateRender()}},{key:"stroke",value:function(e,t){var r=e.getPickedVertices();this._main.getStateManager().pushVertices(r),r=this.dynamicTopology(e),this._culling&&(r=this.getFrontVertices(r,e.getEyeDirection())),e.updateAlpha(!1),e.setIdAlpha(this._idAlpha),this.scale(r,e.getIntersectionPoint(),e.getLocalRadius2(),t,e);var n=this.getMesh();n.updateGeometry(n.getFacesFromVertices(r),r)}},{key:"scale",value:function(e,t,r,n,i){for(var a=this.getMesh(),o=a.getVertices(),s=a.getMaterials(),l=.01*n,u=Math.sqrt(r),c=t[0],h=t[1],f=t[2],d=0,p=e.length;d<p;++d){var _=3*e[d],g=o[_],m=o[_+1],v=o[_+2],y=g-c,b=m-h,A=v-f,T=Math.sqrt(y*y+b*b+A*A)/u,S=T*T;S=3*S*S-4*S*T+1,S*=l*s[_+2]*i.getAlpha(g,m,v),o[_]=g+y*S,o[_+1]=m+b*S,o[_+2]=v+A*S}}}],r&&dn(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(at);const yn=vn;var bn=function(e,t){this.previous=null,this.next=null,this.v1=e,this.v2=t},An=function(e){if(!(e.length<=2)){var t=e.length,r=e[0].v1,n=e[0].v2,i=e[0],a=i;e[0]=e[--t];for(var o=0;o<t;){var s=e[o];if(s.v1===n){if(s.previous=a,a.next=s,a=s,n=e[o].v2,e[o]=e[--t],n===r)break;o=0}else o++}if(e.length=t,n===r)return i.previous=a,a.next=i,i}},Tn=function(e,r,n,i,a,o){var s=e.getVertices(),l=e.getColors(),u=e.getMaterials(),c=e.getNbVertices()+i.length/3,h=r,f=0,d=0,p=0,_=0,g=0,m=0,v=0,y=0,b=0,A=0;do{var T=h.next,S=h.v1,w=h.v2,M=T.v2;n.push(S,w,c,t.A.TRI_INDEX),w*=3,M*=3,A++,f+=s[S*=3],d+=s[S+1],p+=s[S+2],_+=l[S],g+=l[S+1],m+=l[S+2],v+=u[S],y+=u[S+1],b+=u[S+2];var k=s[w],E=s[w+1],x=s[w+2],R=s[S]-k,C=s[S+1]-E,P=s[S+2]-x,D=s[M]-k,O=s[M+1]-E,I=s[M+2]-x,F=R*R+C*C+P*P,L=D*D+O*O+I*I;h.angle=Math.acos((R*D+C*O+P*I)/Math.sqrt(F*L)),h=T}while(h!==r);i.push(f/A,d/A,p/A),a.push(_/A,g/A,m/A),o.push(v/A,y/A,b/A)},Sn=function(e,t,r,n,i){var a=new rn;return a.setID(e.getID()),a.setVertices(t),n&&a.setColors(n),i&&a.setMaterials(i),a.setFaces(r),a.setTransformData(e.getTransformData()),a.setRenderData(e.getRenderData()),Se.OPTIMIZE=!1,a.init(),Se.OPTIMIZE=!0,a},wn={createClosedMesh:function(e){var r=function(e){var r=function(e){for(var r=e.getEdges(),n=e.getFaces(),i=e.getFaceEdges(),a=[],o=0,s=e.getNbFaces();o<s;++o){var l=4*o,u=i[l+3],c=u!==t.A.TRI_INDEX;1===r[i[l]]&&a.push(new bn(n[l],n[l+1])),1===r[i[l+1]]&&a.push(new bn(n[l+1],n[l+2])),1===r[i[l+2]]&&a.push(new bn(n[l+2],n[c?l+3:l])),c&&1===r[u]&&a.push(new bn(n[l+3],n[l]))}for(var h=[];;){var f=An(a);if(!f)break;h.push(f)}return h}(e);if(0===r.length)return e;for(var n=[],i=[],a=[],o=[],s=0,l=r.length;s<l;++s)Tn(e,r[s],n,i,a,o);var u=3*e.getNbVertices(),c=u+i.length,h=new Float32Array(c);h.set(e.getVertices().subarray(0,u));var f=new Float32Array(c);f.set(e.getColors().subarray(0,u));var d=new Float32Array(c);d.set(e.getMaterials().subarray(0,u)),c>u&&(h.set(i,u),f.set(a,u),d.set(o,u));var p=new Uint32Array(4*e.getNbFaces()+n.length);return p.set(e.getFaces()),n.length>0&&p.set(n,4*e.getNbFaces()),Sn(e,h,p,f,d)}(e);if(r===e){var n=3*e.getNbVertices(),i=4*e.getNbFaces(),a=new Uint32Array(e.getFaces().subarray(0,i)),o=new Float32Array(e.getVertices().subarray(0,n)),s=new Float32Array(e.getColors().subarray(0,n)),l=new Float32Array(e.getMaterials().subarray(0,n));r=Sn(e,o,a,s,l)}return r}};const Mn=wn;var kn={BLOCK:!1},En=function(){for(var e=new Uint32Array(24),t=0,r=0;r<8;++r)for(var n=1;n<=4;n<<=1){var i=r^n;r<=i&&(e[t++]=r,e[t++]=i)}return e}(),xn=function(e){for(var t=new Uint32Array(256),r=0;r<256;++r){for(var n=0,i=0;i<24;i+=2)n|=!!(r&1<<e[i])!=!!(r&1<<e[i+1])?1<<(i>>1):0;t[r]=n}return t}(En),Rn=function(e,t,r,n,i,a){for(var o=e.colorField,s=e.materialField,l=e.distanceField,u=0,c=0,h=0,f=0,d=0,p=0,_=0,g=0,m=0,v=r[0],y=r[0]*r[1],b=0;b<2;++b)for(var A=0;A<2;++A)for(var T=0;T<2;++T){var S=n+T+A*v+b*y,w=3*S,M=l[S];t[m]=M,g|=M<0?1<<m:0,m++,M!==1/0&&(_+=M=Math.min(1/Math.abs(M),1e15),u+=o[w]*M,c+=o[w+1]*M,h+=o[w+2]*M,f+=s[w]*M,d+=s[w+1]*M,p+=s[w+2]*M)}return 0!==g&&255!==g&&(_>0&&(_=1/_),i.push(u*_,c*_,h*_),a.push(f*_,d*_,p*_)),g},Cn=[0,0,0],Pn=function(e,t,r,n,i){Cn[0]=Cn[1]=Cn[2]=0;for(var a=0,o=0;o<12;++o)if(e&1<<o&&(++a,!kn.BLOCK)){var s=t[o<<1],l=t[1+(o<<1)],u=r[s],c=u-r[l];if(!(Math.abs(c)<1e-7)){c=u/c;for(var h=0,f=1;h<3;++h,f<<=1){var d=s&f;Cn[h]+=d!==(l&f)?d?1-c:c:d?1:0}}}for(var p=1/a,_=0;_<3;++_)Cn[_]=n[_]+p*Cn[_];i.push(Cn[0],Cn[1],Cn[2])},Dn=function(e,t,r,n,i,a,o){for(var s=0;s<3;++s)if(e&1<<s){var l=(s+1)%3,u=(s+2)%3;if(0!==a[l]&&0!==a[u]){var c=n[l],h=n[u];1&t?o.push(r[i],r[i-c],r[i-c-h],r[i-h]):o.push(r[i],r[i-h],r[i-c-h],r[i-c])}}};kn.computeSurface=function(e){var t=e.dims,r=[],n=[],i=[],a=[],o=0,s=new Int32Array(3),l=new Int32Array([1,t[0]+1,(t[0]+1)*(t[1]+1)]),u=new Float32Array(8),c=1,h=new Int32Array(2*l[2]);for(s[2]=0;s[2]<t[2]-1;++s[2],o+=t[0],c^=1,l[2]=-l[2]){var f=1+(t[0]+1)*(1+c*(t[1]+1));for(s[1]=0;s[1]<t[1]-1;++s[1],++o,f+=2)for(s[0]=0;s[0]<t[0]-1;++s[0],++o,++f){var d=Rn(e,u,t,o,n,i);if(0!==d&&255!==d){var p=xn[d];h[f]=r.length/3,Pn(p,En,u,s,r),Dn(p,d,h,l,f,s,a)}}}return{colors:new Float32Array(n),materials:new Float32Array(i),vertices:new Float32Array(r),faces:new Uint32Array(a)}};const On=kn;var In={BLOCK:!1},Fn=new Uint32Array([0,265,515,778,1030,1295,1541,1804,2060,2309,2575,2822,3082,3331,3593,3840,400,153,915,666,1430,1183,1941,1692,2460,2197,2975,2710,3482,3219,3993,3728,560,825,51,314,1590,1855,1077,1340,2620,2869,2111,2358,3642,3891,3129,3376,928,681,419,170,1958,1711,1445,1196,2988,2725,2479,2214,4010,3747,3497,3232,1120,1385,1635,1898,102,367,613,876,3180,3429,3695,3942,2154,2403,2665,2912,1520,1273,2035,1786,502,255,1013,764,3580,3317,4095,3830,2554,2291,3065,2800,1616,1881,1107,1370,598,863,85,348,3676,3925,3167,3414,2650,2899,2137,2384,1984,1737,1475,1226,966,719,453,204,4044,3781,3535,3270,3018,2755,2505,2240,2240,2505,2755,3018,3270,3535,3781,4044,204,453,719,966,1226,1475,1737,1984,2384,2137,2899,2650,3414,3167,3925,3676,348,85,863,598,1370,1107,1881,1616,2800,3065,2291,2554,3830,4095,3317,3580,764,1013,255,502,1786,2035,1273,1520,2912,2665,2403,2154,3942,3695,3429,3180,876,613,367,102,1898,1635,1385,1120,3232,3497,3747,4010,2214,2479,2725,2988,1196,1445,1711,1958,170,419,681,928,3376,3129,3891,3642,2358,2111,2869,2620,1340,1077,1855,1590,314,51,825,560,3728,3993,3219,3482,2710,2975,2197,2460,1692,1941,1183,1430,666,915,153,400,3840,3593,3331,3082,2822,2575,2309,2060,1804,1541,1295,1030,778,515,265,0]),Ln=[[],[0,8,3],[0,1,9],[1,8,3,9,8,1],[1,2,10],[0,8,3,1,2,10],[9,2,10,0,2,9],[2,8,3,2,10,8,10,9,8],[3,11,2],[0,11,2,8,11,0],[1,9,0,2,3,11],[1,11,2,1,9,11,9,8,11],[3,10,1,11,10,3],[0,10,1,0,8,10,8,11,10],[3,9,0,3,11,9,11,10,9],[9,8,10,10,8,11],[4,7,8],[4,3,0,7,3,4],[0,1,9,8,4,7],[4,1,9,4,7,1,7,3,1],[1,2,10,8,4,7],[3,4,7,3,0,4,1,2,10],[9,2,10,9,0,2,8,4,7],[2,10,9,2,9,7,2,7,3,7,9,4],[8,4,7,3,11,2],[11,4,7,11,2,4,2,0,4],[9,0,1,8,4,7,2,3,11],[4,7,11,9,4,11,9,11,2,9,2,1],[3,10,1,3,11,10,7,8,4],[1,11,10,1,4,11,1,0,4,7,11,4],[4,7,8,9,0,11,9,11,10,11,0,3],[4,7,11,4,11,9,9,11,10],[9,5,4],[9,5,4,0,8,3],[0,5,4,1,5,0],[8,5,4,8,3,5,3,1,5],[1,2,10,9,5,4],[3,0,8,1,2,10,4,9,5],[5,2,10,5,4,2,4,0,2],[2,10,5,3,2,5,3,5,4,3,4,8],[9,5,4,2,3,11],[0,11,2,0,8,11,4,9,5],[0,5,4,0,1,5,2,3,11],[2,1,5,2,5,8,2,8,11,4,8,5],[10,3,11,10,1,3,9,5,4],[4,9,5,0,8,1,8,10,1,8,11,10],[5,4,0,5,0,11,5,11,10,11,0,3],[5,4,8,5,8,10,10,8,11],[9,7,8,5,7,9],[9,3,0,9,5,3,5,7,3],[0,7,8,0,1,7,1,5,7],[1,5,3,3,5,7],[9,7,8,9,5,7,10,1,2],[10,1,2,9,5,0,5,3,0,5,7,3],[8,0,2,8,2,5,8,5,7,10,5,2],[2,10,5,2,5,3,3,5,7],[7,9,5,7,8,9,3,11,2],[9,5,7,9,7,2,9,2,0,2,7,11],[2,3,11,0,1,8,1,7,8,1,5,7],[11,2,1,11,1,7,7,1,5],[9,5,8,8,5,7,10,1,3,10,3,11],[5,7,0,5,0,9,7,11,0,1,0,10,11,10,0],[11,10,0,11,0,3,10,5,0,8,0,7,5,7,0],[11,10,5,7,11,5],[10,6,5],[0,8,3,5,10,6],[9,0,1,5,10,6],[1,8,3,1,9,8,5,10,6],[1,6,5,2,6,1],[1,6,5,1,2,6,3,0,8],[9,6,5,9,0,6,0,2,6],[5,9,8,5,8,2,5,2,6,3,2,8],[2,3,11,10,6,5],[11,0,8,11,2,0,10,6,5],[0,1,9,2,3,11,5,10,6],[5,10,6,1,9,2,9,11,2,9,8,11],[6,3,11,6,5,3,5,1,3],[0,8,11,0,11,5,0,5,1,5,11,6],[3,11,6,0,3,6,0,6,5,0,5,9],[6,5,9,6,9,11,11,9,8],[5,10,6,4,7,8],[4,3,0,4,7,3,6,5,10],[1,9,0,5,10,6,8,4,7],[10,6,5,1,9,7,1,7,3,7,9,4],[6,1,2,6,5,1,4,7,8],[1,2,5,5,2,6,3,0,4,3,4,7],[8,4,7,9,0,5,0,6,5,0,2,6],[7,3,9,7,9,4,3,2,9,5,9,6,2,6,9],[3,11,2,7,8,4,10,6,5],[5,10,6,4,7,2,4,2,0,2,7,11],[0,1,9,4,7,8,2,3,11,5,10,6],[9,2,1,9,11,2,9,4,11,7,11,4,5,10,6],[8,4,7,3,11,5,3,5,1,5,11,6],[5,1,11,5,11,6,1,0,11,7,11,4,0,4,11],[0,5,9,0,6,5,0,3,6,11,6,3,8,4,7],[6,5,9,6,9,11,4,7,9,7,11,9],[10,4,9,6,4,10],[4,10,6,4,9,10,0,8,3],[10,0,1,10,6,0,6,4,0],[8,3,1,8,1,6,8,6,4,6,1,10],[1,4,9,1,2,4,2,6,4],[3,0,8,1,2,9,2,4,9,2,6,4],[0,2,4,4,2,6],[8,3,2,8,2,4,4,2,6],[10,4,9,10,6,4,11,2,3],[0,8,2,2,8,11,4,9,10,4,10,6],[3,11,2,0,1,6,0,6,4,6,1,10],[6,4,1,6,1,10,4,8,1,2,1,11,8,11,1],[9,6,4,9,3,6,9,1,3,11,6,3],[8,11,1,8,1,0,11,6,1,9,1,4,6,4,1],[3,11,6,3,6,0,0,6,4],[6,4,8,11,6,8],[7,10,6,7,8,10,8,9,10],[0,7,3,0,10,7,0,9,10,6,7,10],[10,6,7,1,10,7,1,7,8,1,8,0],[10,6,7,10,7,1,1,7,3],[1,2,6,1,6,8,1,8,9,8,6,7],[2,6,9,2,9,1,6,7,9,0,9,3,7,3,9],[7,8,0,7,0,6,6,0,2],[7,3,2,6,7,2],[2,3,11,10,6,8,10,8,9,8,6,7],[2,0,7,2,7,11,0,9,7,6,7,10,9,10,7],[1,8,0,1,7,8,1,10,7,6,7,10,2,3,11],[11,2,1,11,1,7,10,6,1,6,7,1],[8,9,6,8,6,7,9,1,6,11,6,3,1,3,6],[0,9,1,11,6,7],[7,8,0,7,0,6,3,11,0,11,6,0],[7,11,6],[7,6,11],[3,0,8,11,7,6],[0,1,9,11,7,6],[8,1,9,8,3,1,11,7,6],[10,1,2,6,11,7],[1,2,10,3,0,8,6,11,7],[2,9,0,2,10,9,6,11,7],[6,11,7,2,10,3,10,8,3,10,9,8],[7,2,3,6,2,7],[7,0,8,7,6,0,6,2,0],[2,7,6,2,3,7,0,1,9],[1,6,2,1,8,6,1,9,8,8,7,6],[10,7,6,10,1,7,1,3,7],[10,7,6,1,7,10,1,8,7,1,0,8],[0,3,7,0,7,10,0,10,9,6,10,7],[7,6,10,7,10,8,8,10,9],[6,8,4,11,8,6],[3,6,11,3,0,6,0,4,6],[8,6,11,8,4,6,9,0,1],[9,4,6,9,6,3,9,3,1,11,3,6],[6,8,4,6,11,8,2,10,1],[1,2,10,3,0,11,0,6,11,0,4,6],[4,11,8,4,6,11,0,2,9,2,10,9],[10,9,3,10,3,2,9,4,3,11,3,6,4,6,3],[8,2,3,8,4,2,4,6,2],[0,4,2,4,6,2],[1,9,0,2,3,4,2,4,6,4,3,8],[1,9,4,1,4,2,2,4,6],[8,1,3,8,6,1,8,4,6,6,10,1],[10,1,0,10,0,6,6,0,4],[4,6,3,4,3,8,6,10,3,0,3,9,10,9,3],[10,9,4,6,10,4],[4,9,5,7,6,11],[0,8,3,4,9,5,11,7,6],[5,0,1,5,4,0,7,6,11],[11,7,6,8,3,4,3,5,4,3,1,5],[9,5,4,10,1,2,7,6,11],[6,11,7,1,2,10,0,8,3,4,9,5],[7,6,11,5,4,10,4,2,10,4,0,2],[3,4,8,3,5,4,3,2,5,10,5,2,11,7,6],[7,2,3,7,6,2,5,4,9],[9,5,4,0,8,6,0,6,2,6,8,7],[3,6,2,3,7,6,1,5,0,5,4,0],[6,2,8,6,8,7,2,1,8,4,8,5,1,5,8],[9,5,4,10,1,6,1,7,6,1,3,7],[1,6,10,1,7,6,1,0,7,8,7,0,9,5,4],[4,0,10,4,10,5,0,3,10,6,10,7,3,7,10],[7,6,10,7,10,8,5,4,10,4,8,10],[6,9,5,6,11,9,11,8,9],[3,6,11,0,6,3,0,5,6,0,9,5],[0,11,8,0,5,11,0,1,5,5,6,11],[6,11,3,6,3,5,5,3,1],[1,2,10,9,5,11,9,11,8,11,5,6],[0,11,3,0,6,11,0,9,6,5,6,9,1,2,10],[11,8,5,11,5,6,8,0,5,10,5,2,0,2,5],[6,11,3,6,3,5,2,10,3,10,5,3],[5,8,9,5,2,8,5,6,2,3,8,2],[9,5,6,9,6,0,0,6,2],[1,5,8,1,8,0,5,6,8,3,8,2,6,2,8],[1,5,6,2,1,6],[1,3,6,1,6,10,3,8,6,5,6,9,8,9,6],[10,1,0,10,0,6,9,5,0,5,6,0],[0,3,8,5,6,10],[10,5,6],[11,5,10,7,5,11],[11,5,10,11,7,5,8,3,0],[5,11,7,5,10,11,1,9,0],[10,7,5,10,11,7,9,8,1,8,3,1],[11,1,2,11,7,1,7,5,1],[0,8,3,1,2,7,1,7,5,7,2,11],[9,7,5,9,2,7,9,0,2,2,11,7],[7,5,2,7,2,11,5,9,2,3,2,8,9,8,2],[2,5,10,2,3,5,3,7,5],[8,2,0,8,5,2,8,7,5,10,2,5],[9,0,1,5,10,3,5,3,7,3,10,2],[9,8,2,9,2,1,8,7,2,10,2,5,7,5,2],[1,3,5,3,7,5],[0,8,7,0,7,1,1,7,5],[9,0,3,9,3,5,5,3,7],[9,8,7,5,9,7],[5,8,4,5,10,8,10,11,8],[5,0,4,5,11,0,5,10,11,11,3,0],[0,1,9,8,4,10,8,10,11,10,4,5],[10,11,4,10,4,5,11,3,4,9,4,1,3,1,4],[2,5,1,2,8,5,2,11,8,4,5,8],[0,4,11,0,11,3,4,5,11,2,11,1,5,1,11],[0,2,5,0,5,9,2,11,5,4,5,8,11,8,5],[9,4,5,2,11,3],[2,5,10,3,5,2,3,4,5,3,8,4],[5,10,2,5,2,4,4,2,0],[3,10,2,3,5,10,3,8,5,4,5,8,0,1,9],[5,10,2,5,2,4,1,9,2,9,4,2],[8,4,5,8,5,3,3,5,1],[0,4,5,1,0,5],[8,4,5,8,5,3,9,0,5,0,3,5],[9,4,5],[4,11,7,4,9,11,9,10,11],[0,8,3,4,9,7,9,11,7,9,10,11],[1,10,11,1,11,4,1,4,0,7,4,11],[3,1,4,3,4,8,1,10,4,7,4,11,10,11,4],[4,11,7,9,11,4,9,2,11,9,1,2],[9,7,4,9,11,7,9,1,11,2,11,1,0,8,3],[11,7,4,11,4,2,2,4,0],[11,7,4,11,4,2,8,3,4,3,2,4],[2,9,10,2,7,9,2,3,7,7,4,9],[9,10,7,9,7,4,10,2,7,8,7,0,2,0,7],[3,7,10,3,10,2,7,4,10,1,10,0,4,0,10],[1,10,2,8,7,4],[4,9,1,4,1,7,7,1,3],[4,9,1,4,1,7,0,8,1,8,7,1],[4,0,3,7,4,3],[4,8,7],[9,10,8,10,11,8],[3,0,9,3,9,11,11,9,10],[0,1,10,0,10,8,8,10,11],[3,1,10,11,3,10],[1,2,11,1,11,9,9,11,8],[3,0,9,3,9,11,1,2,9,2,11,9],[0,2,11,8,0,11],[3,2,11],[2,3,8,2,8,10,10,8,9],[9,10,2,0,9,2],[2,3,8,2,8,10,0,1,8,1,10,8],[1,10,2],[1,3,8,9,1,8],[0,9,1],[0,3,8],[]],Vn=[[0,0,0],[1,0,0],[1,1,0],[0,1,0],[0,0,1],[1,0,1],[1,1,1],[0,1,1]],Nn=[[0,1],[1,2],[2,3],[3,0],[4,5],[5,6],[6,7],[7,4],[0,4],[1,5],[2,6],[3,7]],Bn=function(e,t,r,n,i,a){for(var o=e.colorField,s=e.materialField,l=e.distanceField,u=0,c=0,h=0,f=0,d=0,p=0,_=0,g=0,m=r[0],v=r[0]*r[1],y=0;y<8;++y){var b=Vn[y],A=n+b[0]+b[1]*m+b[2]*v,T=3*A,S=l[A];t[y]=S,g|=S>0?1<<y:0,S!==1/0&&(_+=S=Math.min(1/Math.abs(S),1e15),u+=o[T]*S,c+=o[T+1]*S,h+=o[T+2]*S,f+=s[T]*S,d+=s[T+1]*S,p+=s[T+2]*S)}return 0!==Fn[g]&&(_>0&&(_=1/_),i[0]=u*_,i[1]=c*_,i[2]=h*_,a[0]=f*_,a[1]=d*_,a[2]=p*_),g};In.computeSurface=function(e){var r=e.dims,n=new Map,i=[],a=[],o=[],s=[],l=0,u=new Int32Array(3),c=new Float32Array(8),h=new Array(12),f=new Float32Array(3),d=new Float32Array(3),p=new Float32Array(3);for(u[2]=0;u[2]<r[2]-1;++u[2],l+=r[0])for(u[1]=0;u[1]<r[1]-1;++u[1],++l)for(u[0]=0;u[0]<r[0]-1;++u[0],++l){var _=Bn(e,c,r,l,d,p),g=Fn[_];if(0!==g){for(var m=0;m<12;++m)if(g&1<<m){var v=Nn[m],y=Vn[v[0]],b=Vn[v[1]],A=c[v[0]],T=A-c[v[1]],S=0;Math.abs(T)>1e-6&&(S=A/T);for(var w=0;w<3;++w)f[w]=u[w]+y[w]+S*(b[w]-y[w]);var M=f[0]+"+"+f[1]+"+"+f[2],k=n.get(M);k>=0?h[m]=k:(h[m]=i.length/3,n.set(M,h[m]),i.push(f[0],f[1],f[2]),a.push(d[0],d[1],d[2]),o.push(p[0],p[1],p[2]))}for(var E=Ln[_],x=0;x<E.length;x+=3)s.push(h[E[x]],h[E[x+1]],h[E[x+2]],t.A.TRI_INDEX)}}return{colors:new Float32Array(a),materials:new Float32Array(o),vertices:new Float32Array(i),faces:new Uint32Array(s)}};const Un=In;var jn={RESOLUTION:150,BLOCK:!1,SMOOTHING:!0},Gn=function(e,t){for(var r=t.min,n=t.step,i=t.dims,a=1/n,o=r[0],s=r[1],l=r[2],u=i[0],c=u*i[1],h=t.distanceField,f=t.crossedEdges,d=t.colorField,p=t.materialField,_=e.getTriangles(),g=e.getVertices(),m=e.getColors(),v=e.getMaterials(),y=e.getNbTriangles(),b=[0,0,0],A=[0,0,0],T=[0,0,0],S=[0,0,0],w=[0,0,0],M=[0,0,0],k=[0,0,0,0],E=[[1,0,0],[0,1,0],[0,0,1]],x=1/3,R=0;R<y;++R)for(var C=3*R,P=3*_[C],D=3*_[C+1],O=3*_[C+2],I=b[0]=g[P],F=b[1]=g[P+1],L=b[2]=g[P+2],V=A[0]=g[D],N=A[1]=g[D+1],B=A[2]=g[D+2],U=T[0]=g[O],j=T[1]=g[O+1],G=T[2]=g[O+2],W=(m[P]+m[D]+m[O])*x,z=(m[P+1]+m[D+1]+m[O+1])*x,X=(m[P+2]+m[D+2]+m[O+2])*x,K=(v[P]+v[D]+v[O])*x,H=(v[P+1]+v[D+1]+v[O+1])*x,Y=(v[P+2]+v[D+2]+v[O+2])*x,q=I<V?I<U?I:U:V<U?V:U,Z=I>V?I>U?I:U:V>U?V:U,J=F<N?F<j?F:j:N<j?N:j,Q=F>N?F>j?F:j:N>j?N:j,$=L<B?L<G?L:G:B<G?B:G,ee=L>B?L>G?L:G:B>G?B:G,te=S[0]=V-I,re=S[1]=N-F,ne=S[2]=B-L,ie=w[0]=U-I,ae=w[1]=j-F,oe=w[2]=G-L,se=te*te+re*re+ne*ne,le=te*ie+re*ae+ne*oe,ue=ie*ie+ae*ae+oe*oe,ce=Math.floor((q-o)*a),he=Math.floor((J-s)*a),fe=Math.floor(($-l)*a),de=Math.ceil((Z-o)*a),pe=Math.ceil((Q-s)*a),_e=Math.ceil((ee-l)*a),ge=fe;ge<=_e;++ge)for(var me=he;me<=pe;++me)for(var ve=ce;ve<=de;++ve){var ye=o+ve*n,be=s+me*n,Ae=l+ge*n,Te=ve+me*u+ge*c;M[0]=ye,M[1]=be,M[2]=Ae;var Se=Kt.A.distance2PointTriangleEdges(M,S,w,b,se,le,ue,k);if((Se=Math.sqrt(Se))<h[Te]){h[Te]=Se;var we=3*Te;d[we]=W,d[we+1]=z,d[we+2]=X,p[we]=K,p[we+1]=H,p[we+2]=Y}if(!(Se>n))for(var Me=0;Me<3;++Me){var ke=k[Me]-M[Me];if(!(ke<0||ke>n)){var Ee=3*Te+Me;if(1!==f[Ee]){var xe=Kt.A.intersectionRayTriangleEdges(M,E[Me],S,w,b);xe<0||xe>n||(f[Ee]=1)}}}}},Wn=function(e,t,r,n,i){var a=new rn(e.getGL());return a.setID(e.getID()),a.setFaces(t),a.setVertices(r),n&&a.setColors(n),i&&a.setMaterials(i),a.setRenderData(e.getRenderData()),a.init(),a.initRender(),a};jn.remesh=function(r,n,i){console.time("remesh total"),console.time("1. prepareMeshes");var a=function(t){for(var r=[1/0,1/0,1/0,-1/0,-1/0,-1/0],n=[0,0,0],i=0,a=t.length;i<a;++i){var o=t[i];o.isUsingTexCoords()&&o.setShaderType(e.A.Shader.MATCAP);for(var s=o.getMatrix(),l=(o=t[i]=Mn.createClosedMesh(o)).getVertices(),u=0,h=o.getNbVertices();u<h;++u){var f=3*u;n[0]=l[f],n[1]=l[f+1],n[2]=l[f+2],c.Z0(n,n,s);var d=l[f]=n[0],p=l[f+1]=n[1],_=l[f+2]=n[2];d<r[0]&&(r[0]=d),p<r[1]&&(r[1]=p),_<r[2]&&(r[2]=_),d>r[3]&&(r[3]=d),p>r[4]&&(r[4]=p),_>r[5]&&(r[5]=_)}}return r}(r=r.slice());console.timeEnd("1. prepareMeshes"),console.time("2. voxelization");for(var o,s=function(e){for(var r=Math.max(e[3]-e[0],e[4]-e[1],e[5]-e[2])/jn.RESOLUTION,n=1.51*r,i=1.51*r,a=[e[0]-n,e[1]-n,e[2]-n],o=[e[3]+i,e[4]+i,e[5]+i],s=Math.ceil((o[0]-a[0])/r),l=Math.ceil((o[1]-a[1])/r),u=Math.ceil((o[2]-a[2])/r),c=s*l*u,h=t.A.getMemory(31*c),f=new Float32Array(h,0,c),d=new Float32Array(h,4*c,3*c),p=new Float32Array(h,16*c,3*c),_=new Uint8Array(h,28*c,3*c),g=0;g<c;++g)f[g]=1/0;for(var m=0,v=3*c;m<v;++m)_[m]=0;for(var y=0,b=3*c;y<b;++y)d[y]=p[y]=-1;var A={};return A.dims=[s,l,u],A.step=r,A.min=a,A.max=o,A.crossedEdges=_,A.distanceField=f,A.colorField=d,A.materialField=p,A}(a),l=0,u=r.length;l<u;++l)Gn(r[l],s);console.timeEnd("2. voxelization"),console.time("3. flood"),function(e){var t=e.step,r=e.dims,n=r[0],i=n*r[1],a=e.crossedEdges,o=e.distanceField,s=o.length,l=new Uint8Array(s),u=new Int32Array(s);u[0]=0;for(var c=1,h=[-1,1,-n,n,-i,i],f=[0,0,1,1,2,2],d=h.length,p=0,_=0;c>0;){var g=u[--c];if(o[g]<t)for(p=0;p<d;++p){var m=h[p];(_=g+m)>=s||_<0||1!==l[_]&&o[_]!==1/0&&0===a[3*(m>=0?g:_)+f[p]]&&(l[_]=1,u[c++]=_)}else for(p=0;p<d;++p)(_=g+h[p])>=s||_<0||1!==l[_]&&(l[_]=1,u[c++]=_)}for(var v=0;v<s;++v)0===o[v]&&console.log("hit"),0===l[v]&&(o[v]=-o[v])}(s),console.timeEnd("3. flood"),i?(console.time("4. marchingCubes"),Un.BLOCK=jn.BLOCK,o=Un.computeSurface(s),console.timeEnd("4. marchingCubes")):(console.time("4. surfaceNets"),On.BLOCK=jn.BLOCK,o=On.computeSurface(s),console.timeEnd("4. surfaceNets")),console.time("5. createMesh");var h=Wn(n,o.faces,o.vertices,o.colors,o.materials);return console.timeEnd("5. createMesh"),function(e,t){var r=[t[0],t[1],t[2]],n=[t[3],t[4],t[5]],i=c.xg(r,n),a=c.WQ([],r,n);c.hs(a,a,.5);var o=e.getLocalBound(),s=[o[0],o[1],o[2]],l=[o[3],o[4],o[5]],u=c.xg(s,l),h=c.WQ([],s,l);c.hs(h,h,.5);var f=i/u,d=c.hs([],a,1/f);c.jb(d,d,h);var p=e.getMatrix();g.D_(p),g.hs(p,p,[f,f,f]),g.Tl(p,p,d)}(h,a),i&&jn.SMOOTHING&&(console.time("6. tangential smoothing"),function(e){for(var t=e.getNbVertices(),r=new Uint32Array(t),n=0;n<t;++n)r[n]=n;var i=new lr;i.setToolMesh(e),i.smoothTangent(r,1),e.updateGeometry(),e.updateGeometryBuffers()}(h),console.timeEnd("6. tangential smoothing")),console.timeEnd("remesh total"),console.log("\n"),h},jn.mergeArrays=function(e,r){var n,i,a=0,o=0,s=0,l=0,u=e.length,h=0;for(n=0;n<u;++n)a+=e[n].getNbVertices(),o+=e[n].getNbFaces(),s+=e[n].getNbQuads(),l+=e[n].getNbTriangles();r.nbVertices=a,r.nbFaces=o,r.nbQuads=s,r.nbTriangles=l;var f=r.vertices=void 0!==r.vertices?new Float32Array(3*a):null,d=r.colors=void 0!==r.colors?new Float32Array(3*a):null,p=r.materials=void 0!==r.materials?new Float32Array(3*a):null,_=r.faces=void 0!==r.faces?new Uint32Array(4*o):null,g=r.triangles=void 0!==r.triangles?new Uint32Array(3*l):null,m=[0,0,0],v=0,y=0,b=0,A=0;for(n=0;n<u;++n){var T=e[n],S=T.getVertices(),w=T.getColors(),M=T.getMaterials(),k=T.getFaces(),E=T.getTriangles(),x=T.getNbVertices(),R=T.getNbFaces(),C=T.getNbTriangles(),P=T.getMatrix();for(i=0;i<x;++i)h=3*i,m[0]=S[h],m[1]=S[h+1],m[2]=S[h+2],c.Z0(m,m,P),f[v+h]=m[0],f[v+h+1]=m[1],f[v+h+2]=m[2],d&&(d[v+h]=w[h],d[v+h+1]=w[h+1],d[v+h+2]=w[h+2]),p&&(p[v+h]=M[h],p[v+h+1]=M[h+1],p[v+h+2]=M[h+2]);if(v+=3*x,_)for(i=0;i<R;++i)_[y+(h=4*i)]=k[h]+A,_[y+h+1]=k[h+1]+A,_[y+h+2]=k[h+2]+A,_[y+h+3]=k[h+3]===t.A.TRI_INDEX?t.A.TRI_INDEX:k[h+3]+A;if(g)for(i=0;i<C;++i)g[b+(h=3*i)]=E[h]+A,g[b+h+1]=E[h+1]+A,g[b+h+2]=E[h+2]+A;A+=x,y+=4*R,b+=3*C}return r},jn.mergeMeshes=function(e,t){var r={vertices:null,colors:null,materials:null,faces:null};return jn.mergeArrays(e,r),Wn(t,r.faces,r.vertices,r.colors,r.materials)};const zn=jn;var Xn={},Kn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-.5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=new Float32Array(4);u[0]=0,u[1]=1,u[2]=2,u[3]=3;var c=new Float32Array(12);return c[0]=e,c[1]=t,c[2]=r,c[3]=e+n,c[4]=t+i,c[5]=r+a,c[6]=e+n+o,c[7]=t+i+s,c[8]=r+a+l,c[9]=e+o,c[10]=t+s,c[11]=r+l,{faces:u,vertices:c}},Hn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=new Float32Array(24);t[1]=t[2]=t[4]=t[6]=t[7]=t[9]=t[10]=t[11]=t[14]=t[18]=t[21]=t[23]=.5*-e,t[0]=t[3]=t[5]=t[8]=t[12]=t[13]=t[15]=t[16]=t[17]=t[19]=t[20]=t[22]=.5*e;var r=new Float32Array(28);r[0]=r[6]=r[8]=r[10]=r[11]=r[13]=r[16]=r[23]=r[25]=.5,r[1]=r[3]=1,r[2]=r[4]=r[9]=r[12]=r[14]=r[15]=r[18]=.25,r[5]=r[7]=r[21]=r[24]=r[26]=r[27]=.75,r[17]=r[19]=r[20]=r[22]=0;var n=new Uint32Array(24),i=new Uint32Array(24);return n[0]=n[8]=n[21]=i[0]=0,n[1]=n[11]=n[12]=i[1]=1,n[2]=n[15]=n[16]=i[2]=i[15]=i[16]=2,n[3]=n[19]=n[22]=i[3]=i[19]=i[22]=3,n[4]=n[9]=n[20]=i[4]=i[9]=4,n[7]=n[10]=n[13]=i[5]=i[18]=i[23]=5,n[6]=n[14]=n[17]=i[6]=i[14]=i[17]=6,n[5]=n[18]=n[23]=i[7]=i[10]=7,i[8]=8,i[11]=9,i[12]=10,i[13]=11,i[20]=12,i[21]=13,{vertices:t,uv:r,faces:n,facesUV:i}},Yn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:64,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:64,o=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],l=o&&0===e,u=s&&0===r,c=.5*n,h=(a+1)*i,f=a*i;o&&(h+=1,f+=i),s&&(h+=1,f+=i),(l||u)&&(h-=i,f-=i);var d,p=new Float32Array(3*h),_=new Uint32Array(4*f),g=0,m=0,v=0,y=0,b=l?1:0,A=u?a-1:a;for(v=b;v<=A;v++){var T=v/a,S=T*(r-e)+e;for(y=0;y<i;y++){var w=2*Math.PI*y/i;p[m=3*g++]=S*Math.sin(w),p[m+1]=-T*n+c,p[m+2]=S*Math.cos(w)}}for(g=0,y=0;y<i;y++){var M=y===i-1?0:y+1;for(v=b;v<A;v++)_[m=4*g++]=i*v+y,_[m+1]=i*(v+1)+y,_[m+2]=i*(v+1)+M,_[m+3]=i*v+M}if(o)for(p[3*(d=(s?p.length-6:p.length-3)/3)+1]=c,y=0;y<i;y++)_[m=4*g++]=y,_[m+1]=y===i-1?0:y+1,_[m+2]=d,_[m+3]=t.A.TRI_INDEX;if(s){p[3*(d=(p.length-3)/3)+1]=-c,l&&--v;var k=i*v;for(y=0;y<i;y++)_[m=4*g++]=y===i-1?k:k+y+1,_[m+1]=k+y,_[m+2]=d,_[m+3]=t.A.TRI_INDEX}return{vertices:p,faces:_}},qn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2*Math.PI,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:32,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:128,o=2*Math.PI-n<.01,s=i*a,l=s;o||(s+=2,l+=i);var u=o?a:a-1,c=new Float32Array(3*s),h=new Uint32Array(4*l),f=0,d=0,p=0,_=0;for(p=0;p<a;++p)for(_=0;_<i;++_){var g=p/u*n,m=_/i*Math.PI*2;c[d=3*f++]=(e+r*Math.cos(m))*Math.cos(g),c[d+1]=r*Math.sin(m),c[d+2]=(e+r*Math.cos(m))*Math.sin(g)}for(f=0,p=0;p<u;++p){var v=p===a-1?0:p+1;for(_=0;_<i;++_){h[d=4*f++]=i*p+_;var y=_===i-1?0:_+1;h[d+1]=i*p+y,h[d+2]=i*v+y,h[d+3]=i*v+_}}if(!o){var b=(c.length-6)/3;for(c[3*b]=e,_=0;_<i;_++)h[d=4*f++]=b,h[d+1]=_===i-1?0:_+1,h[d+2]=_,h[d+3]=t.A.TRI_INDEX;c[3*++b]=e*Math.cos(n),c[3*b+2]=e*Math.sin(n);var A=i*p;for(_=0;_<i;_++)h[d=4*f++]=b,h[d+1]=A+_,h[d+2]=_===i-1?A:A+_+1,h[d+3]=t.A.TRI_INDEX}return{vertices:c,faces:h}},Zn=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-.5,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-.5,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,l=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:20,c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:u;u+=2,c+=2;var h=new Float32Array(2*(u+c)*3),f=0,d=0,p=n/(u-1),_=i/(u-1),g=a/(u-1),m=e+n+o,v=t+i+s,y=r+a+l;for(f=0;f<u;++f)h[d=6*f]=e+p*f,h[d+1]=t+_*f,h[d+2]=r+g*f,h[d+3]=m-p*(u-f-1),h[d+4]=v-_*(u-f-1),h[d+5]=y-g*(u-f-1);for(p=o/(c-1),_=s/(c-1),g=l/(c-1),f=0;f<c;++f)h[d=6*(u+f)]=e+p*f,h[d+1]=t+_*f,h[d+2]=r+g*f,h[d+3]=m-p*(c-f-1),h[d+4]=v-_*(c-f-1),h[d+5]=y-g*(c-f-1);return{vertices:h}},Jn=function(e,t){var r=new rn(e);return r.setVertices(t.vertices),t.faces&&r.setFaces(t.faces),t.uv&&t.facesUV&&r.initTexCoordsDataFromOBJData(t.uv,t.facesUV),r.init(),e&&r.initRender(),r},Qn=Array.prototype.slice;Xn.createGrid=function(e){var t=Jn(e,Zn.apply(this,Qn.call(arguments,1)));return e&&(t.setMode(e.LINES),t.setUseDrawArrays(!0),t.setAlreadyDrawArrays()),t},Xn.createCube=function(e){return Jn(e,Hn.apply(this,Qn.call(arguments,1)))},Xn.createCylinder=function(e){return Jn(e,Yn.apply(this,Qn.call(arguments,1)))},Xn.createTorus=function(e){return Jn(e,qn.apply(this,Qn.call(arguments,1)))},Xn.createPlane=function(e){return Jn(e,Kn.apply(this,Qn.call(arguments,1)))},Xn.createArrow=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.5,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.2,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:4,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s=Jn(null,Yn(t,t,r,a,o)),l=Jn(null,Yn(0,t*n,r*i,a,o));l.getMatrix()[13]=.5*r;var u={vertices:null,faces:null};return zn.mergeArrays([s,l],u),Jn(e,u)},Xn.createLine2D=function(e){var t=Jn(e,{vertices:new Float32Array([arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,0,arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,0])});return e&&(t.setMode(e.LINES),t.setUseDrawArrays(!0),t.setAlreadyDrawArrays()),t};const $n=Xn;function ei(e){return ei="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ei(e)}function ti(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ri(n.key),n)}}function ri(e){var t=function(e){if("object"!=ei(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ei(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ei(t)?t:t+""}var ni=c.fA(.7,.2,.2),ii=c.fA(.2,.7,.2),ai=c.fA(.2,.2,.7),oi=c.fA(.4,.4,.4),si=c.fA(.8,.4,.2),li=1.5*1.3,ui=Vt(),ci=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return{_finalMatrix:g.vt(),_baseMatrix:g.vt(),_color:c.vt(),_colorSelect:c.fA(1,1,0),_drawGeo:null,_pickGeo:null,_isSelected:!1,_type:e,_nbAxis:t,_lastInter:[0,0,0],updateMatrix:function(){g.C(this._drawGeo.getMatrix(),this._finalMatrix),g.C(this._pickGeo.getMatrix(),this._finalMatrix)},updateFinalMatrix:function(e){g.lK(this._finalMatrix,e,this._baseMatrix)}}},hi=1024,fi=2048,di=4096,pi=8192,_i=15360,gi=function(){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._main=r,this._gl=r._gl,this._activatedType=t.TRANS_XYZ|t.ROT_XYZ|t.PLANE_XYZ|t.SCALE_XYZW|t.ROT_W,this._transX=ci(t.TRANS_X,0),this._transY=ci(t.TRANS_Y,1),this._transZ=ci(t.TRANS_Z,2),this._planeX=ci(t.PLANE_X,0),this._planeY=ci(t.PLANE_Y,1),this._planeZ=ci(t.PLANE_Z,2),this._scaleX=ci(t.SCALE_X,0),this._scaleY=ci(t.SCALE_Y,1),this._scaleZ=ci(t.SCALE_Z,2),this._scaleW=ci(t.SCALE_W),this._rotX=ci(t.ROT_X,0),this._rotY=ci(t.ROT_Y,1),this._rotZ=ci(t.ROT_Z,2),this._rotW=ci(t.ROT_W),this._lineHelper=$n.createLine2D(this._gl),this._lineHelper.setShaderType(e.A.Shader.FLAT),this._lastDistToEye=0,this._isEditing=!1,this._selected=null,this._pickables=[],this._editLineOrigin=[0,0,0],this._editLineDirection=[0,0,0],this._editOffset=[0,0,0],this._editLocal=[],this._editTrans=g.vt(),this._editScaleRot=[],this._editLocalInv=[],this._editTransInv=g.vt(),this._editScaleRotInv=[],this._initTranslate(),this._initRotate(),this._initScale(),this._initPickables()}var r,n,i;return r=t,n=[{key:"setActivatedType",value:function(e){this._activatedType=e,this._initPickables()}},{key:"_initPickables",value:function(){var e=this._pickables;e.length=0;var t=this._activatedType;1&t&&e.push(this._transX._pickGeo),2&t&&e.push(this._transY._pickGeo),4&t&&e.push(this._transZ._pickGeo),128&t&&e.push(this._planeX._pickGeo),256&t&&e.push(this._planeY._pickGeo),512&t&&e.push(this._planeZ._pickGeo),8&t&&e.push(this._rotX._pickGeo),16&t&&e.push(this._rotY._pickGeo),32&t&&e.push(this._rotZ._pickGeo),t&hi&&e.push(this._scaleX._pickGeo),t&fi&&e.push(this._scaleY._pickGeo),t&di&&e.push(this._scaleZ._pickGeo),t&pi&&e.push(this._scaleW._pickGeo)}},{key:"_createArrow",value:function(t,r,n){var i=t._baseMatrix;g.e$(i,i,.5*Math.PI,r),g.Tl(i,i,[0,1.25,0]),c.C(t._color,n),t._pickGeo=$n.createArrow(this._gl,.1,2.5,6*.4),t._pickGeo._gizmo=t,t._drawGeo=$n.createArrow(this._gl,.02,2.5,6,.25),t._drawGeo.setShaderType(e.A.Shader.FLAT)}},{key:"_createPlane",value:function(t,r,n,i,a,o,s,l){c.C(t._color,r),t._pickGeo=$n.createPlane(this._gl,0,0,0,n,i,a,o,s,l),t._pickGeo._gizmo=t,t._drawGeo=$n.createPlane(this._gl,0,0,0,n,i,a,o,s,l),t._drawGeo.setShaderType(e.A.Shader.FLAT)}},{key:"_initTranslate",value:function(){var e=[0,0,0];this._createArrow(this._transX,c.hZ(e,0,0,-1),ni),this._createArrow(this._transY,c.hZ(e,0,1,0),ii),this._createArrow(this._transZ,c.hZ(e,1,0,0),ai);var t=.5;this._createPlane(this._planeX,ni,0,t,0,0,0,t),this._createPlane(this._planeY,ii,t,0,0,0,0,t),this._createPlane(this._planeZ,ai,t,0,0,0,t,0)}},{key:"_createCircle",value:function(t,r,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1;c.C(t._color,n),t._pickGeo=$n.createTorus(this._gl,i,.1*a,r,6,64),t._pickGeo._gizmo=t,t._drawGeo=$n.createTorus(this._gl,i,.02*a,r,6,64),t._drawGeo.setShaderType(e.A.Shader.FLAT)}},{key:"_initRotate",value:function(){this._createCircle(this._rotX,Math.PI,ni),this._createCircle(this._rotY,Math.PI,ii),this._createCircle(this._rotZ,Math.PI,ai),this._createCircle(this._rotW,2*Math.PI,oi)}},{key:"_createCube",value:function(t,r,n){var i=t._baseMatrix;g.e$(i,i,.5*Math.PI,r),g.Tl(i,i,[0,1.5,0]),c.C(t._color,n),t._pickGeo=$n.createCube(this._gl,.42),t._pickGeo._gizmo=t,t._drawGeo=$n.createCube(this._gl,.35),t._drawGeo.setShaderType(e.A.Shader.FLAT)}},{key:"_initScale",value:function(){var e=[0,0,0];this._createCube(this._scaleX,c.hZ(e,0,0,-1),ni),this._createCube(this._scaleY,c.hZ(e,0,1,0),ii),this._createCube(this._scaleZ,c.hZ(e,1,0,0),ai),this._createCircle(this._scaleW,2*Math.PI,si,li,2)}},{key:"_updateArcRotation",value:function(e){ui[0]=e[2],ui[1]=0,ui[2]=-e[0],ui[3]=1+e[1],Xt(ui,ui),g.I0(this._rotW._baseMatrix,ui),g.I0(this._scaleW._baseMatrix,ui),function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);e[0]=n*l+i*s,e[1]=i*l-n*s,e[2]=a*l+o*s,e[3]=o*l-a*s}(ui,Nt(ui),.5*Math.PI),jt(ui,ui,Math.atan2(-e[1],-e[2])),g.I0(this._rotX._baseMatrix,ui),jt(ui,Nt(ui),Math.atan2(-e[0],-e[2])),g.I0(this._rotY._baseMatrix,ui),Ut(ui,Nt(ui),.5*Math.PI),jt(ui,ui,Math.atan2(-e[0],e[1])),g.I0(this._rotZ._baseMatrix,ui)}},{key:"_computeCenterGizmo",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[0,0,0],t=this._main.getSelectedMeshes(),r=[0,0,0],n=[0,0,0],i=0;i<t.length;++i){var a=t[i];c.Z0(n,a.getCenter(),a.getEditMatrix()),c.Z0(n,n,a.getMatrix()),c.WQ(r,r,n)}return c.hs(e,r,1/t.length),e}},{key:"_updateMatrices",value:function(){var e=this._main.getCamera(),t=this._computeCenterGizmo(),r=e.computePosition();this._lastDistToEye=this._isEditing?this._lastDistToEye:c.xg(r,t);var n=80*this._lastDistToEye/e.getConstantScreen(),i=g.vt();g.Tl(i,i,t),g.hs(i,i,[n,n,n]),this._updateArcRotation(c.S8(r,c.jb(r,t,r))),this._transX.updateFinalMatrix(i),this._transY.updateFinalMatrix(i),this._transZ.updateFinalMatrix(i),this._planeX.updateFinalMatrix(i),this._planeY.updateFinalMatrix(i),this._planeZ.updateFinalMatrix(i),this._rotX.updateFinalMatrix(i),this._rotY.updateFinalMatrix(i),this._rotZ.updateFinalMatrix(i),this._rotW.updateFinalMatrix(i),this._scaleX.updateFinalMatrix(i),this._scaleY.updateFinalMatrix(i),this._scaleZ.updateFinalMatrix(i),this._scaleW.updateFinalMatrix(i)}},{key:"_drawGizmo",value:function(e){e.updateMatrix();var t=e._drawGeo;t.setFlatColor(e._isSelected?e._colorSelect:e._color),t.updateMatrices(this._main.getCamera()),t.render(this._main)}},{key:"_updateLineHelper",value:function(e,t,r,n){var i=this._lineHelper.getVertices(),a=this._main,o=a.getCanvasWidth(),s=a.getCanvasHeight();i[0]=e/o*2-1,i[1]=(s-t)/s*2-1,i[3]=r/o*2-1,i[4]=(s-n)/s*2-1,this._lineHelper.updateVertexBuffer()}},{key:"_saveEditMatrices",value:function(){var e=this._main.getSelectedMeshes(),t=this._computeCenterGizmo();g.Tl(this._editTrans,g.D_(this._editTrans),t),g.B8(this._editTransInv,this._editTrans);for(var r=0;r<e.length;++r)this._editLocal[r]=g.vt(),this._editScaleRot[r]=g.vt(),this._editLocalInv[r]=g.vt(),this._editScaleRotInv[r]=g.vt(),g.C(this._editLocal[r],e[r].getMatrix()),g.C(this._editScaleRot[r],this._editLocal[r]),this._editScaleRot[r][12]=this._editScaleRot[r][13]=this._editScaleRot[r][14]=0,g.B8(this._editLocalInv[r],this._editLocal[r]),g.B8(this._editScaleRotInv[r],this._editScaleRot[r])}},{key:"_startRotateEdit",value:function(){var e=this._main,t=e.getCamera(),r=[0,0,0];this._computeCenterGizmo(r),c.C(r,t.project(r));var n=this._editLineDirection,i=0===this._selected._nbAxis?-1:1,a=this._selected._lastInter;c.hZ(n,-i*a[2],-i*a[1],i*a[0]),c.Z0(n,n,this._selected._finalMatrix),c.C(n,t.project(n)),Dt(n,Ft(n,n,r)),Ct(this._editLineOrigin,e._mouseX,e._mouseY)}},{key:"_startTranslateEdit",value:function(){var e=this._main,t=e.getCamera(),r=this._editLineOrigin,n=this._editLineDirection;this._computeCenterGizmo(r);var i=this._selected._nbAxis;-1!==i&&(c.hZ(n,0,0,0)[i]=1),c.WQ(n,r,n),c.C(r,t.project(r)),c.C(n,t.project(n)),Dt(n,Ft(n,n,r));var a=this._editOffset;a[0]=e._mouseX-r[0],a[1]=e._mouseY-r[1]}},{key:"_startPlaneEdit",value:function(){var e=this._main,t=e.getCamera(),r=this._editLineOrigin;this._computeCenterGizmo(r),c.C(r,t.project(r));var n=this._editOffset;n[0]=e._mouseX-r[0],n[1]=e._mouseY-r[1],Ct(this._editLineOrigin,e._mouseX,e._mouseY)}},{key:"_startScaleEdit",value:function(){this._startTranslateEdit()}},{key:"_updateRotateEdit",value:function(){var e=this._main,t=this._editLineOrigin,r=this._editLineDirection,n=[e._mouseX,e._mouseY,0];Ft(n,n,t);var i=Ot(n,r);this._updateLineHelper(t[0],t[1],t[0]+r[0]*i,t[1]+r[1]*i);var a=7*i/Math.min(e.getCanvasWidth(),e.getCanvasHeight());a%=2*Math.PI;for(var o=this._selected._nbAxis,s=this._main.getSelectedMeshes(),l=0;l<s.length;++l){var u=s[l].getEditMatrix();g.D_(u),0===o?g.eL(u,u,-a):1===o?g.Z8(u,u,-a):2===o&&g.Qr(u,u,-a),this._scaleRotateEditMatrix(u,l)}e.render()}},{key:"_updateTranslateEdit",value:function(){var e=this._main,t=e.getCamera(),r=this._editLineOrigin,n=this._editLineDirection,i=[e._mouseX,e._mouseY,0];Ft(i,i,r),Ft(i,i,this._editOffset),Pt(i,r,n,Ot(i,n)),this._updateLineHelper(r[0],r[1],i[0],i[1]);var a=t.unproject(i[0],i[1],0),o=t.unproject(i[0],i[1],.1);c.Z0(a,a,this._editTransInv),c.Z0(o,o,this._editTransInv),c.S8(i,c.jb(i,o,a));var s=[0,0,0];s[this._selected._nbAxis]=1;var l=-c.Om(i,s),u=c.Om(a,i),h=Math.abs(1-l*l),f=-c.Om(a,s);s[this._selected._nbAxis]=(l*u-f)/h,this._updateMatrixTranslate(s),e.render()}},{key:"_updatePlaneEdit",value:function(){var e=this._main,t=e.getCamera(),r=[e._mouseX,e._mouseY,0];Ft(r,r,this._editOffset),this._updateLineHelper(this._editLineOrigin[0],this._editLineOrigin[1],e._mouseX,e._mouseY);var n=t.unproject(r[0],r[1],0),i=t.unproject(r[0],r[1],.1);c.Z0(n,n,this._editTransInv),c.Z0(i,i,this._editTransInv);var a=[0,0,0];a[this._selected._nbAxis]=1;var o=c.Om(n,a),s=c.Om(i,a);if(o===s)return!1;var l=-o/(s-o);a[0]=n[0]+(i[0]-n[0])*l,a[1]=n[1]+(i[1]-n[1])*l,a[2]=n[2]+(i[2]-n[2])*l,this._updateMatrixTranslate(a),e.render()}},{key:"_updateMatrixTranslate",value:function(e){for(var t=[0,0,0],r=this._main.getSelectedMeshes(),n=0;n<r.length;++n){c.Z0(t,e,this._editScaleRotInv[n]);var i=r[n].getEditMatrix();g.D_(i),g.Tl(i,i,t)}}},{key:"_updateScaleEdit",value:function(){var e=this._main,t=(e.getMesh(),this._editLineOrigin),r=this._editLineDirection,n=this._selected._nbAxis,i=[e._mouseX,e._mouseY,0];-1!==n&&(Ft(i,i,t),Pt(i,t,r,Ot(i,r))),this._updateLineHelper(t[0],t[1],i[0],i[1]);var a=c.Il(this._editOffset),o=[1,1,1],s=Math.max(-.99,(Lt(t,i)-a)/a);-1===n?(o[0]+=s,o[1]+=s,o[2]+=s):o[n]+=s;for(var l=this._main.getSelectedMeshes(),u=0;u<l.length;++u){var h=l[u].getEditMatrix();g.D_(h),g.hs(h,h,o),this._scaleRotateEditMatrix(h,u)}e.render()}},{key:"_scaleRotateEditMatrix",value:function(e,t){g.lK(e,this._editTrans,e),g.lK(e,e,this._editTransInv),g.lK(e,this._editLocalInv[t],e),g.lK(e,e,this._editLocal[t])}},{key:"addGizmoToScene",value:function(e){return e.push(this._transX._drawGeo),e.push(this._transY._drawGeo),e.push(this._transZ._drawGeo),e.push(this._planeX._drawGeo),e.push(this._planeY._drawGeo),e.push(this._planeZ._drawGeo),e.push(this._rotX._drawGeo),e.push(this._rotY._drawGeo),e.push(this._rotZ._drawGeo),e.push(this._rotW._drawGeo),e.push(this._scaleX._drawGeo),e.push(this._scaleY._drawGeo),e.push(this._scaleZ._drawGeo),e.push(this._scaleW._drawGeo),e}},{key:"render",value:function(){this._updateMatrices();var e=this._isEditing&&this._selected?this._selected._type:this._activatedType;64&e&&this._drawGizmo(this._rotW),1&e&&this._drawGizmo(this._transX),2&e&&this._drawGizmo(this._transY),4&e&&this._drawGizmo(this._transZ),128&e&&this._drawGizmo(this._planeX),256&e&&this._drawGizmo(this._planeY),512&e&&this._drawGizmo(this._planeZ),8&e&&this._drawGizmo(this._rotX),16&e&&this._drawGizmo(this._rotY),32&e&&this._drawGizmo(this._rotZ),e&hi&&this._drawGizmo(this._scaleX),e&fi&&this._drawGizmo(this._scaleY),e&di&&this._drawGizmo(this._scaleZ),e&pi&&this._drawGizmo(this._scaleW),this._isEditing&&this._lineHelper.render(this._main)}},{key:"onMouseOver",value:function(){if(this._isEditing){var e=this._selected._type;return 56&e?this._updateRotateEdit():7&e?this._updateTranslateEdit():896&e?this._updatePlaneEdit():e&_i&&this._updateScaleEdit(),!0}var t=this._main,r=t.getPicking(),n=t._mouseX,i=t._mouseY,a=this._pickables;r.intersectionMouseMeshes(a,n,i),this._selected&&(this._selected._isSelected=!1);var o=r.getMesh();return o?(this._selected=o._gizmo,this._selected._isSelected=!0,c.C(this._selected._lastInter,r.getIntersectionPoint()),!0):(this._selected=null,!1)}},{key:"onMouseDown",value:function(){var e=this._selected;if(!e)return!1;this._isEditing=!0;var t=e._type;return this._saveEditMatrices(),56&t?this._startRotateEdit():7&t?this._startTranslateEdit():896&t?this._startPlaneEdit():t&_i&&this._startScaleEdit(),!0}},{key:"onMouseUp",value:function(){this._isEditing=!1}}],i=[{key:"TRANS_X",get:function(){return 1}},{key:"TRANS_Y",get:function(){return 2}},{key:"TRANS_Z",get:function(){return 4}},{key:"ROT_X",get:function(){return 8}},{key:"ROT_Y",get:function(){return 16}},{key:"ROT_Z",get:function(){return 32}},{key:"ROT_W",get:function(){return 64}},{key:"PLANE_X",get:function(){return 128}},{key:"PLANE_Y",get:function(){return 256}},{key:"PLANE_Z",get:function(){return 512}},{key:"SCALE_X",get:function(){return hi}},{key:"SCALE_Y",get:function(){return fi}},{key:"SCALE_Z",get:function(){return di}},{key:"SCALE_W",get:function(){return pi}},{key:"TRANS_XYZ",get:function(){return 7}},{key:"ROT_XYZ",get:function(){return 56}},{key:"PLANE_XYZ",get:function(){return 896}},{key:"SCALE_XYZW",get:function(){return _i}}],n&&ti(r.prototype,n),i&&ti(r,i),Object.defineProperty(r,"prototype",{writable:!1}),t}();const mi=gi;function vi(e){return vi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},vi(e)}function yi(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bi(n.key),n)}}function bi(e){var t=function(e){if("object"!=vi(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=vi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==vi(t)?t:t+""}function Ai(e,t){return Ai=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Ai(e,t)}function Ti(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Ti=function(){return!!e})()}function Si(e){return Si=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Si(e)}var wi=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Ai(e,t)}(i,e);var t,r,n=function(e){var t=Ti();return function(){var r,n=Si(e);if(t){var i=Si(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==vi(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(i);function i(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i),(t=n.call(this,e))._gizmo=new mi(e),t}return t=i,r=[{key:"isIdentity",value:function(e){return 1===e[0]&&1===e[5]&&1===e[10]&&1===e[15]&&0===e[1]&&0===e[2]&&0===e[3]&&0===e[4]&&0===e[6]&&0===e[7]&&0===e[8]&&0===e[9]&&0===e[11]&&0===e[12]&&0===e[13]&&0===e[14]}},{key:"preUpdate",value:function(){var e=this._main.getPicking(),t=e.getMesh();this._gizmo.onMouseOver(),e._mesh=t,this._main.setCanvasCursor("default")}},{key:"start",value:function(e){var t=this._main,r=this.getMesh(),n=t.getPicking();return r&&this._gizmo.onMouseDown()?(n._mesh=r,!0):!!n.intersectionMouseMeshes(t.getMeshes(),t._mouseX,t._mouseY)&&!!t.setOrUnsetMesh(n.getMesh(),e)&&(this._lastMouseX=t._mouseX,this._lastMouseY=t._mouseY,!1)}},{key:"end",value:function(){if(this._gizmo.onMouseUp(),this.getMesh()&&!this.isIdentity(this.getMesh().getEditMatrix())){for(var e=this._main.getSelectedMeshes(),t=0;t<e.length;++t){this._forceToolMesh=e[t],this.pushState(),t>0&&(this._main.getStateManager().getCurrentState().squash=!0);var r=this.getUnmaskedVertices();this._main.getStateManager().pushVertices(r),this.applyEditMatrix(r),0!==r.length&&this.updateMeshBuffers()}this._forceToolMesh=null}}},{key:"applyEditMatrix",value:function(e){for(var t=this.getMesh(),r=t.getEditMatrix(),n=t.getMaterials(),i=t.getVertices(),a=[0,0,0],o=0,s=e.length;o<s;++o){var l=3*e[o],u=n[l+2],h=a[0]=i[l],f=a[1]=i[l+1],d=a[2]=i[l+2];c.Z0(a,a,r);var p=1-u;i[l]=h*p+a[0]*u,i[l+1]=f*p+a[1]*u,i[l+2]=d*p+a[2]*u}c.Z0(t.getCenter(),t.getCenter(),r),g.D_(r),e.length===t.getNbVertices()?t.updateGeometry():t.updateGeometry(t.getFacesFromVertices(e),e)}},{key:"update",value:function(){}},{key:"postRender",value:function(){this.getMesh()&&this._gizmo.render()}},{key:"addSculptToScene",value:function(e){this.getMesh()&&this._gizmo.addGizmoToScene(e)}}],r&&yi(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),i}(at);const Mi=wi;var ki=[];ki[e.A.Tools.BRUSH]=At,ki[e.A.Tools.INFLATE]=Rt,ki[e.A.Tools.TWIST]=er,ki[e.A.Tools.SMOOTH]=lr,ki[e.A.Tools.FLATTEN]=dt,ki[e.A.Tools.PINCH]=gr,ki[e.A.Tools.CREASE]=wr,ki[e.A.Tools.DRAG]=Dr,ki[e.A.Tools.PAINT]=jr,ki[e.A.Tools.MOVE]=qr,ki[e.A.Tools.MASKING]=hn,ki[e.A.Tools.LOCALSCALE]=yn,ki[e.A.Tools.TRANSFORM]=Mi,ki[e.A.Tools.BRUSH].uiName="sculptBrush",ki[e.A.Tools.INFLATE].uiName="sculptInflate",ki[e.A.Tools.TWIST].uiName="sculptTwist",ki[e.A.Tools.SMOOTH].uiName="sculptSmooth",ki[e.A.Tools.FLATTEN].uiName="sculptFlatten",ki[e.A.Tools.PINCH].uiName="sculptPinch",ki[e.A.Tools.CREASE].uiName="sculptCrease",ki[e.A.Tools.DRAG].uiName="sculptDrag",ki[e.A.Tools.PAINT].uiName="sculptPaint",ki[e.A.Tools.MOVE].uiName="sculptMove",ki[e.A.Tools.MASKING].uiName="sculptMasking",ki[e.A.Tools.LOCALSCALE].uiName="sculptLocalScale",ki[e.A.Tools.TRANSFORM].uiName="sculptTransform";const Ei=ki;function xi(e){return xi="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xi(e)}function Ri(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ci(n.key),n)}}function Ci(e){var t=function(e){if("object"!=xi(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=xi(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==xi(t)?t:t+""}const Pi=function(){function t(r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._main=r,this._toolIndex=e.A.Tools.BRUSH,this._tools=[],this._symmetry=!0,this._continuous=!1,this._sculptTimer=-1,this._selection=new $e(r._gl),this.init()}var r,n;return r=t,(n=[{key:"setToolIndex",value:function(e){this._toolIndex=e}},{key:"getToolIndex",value:function(){return this._toolIndex}},{key:"getCurrentTool",value:function(){return this._tools[this._toolIndex]}},{key:"getSymmetry",value:function(){return this._symmetry}},{key:"getTool",value:function(e){return this._tools[e]}},{key:"getSelection",value:function(){return this._selection}},{key:"init",value:function(){for(var e=this._main,t=this._tools,r=0,n=Ei.length;r<n;++r)Ei[r]&&(t[r]=new Ei[r](e))}},{key:"canBeContinuous",value:function(){switch(this._toolIndex){case e.A.Tools.TWIST:case e.A.Tools.MOVE:case e.A.Tools.DRAG:case e.A.Tools.LOCALSCALE:case e.A.Tools.TRANSFORM:return!1;default:return!0}}},{key:"isUsingContinuous",value:function(){return this._continuous&&this.canBeContinuous()}},{key:"start",value:function(e){var t=this.getCurrentTool(),r=t.start(e);return this._main.getPicking().getMesh()&&this.isUsingContinuous()&&(this._sculptTimer=window.setInterval(t._cbContinuous,16.6)),r}},{key:"end",value:function(){this.getCurrentTool().end(),-1!==this._sculptTimer&&(clearInterval(this._sculptTimer),this._sculptTimer=-1)}},{key:"preUpdate",value:function(){this.getCurrentTool().preUpdate(this.canBeContinuous())}},{key:"update",value:function(){this.isUsingContinuous()||this.getCurrentTool().update()}},{key:"postRender",value:function(){this.getCurrentTool().postRender(this._selection)}},{key:"addSculptToScene",value:function(e){return this.getCurrentTool().addSculptToScene(e)}}])&&Ri(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();var Di={importOBJ:function(e,r){for(var n=[],i=[],a=[],o=[],s=[],l=[],u=[],c=[],h=[],f=0,d=0,p=0,_=0,g=e.split("\n"),m=[],v=1/255,y=g.length,b=0;b<y;++b){var A=g[b].trim();if(0!==A.length){var T,S=A[0];if("v"===S)" "===(T=A[1])?(m=A.split(/\s+/),i.push(parseFloat(m[1]),parseFloat(m[2]),parseFloat(m[3])),m[4]&&a.push(parseFloat(m[4]),parseFloat(m[5]),parseFloat(m[6])),++p):"t"===T&&(m=A.split(/\s+/),u.push(parseFloat(m[1]),parseFloat(m[2])),++_);else if("f"===S){var w=(m=A.split(/\s+/)).length-1;if(w<3)continue;for(var M=Math.ceil(w/2)-1,k=0;k<M;++k){var E=k+1,x=k+2,R=w-E,C=w-k;R===x&&(R=C,C=t.A.TRI_INDEX);var P,D=m[E].split("/"),O=m[x].split("/"),I=m[R].split("/"),F=C!==t.A.TRI_INDEX;F&&(P=m[C].split("/"));var L=parseInt(D[0],10),V=parseInt(O[0],10),N=parseInt(I[0],10),B=F?parseInt(P[0],10):void 0;if((!F||B!==L&&B!==V&&B!==N)&&L!==V&&L!==N&&V!==N)if(L=(L<0?L+p:L-1)-f,V=(V<0?V+p:V-1)-f,N=(N<0?N+p:N-1)-f,F&&(B=(B<0?B+p:B-1)-f),c.push(L,V,N,F?B:t.A.TRI_INDEX),D[1]){var U=parseInt(D[1],10),j=parseInt(O[1],10),G=parseInt(I[1],10),W=F?parseInt(P[1],10):void 0;U=(U<0?U+_:U-1)-d,j=(j<0?j+_:j-1)-d,G=(G<0?G+_:G-1)-d,F&&(W=(W<0?W+_:W-1)-d),h.push(U,j,G,F?W:t.A.TRI_INDEX)}else h.length>0&&h.push(L,V,N,F?B:t.A.TRI_INDEX)}}else if("#"===S){if("M"!==A[1])continue;if(A.startsWith("#MRGB "))for(var z=(m=A.split(/\s+/))[1],X=2,K=z.length;X<K;X+=8){var H=parseInt(z.substr(X,6),16);o.push((H>>16)*v,(H>>8&255)*v,(255&H)*v)}else if(A.startsWith("#MAT "))for(var Y=(m=A.split(/\s+/))[1],q=0,Z=Y.length;q<Z;q+=6){var J=parseInt(Y.substr(q,6),16);l.push((J>>16)*v,(J>>8&255)*v,(255&J)*v)}}else A.startsWith("o ")&&(n.length>0&&(Di.initMeshOBJ(n[n.length-1],i,c,a,s,u,h,o,l),f=p,d=_),n.push(new rn(r)))}}return 0===n.length&&(n[0]=new rn(r)),Di.initMeshOBJ(n[n.length-1],i,c,a,s,u,h,o,l),n},initMeshOBJ:function(e,t,r,n,i,a,o,s,l){e.setVertices(new Float32Array(t)),e.setFaces(new Uint32Array(r)),s.length===t.length?e.setColors(new Float32Array(s)):n.length===t.length&&e.setColors(new Float32Array(n)),l.length===t.length?e.setMaterials(new Float32Array(l)):i.length===t.length&&e.setMaterials(new Float32Array(i)),a.length>0&&o.length===r.length&&e.initTexCoordsDataFromOBJData(a,o),t.length=r.length=0,s.length=n.length=0,l.length=i.length=0,a.length=o.length=0}};const Oi=Di;var Ii={VERSION:3,exportSGL:function(e,t){var r,n=e.length,i=4*(9+31*n),a=0;for(a=0;a<n;++a)i+=4*(r=e[a]).getNbVertices()*3,r.getColors()&&(i+=4*r.getNbVertices()*3),r.getMaterials()&&(i+=4*r.getNbVertices()*3),i+=4*r.getNbFaces()*4,r.hasUV()&&(i+=4*r.getNbTexCoords()*2,i+=4*r.getNbFaces()*4);var o=new ArrayBuffer(i),s=new Float32Array(o),l=new Uint32Array(o),u=0;l[u++]=Ii.VERSION,l[u++]=t._showGrid,l[u++]=P.showSymmetryLine,l[u++]=t._showContour;var c=t.getCamera();for(l[u++]=c.getProjectionType(),l[u++]=c.getMode(),s[u++]=c.getFov(),l[u++]=c.getUsePivot(),l[u++]=n,a=0;a<n;++a){r=e[a],l[u++]=r.getShaderType(),l[u++]=r.getMatcap(),l[u++]=r.getShowWireframe(),l[u++]=r.getFlatShading(),s[u++]=r.getOpacity(),s.set(r.getCenter(),u),u+=3,s.set(r.getMatrix(),u),u+=16,s[u++]=r.getScale();var h=r.getNbVertices();l[u++]=h,s.set(r.getVertices().subarray(0,3*h),u),u+=3*h;var f=r.getColors()?h:0;l[u++]=f,f>0&&s.set(r.getColors().subarray(0,3*h),u),u+=3*f;var d=r.getMaterials()?h:0;l[u++]=d,d>0&&s.set(r.getMaterials().subarray(0,3*h),u),u+=3*d;var p=r.getNbFaces();l[u++]=p,l.set(r.getFaces().subarray(0,4*p),u),u+=4*p;var _=r.hasUV(),g=r.getNbTexCoords();l[u++]=_?g:0,_&&(s.set(r.getTexCoords().subarray(0,2*g),u),u+=2*g),l[u++]=_?p:0,_&&(l.set(r.getFacesTexCoord().subarray(0,4*p),u),u+=4*p)}var m=new DataView(o,0,4*u);return new Blob([m])}};const Fi=Ii;var Li={},Vi=function(e){for(var r=new Uint32Array(e),n=r.length/4,i=0;i<n;++i){var a=4*i+3;e[a]<0&&(r[a]=t.A.TRI_INDEX)}return r};Li.importSGL=function(e,t,r){var n=new Float32Array(e),i=new Uint32Array(e),a=new Int32Array(e),o=0,s=i[o++];if(s>Fi.VERSION)return[];if(s>=2){r._showGrid=i[o++],P.showSymmetryLine=i[o++],r._showContour=i[o++];var l=r.getCamera();l.setProjectionType(i[o++]),l.setMode(i[o++]),l.setFov(n[o++]),l.setUsePivot(i[o++])}for(var u=i[o++],c=new Array(u),h=0;h<u;++h){var f=c[h]=new rn(t);if(s>=2){var d=f.getRenderData();d._shaderType=i[o++],d._matcap=i[o++],d._showWireframe=i[o++],d._flatShading=i[o++],d._alpha=n[o++]}f.getCenter().set(n.subarray(o,o+3)),o+=3,f.getMatrix().set(n.subarray(o,o+16)),o+=16,o++;var p=i[o++];f.setVertices(n.subarray(o,o+3*p)),o+=3*p,(p=i[o++])>0&&f.setColors(n.subarray(o,o+3*p)),o+=3*p,(p=i[o++])>0&&f.setMaterials(n.subarray(o,o+3*p)),o+=3*p,p=i[o++],s<=2?f.setFaces(Vi(a.subarray(o,o+4*p))):f.setFaces(i.subarray(o,o+4*p)),o+=4*p;var _=null;(p=i[o++])&&(_=n.subarray(o,o+2*p)),o+=2*p;var g=null;(p=i[o++])&&(g=s<=2?Vi(a.subarray(o,o+4*p)):i.subarray(o,o+4*p)),o+=4*p,_&&g&&f.initTexCoordsDataFromOBJData(_,g)}return c};const Ni=Li;var Bi={},Ui=function(e){switch(e){case"uchar":case"char":case"int8":case"uint8":return 1;case"ushort":case"short":case"int16":case"uint16":return 2;case"uint":case"int":case"float":case"int32":case"uint32":case"float32":return 4;case"double":case"float64":return 8;default:return 0}},ji=function(e,t){var r=t?1/255:1;switch(e){case"char":case"uchar":case"short":case"ushort":case"int":case"uint":case"int8":case"uint8":case"int16":case"uint16":case"int32":case"uint32":return function(e){return parseInt(e,10)*r};case"float":case"double":case"float32":case"float64":return parseFloat;default:return function(e){return e}}},Gi=function(e,t,r){var n=r?1/255:1,i=t.offsetOctet;switch(t.type){case"int8":case"char":return function(t){return e.getInt8(t+i)*n};case"uint8":case"uchar":return function(t){return e.getUint8(t+i)*n};case"int16":case"short":return function(t){return e.getInt16(t+i,!0)*n};case"uint16":case"ushort":return function(t){return e.getUint16(t+i,!0)*n};case"int32":case"int":return function(t){return e.getInt32(t+i,!0)*n};case"uint32":case"uint":return function(t){return e.getUint32(t+i,!0)*n};case"float32":case"float":return function(t){return e.getFloat32(t+i,!0)};case"float64":case"double":return function(t){return e.getFloat64(t+i,!0)}}},Wi=function(e,t){var r=e.properties,n=e.objProperties={};e.offsetOctet=0;for(var i=0,a=r.length;i<a;++i){var o=r[i],s=n[o.name]={};s.type=o.type,s.type2=o.type2,t.isBinary?(s.offsetOctet=e.offsetOctet,e.offsetOctet+=Ui(o.type)):s.id=i}},zi=function(e,t){Wi(e,t);var r,n=t.vertices=new Float32Array(3*e.count),i=e.objProperties;(i.red||i.green||i.blue)&&(r=t.colors=new Float32Array(3*e.count)),t.isBinary?function(e,t,r,n){var i,a,o,s=e.count,l=e.objProperties,u=e.offsetOctet,c=u*s,h=new DataView(t.buffer,t.offsetOctet,c),f=Gi(h,l.x,!0),d=Gi(h,l.y,!0),p=Gi(h,l.z,!0);l.red&&(i=Gi(h,l.red,!0)),l.green&&(a=Gi(h,l.green,!0)),l.blue&&(o=Gi(h,l.blue,!0));for(var _=0;_<s;++_){var g=3*_,m=_*u;r[g]=f(m),r[g+1]=d(m),r[g+2]=p(m),i&&(n[g]=i(m)),a&&(n[g+1]=a(m)),o&&(n[g+2]=o(m))}t.offsetOctet+=c}(e,t,n,r):function(e,t,r,n){var i,a,o,s,l,u,c=e.count,h=t.lines,f=e.objProperties,d=t.offsetLine,p=ji(f.x.type,!0),_=ji(f.y.type,!0),g=ji(f.z.type,!0),m=f.x.id,v=f.y.id,y=f.z.id;f.red&&(i=ji(f.red.type,!0)),f.green&&(a=ji(f.green.type,!0)),f.blue&&(o=ji(f.blue.type,!0)),f.red&&(s=f.red.id),f.green&&(l=f.green.id),f.blue&&(u=f.blue.id);for(var b=0;b<c;++b){var A=3*b,T=h[d+b].trim().split(/\s+/);r[A]=p(T[m]),r[A+1]=_(T[v]),r[A+2]=g(T[y]),i&&(n[A]=i(T[s])),a&&(n[A+1]=a(T[l])),o&&(n[A+2]=o(T[u]))}t.offsetLine+=c}(e,t,n,r)},Xi=function(e,r,n,i){for(var a=e.count,o=e.objProperties,s=o&&(o.vertex_index||o.vertex_indices)||e.properties[0],l=new DataView(r.buffer,r.offsetOctet),u=Gi(l,s),c=Gi(l,{type:s.type2,offsetOctet:s.offsetOctet+Ui(s.type)}),h=Ui(s.type2),f=e.offsetOctet,d=0,p=0,_=0;_<a;++_){var g=u(d);3!==g&&4!==g||(n[p++]=c(d),n[p++]=c(d+h),n[p++]=c(d+2*h),n[p++]=3===g?t.A.TRI_INDEX:c(d+3*h)),d+=g*h+f}i||(r.faces=n.subarray(0,p)),r.offsetOctet+=d},Ki=function(e,r){Wi(e,r);var n=r.faces=new Uint32Array(4*e.count);r.isBinary?Xi(e,r,n):function(e,r,n){for(var i=e.count,a=r.lines,o=e.objProperties,s=r.offsetLine,l=o.vertex_index||o.vertex_indices,u=ji(l.type),c=ji(l.type2),h=l.id,f=0,d=0;d<i;++d){var p=a[s+d].trim().split(/\s+/),_=u(p[0]);3!==_&&4!==_||(n[f]=c(p[h+1]),n[f+1]=c(p[h+2]),n[f+2]=c(p[h+3]),n[f+3]=4===_?c(p[h+4]):t.A.TRI_INDEX,f+=4)}r.offsetLine+=i}(e,r,n)},Hi=function(e,t){var r=e.count;t.isBinary?Xi(e,t,[],!0):t.offsetLine+=r};Bi.importPLY=function(e,r){for(var n=function(e){for(var r,n=t.A.ab2str(e).split("\n"),i={isBinary:!1,start:0,elements:[],lines:n,buffer:e,vertices:null,faces:null,colors:null,offsetLine:0,offsetOctet:0},a=0;;){var o=n[a++];if(i.offsetOctet+=o.length+1,i.offsetLine=a,(o=o.trim()).startsWith("format binary"))i.isBinary=!0;else if(o.startsWith("element"))r=o.split(/\s+/),i.elements.push({name:r[1],count:parseInt(r[2],10),properties:[]});else if(o.startsWith("property")){var s="list"===(r=o.split(/\s+/))[1];i.elements[i.elements.length-1].properties.push({type:r[s?2:1],type2:s?r[3]:void 0,name:r[s?4:2]})}else if(o.startsWith("end_header"))break}return i}(e),i=n.elements,a=0,o=i.length;a<o;++a){var s=i[a];"vertex"===s.name?zi(s,n):"face"===s.name?Ki(s,n):Hi(s,n)}var l=new rn(r);return l.setVertices(n.vertices),l.setFaces(n.faces),l.setColors(n.colors),[l]};const Yi=Bi;var qi={importSTL:function(e,r){var n,i=new Uint32Array(e,80,1)[0]||0,a=84+50*i===e.byteLength,o=a?qi.importBinarySTL(e,i):qi.importAsciiSTL(t.A.ab2str(e));a&&(n=o[1],o=o[0]),i=o.length/9;for(var s=new Map,l=[0],u=new Uint32Array(4*i),c=0;c<i;++c){var h=4*c,f=9*c;u[h]=qi.detectNewVertex(s,o,n,f,l),u[h+1]=qi.detectNewVertex(s,o,n,f+3,l),u[h+2]=qi.detectNewVertex(s,o,n,f+6,l),u[h+3]=t.A.TRI_INDEX}var d=new rn(r);return d.setVertices(o.subarray(0,3*l[0])),n&&d.setColors(n.subarray(0,3*l[0])),d.setFaces(u),[d]},detectNewVertex:function(e,t,r,n,i){var a=t[n],o=t[n+1],s=t[n+2],l=a+"+"+o+"+"+s,u=e.get(l);if(void 0===u){u=i[0],e.set(l,u);var c=3*u;t[c]=a,t[c+1]=o,t[c+2]=s,r&&(r[c]=r[n],r[c+1]=r[n+1],r[c+2]=r[n+2]),i[0]++}return u},importAsciiSTL:function(e){for(var t=e.split("\n"),r=t.length,n=new Float32Array(Math.ceil(9*r/7)),i=0,a=0;a<r;++a)if(t[a].trim().startsWith("facet")){var o=t[a+2].trim().split(/\s+/);n[i++]=parseFloat(o[1]),n[i++]=parseFloat(o[2]),n[i++]=parseFloat(o[3]),o=t[a+3].trim().split(/\s+/),n[i++]=parseFloat(o[1]),n[i++]=parseFloat(o[2]),n[i++]=parseFloat(o[3]),o=t[a+4].trim().split(/\s+/),n[i++]=parseFloat(o[1]),n[i++]=parseFloat(o[2]),n[i++]=parseFloat(o[3])}return n.subarray(0,i)},importBinarySTL:function(e,t){var r=new Uint8Array(e),n=r.subarray(0,80),i=-1!==String.fromCharCode.apply(null,n).indexOf("COLOR="),a=0,o=new Uint8Array(36*t),s=new Uint8Array(2*t),l=96,u=0,c=0;for(a=0;a<t;a++){for(var h=0;h<36;++h)o[u++]=r[l++];s[c++]=r[l++],s[c++]=r[l++],l+=12}var f=new Uint16Array(s.buffer);s=new Float32Array(9*t);var d=1/31;for(a=0;a<t;++a){u=9*a;var p=f[a],_=1,g=1,m=1,v=32768&p;i?v||(_=(31&p)*d,g=(p>>5&31)*d,m=(p>>10&31)*d):v&&(_=(p>>10&31)*d,g=(p>>5&31)*d,m=(31&p)*d),s[u]=s[u+3]=s[u+6]=_,s[u+1]=s[u+4]=s[u+7]=g,s[u+2]=s[u+5]=s[u+8]=m}return[new Float32Array(o.buffer),s]}};const Zi=qi,Ji={importOBJ:Oi.importOBJ,importSGL:Ni.importSGL,importPLY:Yi.importPLY,importSTL:Zi.importSTL};var Qi=__webpack_require__(241),$i=__webpack_require__.n(Qi);function ea(e){return ea="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ea(e)}function ta(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ra(n.key),n)}}function ra(e){var t=function(e){if("object"!=ea(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ea(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ea(t)?t:t+""}const na=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._main=r._main,this._menu=null,this.init(t)}var t,r;return t=e,(r=[{key:"init",value:function(e){var t=this._menu=e.addMenu((0,N.A)("backgroundTitle"));this._bg=this._main.getBackground(),t.addCombobox("Type",this._bg._type,this.onBackgroundType.bind(this),["Image","Environment","Ambient env"]),this._ctrlBlur=t.addSlider("Blur",this._bg._blur,this.onEnvBlur.bind(this),0,1,.01),this._ctrlBlur.setVisibility(1===this._bg._type),t.addTitle("Image"),t.addButton((0,N.A)("backgroundReset"),this,"resetBackground"),t.addButton((0,N.A)("backgroundImport"),this,"importBackground"),t.addCheckbox((0,N.A)("backgroundFill"),this._main.getBackground()._fill,this.updateFill.bind(this))}},{key:"updateFill",value:function(e){this._bg._fill=e,this._main.onCanvasResize()}},{key:"resetBackground",value:function(){this._bg.deleteTexture(),this._main.render()}},{key:"onEnvBlur",value:function(e){this._bg._blur=e,this._main.render()}},{key:"onBackgroundType",value:function(e){this._bg.setType(e),this._main.onCanvasResize(),this._main.render(),this._ctrlBlur.setVisibility(1===e)}},{key:"importBackground",value:function(){document.getElementById("backgroundopen").click()}}])&&ta(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function ia(e){return ia="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ia(e)}function aa(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,oa(n.key),n)}}function oa(e){var t=function(e){if("object"!=ia(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ia(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ia(t)?t:t+""}const sa=function(){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._main=r._main,this._menu=null,this._camera=this._main.getCamera(),this._cameraTimer=-1,this._cbTranslation=this.cbOnTranslation.bind(this),this.init(e)}var r,n;return r=t,(n=[{key:"init",value:function(t){var r=this._camera,n=this._menu=t.addMenu((0,N.A)("cameraTitle"));n.addTitle((0,N.A)("cameraReset")),n.addDualButton((0,N.A)("cameraCenter"),(0,N.A)("cameraFront"),this.resetCamera.bind(this),this.resetFront.bind(this)),n.addDualButton((0,N.A)("cameraLeft"),(0,N.A)("cameraTop"),this.resetLeft.bind(this),this.resetTop.bind(this)),this._ctrlProjectionTitle=n.addTitle((0,N.A)("cameraProjection"));var i=[];i[e.A.Projection.PERSPECTIVE]=(0,N.A)("cameraPerspective"),i[e.A.Projection.ORTHOGRAPHIC]=(0,N.A)("cameraOrthographic"),this._ctrlProjection=n.addCombobox("",r.getProjectionType(),this.onCameraTypeChange.bind(this),i),this._ctrlFov=n.addSlider((0,N.A)("cameraFov"),r.getFov(),this.onFovChange.bind(this),10,90,1),this._ctrlFov.setVisibility(r.getProjectionType()===e.A.Projection.PERSPECTIVE),n.addTitle((0,N.A)("cameraMode"));var a=[];a[e.A.CameraMode.ORBIT]=(0,N.A)("cameraOrbit"),a[e.A.CameraMode.SPHERICAL]=(0,N.A)("cameraSpherical"),a[e.A.CameraMode.PLANE]=(0,N.A)("cameraPlane"),n.addCombobox("",r.getMode(),this.onCameraModeChange.bind(this),a),this._ctrlPivot=n.addCheckbox((0,N.A)("cameraPivot"),r.getUsePivot(),this.onPivotChange.bind(this)),n.addSlider("speed",this._main,"_cameraSpeed",.05,1,.001)}},{key:"onCameraModeChange",value:function(e){this._camera.setMode(e),this._main.render()}},{key:"onCameraTypeChange",value:function(t){this._camera.setProjectionType(t),this._ctrlFov.setVisibility(t===e.A.Projection.PERSPECTIVE),this._main.render()}},{key:"onFovChange",value:function(e){this._camera.setFov(e),this._main.render()}},{key:"onKeyDown",value:function(t){if(!0!==t.handled&&(t.stopPropagation(),!this._main._focusGui)){t.preventDefault();var r=this._main,n=r.getCamera();switch(t.handled=!0,t.shiftKey&&r._action===e.A.Action.CAMERA_ROTATE&&(n.snapClosestRotation(),r.render()),T.A.getShortKey(t.which)){case e.A.KeyAction.STRIFE_LEFT:n._moveX=-1;break;case e.A.KeyAction.STRIFE_RIGHT:n._moveX=1;break;case e.A.KeyAction.STRIFE_UP:n._moveZ=-1;break;case e.A.KeyAction.STRIFE_DOWN:n._moveZ=1;break;default:t.handled=!1}!0===t.handled&&-1===this._cameraTimer&&(this._cameraTimer=window.setInterval(this._cbTranslation,16.6))}}},{key:"cbOnTranslation",value:function(){var e=this._main;e.getCamera().updateTranslation(),e.render()}},{key:"onKeyUp",value:function(t){if(!0!==t.handled&&(t.stopPropagation(),!this._main._focusGui)){t.preventDefault(),t.handled=!0;var r=this._camera;switch(T.A.getShortKey(t.which)){case e.A.KeyAction.STRIFE_LEFT:case e.A.KeyAction.STRIFE_RIGHT:r._moveX=0;break;case e.A.KeyAction.STRIFE_UP:case e.A.KeyAction.STRIFE_DOWN:r._moveZ=0;break;case e.A.KeyAction.CAMERA_RESET:this.resetCamera();break;case e.A.KeyAction.CAMERA_FRONT:this.resetFront();break;case e.A.KeyAction.CAMERA_TOP:this.resetTop();break;case e.A.KeyAction.CAMERA_LEFT:this.resetLeft();break;default:t.handled=!1}-1!==this._cameraTimer&&0===r._moveX&&0===r._moveZ&&(clearInterval(this._cameraTimer),this._cameraTimer=-1)}}},{key:"resetCamera",value:function(){this._camera.resetView(),this._main.render()}},{key:"resetFront",value:function(){this._camera.toggleViewFront(),this._main.render()}},{key:"resetLeft",value:function(){this._camera.toggleViewLeft(),this._main.render()}},{key:"resetTop",value:function(){this._camera.toggleViewTop(),this._main.render()}},{key:"onPivotChange",value:function(){this._camera.toggleUsePivot(),this._main.render()}}])&&aa(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();function la(e){return la="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},la(e)}function ua(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ca(n.key),n)}}function ca(e){var t=function(e){if("object"!=la(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=la(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==la(t)?t:t+""}const ha=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._ctrlGui=r,this._menu=null,this.init(t)}var t,r;return t=e,(r=[{key:"init",value:function(e){this._langs=Object.keys(N.A.languages),this._menu=e.addMenu("Language"),this._menu.addCombobox("",this._langs.indexOf(N.A.select),this.onLangChange.bind(this),this._langs)}},{key:"onLangChange",value:function(e){N.A.select=this._langs[parseInt(e,10)],this._ctrlGui.initGui()}}])&&ua(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();var fa=__webpack_require__(464),da=__webpack_require__(442),pa={exportOBJ:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n="s 0\n",i=[1,1],a=0,o=e.length;a<o;++a)n+="o mesh_"+a+"\n",n=pa.addMesh(e[a],n,i,t,r);return new Blob([n])}},_a=function(e,t,r){for(var n=0,i=t.length;n<i;n++)e[r++]=t.charCodeAt(n);return r};pa.addMesh=function(e,r,n,i,a){var o=e.getVertices(),s=e.getColors(),l=e.getMaterials(),u=e.getFaces(),h=e.getNbVertices(),f=e.getNbFaces(),d=e.getNbTexCoords(),p=e.getMatrix(),_=0,g=0,m="",v=0;v=a?128*h:79*h,v+=45*d+66*f;var y=new Uint8Array(Math.max(1e3,v)),b=0,A=[0,0,0];for(_=0;_<h;++_)g=3*_,A[0]=o[g],A[1]=o[g+1],A[2]=o[g+2],c.Z0(A,A,p),m="v "+A[0]+" "+A[1]+" "+A[2],m+=a?" "+s[g]+" "+s[g+1]+" "+s[g+2]+"\n":"\n",b=_a(y,m,b);if(i){var T=Math.ceil(h/64);for(_=0;_<T;++_){m="#MRGB ",g=64*_;for(var S=_===T-1?h:g+64;g<S;++g){m+="ff";var w=3*g,M=Math.round(255*s[w]).toString(16),k=Math.round(255*s[w+1]).toString(16),E=Math.round(255*s[w+2]).toString(16);m+=1===M.length?"0"+M:M,m+=1===k.length?"0"+k:k,m+=1===E.length?"0"+E:E}b=_a(y,m+="\n",b)}for(T=Math.ceil(h/46),_=0;_<T;++_){m="#MAT ",g=46*_;for(var x=_===T-1?h:g+46;g<x;++g){var R=3*g,C=Math.round(255*l[R]).toString(16),P=Math.round(255*l[R+1]).toString(16),D=Math.round(255*l[R+2]).toString(16);m+=1===C.length?"0"+C:C,m+=1===P.length?"0"+P:P,m+=1===D.length?"0"+D:D}b=_a(y,m+="\n",b)}}var O=e.getFacesTexCoord(),I=e.getTexCoords(),F=e.hasUV();if(F)for(_=0;_<d;++_)m="vt "+I[g=2*_]+" "+I[g+1]+"\n",b=_a(y,m,b);var L=n[0],V=n[1];for(n[0]+=h,n[1]+=d,_=0;_<f;++_){var N=u[3+(g=4*_)];F?(m="f "+(L+u[g])+"/"+(V+O[g]),m+=" "+(L+u[g+1])+"/"+(V+O[g+1]),m+=" "+(L+u[g+2])+"/"+(V+O[g+2]),m+=N!==t.A.TRI_INDEX?" "+(L+N)+"/"+(V+O[g+3])+"\n":"\n"):(m="f "+(L+u[g]),m+=" "+(L+u[g+1]),m+=" "+(L+u[g+2]),m+=N!==t.A.TRI_INDEX?" "+(L+N)+"\n":"\n"),b=_a(y,m,b)}if(y=y.subarray(0,b),window.TextDecoder)return r+(new TextDecoder).decode(y);for(_=0;_<b;++_)r+=String.fromCharCode(y[_]);return r};const ga=pa;var ma={},va=function(e){return zn.mergeArrays(e,{vertices:null,colors:null,faces:null})};ma.exportAsciiPLY=function(e){var r=va(e),n=r.nbVertices,i=r.nbFaces,a=r.vertices,o=r.colors,s=r.faces,l=0,u=0,c="ply\nformat ascii 1.0\ncomment created by SculptGL\n";for(c+="element vertex "+n+"\n",c+="property float x\nproperty float y\nproperty float z\n",c+="property uchar red\nproperty uchar green\nproperty uchar blue\n",c+="element face "+i+"\n",c+="property list uchar uint vertex_indices\nend_header\n",l=0;l<n;++l)c+=a[u=3*l]+" "+a[u+1]+" "+a[u+2]+" "+(255*o[u]|0)+" "+(255*o[u+1]|0)+" "+(255*o[u+2]|0)+"\n";for(l=0;l<i;++l){var h=s[3+(u=4*l)],f=h!==t.A.TRI_INDEX;c+=(f?"4 ":"3 ")+s[u]+" "+s[u+1]+" "+s[u+2]+(f?" "+h+"\n":"\n")}return new Blob([c])},ma.exportBinaryPLY=function(e,r){var n=va(e),i=n.nbVertices,a=n.nbFaces,o=n.nbQuads,s=n.nbTriangles,l=n.vertices,u=n.colors,c=n.faces,h=0,f=0,d=0;if(r&&r.swapXY)for(h=0;h<i;++h){var p=l[1+(d=3*h)];l[d+1]=-l[d+2],l[d+2]=p}var _="ply\nformat binary_"+(t.A.littleEndian?"little":"big")+"_endian 1.0\ncomment created by SculptGL\n";_+="element vertex "+i+"\n",_+="property float x\nproperty float y\nproperty float z\n",_+="property uchar red\nproperty uchar green\nproperty uchar blue\n",_+="element face "+a+"\n",_+="property list uchar uint vertex_indices\nend_header\n";var g=4*l.length+u.length,m=4*(4*o+3*s)+a,v=_.length+g+2*m,y=new Uint8Array(v),b=new DataView(y.buffer);f=_.length;var A=0;for(A=0;A<f;++A)y[A]=_.charCodeAt(A);for(h=0;h<i;++h)f=3*h,b.setFloat32(A,l[f],!0),A+=4,b.setFloat32(A,l[f+1],!0),A+=4,b.setFloat32(A,l[f+2],!0),A+=4,b.setUint8(A,Math.round(255*u[f])),A+=1,b.setUint8(A,Math.round(255*u[f+1])),A+=1,b.setUint8(A,Math.round(255*u[f+2])),A+=1;for(h=0;h<a;++h){var T=c[3+(f=4*h)]!==t.A.TRI_INDEX;b.setUint8(A,T?4:3),A+=1,b.setUint32(A,c[f],!0),A+=4,b.setUint32(A,c[f+1],!0),A+=4,b.setUint32(A,c[f+2],!0),A+=4,T&&(b.setUint32(A,c[f+3],!0),A+=4)}return new Blob([y])};const ya=ma;var ba={},Aa=function(e){for(var t=zn.mergeArrays(e,{vertices:null,colors:null,triangles:null}),r=t.vertices,n=t.triangles,i=c.vt(),a=c.vt(),o=c.vt(),s=t.faceNormals=new Float32Array(3*t.nbTriangles),l=0;l<t.nbTriangles;++l){var u=3*l,h=3*n[u],f=3*n[u+1],d=3*n[u+2];c.hZ(i,r[h],r[h+1],r[h+2]),c.hZ(a,r[f],r[f+1],r[f+2]),c.hZ(o,r[d],r[d+1],r[d+2]),c.jb(a,a,i),c.jb(o,o,a),c.$A(i,a,o),c.S8(i,i),s[u]=i[0],s[u+1]=i[1],s[u+2]=i[2]}return t};ba.exportAsciiSTL=function(e){for(var t=Aa(e),r=t.nbTriangles,n=t.vertices,i=t.triangles,a=t.faceNormals,o="solid mesh\n",s=0;s<r;++s){var l=3*s;o+=" facet normal "+a[l]+" "+a[l+1]+" "+a[l+2]+"\n",o+="  outer loop\n";var u=3*i[l],c=3*i[l+1],h=3*i[l+2];o+="   vertex "+n[u]+" "+n[u+1]+" "+n[u+2]+"\n",o+="   vertex "+n[c]+" "+n[c+1]+" "+n[c+2]+"\n",o+="   vertex "+n[h]+" "+n[h+1]+" "+n[h+2]+"\n",o+="  endloop\n",o+=" endfacet\n"}return o+="endsolid mesh\n",new Blob([o])},ba.exportBinarySTL=function(e,t){var r,n,i=Aa(e),a=i.nbTriangles,o=i.vertices,s=i.colors,l=i.triangles,u=i.faceNormals;if(t&&t.swapXY){var c=i.nbVertices;for(r=0;r<c;++r){var h=o[1+(n=3*r)];o[n+1]=-o[n+2],o[n+2]=h}}var f=new Uint8Array(84+50*a),d=t&&t.colorMagic;if(d){var p=[67,79,76,79,82,61,255,255,255,255];for(r=0;r<p.length;++r)f[r]=p[r]}new DataView(f.buffer).setUint32(80,a,!0);var _=new Uint8Array(o.buffer),g=new Uint8Array(u.buffer),m=84,v=0,y=d?0:32768,b=31/3;for(r=0;r<a;++r){for(n=12*r,v=0;v<12;++v)f[m++]=g[n++];var A=3*l[n=3*r],T=3*l[n+1],S=3*l[n+2],w=4*A;for(v=0;v<12;++v)f[m++]=_[w++];var M=4*T;for(v=0;v<12;++v)f[m++]=_[M++];var k=4*S;for(v=0;v<12;++v)f[m++]=_[k++];var E=Math.round((s[A]+s[T]+s[S])*b),x=Math.round((s[A+1]+s[T+1]+s[S+1])*b)<<5,R=Math.round((s[A+2]+s[T+2]+s[S+2])*b);d?R<<=10:E<<=10;var C=E+x+R+y;f[m++]=255&C,f[m++]=C>>8}return new Blob([f])};const Ta=ba;var Sa={},wa=5126;Sa.exportGLB=function(e){for(var t=[],r=[],n=[],i=0,a=[],o=[],s=function(e,a,o,s){var l=function(e){var t=(4-e.byteLength%4)%4;if(0===t)return e;var r=new Uint8Array(e.byteLength+t);return r.set(new Uint8Array(e.buffer?e.buffer:e)),r}(e),u=i,c=l.byteLength;i+=c,n.push(l);var h=t.length;t.push({buffer:0,byteOffset:u,byteLength:c,target:s});var f,d,p=r.length,_=e.length/("VEC3"===a?3:"VEC2"===a?2:1);if("VEC3"===a&&o===wa){f=[1/0,1/0,1/0],d=[-1/0,-1/0,-1/0];for(var g=0;g<e.length;g+=3)f[0]=Math.min(f[0],e[g]),f[1]=Math.min(f[1],e[g+1]),f[2]=Math.min(f[2],e[g+2]),d[0]=Math.max(d[0],e[g]),d[1]=Math.max(d[1],e[g+1]),d[2]=Math.max(d[2],e[g+2])}var m={bufferView:h,byteOffset:0,componentType:o,count:_,type:a};return f&&(m.min=f),d&&(m.max=d),r.push(m),p},l=0;l<e.length;++l){for(var u=e[l],h=u.getVertices(),f=u.getFaces(),d=u.getColors(),p=u.getMatrix(),_=new Float32Array(h.length),g=[0,0,0],m=0;m<h.length;m+=3)g[0]=h[m],g[1]=h[m+1],g[2]=h[m+2],c.Z0(g,g,p),_[m]=g[0],_[m+1]=g[1],_[m+2]=g[2];var v=_.length/3>65535,y=v?5125:5123,b=v?f:new Uint16Array(f),A=s(_,"VEC3",wa,34962),T=s(b,"SCALAR",y,34963),S={attributes:{POSITION:A,COLOR_0:s(d,"VEC3",wa,34962)},indices:T,mode:4};a.push({primitives:[S]}),o.push({mesh:l})}for(var w={asset:{version:"2.0",generator:"SculptGL"},scene:0,scenes:[{nodes:o.map((e,t)=>t)}],nodes:o,meshes:a,buffers:[{byteLength:i}],bufferViews:t,accessors:r},M=JSON.stringify(w);M.length%4!=0;)M+=" ";var k=(new TextEncoder).encode(M),E=k.length,x=20+E+8+i,R=new Uint8Array(x),C=new DataView(R.buffer),P=0;C.setUint32(0,1179937895,!0),C.setUint32(4,2,!0),C.setUint32(8,x,!0),P+=12,C.setUint32(P,E,!0),C.setUint32(P+4,1313821514,!0),P+=8,R.set(k,P),P+=E,C.setUint32(P,i,!0),C.setUint32(P+4,5130562,!0),P+=8;for(var D=0;D<n.length;D++)R.set(new Uint8Array(n[D].buffer||n[D]),P),P+=n[D].byteLength;return new Blob([R],{type:"model/gltf-binary"})};const Ma=Sa;var ka=__webpack_require__(863),Ea=__webpack_require__.n(ka);function xa(e){return xa="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xa(e)}var Ra={exportSketchfab:function(e,t){if(window.sketchfabOAuth2Config){var r=new XMLHttpRequest;return new(Ea())(window.sketchfabOAuth2Config).connect().then(function(n){!function(e,t,r,n){e.open("POST","https://api.sketchfab.com/v2/models",!0),e.onprogress=function(e){if(e.lengthComputable&&e.total){var t=Math.round(100*e.loaded/e.total);n.setVisibility("Sketchfab upload: "+t+"%")}};var i=function(){n.setMessage("")};e.onerror=i,e.onabort=i,e.onload=function(){i();var t=JSON.parse(e.responseText),n=t.uid;n?(window.prompt((0,N.A)("sketchfabUploadProcessing"),"https://sketchfab.com/models/"+n),function e(){var t=new XMLHttpRequest,i="https://api.sketchfab.com/v2/models/"+n+"/status";"object"===xa(r)&&r.hasOwnProperty("token_type")&&"Bearer"===r.token_type?(t.open("GET",i,!0),t.setRequestHeader("Authorization","Bearer "+r.access_token)):t.open("GET",i+"?token="+r,!0),t.onload=function(){var r=JSON.parse(t.responseText);"FAILED"===r.processing?window.alert((0,N.A)("sketchfabUploadError",r.warning.generic.join("\n"))):"SUCCEEDED"===r.processing?window.prompt((0,N.A)("sketchfabUploadSuccess"),"https://sketchfab.com/models/"+n):window.setTimeout(e,5e3)},t.send()}()):window.alert((0,N.A)("sketchfabUploadError",t.detail))},n.setMessage("Creating zip..."),da.zip.useWebWorkers=!0,da.zip.workerScriptsPath="worker/",da.zip.createWriter(new da.zip.BlobWriter("application/zip"),function(i){var a=ya.exportBinaryPLY(t.getMeshes(),{swapXY:!0});i.add("yourMesh.ply",new da.zip.BlobReader(a),function(){i.close(Ra.exportFileSketchfab.bind(this,r,e,n))})},onerror)}(r,e,n,t)}).catch(function(e){console.error(e)}),r}},exportFileSketchfab:function(e,t,r,n){if(!t.isAborted){var i=new FormData;i.append("modelFile",n,"sculptglModel.zip"),i.append("name","My model"),i.append("tags","sculptgl"),"object"===xa(e)&&e.hasOwnProperty("token_type")&&"Bearer"===e.token_type?t.setRequestHeader("Authorization","Bearer "+e.access_token):i.append("token",e),r.setMessage("Sketchfab upload..."),t.send(i)}}};const Ca=Ra;var Pa={exportSculpteo:function(e,t){var r=new XMLHttpRequest;r.open("POST","uploadSculpteo.php",!0),r.onprogress=function(e){if(e.lengthComputable&&e.total){var r=Math.round(100*e.loaded/e.total);t.setMessage("Sculpteo upload: "+r+"%")}};var n=function(){t.setMessage("")};r.onerror=n,r.onabort=n,r.onload=function(){if(n(),200===this.status){var e=r.responseText.match(/\/print\/(.+?)(?=")/);e&&window.open("https://www.sculpteo.com/en"+e[0],"_blank")}};var i=e.getMeshes(),a=e.computeBoundingBoxMeshes(i),o=e.computeRadiusFromBoundingBox(a),s=ya.exportBinaryPLY(i,{swapXY:!0});return t.setMessage("Creating zip..."),da.zip.useWebWorkers=!0,da.zip.workerScriptsPath="worker/",da.zip.createWriter(new da.zip.BlobWriter("application/zip"),function(e){e.add("yourMesh.ply",new da.zip.BlobReader(s),function(){e.close(Pa.exportFileSculpteo.bind(this,o,r,t))})},onerror),r},exportFileSculpteo:function(e,t,r,n){if(!t.isAborted){var i=new FormData;i.append("file",n),i.append("name","fromSculptgl"),i.append("scale",4/e),r.setMessage("Sculpteo upload..."),t.send(i)}}};const Da=Pa;var Oa={exportMaterialise:function(e,t){var r=new XMLHttpRequest;r.open("POST","https://i.materialise.com/web-api/tool/20cc0fd6-3cef-4111-a201-0b87026d892c/model",!0),r.onprogress=function(e){if(e.lengthComputable&&e.total){var r=Math.round(100*e.loaded/e.total);t.setMessage("Materialise upload: "+r+"%")}};var n=function(){t.setMessage("")};r.onerror=n,r.onabort=n,r.onload=function(){if(n(),200===r.status){var e=JSON.parse(r.responseText);window.open("https://i.materialise.com/en/3dprint#modelId="+e.modelID,"_blank")}};var i=e.getMeshes(),a=e.computeBoundingBoxMeshes(i),o=e.computeRadiusFromBoundingBox(a),s=Ta.exportBinarySTL(i,{colorMagic:!0,swapXY:!0});return t.setMessage("Creating zip..."),da.zip.useWebWorkers=!0,da.zip.workerScriptsPath="worker/",da.zip.createWriter(new da.zip.BlobWriter("application/zip"),function(e){e.add("yourMesh.stl",new da.zip.BlobReader(s),function(){e.close(Oa.exportFileMaterialise.bind(this,o,r,t))})},onerror),r},exportFileMaterialise:function(e,t,r,n){if(!t.isAborted){var i=new FormData;i.append("file",n,"yourMesh.zip"),r.setMessage("Materialise upload..."),t.send(i)}}};const Ia=Oa;var Fa={};Fa.exportOBJ=ga.exportOBJ,Fa.exportSGL=Fi.exportSGL,Fa.exportAsciiPLY=ya.exportAsciiPLY,Fa.exportBinaryPLY=ya.exportBinaryPLY,Fa.exportAsciiSTL=Ta.exportAsciiSTL,Fa.exportBinarySTL=Ta.exportBinarySTL,Fa.exportGLB=Ma.exportGLB,Fa.exportSketchfab=Ca.exportSketchfab,Fa.exportSculpteo=Da.exportSculpteo,Fa.exportMaterialise=Ia.exportMaterialise;const La=Fa;var Va={_gl:null,_checkRTT:{},_webGLExtensions:{}};Va.HALF_FLOAT=Va.HALF_FLOAT_OES=36193,Va.checkRTTSupport=function(e,t){var r=Va._gl;if(void 0===r)return!1;var n=e+","+t;if(void 0!==Va._checkRTT[n])return Va._checkRTT[n];var i=r.createTexture();r.bindTexture(r.TEXTURE_2D,i),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,2,2,0,r.RGBA,e,null),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,t),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,t);var a=r.createFramebuffer();r.bindFramebuffer(r.FRAMEBUFFER,a),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,i,0);var o=Va._checkRTT[n]=r.checkFramebufferStatus(r.FRAMEBUFFER)===r.FRAMEBUFFER_COMPLETE;return r.deleteTexture(i),r.deleteFramebuffer(a),r.bindTexture(r.TEXTURE_2D,null),r.bindFramebuffer(r.FRAMEBUFFER,null),o},Va.hasRTTLinearHalfFloat=function(){return Va._webGLExtensions.OES_texture_half_float_linear&&Va.checkRTTSupport(Va.HALF_FLOAT,Va._gl.LINEAR)},Va.hasRTTLinearFloat=function(){return Va._webGLExtensions.OES_texture_float_linear&&Va.checkRTTSupport(Va._gl.FLOAT,Va._gl.LINEAR)},Va.hasRTTHalfFloat=function(){return Va._webGLExtensions.OES_texture_half_float&&Va.checkRTTSupport(Va.HALF_FLOAT,Va._gl.NEAREST)},Va.hasRTTFloat=function(){return Va._webGLExtensions.OES_texture_float&&Va.checkRTTSupport(Va._gl.FLOAT,Va._gl.NEAREST)},Va.getWebGLExtension=function(e){return Va._webGLExtensions[e]},Va.getWebGLExtensions=function(){return Va._webGLExtensions},Va.initWebGLExtensions=function(e){Va._gl=e;for(var t=e.getSupportedExtensions(),r=Va._webGLExtensions,n=0,i=t.length;n<i;++n){var a=t[n];r[a]=e.getExtension(a)}};const Na=Va;function Ba(e){return Ba="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ba(e)}function Ua(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ja(n.key),n)}}function ja(e){var t=function(e){if("object"!=Ba(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ba(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ba(t)?t:t+""}var Ga;const Wa=function(){function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t.createRenderbuffer(),i=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._gl=t,this._texture=t.createTexture(),this._depth=n,this._framebuffer=t.createFramebuffer(),this._shaderType=r,this._invSize=new Float32Array(2),this._vertexBuffer=null,i&&Na.hasRTTHalfFloat()?this._type=Na.HALF_FLOAT_OES:i&&Na.hasRTTFloat()?this._type=t.FLOAT:this._type=t.UNSIGNED_BYTE,this.setWrapRepeat(!1),this.setFilterNearest(!1),this.init()}var t,r;return t=e,(r=[{key:"getGL",value:function(){return this._gl}},{key:"getVertexBuffer",value:function(){return this._vertexBuffer}},{key:"getFramebuffer",value:function(){return this._framebuffer}},{key:"getTexture",value:function(){return this._texture}},{key:"getDepth",value:function(){return this._depth}},{key:"getInverseSize",value:function(){return this._invSize}},{key:"init",value:function(){var e=this._gl;Ga||(Ga=new ge(e,e.ARRAY_BUFFER,e.STATIC_DRAW)).update(new Float32Array([-1,-1,4,-1,-1,4])),this._vertexBuffer=Ga}},{key:"setWrapRepeat",value:function(e){this._wrapRepeat=e}},{key:"setFilterNearest",value:function(e){this._filterNearest=e}},{key:"onResize",value:function(e,t){var r=this._gl;this._invSize[0]=1/e,this._invSize[1]=1/t,r.bindTexture(r.TEXTURE_2D,this._texture),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,e,t,0,r.RGBA,this._type,null);var n=this._filterNearest?r.NEAREST:r.LINEAR;r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MAG_FILTER,n),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_MIN_FILTER,n);var i=this._wrapRepeat?r.REPEAT:r.CLAMP_TO_EDGE;r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_S,i),r.texParameteri(r.TEXTURE_2D,r.TEXTURE_WRAP_T,i),this._depth&&(r.bindRenderbuffer(r.RENDERBUFFER,this._depth),r.renderbufferStorage(r.RENDERBUFFER,r.DEPTH_STENCIL,e,t)),r.bindFramebuffer(r.FRAMEBUFFER,this._framebuffer),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,this._texture,0),r.framebufferRenderbuffer(r.FRAMEBUFFER,r.DEPTH_STENCIL_ATTACHMENT,r.RENDERBUFFER,this._depth),r.bindTexture(r.TEXTURE_2D,null)}},{key:"release",value:function(){this._texture&&this._gl.deleteTexture(this._texture),this.getVertexBuffer().release()}},{key:"render",value:function(e){fe[this._shaderType].getOrCreate(this._gl).draw(this,e)}}])&&Ua(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function za(e){return za="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},za(e)}function Xa(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ka(n.key),n)}}function Ka(e){var t=function(e){if("object"!=za(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=za(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==za(t)?t:t+""}const Ha=function(){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._main=r._main,this._ctrlGui=r,this._menu=null,this._parent=e,this._exportAll=!0,this._objColorZbrush=!0,this._objColorAppended=!1,this.init(e)}var r,n;return r=t,(n=[{key:"init",value:function(e){var t=this._menu=e.addMenu((0,N.A)("fileTitle"));t.addTitle((0,N.A)("fileImportTitle")),t.addButton((0,N.A)("fileAdd"),this,"addFile"),t.addCheckbox((0,N.A)("fileAutoMatrix"),this._main,"_autoMatrix"),t.addCheckbox((0,N.A)("fileVertexSRGB"),this._main,"_vertexSRGB"),t.addTitle((0,N.A)("fileExportSceneTitle")),t.addCheckbox((0,N.A)("fileExportAll"),this,"_exportAll"),t.addButton((0,N.A)("fileExportSGL"),this,"saveFileAsSGL"),t.addButton((0,N.A)("fileExportOBJ"),this,"saveFileAsOBJ"),t.addButton((0,N.A)("fileExportPLY"),this,"saveFileAsPLY"),t.addButton((0,N.A)("fileExportSTL"),this,"saveFileAsSTL"),t.addCheckbox("OBJ color zbrush",this,"_objColorZbrush"),t.addCheckbox("OBJ color append",this,"_objColorAppended"),t.addButton((0,N.A)("sketchfabTitle"),this._ctrlGui,"exportSketchfab"),t.addTitle((0,N.A)("fileExportTextureTitle")),this._guiTexSize=t.addSlider((0,N.A)("fileExportTextureSize"),10,this.onTextureSize.bind(this),8,12,1),this._guiTexSize.setValue(10),t.addButton((0,N.A)("fileExportColor"),this,"saveColor"),t.addButton((0,N.A)("fileExportRoughness"),this,"saveRoughness"),t.addButton((0,N.A)("fileExportMetalness"),this,"saveMetalness")}},{key:"addFile",value:function(){document.getElementById("fileopen").click()}},{key:"onTextureSize",value:function(e){this._texSize=1<<e,this._guiTexSize.domInputText.value=this._texSize}},{key:"_getExportMeshes",value:function(){if(this._exportAll)return this._main.getMeshes();var e=this._main.getSelectedMeshes();return e.length?e:void 0}},{key:"_extractTexture",value:function(e,t,r){var n=document.createElement("canvas");n.width=t,n.height=r;var i=new Uint8Array(4*t*r);if(e.checkFramebufferStatus(e.FRAMEBUFFER)!==e.FRAMEBUFFER_COMPLETE)return console.error("FRAMEBUFFER not complete"),n;e.flush(),e.finish(),e.readPixels(0,0,t,r,e.RGBA,e.UNSIGNED_BYTE,i);var a=n.getContext("2d"),o=a.getImageData(0,0,t,r);return o.data.set(i),a.putImageData(o,0,0),n}},{key:"_getRttPaint",value:function(t){return this._rttPaint||(this._rttPaint=new Wa(t,e.A.Shader.PAINTUV,null),this._rttPaint.setWrapRepeat(!0),this._rttPaint.setFilterNearest(!0),ce.INPUT_TEXTURE=this._getRttPaint()),this._rttPaint}},{key:"_getRttBlur",value:function(t){return this._rttBlur||(this._rttBlur=new Wa(t,e.A.Shader.BLUR,null)),this._rttBlur}},{key:"_saveTexture",value:function(t){var r=this._main.getMesh();if(r)if(r.getTexCoords()){var n=r.getGL(),i=this._texSize,a=this._texSize,o=r.getShaderType();r.setShaderType(e.A.Shader.PAINTUV);var s=this._getRttPaint(n);s.onResize(i,a),n.bindFramebuffer(n.FRAMEBUFFER,s.getFramebuffer()),n.clear(n.COLOR_BUFFER_BIT),n.viewport(0,0,i,a),r.render(),r.setShaderType(o),this._blurImage(n,i,a),this._extractTexture(n,i,a).toBlob(function(e){(0,fa.saveAs)(e,t+".png")}.bind(this)),this._main.onCanvasResize()}else window.alert("The selected mesh has no UV!")}},{key:"_blurImage",value:function(e,t,r){var n=this._getRttBlur(e);n.onResize(t,r),e.bindFramebuffer(e.FRAMEBUFFER,n.getFramebuffer()),e.clear(e.COLOR_BUFFER_BIT),n.render(this._main)}},{key:"saveColor",value:function(){le.CHANNEL_VALUE=0,this._saveTexture("diffuse")}},{key:"saveRoughness",value:function(){le.CHANNEL_VALUE=1,this._saveTexture("roughness")}},{key:"saveMetalness",value:function(){le.CHANNEL_VALUE=2,this._saveTexture("metalness")}},{key:"saveFileAsSGL",value:function(){var e=this._getExportMeshes();e&&this._save(La.exportSGL(e,this._main),"yourMesh.sgl")}},{key:"saveFileAsOBJ",value:function(){var e=this._getExportMeshes();e&&this._save(La.exportOBJ(e,this._objColorZbrush,this._objColorAppended),"yourMesh.obj")}},{key:"saveFileAsPLY",value:function(){var e=this._getExportMeshes();e&&this._save(La.exportBinaryPLY(e),"yourMesh.ply")}},{key:"saveFileAsSTL",value:function(){var e=this._getExportMeshes();e&&this._save(La.exportBinarySTL(e),"yourMesh.stl")}},{key:"_save",value:function(e,t,r){if(!r)return(0,fa.saveAs)(e,t);da.zip.useWebWorkers=!0,da.zip.workerScriptsPath="worker/",da.zip.createWriter(new da.zip.BlobWriter("application/zip"),function(r){r.add(t,new da.zip.BlobReader(e),function(){r.close(function(e){(0,fa.saveAs)(e,"yourMesh.zip")})})},onerror)}},{key:"onKeyDown",value:function(e){if(!0!==e.handled){e.stopPropagation(),this._main._focusGui||e.preventDefault();var t=e.which;e.ctrlKey&&e.altKey&&78===t?(this._main.clearScene(),e.handled=!0):!e.ctrlKey||79!==t&&73!==t?e.ctrlKey&&69===t&&(this.saveFileAsOBJ(),e.handled=!0):(this.addFile(),e.handled=!0)}}}])&&Xa(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();function Ya(e){return Ya="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ya(e)}function qa(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function Za(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var a=e.apply(t,r);function o(e){qa(a,n,i,o,s,"next",e)}function s(e){qa(a,n,i,o,s,"throw",e)}o(void 0)})}}function Ja(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Qa(n.key),n)}}function Qa(e){var t=function(e){if("object"!=Ya(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ya(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ya(t)?t:t+""}const $a=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._menu=null,this._gui=r,this._main=r._main,this._pm=this._main.getPluginManager&&this._main.getPluginManager(),this.init(t)}var t,r,n,i;return t=e,r=[{key:"init",value:function(e){var t=this._menu=e.addMenu("Add-ons");t.addTitle("Instalar"),t.addButton("Desde URL (ESM)",this,"installFromUrl"),t.addButton("Desde archivo (.js)",this,"installFromFile"),t.addSeparator&&t.addSeparator(),t.addTitle("Gestionar"),t.addButton("Administrar plugins",this,"openManager")}},{key:"_ensurePluginManager",value:function(){return this._pm=this._main.getPluginManager&&this._main.getPluginManager(),this._pm}},{key:"installFromUrl",value:(i=Za(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._ensurePluginManager()){e.next=3;break}return e.abrupt("return");case 3:if(r=window.prompt("URL del plugin (ES module con CORS o script que exponga window.SculptGLPlugin):")){e.next=6;break}return e.abrupt("return");case 6:return e.prev=6,e.next=9,t.installFromUrl(r);case 9:window.alert("Plugin instalado. Si el plugin no aparece, revisa CORS/URL. Queda guardado para prximos inicios."),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(6),console.error(e.t0),window.alert("No se pudo instalar el plugin desde URL. Verific que sea ES module con CORS o defina window.SculptGLPlugin.");case 16:this.openManager();case 17:case"end":return e.stop()}},e,this,[[6,12]])})),function(){return i.apply(this,arguments)})},{key:"installFromFile",value:(n=Za(regeneratorRuntime.mark(function e(){var t,r,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this._ensurePluginManager()){e.next=3;break}return e.abrupt("return");case 3:(r=document.createElement("input")).type="file",r.accept=".js,.mjs,text/javascript,application/javascript",r.style.display="none",document.body.appendChild(r),r.onchange=Za(regeneratorRuntime.mark(function e(){var i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=r.files&&r.files[0],document.body.removeChild(r),i){e.next=4;break}return e.abrupt("return");case 4:return e.prev=4,e.next=7,t.installFromFile(i);case 7:window.alert("Plugin instalado desde archivo. Queda guardado para prximos inicios."),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(4),console.error(e.t0),window.alert("No se pudo instalar el plugin desde archivo. Asegurate de exportar default o definir window.SculptGLPlugin.");case 14:n.openManager();case 15:case"end":return e.stop()}},e,null,[[4,10]])})),r.click();case 10:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"openManager",value:function(){var e=this._ensurePluginManager();e&&__webpack_require__(952).A.open(e)}}],r&&Ja(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function eo(e){return eo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eo(e)}function to(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,ro(n.key),n)}}function ro(e){var t=function(e){if("object"!=eo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=eo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==eo(t)?t:t+""}const no=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._main=r._main,this.domVerts=null,this.domFaces=null,this.domUl=null,this.init(t)}var t,r;return t=e,(r=[{key:"init",value:function(e){this.domVerts=document.createElement("ul"),this.domVerts.innerHTML=(0,N.A)("meshNbVertices"),this.domFaces=document.createElement("ul"),this.domFaces.innerHTML=(0,N.A)("meshNbFaces"),this.domUl=document.createElement("span"),this.domUl.appendChild(this.domVerts),this.domUl.appendChild(this.domFaces);var t=this.domUl.style;t.cursor="default",void 0===t.float?t.cssFloat="right":t.float="right",e.domTopbar.appendChild(this.domUl)}},{key:"updateMeshInfo",value:function(){var e=this._main.getMesh();this.domVerts.innerHTML=(0,N.A)("meshNbVertices")+(e?e.getNbVertices():0),this.domFaces.innerHTML=(0,N.A)("meshNbFaces")+(e?e.getNbFaces():0)}}])&&to(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();var io,ao,oo,so,lo,uo={_mesh:null,_linear:!1,_verticesMap:new Map,_states:null,_center:[0,0,0],_radius2:0,_edgeMax2:0},co=function(e,r,n,i,a){var o=uo._mesh,s=o.getVerticesRingVert(),l=o.getVerticesRingFace(),u=o.getFacePosInLeaf(),c=o.getFaceLeaf(),h=o.getFacesStateFlags(),f=o.getFaces(),d=4*e;f[d]=r,f[d+1]=a,f[d+2]=i,f[d+3]=t.A.TRI_INDEX;var p=c[e],_=p._iFaces;s[a].push(i),s[i].push(a);var g=o.getNbTriangles();l[a].push(e,g),f[d=4*g]=a,f[d+1]=n,f[d+2]=i,f[d+3]=t.A.TRI_INDEX,h[g]=t.A.STATE_FLAG,c[g]=p,u[g]=_.length,l[i].push(g),t.A.replaceElement(l[n],e,g),_.push(g),o.addNbFace(1)},ho=function(e){for(var r=uo._mesh,n=r.getVerticesRingVert(),i=r.getFaces(),a=e.length,o=new Uint32Array(t.A.getMemory(8*a),0,2*a),s=0,l=uo._verticesMap,u=0;u<a;++u){var c=e[u],h=4*c,f=i[h],d=i[h+1],p=i[h+2],_=l.get(Math.min(f,d)+"+"+Math.max(f,d)),g=l.get(Math.min(d,p)+"+"+Math.max(d,p)),m=l.get(Math.min(f,p)+"+"+Math.max(f,p)),v=n[f].length,y=n[d].length,b=n[p].length,A=0;if(_?A=g?m?v<y&&v<b?2:y<b?3:1:v<b?2:1:m&&y<b?3:1:g?A=m&&y<v?3:2:m&&(A=3),1===A)co(c,f,d,p,_);else if(2===A)co(c,d,p,f,g);else{if(3!==A)continue;co(c,p,f,d,m)}o[s++]=c,o[s++]=r.getNbTriangles()-1}return new Uint32Array(o.subarray(0,s))},fo=function(e,r,n,i){var a=uo._mesh,o=a.getVertices(),s=a.getNormals(),l=a.getColors(),u=a.getMaterials(),c=a.getFaces(),h=a.getFacePosInLeaf(),f=a.getFaceLeaf(),d=a.getVerticesRingVert(),p=a.getVerticesRingFace(),_=a.getFacesStateFlags(),g=a.getVerticesStateFlags(),m=uo._verticesMap,v=Math.min(r,n)+"+"+Math.max(r,n),y=!1,b=m.get(v);void 0===b&&(b=a.getNbVertices(),y=!0,m.set(v,b)),d[i].push(b);var A=4*e;c[A]=r,c[A+1]=b,c[A+2]=i,c[A+3]=t.A.TRI_INDEX;var T=a.getNbTriangles();c[A=4*T]=b,c[A+1]=n,c[A+2]=i,c[A+3]=t.A.TRI_INDEX,_[T]=t.A.STATE_FLAG,p[i].push(T),t.A.replaceElement(p[n],e,T);var S=f[e],w=S._iFaces;if(f[T]=S,h[T]=w.length,w.push(T),!y)return d[b].push(i),p[b].push(e,T),void a.addNbFace(1);var M=3*r,k=o[M],E=o[M+1],x=o[M+2],R=s[M],C=s[M+1],P=s[M+2],D=3*n,O=o[D],I=o[D+1],F=o[D+2],L=s[D],V=s[D+1],N=s[D+2],B=R+L,U=C+V,j=P+N;if(s[A=3*b]=.5*B,s[A+1]=.5*U,s[A+2]=.5*j,l[A]=.5*(l[M]+l[D]),l[A+1]=.5*(l[M+1]+l[D+1]),l[A+2]=.5*(l[M+2]+l[D+2]),u[A]=.5*(u[M]+u[D]),u[A+1]=.5*(u[M+1]+u[D+1]),u[A+2]=.5*(u[M+2]+u[D+2]),uo._linear)o[A]=.5*(k+O),o[A+1]=.5*(E+I),o[A+2]=.5*(x+F);else{var G=R*R+C*C+P*P;0===G?R=1:(R*=G=1/Math.sqrt(G),C*=G,P*=G),0===(G=L*L+V*V+N*N)?L=1:(L*=G=1/Math.sqrt(G),V*=G,N*=G);var W=R*L+C*V+P*N,z=k-O,X=E-I,K=x-F,H=.12*(W<=-1?Math.PI:W>=1?0:Math.acos(W));H*=Math.sqrt(z*z+X*X+K*K),(G=B*B+U*U+j*j)>0&&(H/=Math.sqrt(G)),z*(R-L)+X*(C-V)+K*(P-N)<0&&(H=-H),o[A]=.5*(k+O)+B*H,o[A+1]=.5*(E+I)+U*H,o[A+2]=.5*(x+F)+j*H}g[b]=t.A.STATE_FLAG,d[b]=[r,n,i],p[b]=[e,T],t.A.replaceElement(d[r],n,b),t.A.replaceElement(d[n],r,b),a.addNbVertice(1),a.addNbFace(1)},po=(io=[0,0,0],ao=[0,0,0],oo=[0,0,0],so=Kt.A.triangleInsideSphere,lo=Kt.A.pointInsideTriangle,function(e,t){var r=uo._mesh,n=r.getVertices(),i=r.getFaces(),a=4*e,o=3*i[a],s=3*i[a+1],l=3*i[a+2];if(io[0]=n[o],io[1]=n[o+1],io[2]=n[o+2],ao[0]=n[s],ao[1]=n[s+1],ao[2]=n[s+2],oo[0]=n[l],oo[1]=n[l+1],oo[2]=n[l+2],t&&!so(uo._center,uo._radius2,io,ao,oo)&&!lo(uo._center,io,ao,oo))return 0;var u=r.getMaterials(),h=u[o+2],f=u[s+2],d=u[l+2],p=c.lo(io,ao),_=c.lo(ao,oo),g=c.lo(io,oo);return p>_&&p>g?.5*(h+f)*p>uo._edgeMax2?1:0:_>g?.5*(f+d)*_>uo._edgeMax2?2:0:.5*(h+d)*g>uo._edgeMax2?3:0}),_o=function(e){var r=uo._mesh,n=r.getNbVertices(),i=r.getNbTriangles();uo._verticesMap=new Map;var a=function(e){for(var r=e.length,n=t.A.getMemory(5*r),i=new Uint32Array(n,0,r),a=new Uint8Array(n,4*r,r),o=0,s=0;s<r;++s){var l=e[s],u=po(l,!0);0!==u&&(a[o]=u,i[o++]=l)}return[new Uint32Array(i.subarray(0,o)),new Uint8Array(a.subarray(0,o))]}(e),o=a[0],s=a[1];o.length>5&&(o=r.expandsFaces(o,3),(s=new Uint8Array(o.length)).set(a[1])),uo._states.pushVertices(r.getVerticesFromFaces(o)),uo._states.pushFaces(o),r.reAllocateArrays(s.length),function(e,t){for(var r=uo._mesh.getFaces(),n=e.length,i=0;i<n;++i){var a=e[i],o=t[i];0===o&&(o=po(a));var s=4*a;1===o?fo(a,r[s],r[s+1],r[s+2]):2===o?fo(a,r[s+1],r[s+2],r[s]):3===o&&fo(a,r[s+2],r[s],r[s+1])}}(o,s);var l=0,u=r.getNbTriangles()-i,c=new Uint32Array(u);for(l=0;l<u;++l)c[l]=i+l;o=(c=r.expandsFaces(c,1)).subarray(u),uo._states.pushVertices(r.getVerticesFromFaces(o)),uo._states.pushFaces(o);var h=e,f=e.length;(e=new Uint32Array(f+c.length)).set(h),e.set(c,f);var d=r.getFacesTagFlags(),p=e.length,_=new Uint32Array(t.A.getMemory(4*p),0,p),g=0,m=++t.A.TAG_FLAG;for(l=0;l<p;++l){var v=e[l];d[v]!==m&&(d[v]=m,_[g++]=v)}_=new Uint32Array(_.subarray(0,g));for(var y=r.getNbTriangles();c.length>0;)r.reAllocateArrays(c.length),c=ho(c);for(u=r.getNbTriangles()-y,h=_,(_=new Uint32Array(g+u)).set(h),l=0;l<u;++l)_[g+l]=y+l;var b=r.getNbVertices()-n,A=new Uint32Array(b);for(l=0;l<b;++l)A[l]=n+l;if(A=r.expandsVertices(A,1),!uo._linear){var T=A.subarray(b),S=new lr;S.setToolMesh(r),S.smoothTangent(T,1)}var w=r.getVertices(),M=r.getVerticesSculptFlags(),k=uo._center,E=k[0],x=k[1],R=k[2],C=t.A.SCULPT_FLAG;for(b=A.length,l=0;l<b;++l){var P=A[l],D=3*P,O=w[D]-E,I=w[D+1]-x,F=w[D+2]-R;M[P]=O*O+I*I+F*F<uo._radius2?C:C-1}return _};const go={subdivision:function(e,t,r,n,i,a,o){uo._mesh=e,uo._linear=o,c.C(uo._center,r),uo._radius2=n,uo._edgeMax2=i,uo._states=a;for(var s=0;s!==e.getNbTriangles();)s=e.getNbTriangles(),t=_o(t);return t}};var mo={_mesh:null,_states:null,_iTrisToDelete:[],_iVertsToDelete:[],_iVertsDecimated:[]},vo=function(e,t){return e-t},yo=function(e){var r=mo._mesh,n=r.getVerticesRingFace(),i=r.getFacesTagFlags(),a=r.getFaces(),o=r.getFacePosInLeaf(),s=r.getFaceLeaf(),l=r.getFacesStateFlags(),u=o[e],c=s[e]._iFaces,h=c[c.length-1];e!==h&&(c[u]=h,o[h]=u),c.pop();var f=r.getNbTriangles()-1;if(f!==e){var d=4*f,p=a[d],_=a[d+1],g=a[d+2];mo._states.pushVertices([p,_,g]),mo._states.pushFaces([f]),t.A.replaceElement(n[p],f,e),t.A.replaceElement(n[_],f,e),t.A.replaceElement(n[g],f,e);var m=s[f],v=o[f];m._iFaces[v]=e,s[e]=m,o[e]=v,i[e]=i[f],l[e]=l[f],a[e*=4]=p,a[e+1]=_,a[e+2]=g,a[e+3]=t.A.TRI_INDEX,mo._iVertsDecimated.push(p,_,g),r.addNbFace(-1)}else r.addNbFace(-1)},bo=function(e){var r=mo._mesh,n=r.getVerticesRingVert(),i=r.getVerticesRingFace(),a=r.getVertices(),o=r.getNormals(),s=r.getColors(),l=r.getMaterials(),u=r.getFaces(),c=r.getVerticesTagFlags(),h=r.getVerticesStateFlags(),f=r.getVerticesSculptFlags(),d=r.getNbVertices()-1;if(e!==d){var p=0,_=mo._states;_.pushVertices([d]);var g=i[d],m=n[d],v=g.length,y=m.length,b=0;for(b=0;b<v;++b)p=g[b],_.pushFaces([p]),u[p*=4]===d?u[p]=e:u[p+1]===d?u[p+1]=e:u[p+2]=e;for(b=0;b<y;++b)p=m[b],_.pushVertices([p]),t.A.replaceElement(n[p],d,e);n[e]=n[d].slice(),i[e]=i[d].slice(),c[e]=c[d],h[e]=h[d],f[e]=f[d];var A=3*d;a[p=3*e]=a[A],a[p+1]=a[A+1],a[p+2]=a[A+2],o[p]=o[A],o[p+1]=o[A+1],o[p+2]=o[A+2],s[p]=s[A],s[p+1]=s[A+1],s[p+2]=s[A+2],l[p]=l[A],l[p+1]=l[A+1],l[p+2]=l[A+2],r.addNbVertice(-1)}else r.addNbVertice(-1)},Ao=function(e,r,n,i,a,o,s){var l=mo._mesh,u=l.getVertices(),c=l.getNormals(),h=l.getColors(),f=l.getMaterials(),d=l.getFaces(),p=l.getVerticesTagFlags(),_=l.getFacesTagFlags(),g=l.getVerticesRingVert(),m=l.getVerticesRingFace(),v=g[n],y=g[i],b=m[n],A=m[i];if(v.length===b.length&&y.length===A.length){var T=g[a],S=g[o],w=m[a],M=m[o];if(T.length===w.length&&S.length===M.length){mo._iVertsDecimated.push(n,i),mo._states.pushVertices(v),mo._states.pushVertices(y),mo._states.pushFaces(b),mo._states.pushFaces(A),v.sort(vo),y.sort(vo);var k=0;if(t.A.intersectionArrays(v,y).length>=3)return t.A.removeElement(b,r),t.A.removeElement(A,e),w.push(r),M.push(e),d[k=4*e]===i?d[k]=o:d[k+1]===i?d[k+1]=o:d[k+2]=o,d[k=4*r]===n?d[k]=a:d[k+1]===n?d[k+1]=a:d[k+2]=a,l.computeRingVertices(n),l.computeRingVertices(i),l.computeRingVertices(a),void l.computeRingVertices(o);var E=3*i,x=c[k=3*n]+c[E],R=c[k+1]+c[E+1],C=c[k+2]+c[E+2],P=x*x+R*R+C*C;0===P?x=1:(x*=P=1/Math.sqrt(P),R*=P,C*=P),c[k]=x,c[k+1]=R,c[k+2]=C,h[k]=.5*(h[k]+h[E]),h[k+1]=.5*(h[k+1]+h[E+1]),h[k+2]=.5*(h[k+2]+h[E+2]),f[k]=.5*(f[k]+f[E]),f[k+1]=.5*(f[k+1]+f[E+1]),f[k+2]=.5*(f[k+2]+f[E+2]),t.A.removeElement(b,e),t.A.removeElement(b,r),t.A.removeElement(A,e),t.A.removeElement(A,r),t.A.removeElement(w,e),t.A.removeElement(M,r);var D=A.length,O=0;for(O=0;O<D;++O){var I=A[O];b.push(I);var F=4*I;d[F]===i?d[F]=n:d[F+1]===i?d[F+1]=n:d[F+2]=n}for(D=y.length,O=0;O<D;++O)v.push(y[O]);l.computeRingVertices(n);var L=0,V=0,N=0,B=v.length;for(O=0;O<B;++O){var U=v[O];l.computeRingVertices(U),L+=u[U*=3],V+=u[U+1],N+=u[U+2]}V/=B,N/=B;var j=x*((L/=B)-u[k])+R*(V-u[k+1])+C*(N-u[k+2]);for(u[k]=L-x*j,u[k+1]=V-R*j,u[k+2]=N-C*j,p[i]=_[e]=_[r]=-1,mo._iVertsToDelete.push(i),mo._iTrisToDelete.push(e,r),D=b.length,O=0;O<D;++O)s.push(b[O])}}},To=function(e,t,r){if(-1!==t){var n=mo._mesh.getFaces(),i=4*e,a=n[i],o=n[i+1],s=n[i+2],l=n[i=4*t],u=n[i+1],c=n[i+2];a===l?o===c?Ao(e,t,a,o,s,u,r):Ao(e,t,a,s,o,c,r):a===u?o===l?Ao(e,t,a,o,s,c,r):Ao(e,t,a,s,o,l,r):a===c?o===u?Ao(e,t,a,o,s,l,r):Ao(e,t,a,s,o,u,r):Ao(e,t,s,o,a,o===l?u:o===u?c:l,r)}},So=function(e,r,n){var i=mo._mesh.getVerticesRingFace(),a=i[r],o=i[n];a.sort(vo),o.sort(vo);var s=t.A.intersectionArrays(a,o);return 2!==s.length?-1:s[0]===e?s[1]:s[0]},wo={decimation:function(e,r,n,i,a,o){mo._mesh=e,mo._states=o,mo._iVertsDecimated.length=0,mo._iTrisToDelete.length=0,mo._iVertsToDelete.length=0;var s=Math.sqrt(i),l=e.getFacesTagFlags(),u=e.getVertices(),c=e.getMaterials(),h=e.getFaces(),f=n[0],d=n[1],p=n[2],_=0,g=r.length,m=new Array(g);for(_=0;_<g;++_)m[_]=r[_];for(_=0;_<m.length;++_){var v=m[_];if(!(l[v]<0)){var y=4*v,b=h[y],A=h[y+1],T=h[y+2],S=3*b,w=3*A,M=3*T,k=u[S],E=u[S+1],x=u[S+2],R=u[w],C=u[w+1],P=u[w+2],D=u[M],O=u[M+1],I=u[M+2],F=(k+R+D)/3-f,L=(E+C+O)/3-d,V=(x+P+I)/3-p,N=F*F+L*L+V*V;if(N<i)N=1;else{if(!(N<2*i))continue;var B=(N=(Math.sqrt(N)-s)/(s*Math.SQRT2-s))*N;N=3*B*B-4*B*N+1}var U=(F=R-k)*F+(L=C-E)*L+(V=P-x)*V,j=(F=R-D)*F+(L=C-O)*L+(V=P-I)*V,G=(F=k-D)*F+(L=E-O)*L+(V=x-I)*V,W=c[S+2],z=c[w+2],X=c[M+2];U<j&&U<G?U<a*N*(W+z)*.5&&To(v,So(v,b,A),m):j<G?j<a*N*(z+X)*.5&&To(v,So(v,A,T),m):G<a*N*(W+X)*.5&&To(v,So(v,b,T),m)}}return function(){var e=mo._iTrisToDelete;t.A.tidy(e);var r=0;for(r=e.length-1;r>=0;--r)yo(e[r]);var n=mo._iVertsToDelete;for(t.A.tidy(n),r=n.length-1;r>=0;--r)bo(n[r])}(),r=function(e,r){var n=mo._mesh,i=n.getFacesTagFlags(),a=n.getNbTriangles(),o=n.getFacesFromVertices(e),s=r,l=r.length;(r=new Uint32Array(l+o.length)).set(s),r.set(o,l);var u=++t.A.TAG_FLAG;l=r.length;for(var c=new Uint32Array(t.A.getMemory(4*l),0,l),h=0,f=0;f<l;++f){var d=r[f];d>=a||i[d]!==u&&(i[d]=u,c[h++]=d)}return new Uint32Array(c.subarray(0,h))}(function(){for(var e=mo._mesh,r=e.getVerticesTagFlags(),n=e.getNbVertices(),i=++t.A.TAG_FLAG,a=mo._iVertsDecimated,o=a.length,s=new Uint32Array(t.A.getMemory(4*o),0,o),l=0,u=0;u<o;++u){var c=a[u];c>=n||r[c]!==i&&(r[c]=i,s[l++]=c)}return new Uint32Array(s.subarray(0,l))}(),m),r}};const Mo=wo;function ko(e){return ko="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ko(e)}function Eo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,xo(n.key),n)}}function xo(e){var t=function(e){if("object"!=ko(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ko(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ko(t)?t:t+""}function Ro(){return Ro="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Do(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Ro.apply(null,arguments)}function Co(e,t){return Co=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Co(e,t)}function Po(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(Po=function(){return!!e})()}function Do(e){return Do=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Do(e)}var Oo=function(r){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Co(e,t)}(o,r);var n,i,a=function(e){var t=Po();return function(){var r,n=Do(e);if(t){var i=Do(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==ko(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,r)}}(o);function o(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),(t=a.call(this)).setID(e.getID()),t._meshData={_nbVertices:0,_nbFaces:0,_nbTexCoords:0,_verticesXYZ:null,_normalsXYZ:null,_colorsRGB:null,_materialsPBR:null,_vertOnEdge:null,_vertRingFace:null,_vrfStartCount:null,_vrvStartCount:null,_vertRingVert:null,_vertTagFlags:null,_vertSculptFlags:null,_vertStateFlags:null,_vertProxy:null,_facesABCD:null,_faceEdges:null,_faceNormalsXYZ:null,_facesToTriangles:null,_trianglesABC:null,_facesTagFlags:null,_edges:null,_drawArraysWireframe:null,_drawElementsWireframe:null,_texCoordsST:null,_duplicateStartCount:null,_UVfacesABCD:null,_UVtrianglesABC:null,_DAverticesXYZ:null,_DAnormalsXYZ:null,_DAcolorsRGB:null,_DAmaterialsPBR:null,_DAtexCoordsST:null,_octree:null,_faceBoxes:null,_faceCentersXYZ:null,_facePosInLeaf:null,_faceLeaf:[],_leavesToUpdate:[],_worldBound:[1/0,1/0,1/0,-1/0,-1/0,-1/0]},t.setRenderData(e.getRenderData()),t.setTransformData(e.getTransformData()),t._facesStateFlags=null,t._wireframe=null,t.initFromMesh(e),t.initRender(),t.isDynamic=!0,t}return n=o,i=[{key:"subdivide",value:function(e,t,r,n,i){return go.subdivision(this,e,t,r,n,i,o.LINEAR)}},{key:"decimate",value:function(e,t,r,n,i){return Mo.decimation(this,e,t,r,n,i)}},{key:"getSubdivisionFactor",value:function(){return.01*o.SUBDIVISION_FACTOR}},{key:"getDecimationFactor",value:function(){return.01*o.DECIMATION_FACTOR}},{key:"getVerticesProxy",value:function(){return this.getVertices()}},{key:"addNbVertice",value:function(e){this._meshData._nbVertices+=e}},{key:"getNbTriangles",value:function(){return this.getNbFaces()}},{key:"addNbFace",value:function(e){this._meshData._nbFaces+=e}},{key:"getNbEdges",value:function(){return 3*this.getNbTriangles()}},{key:"getFacesStateFlags",value:function(){return this._facesStateFlags}},{key:"allocateArrays",value:function(){Ro(Do(o.prototype),"allocateArrays",this).call(this),this._meshData._vertRingVert=[],this._meshData._vertRingFace=[],this._facesStateFlags=new Int32Array(this.getNbFaces())}},{key:"initFromMesh",value:function(t){var r=t.getNbVertices();this.setVertices(new Float32Array(t.getVertices().subarray(0,3*r))),this.setColors(new Float32Array(t.getColors().subarray(0,3*r))),this.setMaterials(new Float32Array(t.getMaterials().subarray(0,3*r))),this.setNbVertices(r),this.setFacesFromMesh(t),this.init(),t.isUsingTexCoords()&&this.setShaderType(e.A.Shader.MATCAP)}},{key:"setFacesFromMesh",value:function(e){this.setFaces(new Uint32Array(4*e.getNbTriangles())),this.setNbFaces(e.getNbTriangles());var r=e.getTriangles(),n=this.getNbTriangles(),i=this.getFaces();this._meshData._trianglesABC=new Uint32Array(r.subarray(0,3*n));for(var a=0;a<n;++a){var o=3*a,s=4*a;i[s]=r[o],i[s+1]=r[o+1],i[s+2]=r[o+2],i[s+3]=t.A.TRI_INDEX}}},{key:"updateTopology",value:function(e,t){this.updateRenderTriangles(e),this.updateVerticesOnEdge(t),this.getShowWireframe()&&this.updateWireframe(e),this.isUsingDrawArrays()&&this.updateDrawArrays(e)}},{key:"getWireframe",value:function(){return this._wireframe||(this._wireframe=new Uint32Array(2*this.getTriangles().length),this.updateWireframe()),this._wireframe}},{key:"setShowWireframe",value:function(e){this._wireframe=null,Ro(Do(o.prototype),"setShowWireframe",this).call(this,e)}},{key:"updateWireframe",value:function(e){for(var t=this._wireframe,r=this.getTriangles(),n=void 0===e,i=this.isUsingDrawArrays(),a=n?this.getNbTriangles():e.length,o=0;o<a;++o){var s=n?o:e[o],l=6*s,u=3*s;i?(t[l]=t[l+5]=u,t[l+1]=t[l+2]=u+2,t[l+3]=t[l+4]=u+1):(t[l]=t[l+5]=r[u],t[l+1]=t[l+2]=r[u+1],t[l+3]=t[l+4]=r[u+2])}}},{key:"updateRenderTriangles",value:function(e){for(var t=this.getTriangles(),r=this.getFaces(),n=void 0===e,i=n?this.getNbFaces():e.length,a=0;a<i;++a){var o=n?a:e[a],s=3*o,l=4*o;t[s]=r[l],t[s+1]=r[l+1],t[s+2]=r[l+2]}}},{key:"updateVerticesOnEdge",value:function(e){for(var t=this.getVerticesOnEdge(),r=this.getVerticesRingVert(),n=this.getVerticesRingFace(),i=void 0===e,a=i?this.getNbVertices():e.length,o=0;o<a;++o){var s=i?o:e[o];t[s]=r[s].length!==n[s].length?1:0}}},{key:"resizeArray",value:function(e,t){if(!e)return null;if(e.length>=t)return e.subarray(0,2*t);var r=new e.constructor(2*t);return r.set(e),r}},{key:"reAllocateArrays",value:function(e){var t=this._meshData,r=this._facesStateFlags.length,n=this.getNbTriangles(),i=n+e;(r<i||r>4*i)&&(this._facesStateFlags=this.resizeArray(this._facesStateFlags,i),this.getShowWireframe()&&(this._wireframe=this.resizeArray(this._wireframe,6*i)),t._facesABCD=this.resizeArray(t._facesABCD,4*i),t._trianglesABC=this.resizeArray(t._trianglesABC,3*i),t._faceBoxes=this.resizeArray(t._faceBoxes,6*i),t._faceNormalsXYZ=this.resizeArray(t._faceNormalsXYZ,3*i),t._faceCentersXYZ=this.resizeArray(t._faceCentersXYZ,3*i),t._facesTagFlags=this.resizeArray(t._facesTagFlags,i),t._facePosInLeaf=this.resizeArray(t._facePosInLeaf,i)),((r=t._verticesXYZ.length/3)<(i=this.getNbVertices()+e)||r>4*i)&&(t._verticesXYZ=this.resizeArray(t._verticesXYZ,3*i),t._normalsXYZ=this.resizeArray(t._normalsXYZ,3*i),t._colorsRGB=this.resizeArray(t._colorsRGB,3*i),t._materialsPBR=this.resizeArray(t._materialsPBR,3*i),t._vertOnEdge=this.resizeArray(t._vertOnEdge,i),t._vertTagFlags=this.resizeArray(t._vertTagFlags,i),t._vertSculptFlags=this.resizeArray(t._vertSculptFlags,i),t._vertStateFlags=this.resizeArray(t._vertStateFlags,i)),this.isUsingDrawArrays()&&((r=t._verticesXYZ.length/9)<(i=n+10*e)||r>4*i)&&(t._verticesXYZ=this.resizeArray(t._verticesXYZ,9*i),t._normalsXYZ=this.resizeArray(t._normalsXYZ,9*i),t._colorsRGB=this.resizeArray(t._colorsRGB,9*i),t._materialsPBR=this.resizeArray(t._materialsPBR,9*i))}},{key:"initTopology",value:function(){var e=this.getVerticesRingVert(),t=this.getVerticesRingFace(),r=0,n=this.getNbVertices();for(e.length=t.length=n,r=0;r<n;++r)e[r]=[],t[r]=[];var i=this.getNbTriangles(),a=this.getTriangles();for(r=0;r<i;++r){var o=3*r;t[a[o]].push(r),t[a[o+1]].push(r),t[a[o+2]].push(r)}var s=this.getVerticesOnEdge();for(r=0;r<n;++r)this.computeRingVertices(r),s[r]=t[r].length!==e[r].length?1:0}},{key:"computeRingVertices",value:function(e){var r=++t.A.TAG_FLAG,n=this.getFaces(),i=this.getVerticesTagFlags(),a=this._meshData._vertRingVert[e],o=this._meshData._vertRingFace[e];a.length=0;for(var s=o.length,l=0;l<s;++l){var u=4*o[l],c=n[u],h=n[u+1];c===e?c=n[u+2]:h===e&&(h=n[u+2]),i[c]!==r&&(i[c]=r,a.push(c)),i[h]!==r&&(i[h]=r,a.push(h))}}}],i&&Eo(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),o}(Se);Oo.SUBDIVISION_FACTOR=75,Oo.DECIMATION_FACTOR=0,Oo.LINEAR=!1;const Io=Oo;function Fo(e){return Fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fo(e)}function Lo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vo(n.key),n)}}function Vo(e){var t=function(e){if("object"!=Fo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Fo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Fo(t)?t:t+""}const No=function(){function e(t,r,n,i){switch(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._main=t,this._multimesh=r,this._mesh=r.getCurrentMesh(),this._type=n,n){case e.DELETE_LOWER:this._deletedMeshes=r._meshes.slice(0,r._sel);break;case e.DELETE_HIGHER:this._deletedMeshes=r._meshes.slice(r._sel+1),i||(this._vMappingState=this._mesh.getVerticesMapping());break;case e.SUBDIVISION:case e.REVERSION:i||(this._vArState=new Float32Array(this._mesh.getVertices()),this._cArState=new Float32Array(this._mesh.getColors()),this._mArState=new Float32Array(this._mesh.getMaterials()))}}var t,r,n;return t=e,n=[{key:"SUBDIVISION",get:function(){return 0}},{key:"REVERSION",get:function(){return 1}},{key:"SELECTION",get:function(){return 2}},{key:"DELETE_LOWER",get:function(){return 3}},{key:"DELETE_HIGHER",get:function(){return 4}}],(r=[{key:"isNoop",value:function(){return!1}},{key:"undo",value:function(){var t=this._multimesh;switch(this._type){case e.SELECTION:t.selectMesh(this._mesh);break;case e.DELETE_LOWER:Array.prototype.unshift.apply(t._meshes,this._deletedMeshes);break;case e.DELETE_HIGHER:Array.prototype.push.apply(t._meshes,this._deletedMeshes),this._mesh.setVerticesMapping(this._vMappingState);break;case e.SUBDIVISION:case e.REVERSION:var r=this._mesh.getNbVertices();this._mesh.setVertices(new Float32Array(this._vArState)),this._mesh.setColors(new Float32Array(this._cArState)),this._mesh.setMaterials(new Float32Array(this._mArState)),this._mesh.setNbVertices(r),this._type===e.SUBDIVISION?t.popMesh():t.shiftMesh()}t.setSelection(t.findIndexFromMesh(this._mesh)),this._main.setMesh(t)}},{key:"redo",value:function(){var t=this._multimesh;switch(this._type){case e.SELECTION:t.selectMesh(this._mesh);break;case e.DELETE_LOWER:t.deleteLower();break;case e.DELETE_HIGHER:t.deleteHigher();break;case e.SUBDIVISION:t.pushMesh(this._mesh);break;case e.REVERSION:t.unshiftMesh(this._mesh)}t.setSelection(t.findIndexFromMesh(this._mesh)),this._main.setMesh(t)}},{key:"createRedo",value:function(){return new e(this._main,this._multimesh,this._type,!0)}}])&&Lo(t.prototype,r),n&&Lo(t,n),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Bo(e){return Bo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bo(e)}function Uo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jo(n.key),n)}}function jo(e){var t=function(e){if("object"!=Bo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Bo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Bo(t)?t:t+""}const Go=function(){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._ctrlGui=r,this._main=r._main,this._menu=null,this._ctrlResolution=null,this._ctrlDynamic=null,this.init(e)}var r,n;return r=t,(n=[{key:"init",value:function(e){var t=this._menu=e.addMenu((0,N.A)("topologyTitle"));t.close(),t.addTitle((0,N.A)("multiresTitle")),this._ctrlResolution=t.addSlider((0,N.A)("multiresResolution"),1,this.onResolutionChanged.bind(this),1,1,1);var r=t.addDualButton((0,N.A)("multiresReverse"),(0,N.A)("multiresSubdivide"),this,this,"reverse","subdivide");this._ctrlReverse=r[0],this._ctrlSubdivide=r[1],r=this._dualButtonDel=t.addDualButton((0,N.A)("multiresDelLower"),(0,N.A)("multiresDelHigher"),this,this,"deleteLower","deleteHigher"),this._ctrlDelLower=r[0],this._ctrlDelHigher=r[1],this._ctrlDelLower.domButton.style.background=this._ctrlDelHigher.domButton.style.background="rgba(230,53,59,0.35)";var n=this.remeshResolution.bind(this);t.addTitle((0,N.A)("remeshTitle")),this._ctrlRes1=t.addSlider((0,N.A)("remeshResolution"),zn.RESOLUTION,n,8,400,1),t.addCheckbox((0,N.A)("remeshBlock"),zn,"BLOCK"),t.addButton((0,N.A)("remeshRemesh"),this,"remesh"),t.addTitle((0,N.A)("remeshTitleMC")),this._ctrlRes2=t.addSlider((0,N.A)("remeshResolution"),zn.RESOLUTION,n,8,400,1),t.addCheckbox((0,N.A)("remeshSmoothingMC"),zn,"SMOOTHING"),t.addButton((0,N.A)("remeshRemeshMC"),this,"remeshMC"),t.addTitle((0,N.A)("dynamicTitle")),this._ctrlDynamic=t.addCheckbox((0,N.A)("dynamicActivated"),!1,this.dynamicToggleActivate.bind(this)),this._ctrlDynSubd=t.addSlider((0,N.A)("dynamicSubdivision"),Io,"SUBDIVISION_FACTOR",0,100,1),this._ctrlDynDec=t.addSlider((0,N.A)("dynamicDecimation"),Io,"DECIMATION_FACTOR",0,100,1),this._ctrlDynLin=t.addCheckbox((0,N.A)("dynamicLinear"),Io,"LINEAR"),this.updateDynamicVisibility(!1)}},{key:"onKeyUp",value:function(t){if(!0!==t.handled){var r=T.A.getShortKey(t.which);t.stopPropagation(),r===e.A.KeyAction.REMESH&&this.remesh()}}},{key:"updateDynamicVisibility",value:function(e){this._ctrlDynSubd.setVisibility(e),this._ctrlDynDec.setVisibility(e),this._ctrlDynLin.setVisibility(e)}},{key:"dynamicToggleActivate",value:function(){var e=this._main,t=e.getMesh();if(t){var r=t.isDynamic?this.convertToStaticMesh(t):new Io(t);this.updateDynamicVisibility(!t.isDynamic),e.getStateManager().pushStateAddRemove(r,t),e.replaceMesh(t,r)}}},{key:"remeshResolution",value:function(e){zn.RESOLUTION=e,this._ctrlRes1.setValue(e,!0),this._ctrlRes2.setValue(e,!0)}},{key:"remesh",value:function(e){var t=this._main,r=t.getMesh();if(r){for(var n=r.isDynamic,i=t.getMeshes(),a=t.getSelectedMeshes().slice(),o=0,s=a.length;o<s;++o){var l=a[o];i.splice(t.getIndexMesh(l),1),a[o]=this.convertToStaticMesh(l),l===r&&(r=a[o])}var u=zn.remesh(a,r,e);n&&(u=new Io(u)),t.getStateManager().pushStateAddRemove(u,t.getSelectedMeshes().slice()),t.getMeshes().push(u),t.setMesh(u)}}},{key:"remeshMC",value:function(){this.remesh(!0)}},{key:"isMultimesh",value:function(e){return!(!e||!e._meshes)}},{key:"convertToStaticMesh",value:function(e){if(!e.isDynamic)return e;var t=new rn(e.getGL());return t.setID(e.getID()),t.setTransformData(e.getTransformData()),t.setVertices(e.getVertices().subarray(0,3*e.getNbVertices())),t.setColors(e.getColors().subarray(0,3*e.getNbVertices())),t.setMaterials(e.getMaterials().subarray(0,3*e.getNbVertices())),t.setFaces(e.getFaces().subarray(0,4*e.getNbFaces())),Se.OPTIMIZE=!1,t.init(),Se.OPTIMIZE=!0,t.setRenderData(e.getRenderData()),t.initRender(),t}},{key:"convertToMultimesh",value:function(e){return this.isMultimesh(e)?e:new ze(this.convertToStaticMesh(e))}},{key:"subdivide",value:function(){var e=this._main,t=e.getMesh();if(t){var r=this.convertToMultimesh(t);r._sel===r._meshes.length-1?r.getNbTriangles()>4e5&&!window.confirm((0,N.A)("multiresWarnBigMesh",4*r.getNbFaces()))||(t!==r&&(e.replaceMesh(t,r),e.getStateManager().pushStateAddRemove(r,t,!0)),e.getStateManager().pushState(new No(e,r,No.SUBDIVISION)),r.addLevel(),e.setMesh(r),e.render()):window.alert((0,N.A)("multiresSelectHighest"))}}},{key:"reverse",value:function(){var e=this._main,t=e.getMesh();if(t){var r=this.convertToMultimesh(t);if(0===r._sel){var n=new No(e,r,No.REVERSION);r.computeReverse()?(t!==r&&(e.replaceMesh(t,r),e.getStateManager().pushStateAddRemove(r,t,!0)),e.getStateManager().pushState(n),e.setMesh(r),e.render()):window.alert((0,N.A)("multiresNotReversible"))}else window.alert((0,N.A)("multiresSelectLowest"))}}},{key:"deleteLower",value:function(){var e=this._main,t=e._mesh;this.isMultimesh(t)&&0!==t._sel?(e.getStateManager().pushState(new No(e,t,No.DELETE_LOWER)),t.deleteLower(),this.updateMeshResolution()):window.alert((0,N.A)("multiresNoLower"))}},{key:"deleteHigher",value:function(){var e=this._main,t=e.getMesh();this.isMultimesh(t)&&t._sel!==t._meshes.length-1?(e.getStateManager().pushState(new No(e,t,No.DELETE_HIGHER)),t.deleteHigher(),this.updateMeshResolution()):window.alert((0,N.A)("multiresNoHigher"))}},{key:"onResolutionChanged",value:function(e){var t=e-1,r=this._main,n=r.getMesh();if(n){var i=this.isMultimesh(n),a=i&&n._meshes.length-1===t;this._ctrlReverse.setEnable(!i||0===t),this._ctrlSubdivide.setEnable(!i||a),this._ctrlDelLower.setEnable(i&&0!==t),this._ctrlDelHigher.setEnable(i&&!a),i&&n._sel!==t&&(r.getStateManager().pushState(new No(r,n,No.SELECTION)),n.selectResolution(t),this._ctrlGui.updateMeshInfo(),r.render())}}},{key:"updateMeshResolution",value:function(){var e=this._main.getMesh();if(!e||!this.isMultimesh(e))return this._ctrlResolution.setMax(1),void this._ctrlResolution.setValue(0);this._ctrlResolution.setMax(e._meshes.length),this._ctrlResolution.setValue(e._sel+1)}},{key:"updateMesh",value:function(){if(this._main.getMesh()){this._menu.setVisibility(!0),this.updateMeshResolution();var e=this._main.getMesh().isDynamic;this.updateDynamicVisibility(e),this._ctrlDynamic.setValue(e,!0)}else this._menu.setVisibility(!1)}}])&&Uo(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();function Wo(e){return Wo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Wo(e)}function zo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Xo(n.key),n)}}function Xo(e){var t=function(e){if("object"!=Wo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Wo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Wo(t)?t:t+""}var Ko=fe[e.A.Shader.MERGE],Ho=fe[e.A.Shader.UV],Yo=fe[e.A.Shader.PBR],qo=fe[e.A.Shader.MATCAP];const Zo=function(){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._main=r._main,this._menu=null,this._ctrlFlatShadizfng=null,this._ctrlShowWireframe=null,this._ctrlShaders=null,this._ctrlMatcap=null,this._ctrlUV=null,this.init(e)}var r,n;return r=t,(n=[{key:"init",value:function(t){var r=this._menu=t.addMenu((0,N.A)("renderingTitle"));r.close();var n=[];n[e.A.Shader.MATCAP]=(0,N.A)("renderingMatcap"),n[e.A.Shader.PBR]=(0,N.A)("renderingPBR"),n[e.A.Shader.NORMAL]=(0,N.A)("renderingNormal"),n[e.A.Shader.UV]=(0,N.A)("renderingUV"),r.addTitle((0,N.A)("renderingShader")),this._ctrlShaders=r.addCombobox("",e.A.Shader.MATCAP,this.onShaderChanged.bind(this),n),this._ctrlCurvature=r.addSlider((0,N.A)("renderingCurvature"),20,this.onCurvatureChanged.bind(this),0,100,1),this._ctrlFilmic=r.addCheckbox((0,N.A)("renderingFilmic"),Ko.FILMIC,this.onFilmic.bind(this));for(var i={},a=0,o=Yo.environments,s=o.length;a<s;++a)i[a]=o[a].name;this._ctrlEnvTitle=r.addTitle((0,N.A)("renderingEnvironment")),this._ctrlEnv=r.addCombobox("",Yo.idEnv,this.onEnvironmentChanged.bind(this),i);for(var l={},u=0,c=qo.matcaps,h=c.length;u<h;++u)l[u]=c[u].name;this._ctrlMatcapTitle=r.addTitle((0,N.A)("renderingMaterial")),this._ctrlMatcap=r.addCombobox((0,N.A)("renderingMatcap"),0,this.onMatcapChanged.bind(this),l),this._ctrlImportMatcap=r.addButton((0,N.A)("renderingImportMatcap"),this,"importMatcap"),this._ctrlUV=r.addButton((0,N.A)("renderingImportUV"),this,"importTexture"),this._ctrlExposure=r.addSlider((0,N.A)("renderingExposure"),1,this.onExposureChanged.bind(this),0,5,.001),this.onUpdateCtrlExposure(),r.addTitle((0,N.A)("renderingExtra")),this._ctrlTransparency=r.addSlider((0,N.A)("renderingTransparency"),0,this.onTransparencyChanged.bind(this),0,100,1),this._ctrlFlatShading=r.addCheckbox((0,N.A)("renderingFlat"),!1,this.onFlatShading.bind(this)),this._ctrlShowWireframe=r.addCheckbox((0,N.A)("renderingWireframe"),!1,this.onShowWireframe.bind(this)),ve.ONLY_DRAW_ARRAYS&&this._ctrlShowWireframe.setVisibility(!1),this.addEvents()}},{key:"onFilmic",value:function(e){Ko.FILMIC=e,this._main.render()}},{key:"onCurvatureChanged",value:function(e){this._main.getMesh()&&(this._main.getMesh().setCurvature(e/20),this._main.render())}},{key:"onEnvironmentChanged",value:function(e){Yo.idEnv=e,this.onUpdateCtrlExposure(),this._main.render()}},{key:"onUpdateCtrlExposure",value:function(){this._ctrlExposure.setValue(Yo.environments[Yo.idEnv].exposure)}},{key:"onExposureChanged",value:function(e){Yo.exposure=e,this._main.render()}},{key:"onTransparencyChanged",value:function(e){for(var t=this._main.getSelectedMeshes(),r=0,n=t.length;r<n;++r)t[r].setOpacity(1-e/100);this._main.render()}},{key:"onShaderChanged",value:function(t){for(var r=this._main,n=!1,i=this._main.getSelectedMeshes(),a=0,o=i.length;a<o;++a){var s=i[a];s&&(t!==e.A.Shader.UV||s.hasUV()?(s.setShaderType(t),r.render()):(n||window.alert("No UV on the mesh."),n=!0),n&&this.updateMesh())}this.updateVisibility()}},{key:"onMatcapChanged",value:function(t){for(var r=this._main.getSelectedMeshes(),n=0,i=r.length;n<i;++n){var a=r[n];a.getShaderType()!==e.A.Shader.MATCAP&&a.setShaderType(e.A.Shader.MATCAP),a.setMatcap(t)}this._main.render()}},{key:"onFlatShading",value:function(e){for(var t=this._main.getSelectedMeshes(),r=0,n=t.length;r<n;++r)t[r].setFlatShading(e);this._main.render()}},{key:"onShowWireframe",value:function(e){for(var t=this._main.getSelectedMeshes(),r=0,n=t.length;r<n;++r)t[r].setShowWireframe(e);this._main.render()}},{key:"addEvents",value:function(){var e=this.loadTextureUV.bind(this),t=this.loadMatcap.bind(this);document.getElementById("textureopen").addEventListener("change",e,!1),document.getElementById("matcapopen").addEventListener("change",t,!1),this.removeCallback=function(){document.getElementById("textureopen").removeEventListener("change",e,!1),document.getElementById("matcapopen").removeEventListener("change",t,!1)}}},{key:"removeEvents",value:function(){this.removeCallback&&this.removeCallback()}},{key:"updateMesh",value:function(){var e=this._main.getMesh();e?(this._menu.setVisibility(!0),this._ctrlShaders.setValue(e.getShaderType(),!0),this._ctrlFlatShading.setValue(e.getFlatShading(),!0),this._ctrlShowWireframe.setValue(e.getShowWireframe(),!0),this._ctrlMatcap.setValue(e.getMatcap(),!0),this._ctrlTransparency.setValue(100-100*e.getOpacity(),!0),this._ctrlCurvature.setValue(20*e.getCurvature(),!0),this.updateVisibility()):this._menu.setVisibility(!1)}},{key:"updateVisibility",value:function(){var t=this._main.getMesh();if(t){var r=t.getShaderType();this._ctrlMatcapTitle.setVisibility(r===e.A.Shader.MATCAP),this._ctrlMatcap.setVisibility(r===e.A.Shader.MATCAP),this._ctrlImportMatcap.setVisibility(r===e.A.Shader.MATCAP),this._ctrlExposure.setVisibility(r===e.A.Shader.PBR),this._ctrlEnvTitle.setVisibility(r===e.A.Shader.PBR),this._ctrlEnv.setVisibility(r===e.A.Shader.PBR),this._ctrlUV.setVisibility(r===e.A.Shader.UV)}}},{key:"getFlatShading",value:function(){return this._ctrlFlatShading.getValue()}},{key:"getWireframe",value:function(){return this._ctrlShowWireframe.getValue()}},{key:"getShaderName",value:function(){return this._ctrlShaders.getValue()}},{key:"importTexture",value:function(){document.getElementById("textureopen").click()}},{key:"loadTextureUV",value:function(e){if(0!==e.target.files.length){var t=e.target.files[0];if(t.type.match("image.*")){var r=new FileReader,n=this._main;r.onload=function(e){Ho.texture0=void 0,Ho.texPath=e.target.result,n.render()},document.getElementById("textureopen").value="",r.readAsDataURL(t)}}}},{key:"loadMatcap",value:function(e){if(0!==e.target.files.length){var t=e.target.files[0];if(t.type.match("image.*")){var r=new FileReader,n=this._main,i=this._ctrlMatcap;r.onload=function(e){var r=new Image;r.src=e.target.result,r.onload=function(){var e=qo.matcaps.length;qo.matcaps.push({name:t.name}),qo.createTexture(n._gl,r,e);var a={};a[e]=t.name,i.addOptions(a),i.setValue(e),n.render()}},document.getElementById("matcapopen").value="",r.readAsDataURL(t)}}}},{key:"importMatcap",value:function(){document.getElementById("matcapopen").click()}},{key:"onKeyUp",value:function(t){T.A.getShortKey(t.which)!==e.A.KeyAction.WIREFRAME||t.ctrlKey||this._ctrlShowWireframe.setValue(!this._ctrlShowWireframe.getValue())}}])&&zo(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();function Jo(e){return Jo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Jo(e)}function Qo(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,$o(n.key),n)}}function $o(e){var t=function(e){if("object"!=Jo(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Jo(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Jo(t)?t:t+""}const es=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._main=r._main,this._menu=null,this.init(t)}var t,r;return t=e,(r=[{key:"init",value:function(e){var t=this._menu=e.addMenu((0,N.A)("sceneTitle"));t.addButton((0,N.A)("sceneReset"),this,"clearScene"),t.addButton((0,N.A)("sceneAddSphere"),this._main,"addSphere"),t.addButton((0,N.A)("sceneAddCube"),this._main,"addCube"),t.addButton((0,N.A)("sceneAddCylinder"),this._main,"addCylinder"),t.addButton((0,N.A)("sceneAddTorus"),this._main,"addTorus"),t.addTitle((0,N.A)("sceneSelection")),this._ctrlIsolate=t.addCheckbox((0,N.A)("renderingIsolate"),!1,this.showHide.bind(this)),this._ctrlIsolate.setVisibility(!1),this._ctrlMerge=t.addButton((0,N.A)("sceneMerge"),this,"merge"),this._ctrlMerge.setVisibility(!1),t.addButton((0,N.A)("sceneDuplicate"),this,"duplicateSelection"),t.addButton((0,N.A)("sceneDelete"),this,"deleteSelection"),t.addTitle((0,N.A)("renderingExtra")),t.addCheckbox((0,N.A)("darkenUnselected"),P.darkenUnselected,this.onDarkenUnselected.bind(this)),t.addCheckbox((0,N.A)("contourShow"),this._main._showContour,this.onShowContour.bind(this)),t.addCheckbox((0,N.A)("renderingGrid"),this._main._showGrid,this.onShowGrid.bind(this)),t.addCheckbox((0,N.A)("renderingSymmetryLine"),P.showSymmetryLine,this.onShowSymmetryLine.bind(this)),this._ctrlOffSym=t.addSlider("SymOffset",0,this.onOffsetSymmetry.bind(this),-1,1,.001)}},{key:"clearScene",value:function(){window.confirm((0,N.A)("sceneResetConfirm"))&&this._main.clearScene()}},{key:"onOffsetSymmetry",value:function(e){var t=this._main.getMesh();t&&(t.setSymmetryOffset(e),this._main.render())}},{key:"duplicateSelection",value:function(){this._main.duplicateSelection()}},{key:"deleteSelection",value:function(){this._main.deleteCurrentSelection()}},{key:"validatePreview",value:function(){this._main._meshPreview||this._main.addTorus(!0),this._main._meshPreview.setShowWireframe(!1),this._main.addNewMesh(this._main._meshPreview),this._main._meshPreview=null,this.ctrlDiscard.setVisibility(!1),this.ctrlValidate.setVisibility(!1),this._main.render()}},{key:"discardPreview",value:function(){this._main._meshPreview=null,this.ctrlDiscard.setVisibility(!1),this.ctrlValidate.setVisibility(!1),this._main.render()}},{key:"updateTorusRadius",value:function(e){this._main._torusRadius=e,this.updateTorus()}},{key:"updateTorusRadial",value:function(e){this._main._torusRadial=e,this.updateTorus()}},{key:"updateTorusTubular",value:function(e){this._main._torusTubular=e,this.updateTorus()}},{key:"updateTorusWidth",value:function(e){this._main._torusWidth=e,this._main._torusLength<this._main._torusWidth?this.ctrlLE.setValue(e):this.updateTorus()}},{key:"updateTorusLength",value:function(e){this._main._torusLength=e,this._main._torusLength<this._main._torusWidth?this.ctrlWI.setValue(e):this.updateTorus()}},{key:"updateTorus",value:function(){this._main.addTorus(!0),this.ctrlDiscard.setVisibility(!0),this.ctrlValidate.setVisibility(!0),this._main.render()}},{key:"hasHiddenMeshes",value:function(){for(var e=this._main.getMeshes(),t=0;t<e.length;++t)if(!e[t].isVisible())return!0;return!1}},{key:"updateMesh",value:function(){var e=this._main.getMeshes().length,t=this._main.getSelectedMeshes().length;this._ctrlIsolate.setVisibility(this.hasHiddenMeshes()||e!==t&&t>=1),this._ctrlMerge.setVisibility(t>1);var r=this._main.getMesh();this._ctrlOffSym.setValue(r?r.getSymmetryOffset():0)}},{key:"merge",value:function(){var e=this._main,t=e.getSelectedMeshes();if(!(t.length<2)){var r=zn.mergeMeshes(t,e.getMesh()||t[0]);e.removeMeshes(t),e.getStateManager().pushStateAddRemove(r,t.slice()),e.getMeshes().push(r),e.setMesh(r)}}},{key:"toggleShowHide",value:function(e){this._ctrlIsolate.setValue(!this._ctrlIsolate.getValue(),!!e)}},{key:"showHide",value:function(e){e?this.isolate():this.showAll(),this.updateMesh()}},{key:"setMeshesVisible",value:function(e,t){for(var r=0;r<e.length;++r)e[r].setVisible(t);this._ctrlIsolate.setValue(!t,!0)}},{key:"pushSetMeshesVisible",value:function(e,t){this.setMeshesVisible(e,t);var r=this.setMeshesVisible.bind(this,e,!t),n=this.setMeshesVisible.bind(this,e,t);this._main.getStateManager().pushStateCustom(r,n)}},{key:"isolate",value:function(){var e=this._main,t=e.getSelectedMeshes(),r=e.getMeshes();if(r.length===t.length||r.length<2)this._ctrlIsolate.setValue(!1,!0);else{for(var n=[],i=0;i<r.length;++i)e.getIndexSelectMesh(r[i])<0&&n.push(r[i]);this.pushSetMeshesVisible(n,!1),e.render()}}},{key:"showAll",value:function(){for(var e=this._main,t=e.getMeshes(),r=[],n=0;n<t.length;++n)t[n].isVisible()||r.push(t[n]);this.pushSetMeshesVisible(r,!0),e.render()}},{key:"onDarkenUnselected",value:function(e){P.darkenUnselected=e,this._main.render()}},{key:"onShowSymmetryLine",value:function(e){P.showSymmetryLine=e,this._main.render()}},{key:"onShowGrid",value:function(e){var t=this._main;t._showGrid=e,t.render()}},{key:"onShowContour",value:function(e){var t=this._main;t._showContour=e,t.render()}},{key:"onKeyDown",value:function(e){!0!==e.handled&&(e.stopPropagation(),this._main._focusGui||e.preventDefault(),73===e.which?(this.toggleShowHide(),e.handled=!0):68===e.which&&e.ctrlKey&&(this._main.duplicateSelection(),e.handled=!0))}}])&&Qo(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();var ts=__webpack_require__(2),rs={tools:[]},ns=rs.tools;rs.initGuiTools=function(e,t,r){for(var n=0,i=Ei.length;n<i;++n)if(Ei[n]){var a=ns[n];a||(console.error("No gui for tool index : "+n),rs[n]={_ctrls:[],init:function(){}}),a.init(e.getTool(n),t,r),rs.hide(n)}},rs.hide=function(e){for(var t=0,r=ns[e]._ctrls,n=r.length;t<n;++t)r[t].setVisibility(!1)},rs.show=function(e){for(var t=0,r=ns[e]._ctrls,n=r.length;t<n;++t)r[t].setVisibility(!0)};var is=function(e,t,r){this[e]=t?r/t:r},as=function(e,t,r,n){var i=t.addSlider((0,N.A)("sculptRadius"),e._radius,function(t){is.call(e,"_radius",1,t),n.getSculptManager().getSelection().setIsEditMode(!0),n.renderSelectOverRtt()},5,500,1);return r._ctrlRadius=i,i},os=function(e,t,r){var n=t.addSlider((0,N.A)("sculptIntensity"),100*e._intensity,is.bind(e,"_intensity",100),0,100,1);return r._ctrlIntensity=n,n},ss=function(e,t){return t.addSlider((0,N.A)("sculptHardness"),100*e._hardness,is.bind(e,"_hardness",100),0,100,1)},ls=function(e,t){return t.addCheckbox((0,N.A)("sculptCulling"),e,"_culling")},us=function(e,t,r,n){var i=t.addCheckbox(n||(0,N.A)("sculptNegative"),e,"_negative");return r.toggleNegative=function(){i.setValue(!i.getValue())},i},cs=function(){document.getElementById("alphaopen").click()},hs=function(e,t,r,n){e.push(t.addTitle((0,N.A)("sculptAlphaTitle"))),void 0!==r._lockPosition&&e.push(t.addCheckbox((0,N.A)("sculptLockPositon"),r,"_lockPosition")),n._ctrlAlpha=t.addCombobox((0,N.A)("sculptAlphaTex"),r,"_idAlpha",ts.A.ALPHAS_NAMES),e.push(n._ctrlAlpha),e.push(t.addButton((0,N.A)("sculptImportAlpha"),cs))};ns[e.A.Tools.BRUSH]={_ctrls:[],init:function(e,t,r){this._ctrls.push(as(e,t,this,r)),this._ctrls.push(os(e,t,this)),this._ctrls.push(us(e,t,this)),this._ctrls.push(t.addCheckbox((0,N.A)("sculptClay"),e,"_clay")),this._ctrls.push(t.addCheckbox((0,N.A)("sculptAccumulate"),e,"_accumulate")),this._ctrls.push(ls(e,t)),hs(this._ctrls,t,e,this)}},ns[e.A.Tools.CREASE]={_ctrls:[],init:function(e,t,r){this._ctrls.push(as(e,t,this,r)),this._ctrls.push(os(e,t,this)),this._ctrls.push(us(e,t,this)),this._ctrls.push(ls(e,t)),hs(this._ctrls,t,e,this)}},ns[e.A.Tools.DRAG]={_ctrls:[],init:function(e,t,r){this._ctrls.push(as(e,t,this,r)),hs(this._ctrls,t,e,this)}},ns[e.A.Tools.FLATTEN]={_ctrls:[],init:function(e,t,r){this._ctrls.push(as(e,t,this,r)),this._ctrls.push(os(e,t,this)),this._ctrls.push(us(e,t,this)),this._ctrls.push(ls(e,t)),hs(this._ctrls,t,e,this)}},ns[e.A.Tools.INFLATE]={_ctrls:[],init:function(e,t,r){this._ctrls.push(as(e,t,this,r)),this._ctrls.push(os(e,t,this)),this._ctrls.push(us(e,t,this)),this._ctrls.push(ls(e,t)),hs(this._ctrls,t,e,this)}},ns[e.A.Tools.PAINT]={_ctrls:[],onMaterialChanged:function(e,t,r){c.C(t._color,r[0].getValue()),t._material[0]=r[1].getValue()/100,t._material[1]=r[2].getValue()/100;var n=e.getMesh();n&&(t._writeAlbedo&&n.setAlbedo(t._color),t._writeRoughness&&n.setRoughness(t._material[0]),t._writeMetalness&&n.setMetallic(t._material[1]),e.render())},resetMaterialOverride:function(e,t){this._ctrlPicker.getValue()!==t._pickColor&&this._ctrlPicker.setValue(t._pickColor);var r=e.getMesh();r&&r.getAlbedo&&(r.getAlbedo()[0]=-1,r.setRoughness(-1),r.setMetallic(-1),e.render())},onPickedMaterial:function(e,r,n,i,a,o){n.setCanvasCursor(t.A.cursors.dropper),e[0].setValue(i,!0),e[1].setValue(100*a,!0),e[2].setValue(100*o,!0),c.C(r._color,i),r._material[0]=a,r._material[1]=o},onColorPick:function(r,n,i){r._pickColor=i,n.setCanvasCursor(i?t.A.cursors.dropper:"default"),n._action=i?e.A.Action.SCULPT_EDIT:e.A.Action.NOTHING,n.renderSelectOverRtt()},init:function(e,t,r){this._ctrls.push(as(e,t,this,r)),this._ctrls.push(os(e,t,this)),this._ctrls.push(ss(e,t)),this._ctrls.push(ls(e,t)),this._ctrls.push(t.addTitle((0,N.A)("sculptPBRTitle"))),this._ctrls.push(t.addButton((0,N.A)("sculptPaintAll"),e,"paintAll")),this._ctrlPicker=t.addCheckbox((0,N.A)("sculptPickColor"),e._pickColor,this.onColorPick.bind(this,e,r)),this._ctrls.push(this._ctrlPicker);var n=[],i=this.onMaterialChanged.bind(this,r,e,n),a=t.addColor((0,N.A)("sculptColor"),e._color,i),o=t.addSlider((0,N.A)("sculptRoughness"),100*e._material[0],i,0,100,1),s=t.addSlider((0,N.A)("sculptMetallic"),100*e._material[1],i,0,100,1);n.push(a,o,s),this._ctrls.push(a,o,s),e.setPickCallback(this.onPickedMaterial.bind(this,n,e,r)),this._ctrls.push(t.addTitle("Write channel")),this._ctrls.push(t.addCheckbox((0,N.A)("sculptColor"),e,"_writeAlbedo")),this._ctrls.push(t.addCheckbox((0,N.A)("sculptRoughness"),e,"_writeRoughness")),this._ctrls.push(t.addCheckbox((0,N.A)("sculptMetallic"),e,"_writeMetalness")),window.addEventListener("keyup",this.resetMaterialOverride.bind(this,r,e)),window.addEventListener("mouseup",this.resetMaterialOverride.bind(this,r,e)),hs(this._ctrls,t,e,this)}},ns[e.A.Tools.PINCH]={_ctrls:[],init:function(e,t,r){this._ctrls.push(as(e,t,this,r)),this._ctrls.push(os(e,t,this)),this._ctrls.push(us(e,t,this)),this._ctrls.push(ls(e,t)),hs(this._ctrls,t,e,this)}},ns[e.A.Tools.TWIST]={_ctrls:[],init:function(e,t,r){this._ctrls.push(as(e,t,this,r)),this._ctrls.push(ls(e,t)),hs(this._ctrls,t,e,this)}},ns[e.A.Tools.LOCALSCALE]={_ctrls:[],init:function(e,t,r){this._ctrls.push(as(e,t,this,r)),this._ctrls.push(ls(e,t)),hs(this._ctrls,t,e,this)}},ns[e.A.Tools.MOVE]={_ctrls:[],init:function(e,t,r){this._ctrls.push(as(e,t,this,r)),this._ctrls.push(os(e,t,this)),this._ctrls.push(t.addCheckbox((0,N.A)("sculptTopologicalCheck"),e,"_topoCheck")),this._ctrls.push(us(e,t,this,(0,N.A)("sculptMoveAlongNormal"))),hs(this._ctrls,t,e,this)}},ns[e.A.Tools.SMOOTH]={_ctrls:[],init:function(e,t,r){this._ctrls.push(as(e,t,this,r)),this._ctrls.push(os(e,t,this)),this._ctrls.push(t.addCheckbox((0,N.A)("sculptTangentialSmoothing"),e,"_tangent")),this._ctrls.push(ls(e,t)),hs(this._ctrls,t,e,this)}},ns[e.A.Tools.MASKING]={_ctrls:[],init:function(e,t,r){this._ctrls.push(as(e,t,this,r)),this._ctrls.push(os(e,t,this)),this._ctrls.push(ss(e,t)),this._ctrls.push(us(e,t,this)),this._ctrls.push(ls(e,t)),this._main=r,this._tool=e;var n=t.addDualButton((0,N.A)("sculptMaskingClear"),(0,N.A)("sculptMaskingInvert"),e,e,"clear","invert"),i=t.addDualButton((0,N.A)("sculptMaskingBlur"),(0,N.A)("sculptMaskingSharpen"),e,e,"blur","sharpen");this._ctrls.push(n[0],n[1],i[0],i[1]),this._ctrls.push(t.addTitle((0,N.A)("sculptExtractTitle"))),this._ctrls.push(t.addSlider((0,N.A)("sculptExtractThickness"),e,"_thickness",-5,5,.001)),this._ctrls.push(t.addButton((0,N.A)("sculptExtractAction"),e,"extract")),hs(this._ctrls,t,e,this)}},ns[e.A.Tools.TRANSFORM]={_ctrls:[],init:function(){}};const fs=rs;function ds(e){return ds="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ds(e)}function ps(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,_s(n.key),n)}}function _s(e){var t=function(e){if("object"!=ds(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ds(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ds(t)?t:t+""}var gs=fs.tools,ms=function(){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._main=r._main,this._ctrlGui=r,this._sculptManager=r._main.getSculptManager(),this._toolOnRelease=-1,this._invertSign=!1,this._modalBrushRadius=!1,this._modalBrushIntensity=!1,this._lastPageX=0,this._lastPageY=0,this._refX=0,this._refY=0,this._menu=null,this._ctrlSculpt=null,this._ctrlSymmetry=null,this._ctrlContinuous=null,this._ctrlTitleCommon=null,this.init(e)}var r,n;return r=t,n=[{key:"init",value:function(e){var t=this._menu=e.addMenu((0,N.A)("sculptTitle"));t.open(),t.addTitle((0,N.A)("sculptTool"));for(var r=[],n=0,i=Ei.length;n<i;++n)Ei[n]&&(r[n]=(0,N.A)(Ei[n].uiName));this._ctrlSculpt=t.addCombobox((0,N.A)("sculptTool"),this._sculptManager.getToolIndex(),this.onChangeTool.bind(this),r),fs.initGuiTools(this._sculptManager,this._menu,this._main),this._ctrlTitleCommon=t.addTitle((0,N.A)("sculptCommon")),this._ctrlSymmetry=t.addCheckbox((0,N.A)("sculptSymmetry"),this._sculptManager._symmetry,this.onSymmetryChange.bind(this)),this._ctrlContinuous=t.addCheckbox((0,N.A)("sculptContinuous"),this._sculptManager,"_continuous"),fs.show(this._sculptManager.getToolIndex()),this.addEvents(),this.onChangeTool(this._sculptManager.getToolIndex())}},{key:"onSymmetryChange",value:function(e){this._sculptManager._symmetry=e,this._main.render()}},{key:"addEvents",value:function(){var e=this.loadAlpha.bind(this);document.getElementById("alphaopen").addEventListener("change",e,!1),this.removeCallback=function(){document.getElementById("alphaopen").removeEventListener("change",e,!1)}}},{key:"removeEvents",value:function(){this.removeCallback&&this.removeCallback()}},{key:"getSelectedTool",value:function(){return this._ctrlSculpt.getValue()}},{key:"releaseInvertSign",value:function(){if(this._invertSign){this._invertSign=!1;var e=gs[this.getSelectedTool()];e.toggleNegative&&e.toggleNegative()}}},{key:"onChangeTool",value:function(t){fs.hide(this._sculptManager.getToolIndex()),this._sculptManager.setToolIndex(t);var r=this._main.getPluginManager&&this._main.getPluginManager();r&&r.onToolChange(t),fs.show(t);var n=!0===this._sculptManager.canBeContinuous();this._ctrlContinuous.setVisibility(n);var i=t!==e.A.Tools.TRANSFORM;this._ctrlSymmetry.setVisibility(i),this._ctrlTitleCommon.setVisibility(n||i),this._main.getPicking().updateLocalAndWorldRadius2()}},{key:"loadAlpha",value:function(e){if(0!==e.target.files.length){var t=e.target.files[0];if(t.type.match("image.*")){var r=new FileReader,n=this._main,i=gs[this._sculptManager.getToolIndex()];r.onload=function(e){var r=new Image;r.src=e.target.result,r.onload=n.onLoadAlphaImage.bind(n,r,t.name||"new alpha",i)},document.getElementById("alphaopen").value="",r.readAsDataURL(t)}}}},{key:"addAlphaOptions",value:function(e){for(var t=0,r=gs.length;t<r;++t){var n=gs[t];n&&n._ctrlAlpha&&n._ctrlAlpha.addOptions(e)}}},{key:"updateMesh",value:function(){this._menu.setVisibility(!!this._main.getMesh())}},{key:"_startModalBrushRadius",value:function(e,t){this._refX=e,this._refY=t;var r=gs[this.getSelectedTool()];if(r._ctrlRadius){var n=r._ctrlRadius.getValue();this._refX-=n,this._main.getSculptManager().getSelection().setOffsetX(-n*this._main.getPixelRatio()),this._main.renderSelectOverRtt()}}},{key:"_checkModifierKey",value:function(t){var r=this.getSelectedTool();if(this._main._action===e.A.Action.NOTHING&&(!t.shiftKey||t.altKey||t.ctrlKey||r!==e.A.Tools.SMOOTH&&(this._toolOnRelease=r,this._ctrlSculpt.setValue(e.A.Tools.SMOOTH)),!t.ctrlKey||t.shiftKey||t.altKey||r!==e.A.Tools.MASKING&&(this._toolOnRelease=r,this._ctrlSculpt.setValue(e.A.Tools.MASKING))),t.altKey){if(this._invertSign||t.shiftKey)return!0;this._invertSign=!0;var n=gs[r];return n.toggleNegative&&n.toggleNegative(),!0}return!1}},{key:"onKeyDown",value:function(t){if(!0!==t.handled){var r=this._main,n=T.A.getShortKey(t.which);if(t.stopPropagation(),r._focusGui&&n!==e.A.KeyAction.RADIUS&&n!==e.A.KeyAction.INTENSITY||t.preventDefault(),t.handled=!0,!this._checkModifierKey(t)&&r._action===e.A.Action.NOTHING){if(void 0!==n&&Ei[n])return this._ctrlSculpt.setValue(n);var i=gs[this.getSelectedTool()];switch(n){case e.A.KeyAction.DELETE:r.deleteCurrentSelection();break;case e.A.KeyAction.INTENSITY:this._modalBrushIntensity=r._focusGui=!0;break;case e.A.KeyAction.RADIUS:this._modalBrushRadius||this._startModalBrushRadius(this._lastPageX,this._lastPageY),this._modalBrushRadius=r._focusGui=!0;break;case e.A.KeyAction.NEGATIVE:i.toggleNegative&&i.toggleNegative();break;case e.A.KeyAction.PICKER:var a=i._ctrlPicker;a&&!a.getValue()&&a.setValue(!0);break;default:t.handled=!1}}}}},{key:"onKeyUp",value:function(t){var r=this._main._action===e.A.Action.NOTHING&&-1!==this._toolOnRelease&&!t.ctrlKey&&!t.shiftKey;t.altKey&&!r||this.releaseInvertSign(),r&&(this._ctrlSculpt.setValue(this._toolOnRelease),this._toolOnRelease=-1);var n=this._main;switch(T.A.getShortKey(t.which)){case e.A.KeyAction.RADIUS:this._modalBrushRadius=n._focusGui=!1,this._main.getSculptManager().getSelection().setOffsetX(0),t.pageX=this._lastPageX,t.pageY=this._lastPageY,n.setMousePosition(t),n.getPicking().intersectionMouseMeshes(),n.renderSelectOverRtt();break;case e.A.KeyAction.PICKER:var i=gs[this.getSelectedTool()]._ctrlPicker;i&&i.getValue()&&i.setValue(!1);break;case e.A.KeyAction.INTENSITY:this._modalBrushIntensity=n._focusGui=!1}}},{key:"onMouseUp",value:function(e){-1===this._toolOnRelease||e.ctrlKey||e.shiftKey||(this.releaseInvertSign(),this._ctrlSculpt.setValue(this._toolOnRelease),this._toolOnRelease=-1)}},{key:"onMouseMove",value:function(e){var t=gs[this.getSelectedTool()];if(this._modalBrushRadius&&t._ctrlRadius){var r=e.pageX-this._refX,n=e.pageY-this._refY;t._ctrlRadius.setValue(Math.sqrt(r*r+n*n)),this._main.renderSelectOverRtt()}this._modalBrushIntensity&&t._ctrlIntensity&&t._ctrlIntensity.setValue(t._ctrlIntensity.getValue()+e.pageX-this._lastPageX),this._lastPageX=e.pageX,this._lastPageY=e.pageY}},{key:"onMouseOver",value:function(e){this._modalBrushRadius&&this._startModalBrushRadius(e.pageX,e.pageY)}}],n&&ps(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();const vs=ms;function ys(e){return ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ys(e)}function bs(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,As(n.key),n)}}function As(e){var t=function(e){if("object"!=ys(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=ys(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==ys(t)?t:t+""}const Ts=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._main=t,this._addedMeshes=void 0!==r.length?r:[r],this._removedMeshes=void 0!==n.length?n:[n],this._selectMeshes=t.getSelectedMeshes().slice()}var t,r;return t=e,(r=[{key:"isNoop",value:function(){return 0===this._addedMeshes.length&&0===this._removedMeshes.length}},{key:"undo",value:function(){var e,t,r=this._main,n=r.getMeshes(),i=this._addedMeshes;for(e=0,t=i.length;e<t;++e)n.splice(r.getIndexMesh(i[e]),1);var a=this._removedMeshes;for(e=0,t=a.length;e<t;++e)n.push(a[e]);for(e=0,t=n.length;e<t;++e)n[e].initRender();var o=this._selectMeshes;r.setMesh(o[0]?o[0]:null);var s=r.getSelectedMeshes();for(s.length=0,e=0,t=o.length;e<t;++e)s.push(o[e])}},{key:"redo",value:function(){this.undo()}},{key:"createRedo",value:function(){return new e(this._main,this._removedMeshes,this._addedMeshes)}}])&&bs(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Ss(e){return Ss="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ss(e)}function ws(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ms(n.key),n)}}function Ms(e){var t=function(e){if("object"!=Ss(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ss(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ss(t)?t:t+""}const ks=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._main=t,this._mesh=r,this._idVertState=[],this._cArState=[],this._mArState=[]}var r,n;return r=e,(n=[{key:"isNoop",value:function(){return 0===this._idVertState.length}},{key:"undo",value:function(){this.pullVertices();var e=this._mesh;e.updateDuplicateColorsAndMaterials(),e.updateDrawArrays(),e.updateColorBuffer(),e.updateMaterialBuffer(),this._main.setMesh(e)}},{key:"redo",value:function(){this.undo()}},{key:"createRedo",value:function(){var t=new e(this._main,this._mesh);return this.pushRedoVertices(t),t}},{key:"pushVertices",value:function(e){for(var r=this._idVertState,n=this._cArState,i=this._mArState,a=this._mesh,o=a.getColors(),s=a.getMaterials(),l=a.getVerticesStateFlags(),u=t.A.STATE_FLAG,c=e.length,h=0;h<c;++h){var f=e[h];l[f]!==u&&(l[f]=u,r.push(f),f*=3,n.push(o[f],o[f+1],o[f+2]),i.push(s[f],s[f+1],s[f+2]))}}},{key:"pushRedoVertices",value:function(e){for(var t=e._mesh,r=t.getColors(),n=t.getMaterials(),i=this._idVertState,a=i.length,o=e._cArState=new Float32Array(3*a),s=e._mArState=new Float32Array(3*a),l=e._idVertState=new Uint32Array(a),u=0;u<a;++u){var c=l[u]=i[u];c*=3;var h=3*u;o[h]=r[c],o[h+1]=r[c+1],o[h+2]=r[c+2],s[h]=n[c],s[h+1]=n[c+1],s[h+2]=n[c+2]}}},{key:"pullVertices",value:function(){for(var e=this._cArState,t=this._mArState,r=this._idVertState,n=r.length,i=this._mesh,a=i.getColors(),o=i.getMaterials(),s=0;s<n;++s){var l=3*r[s],u=3*s;a[l]=e[u],a[l+1]=e[u+1],a[l+2]=e[u+2],o[l]=t[u],o[l+1]=t[u+1],o[l+2]=t[u+2]}}}])&&ws(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();function Es(e){return Es="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Es(e)}function xs(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Rs(n.key),n)}}function Rs(e){var t=function(e){if("object"!=Es(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Es(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Es(t)?t:t+""}const Cs=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._main=t,this._mesh=r,this._center=c.C([0,0,0],r.getCenter()),this._idVertState=[],this._vArState=[]}var r,n;return r=e,(n=[{key:"isNoop",value:function(){return 0===this._idVertState.length}},{key:"undo",value:function(){this.pullVertices();var e=this._mesh;e.updateGeometry(e.getFacesFromVertices(this._idVertState),this._idVertState),e.updateGeometryBuffers(),c.C(e.getCenter(),this._center),this._main.setMesh(e)}},{key:"redo",value:function(){this.undo()}},{key:"createRedo",value:function(){var t=new e(this._main,this._mesh);return this.pushRedoVertices(t),t}},{key:"pushVertices",value:function(e){for(var r=this._idVertState,n=this._vArState,i=this._mesh,a=i.getVertices(),o=i.getVerticesStateFlags(),s=t.A.STATE_FLAG,l=e.length,u=0;u<l;++u){var c=e[u];o[c]!==s&&(o[c]=s,r.push(c),c*=3,n.push(a[c],a[c+1],a[c+2]))}}},{key:"pushRedoVertices",value:function(e){for(var t=e._mesh.getVertices(),r=this._idVertState,n=r.length,i=e._vArState=new Float32Array(3*n),a=e._idVertState=new Uint32Array(n),o=0;o<n;++o){var s=a[o]=r[o];s*=3;var l=3*o;i[l]=t[s],i[l+1]=t[s+1],i[l+2]=t[s+2]}}},{key:"pullVertices",value:function(){for(var e=this._vArState,t=this._idVertState,r=t.length,n=this._mesh.getVertices(),i=0;i<r;++i){var a=3*t[i],o=3*i;n[a]=e[o],n[a+1]=e[o+1],n[a+2]=e[o+2]}}}])&&xs(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();function Ps(e){return Ps="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ps(e)}function Ds(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Os(n.key),n)}}function Os(e){var t=function(e){if("object"!=Ps(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ps(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ps(t)?t:t+""}const Is=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._main=t,this._mesh=r,this._center=c.C([0,0,0],r.getCenter()),this._nbFacesState=r.getNbFaces(),this._nbVerticesState=r.getNbVertices(),this._idVertState=[],this._fRingState=[],this._vRingState=[],this._vArState=[],this._cArState=[],this._mArState=[],this._idFaceState=[],this._fArState=[]}var r,n;return r=e,(n=[{key:"isNoop",value:function(){return 0===this._idVertState.length&&0===this._idFaceState.length}},{key:"undo",value:function(){this.pullVertices(),this.pullFaces();var e=this._mesh;e.setNbVertices(this._nbVerticesState),e.setNbFaces(this._nbFacesState),e.updateTopology(),e.updateGeometry(),e.updateDuplicateColorsAndMaterials(),e.updateDrawArrays(),e.updateColorBuffer(),e.updateMaterialBuffer(),e.updateBuffers(),c.C(e.getCenter(),this._center),this._main.setMesh(e)}},{key:"redo",value:function(){this.undo()}},{key:"createRedo",value:function(){var t=new e(this._main,this._mesh);return this.pushRedoVertices(t),this.pushRedoFaces(t),t}},{key:"pushVertices",value:function(e){for(var r=this._idVertState,n=this._fRingState,i=this._vRingState,a=this._vArState,o=this._cArState,s=this._mArState,l=this._mesh,u=l.getVerticesRingFace(),c=l.getVerticesRingVert(),h=l.getVertices(),f=l.getColors(),d=l.getMaterials(),p=l.getVerticesStateFlags(),_=t.A.STATE_FLAG,g=e.length,m=0;m<g;++m){var v=e[m];p[v]!==_&&(p[v]=_,n.push(u[v].slice()),i.push(c[v].slice()),r.push(v),v*=3,a.push(h[v],h[v+1],h[v+2]),o.push(f[v],f[v+1],f[v+2]),s.push(d[v],d[v+1],d[v+2]))}}},{key:"pushFaces",value:function(e){for(var r=this._idFaceState,n=this._fArState,i=this._mesh,a=i.getFaces(),o=i.getFacesStateFlags(),s=t.A.STATE_FLAG,l=e.length,u=0;u<l;++u){var c=e[u];o[c]!==s&&(o[c]=s,r.push(c),c*=4,n.push(a[c],a[c+1],a[c+2],a[c+3]))}}},{key:"pushRedoVertices",value:function(e){var r=e._mesh,n=r.getNbVertices(),i=r.getVerticesRingFace(),a=r.getVerticesRingVert(),o=r.getVertices(),s=r.getColors(),l=r.getMaterials(),u=0,c=0,h=0,f=this._idVertState,d=f.length,p=this._nbVerticesState,_=Math.min(p,n),g=new Uint32Array(t.A.getMemory(4*n),0,n);for(u=0;u<d;++u)(c=f[u])<_&&(g[h++]=c);for(u=p;u<n;++u)g[h++]=u;d=h,g=e._idVertState=new Uint32Array(g.subarray(0,d));var m=e._fRingState=new Array(d),v=e._vRingState=new Array(d),y=e._vArState=new Float32Array(3*d),b=e._cArState=new Float32Array(3*d),A=e._mArState=new Float32Array(3*d);for(u=0;u<d;++u){c=g[u],m[u]=i[c].slice(),v[u]=a[c].slice(),c*=3;var T=3*u;y[T]=o[c],y[T+1]=o[c+1],y[T+2]=o[c+2],b[T]=s[c],b[T+1]=s[c+1],b[T+2]=s[c+2],A[T]=l[c],A[T+1]=l[c+1],A[T+2]=l[c+2]}}},{key:"pushRedoFaces",value:function(e){var r=e._mesh,n=r.getNbFaces(),i=r.getFaces(),a=0,o=0,s=0,l=this._idFaceState,u=l.length,c=this._nbFacesState,h=Math.min(c,n),f=new Uint32Array(t.A.getMemory(4*n),0,n);for(a=0;a<u;++a)(o=l[a])<h&&(f[s++]=o);for(a=c;a<n;++a)f[s++]=a;u=s,f=e._idFaceState=new Uint32Array(f.subarray(0,u));var d=e._fArState=new Int32Array(4*u);for(a=0;a<u;++a){o=f[a],o*=4;var p=4*a;d[p]=i[o],d[p+1]=i[o+1],d[p+2]=i[o+2],d[p+3]=i[o+3]}}},{key:"pullVertices",value:function(){for(var e=this._nbVerticesState,t=this._fRingState,r=this._vRingState,n=this._vArState,i=this._cArState,a=this._mArState,o=this._idVertState,s=o.length,l=this._mesh,u=l.getVerticesRingFace(),c=l.getVerticesRingVert(),h=l.getVertices(),f=l.getColors(),d=l.getMaterials(),p=0;p<s;++p){var _=o[p];if(!(_>=e)){u[_]=t[p].slice(),c[_]=r[p].slice();var g=3*p;h[_*=3]=n[g],h[_+1]=n[g+1],h[_+2]=n[g+2],f[_]=i[g],f[_+1]=i[g+1],f[_+2]=i[g+2],d[_]=a[g],d[_+1]=a[g+1],d[_+2]=a[g+2]}}}},{key:"pullFaces",value:function(){for(var e=this._nbFacesState,t=this._fArState,r=this._idFaceState,n=r.length,i=this._mesh.getFaces(),a=0;a<n;++a){var o=r[a];if(!(o>=e)){var s=4*a;i[o*=4]=t[s],i[o+1]=t[s+1],i[o+2]=t[s+2],i[o+3]=t[s+3]}}}}])&&Ds(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();function Fs(e){return Fs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Fs(e)}function Ls(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Vs(n.key),n)}}function Vs(e){var t=function(e){if("object"!=Fs(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Fs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Fs(t)?t:t+""}const Ns=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._undocb=t,this._redocb=r||t}var t,r;return t=e,(r=[{key:"isNoop",value:function(){return!this._undocb}},{key:"undo",value:function(){this._undocb()}},{key:"redo",value:function(){this._redocb()}},{key:"createRedo",value:function(){return new e(this._undocb,this._redocb)}}])&&Ls(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Bs(e){return Bs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Bs(e)}function Us(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,js(n.key),n)}}function js(e){var t=function(e){if("object"!=Bs(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Bs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Bs(t)?t:t+""}var Gs=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._main=t,this._undos=[],this._redos=[],this._curUndoIndex=-1}var r,n;return r=e,(n=[{key:"pushStateCustom",value:function(e,t,r){var n=new Ns(e,t);n.squash=r,this.pushState(n)}},{key:"pushStateAddRemove",value:function(e,t,r){var n=new Ts(this._main,e,t);n.squash=r,this.pushState(n)}},{key:"pushStateRemove",value:function(e){this.pushState(new Ts(this._main,[],e))}},{key:"pushStateAdd",value:function(e){this.pushState(new Ts(this._main,e,[]))}},{key:"pushStateColorAndMaterial",value:function(e){e.isDynamic?this.pushState(new Is(this._main,e)):this.pushState(new ks(this._main,e))}},{key:"pushStateGeometry",value:function(e){e.isDynamic?this.pushState(new Is(this._main,e)):this.pushState(new Cs(this._main,e))}},{key:"pushStateMultiresolution",value:function(e,t){this.pushState(new No(this._main,e,t))}},{key:"setNewMaxStack",value:function(t){e.STACK_LENGTH=t;for(var r=this._undos,n=this._redos;this._curUndoIndex>=t;)r.shift(),--this._curUndoIndex;for(;r.length>t;)r.pop(),n.shift()}},{key:"pushState",value:function(r){++t.A.STATE_FLAG;var n=this._undos;-1===this._curUndoIndex?n.length=0:n.length>=e.STACK_LENGTH&&(n.shift(),--this._curUndoIndex),this._redos.length=0,++this._curUndoIndex,n.length>0&&(n.length=this._curUndoIndex),n.push(r)}},{key:"getCurrentState",value:function(){return this._undos[this._curUndoIndex]}},{key:"pushVertices",value:function(e){e&&e.length>0&&this.getCurrentState().pushVertices(e)}},{key:"pushFaces",value:function(e){e&&e.length>0&&this.getCurrentState().pushFaces(e)}},{key:"undo",value:function(){if(this._undos.length&&!(this._curUndoIndex<0)){var e=this.getCurrentState(),t=e.createRedo();t.squash=e.squash,this._redos.push(t),e.undo(),this._curUndoIndex--,!0===e.squash&&this.undo()}}},{key:"redo",value:function(){this._redos.length&&(this._redos[this._redos.length-1].redo(),this._curUndoIndex++,this._redos.pop(),this._redos.length&&!0===this._redos[this._redos.length-1].squash&&this.redo())}},{key:"reset",value:function(){this._undos.length=0,this._redos.length=0,this._curUndoIndex=-1}},{key:"cleanNoop",value:function(){for(;this._curUndoIndex>=0&&this.getCurrentState().isNoop();)this._undos.length--,this._curUndoIndex--,this._redos.length=0}}])&&Us(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),e}();Gs.STACK_LENGTH=15;const Ws=Gs;function zs(e){return zs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},zs(e)}function Xs(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ks(n.key),n)}}function Ks(e){var t=function(e){if("object"!=zs(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=zs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==zs(t)?t:t+""}const Hs=function(){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._ctrlGui=r,this._main=r._main,this._menu=null,this.init(e)}var r,n;return r=t,(n=[{key:"init",value:function(e){var t=this._menu=e.addMenu((0,N.A)("stateTitle"));t.addButton((0,N.A)("stateUndo"),this,"onUndo","CTRL+Z"),t.addButton((0,N.A)("stateRedo"),this,"onRedo","CTRL+Y"),t.addTitle((0,N.A)("stateMaxStack"));var r=this._main.getStateManager();t.addSlider("",Ws.STACK_LENGTH,r.setNewMaxStack.bind(r),3,50,1)}},{key:"onUndo",value:function(){this._main._action=e.A.Action.NOTHING,this._main.getSculptManager().end(),this._main.getStateManager().undo(),this._main.render(),this._ctrlGui.updateMesh()}},{key:"onRedo",value:function(){this._main.getStateManager().redo(),this._main.render(),this._ctrlGui.updateMesh()}},{key:"onKeyDown",value:function(e){if(!0!==e.handled){e.stopPropagation(),this._main._focusGui||e.preventDefault();var t=e.which;e.ctrlKey&&90===t?(this.onUndo(),e.handled=!0):e.ctrlKey&&89===t&&(this.onRedo(),e.handled=!0)}}}])&&Xs(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();function Ys(e){return Ys="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ys(e)}function qs(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Zs(n.key),n)}}function Zs(e){var t=function(e){if("object"!=Ys(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ys(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ys(t)?t:t+""}const Js=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._menu=null,this.init(t)}var t,r;return t=e,(r=[{key:"init",value:function(e){var t=this._menu=e.addMenu((0,N.A)("pressureTitle"));t.addTitle((0,N.A)("pressureRadius")),t.addSlider("",et.A,"radiusFactor",0,1,.01),t.addTitle((0,N.A)("pressureIntensity")),t.addSlider("",et.A,"intensityFactor",0,1,.01)}}])&&qs(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function Qs(e){return Qs="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Qs(e)}function $s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,el(n.key),n)}}function el(e){var t=function(e){if("object"!=Qs(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Qs(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Qs(t)?t:t+""}var tl=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._main=t,this._guiMain=null,this._sidebar=null,this._topbar=null,this._ctrlTablet=null,this._ctrlFiles=null,this._ctrlScene=null,this._ctrlStates=null,this._ctrlCamera=null,this._ctrlBackground=null,this._ctrlSculpting=null,this._ctrlTopology=null,this._ctrlRendering=null,this._ctrlNotification=null,this._ctrls=[],this._notifications={},this._xhrs={}}var t,r;return t=e,r=[{key:"initGui",value:function(){this.deleteGui(),this._guiMain=new($i().GuiMain)(this._main.getViewport(),this._main.onCanvasResize.bind(this._main));var e=this._ctrls;e.length=0;var t=0;this._topbar=this._guiMain.addTopbar(),e[t++]=this._ctrlFiles=new Ha(this._topbar,this),e[t++]=this._ctrlAddons=new $a(this._topbar,this),e[t++]=this._ctrlScene=new es(this._topbar,this),e[t++]=this._ctrlStates=new Hs(this._topbar,this),e[t++]=this._ctrlBackground=new na(this._topbar,this),e[t++]=this._ctrlCamera=new sa(this._topbar,this),e[t++]=this._ctrlTablet=new Js(this._topbar,this),e[t++]=this._ctrlConfig=new ha(this._topbar,this),e[t++]=this._ctrlMesh=new no(this._topbar,this),this._sidebar=this._guiMain.addRightSidebar(),e[t++]=this._ctrlRendering=new Zo(this._sidebar,this),e[t++]=this._ctrlTopology=new Go(this._sidebar,this),e[t++]=this._ctrlSculpting=new vs(this._sidebar,this);var r=this._topbar.addExtra();r.addTitle((0,N.A)("contour")),r.addColor((0,N.A)("contourColor"),oe.color,this.onContourColor.bind(this)),r.addTitle((0,N.A)("resolution")),r.addSlider("",this._main._pixelRatio,this.onPixelRatio.bind(this),.5,2,.02),this.addAboutButton(),this.updateMesh(),this.setVisibility(!0),window.postprocessGui&&window.postprocessGui()}},{key:"getNotification",value:function(e){var t=this._notifications[e];return t?this._xhrs[e]&&t.isVisible()?void(window.confirm("Abort "+e+" previous upload?")&&(this._xhrs[e].abort(),this._xhrs[e].isAborted=!0,t.setMessage(null))):t:((t=this._topbar.addMenu()).isVisible=function(){return!this.domContainer.hidden},t.setMessage=function(e){this.domContainer.innerHTML=e,this.setVisibility(!!e)},t.domContainer.style.color="red",t.setMessage(""),this._notifications[e]=t,t)}},{key:"initPrint",value:function(e){e.addMenu("Print it!").addButton("Go to Materialise!",this,"exportMaterialise")}},{key:"exportSculpteo",value:function(){this._export("sculpteo")}},{key:"exportMaterialise",value:function(){window.confirm("A new webpage will be opened. Start upload?")&&this._export("materialise")}},{key:"exportSketchfab",value:function(){this._export("sketchfab")}},{key:"_export",value:function(e){if(this._main.getMesh()){var t=this.getNotification(e);if(t){var r="export"+e.charAt(0).toUpperCase()+e.slice(1);this._xhrs[e]=La[r](this._main,t)}}}},{key:"onPixelRatio",value:function(e){this._main._pixelRatio=e,this._main.onCanvasResize()}},{key:"onContourColor",value:function(e){oe.color[0]=e[0],oe.color[1]=e[1],oe.color[2]=e[2],oe.color[3]=e[3],this._main.render()}},{key:"addAboutButton",value:function(){var e=this._topbar.addMenu();e.domContainer.innerHTML=(0,N.A)("about"),e.domContainer.addEventListener("mousedown",function(){window.open("http://stephaneginier.com","_blank")})}},{key:"updateMesh",value:function(){this._ctrlRendering.updateMesh(),this._ctrlTopology.updateMesh(),this._ctrlSculpting.updateMesh(),this._ctrlScene.updateMesh(),this.updateMeshInfo()}},{key:"updateMeshInfo",value:function(){this._ctrlMesh.updateMeshInfo()}},{key:"getFlatShading",value:function(){return this._ctrlRendering.getFlatShading()}},{key:"getWireframe",value:function(){return this._ctrlRendering.getWireframe()}},{key:"getShaderType",value:function(){return this._ctrlRendering.getShaderType()}},{key:"addAlphaOptions",value:function(e){this._ctrlSculpting.addAlphaOptions(e)}},{key:"deleteGui",value:function(){this._guiMain&&this._guiMain.domMain.parentNode&&(this.callFunc("removeEvents"),this.setVisibility(!1),this._guiMain.domMain.parentNode.removeChild(this._guiMain.domMain))}},{key:"setVisibility",value:function(e){this._guiMain.setVisibility(e)}},{key:"callFunc",value:function(e,t){for(var r=0,n=this._ctrls,i=n.length;r<i;++r){var a=n[r];a&&a[e]&&a[e](t)}}}],r&&$s(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();const rl=tl;function nl(e){return nl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},nl(e)}function il(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,al(n.key),n)}}function al(e){var t=function(e){if("object"!=nl(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=nl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==nl(t)?t:t+""}var ol=200,sl=200,ll=[0,0],ul=[0,0,0],cl=[0,0,0],hl=[0,1,0],fl=[0,0,0,1],dl=g.vt(),pl=Math.SQRT1_2,_l=.5,gl=[Gt(1,0,0,0),Gt(0,1,0,0),Gt(0,0,1,0),Gt(0,0,0,1),Gt(pl,pl,0,0),Gt(pl,-pl,0,0),Gt(pl,0,pl,0),Gt(pl,0,-pl,0),Gt(pl,0,0,pl),Gt(pl,0,0,-pl),Gt(0,pl,pl,0),Gt(0,pl,-pl,0),Gt(0,pl,0,pl),Gt(0,pl,0,-pl),Gt(0,0,pl,pl),Gt(0,0,pl,-pl),Gt(_l,_l,_l,_l),Gt(_l,_l,_l,-_l),Gt(_l,_l,-_l,_l),Gt(_l,_l,-_l,-_l),Gt(_l,-_l,_l,_l),Gt(_l,-_l,_l,-_l),Gt(_l,-_l,-_l,_l),Gt(-_l,_l,_l,_l)],ml=function(){function r(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this._main=t;var n=(0,T.A)();this._mode=n.cameramode||e.A.CameraMode.ORBIT,this._projectionType=n.projection||e.A.Projection.PERSPECTIVE,this._quatRot=[0,0,0,1],this._view=g.vt(),this._proj=g.vt(),this._viewport=g.vt(),this._lastNormalizedMouseXY=[0,0],this._width=0,this._height=0,this._speed=0,this._fov=Math.min(n.fov,150),this._trans=[0,0,30],this._moveX=0,this._moveZ=0,this._usePivot=n.pivot,this._center=[0,0,0],this._offset=[0,0,0],this._rotX=0,this._rotY=0,this._near=.05,this._far=5e3,this._timers={},this.resetView()}var n,i;return n=r,i=[{key:"setProjectionType",value:function(e){this._projectionType=e,this.updateProjection(),this.updateView()}},{key:"setMode",value:function(t){this._mode=t,t===e.A.CameraMode.ORBIT&&this.resetViewFront()}},{key:"setFov",value:function(e){this._fov=e,this.updateView(),this.optimizeNearFar()}},{key:"setUsePivot",value:function(e){this._usePivot=e}},{key:"toggleUsePivot",value:function(){this._usePivot=!this._usePivot}},{key:"getView",value:function(){return this._view}},{key:"getProjection",value:function(){return this._proj}},{key:"getProjectionType",value:function(){return this._projectionType}},{key:"isOrthographic",value:function(){return this._projectionType===e.A.Projection.ORTHOGRAPHIC}},{key:"getMode",value:function(){return this._mode}},{key:"getFov",value:function(){return this._fov}},{key:"getUsePivot",value:function(){return this._usePivot}},{key:"getConstantScreen",value:function(){var t=this._main.getCanvas().clientWidth;return this._projectionType===e.A.Projection.ORTHOGRAPHIC?t/this.getOrthoZoom():t*this._proj[0]}},{key:"start",value:function(e,t){if(this._lastNormalizedMouseXY=Kt.A.normalizedMouse(e,t,this._width,this._height),this._usePivot){var r=this._main,n=r.getPicking();n.intersectionMouseMeshes(r.getMeshes(),e,t),n.getMesh()&&(c.Z0(ul,n.getIntersectionPoint(),n.getMesh().getMatrix()),this.setPivot(ul))}}},{key:"setPivot",value:function(t){if(c.gL(this._offset,this._offset,function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return e[0]=-r*s,e[1]=-n*s,e[2]=-i*s,e[3]=a*s,e}(fl,this._quatRot)),c.jb(this._offset,this._offset,this._center),c.C(this._center,t),c.WQ(this._offset,this._offset,this._center),c.gL(this._offset,this._offset,this._quatRot),this._projectionType===e.A.Projection.PERSPECTIVE){var r=this.getTransZ();this._trans[2]=c.xg(this.computePosition(),this._center)*this._fov/45,this._offset[2]+=this.getTransZ()-r}else this._offset[2]=0}},{key:"rotate",value:function(t,r){var n=ul,i=ll,a=Kt.A.normalizedMouse(t,r,this._width,this._height);if(this._mode===e.A.CameraMode.ORBIT)Ft(i,a,this._lastNormalizedMouseXY),this.setOrbit(this._rotX-2*i[1],this._rotY+2*i[0]),this.rotateDelay([6*-i[1],6*i[0]],-1);else if(this._mode===e.A.CameraMode.PLANE){var o=Lt(this._lastNormalizedMouseXY,a);Ft(i,a,this._lastNormalizedMouseXY),c.S8(n,c.hZ(n,-i[1],i[0],0)),Wt(this._quatRot,Bt(fl,n,2*o),this._quatRot),this.rotateDelay([n[0],n[1],n[2],6*o],-1)}else if(this._mode===e.A.CameraMode.SPHERICAL){var s=Kt.A.mouseOnUnitSphere(this._lastNormalizedMouseXY),l=Kt.A.mouseOnUnitSphere(a),u=Math.acos(Math.min(1,c.Om(s,l)));c.S8(n,c.$A(n,s,l)),Wt(this._quatRot,Bt(fl,n,2*u),this._quatRot),this.rotateDelay([n[0],n[1],n[2],6*u],-1)}this._lastNormalizedMouseXY=a,this.updateView()}},{key:"setOrbit",value:function(e,t){var r=.49*Math.PI;this._rotX=Math.max(Math.min(e,r),-r),this._rotY=t;var n=this._quatRot;Nt(n),Ut(n,n,this._rotX),jt(n,n,this._rotY)}},{key:"getTransZ",value:function(){return this._projectionType===e.A.Projection.PERSPECTIVE?45*this._trans[2]/this._fov:1e3}},{key:"updateView",value:function(){var e=ul,t=this._view,r=this._trans[0],n=this._trans[1],i=this._offset;c.hZ(cl,r-i[0],n-i[1],this.getTransZ()-i[2]),c.hZ(e,r-i[0],n-i[1],-i[2]),g.t5(t,cl,e,hl),g.lK(t,t,g.I0(dl,this._quatRot)),g.Tl(t,t,c.ze(ul,this._center))}},{key:"optimizeNearFar",value:function(e){if(e||(e=this._lastBBox),e){this._lastBBox=e;var t=this.computePosition(cl),r=c.hZ(ul,.5*(e[0]+e[3]),.5*(e[1]+e[4]),.5*(e[2]+e[5])),n=c.xg(t,r),i=.5*c.xg(e,c.hZ(ul,e[3],e[4],e[5]));this._near=Math.max(.01,n-i),this._far=i+n,this.updateProjection()}}},{key:"updateProjection",value:function(){this._projectionType===e.A.Projection.PERSPECTIVE?(g.fN(this._proj,this._fov*Math.PI/180,this._width/this._height,this._near,this._far),this._proj[10]=-1,this._proj[14]=-2*this._near):this.updateOrtho()}},{key:"updateTranslation",value:function(){var t=this._trans;t[0]+=this._moveX*this._speed*t[2]/50/400,t[2]=Math.max(1e-5,t[2]+this._moveZ*this._speed/400),this._projectionType===e.A.Projection.ORTHOGRAPHIC&&this.updateOrtho(),this.updateView()}},{key:"translate",value:function(e,t){var r=this._speed*this._trans[2]/54,n=[-e*r,t*r,0];this.setTrans(c.WQ(this._trans,this._trans,n)),c.hs(n,n,5),this.translateDelay(n,-1)}},{key:"zoom",value:function(e){var t=[0,0,0];c.jb(t,this._offset,this._trans),c.hs(t,t,e*this._speed/54),e<0&&(t[0]=t[1]=0),this.setTrans(c.WQ(this._trans,this._trans,t)),c.hs(t,t,5),this.translateDelay(t,-1)}},{key:"setAndFocusOnPivot",value:function(e,t){this.setPivot(e),this.moveToDelay(this._offset[0],this._offset[1],this._offset[2]+t)}},{key:"moveToDelay",value:function(e,t,r){var n=[e,t,r];this.translateDelay(c.jb(n,n,this._trans),sl)}},{key:"setTrans",value:function(t){c.C(this._trans,t),this._projectionType===e.A.Projection.ORTHOGRAPHIC&&this.updateOrtho(),this.updateView()}},{key:"getOrthoZoom",value:function(){return 55e-5*Math.abs(this._trans[2])}},{key:"updateOrtho",value:function(){var e=this.getOrthoZoom(),t=this._width*e,r=this._height*e;g.v3(this._proj,-t,t,-r,r,-this._near,this._far)}},{key:"computePosition",value:function(e){e=e||[0,0,0];var t=this._view;return c.hZ(e,-t[12],-t[13],-t[14]),d(dl,t),p(dl,dl),c.ei(e,e,dl)}},{key:"resetView",value:function(){this._speed=1.5*t.A.SCALE,this.centerDelay([0,0,0],sl),this.offsetDelay([0,0,0],sl);var e=[0,0,30+this._speed/3];c.jb(e,e,this._trans),this.translateDelay(e,sl),this.quatDelay([0,0,0,1],sl)}},{key:"resetViewFront",value:function(){this.quatDelay([0,0,0,1],ol)}},{key:"resetViewBack",value:function(){this.quatDelay([0,1,0,0],ol)}},{key:"resetViewTop",value:function(){this.quatDelay([Math.SQRT1_2,0,0,Math.SQRT1_2],ol)}},{key:"resetViewBottom",value:function(){this.quatDelay([-Math.SQRT1_2,0,0,Math.SQRT1_2],ol)}},{key:"resetViewLeft",value:function(){this.quatDelay([0,-Math.SQRT1_2,0,Math.SQRT1_2],ol)}},{key:"resetViewRight",value:function(){this.quatDelay([0,Math.SQRT1_2,0,Math.SQRT1_2],ol)}},{key:"toggleViewFront",value:function(){Math.abs(this._quatRot[3])>.99?this.resetViewBack():this.resetViewFront()}},{key:"toggleViewTop",value:function(){var e=this._quatRot[0]*Math.SQRT1_2+this._quatRot[3]*Math.SQRT1_2;e*e>.99?this.resetViewBottom():this.resetViewTop()}},{key:"toggleViewLeft",value:function(){var e=-this._quatRot[1]*Math.SQRT1_2+this._quatRot[3]*Math.SQRT1_2;e*e>.99?this.resetViewRight():this.resetViewLeft()}},{key:"computeWorldToScreenMatrix",value:function(e){return e=e||g.vt(),g.lK(e,g.lK(e,this._viewport,this._proj),this._view)}},{key:"unproject",value:function(e,t,r){var n=[0,0,0];return g.B8(dl,this.computeWorldToScreenMatrix(dl)),c.Z0(n,c.hZ(n,e,this._height-t,r),dl)}},{key:"project",value:function(e){var t=[0,0,0];return c.Z0(t,e,this.computeWorldToScreenMatrix(dl)),t[1]=this._height-t[1],t}},{key:"onResize",value:function(e,t){this._width=e,this._height=t;var r=this._viewport;g.D_(r),g.hs(r,r,c.hZ(ul,.5*e,.5*t,.5)),g.Tl(r,r,c.hZ(ul,1,1,1)),this.updateProjection()}},{key:"snapClosestRotation",value:function(){for(var e=this._quatRot,t=1/0,r=0,n=gl.length,i=0;i<n;++i){var a=zt(e,gl[i]);t<(a=1-a*a)||(t=a,r=i)}this.quatDelay(gl[r],ol)}},{key:"clearTimerN",value:function(e){window.clearInterval(this._timers[e]),this._timers[e]=0}},{key:"delay",value:function(e,t,r){var n=r||"default";if(this._timers[n]&&this.clearTimerN(n),0===t)return e(1);if(!(t<0)){var i=0,a=(new Date).getTime();this._timers[n]=window.setInterval(function(){var r=((new Date).getTime()-a)/t;r=function(e){return-((e=Math.min(1,e)-1)*e*e*e-1)}(r),e(r-i,r),i=r,r>=1&&this.clearTimerN(n)}.bind(this),16.6)}}},{key:"_translateDelta",value:function(e,t){var r=this._trans;c.Ln(r,r,e,t),this.setTrans(r),this._main.render()}},{key:"translateDelay",value:function(e,t){var r=this._translateDelta.bind(this,e);this.delay(r,t,"translate")}},{key:"_rotDelta",value:function(t,r){if(this._mode===e.A.CameraMode.ORBIT){var n=this._rotX+t[0]*r,i=this._rotY+t[1]*r;this.setOrbit(n,i)}else Wt(this._quatRot,Bt(fl,t,t[3]*r),this._quatRot);this.updateView(),this._main.render()}},{key:"rotateDelay",value:function(e,t){var r=this._rotDelta.bind(this,e);this.delay(r,t,"rotate")}},{key:"_quatDelta",value:function(t,r){Nt(fl),function(e,t,r,n){var i,a,o,s,l,u=t[0],c=t[1],f=t[2],d=t[3],p=r[0],_=r[1],g=r[2],m=r[3];(a=u*p+c*_+f*g+d*m)<0&&(a=-a,p=-p,_=-_,g=-g,m=-m),1-a>h.p8?(i=Math.acos(a),o=Math.sin(i),s=Math.sin((1-n)*i)/o,l=Math.sin(n*i)/o):(s=1-n,l=n),e[0]=s*u+l*p,e[1]=s*c+l*_,e[2]=s*f+l*g,e[3]=s*d+l*m}(fl,fl,t,r);var n=this._quatRot;if(Wt(this._quatRot,this._quatRot,fl),this._mode===e.A.CameraMode.ORBIT){var i=n[0],a=n[1],o=n[2],s=n[3];this._rotY=Math.atan2(2*(s*a+o*i),1-2*(a*a+o*o)),this._rotX=Math.atan2(2*(s*i+a*o),1-2*(o*o+i*i))}this.updateView(),this._main.render()}},{key:"quatDelay",value:function(e,t){var r=[0,0,0,0];!function(e,t){e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3]}(r,this._quatRot),Wt(r,r,e),Xt(r,r);var n=this._quatDelta.bind(this,r);this.delay(n,t,"quat")}},{key:"_centerDelta",value:function(e,t){c.Ln(this._center,this._center,e,t),this.updateView(),this._main.render()}},{key:"centerDelay",value:function(e,t){var r=[0,0,0];c.jb(r,e,this._center);var n=this._centerDelta.bind(this,r);this.delay(n,t,"center")}},{key:"_offsetDelta",value:function(e,t){c.Ln(this._offset,this._offset,e,t),this.updateView(),this._main.render()}},{key:"offsetDelay",value:function(e,t){var r=[0,0,0];c.jb(r,e,this._offset);var n=this._offsetDelta.bind(this,r);this.delay(n,t,"offset")}},{key:"computeFrustumFit",value:function(){var t,r=this._near;if(this._projectionType===e.A.Projection.ORTHOGRAPHIC)return t=Math.min(this._width,this._height)/r*.5,Math.sqrt(1+t*t)/t;var n=this._proj,i=r*(n[8]-1)/n[0],a=r*(1+n[8])/n[0],o=r*(1+n[9])/n[5],s=r*(n[9]-1)/n[5],l=Math.abs(a-i),u=Math.abs(o-s);return t=Math.min(u,l)/r*.5,this._fov/45*Math.sqrt(1+t*t)/t}}],i&&il(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),r}();const vl=ml;function yl(e){return yl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yl(e)}function bl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Al(n.key),n)}}function Al(e){var t=function(e){if("object"!=yl(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=yl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==yl(t)?t:t+""}const Tl=function(){function t(e,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._main=r,this._gl=e,this._vertexBuffer=new ge(e,e.ARRAY_BUFFER,e.STATIC_DRAW),this._texCoordBuffer=new ge(e,e.ARRAY_BUFFER,e.STATIC_DRAW),this._fill=!0,this._monoTex=null,this._texture=null,this._texWidth=1,this._texHeight=1,this._type=0,this._blur=0,this.init()}var r,n;return r=t,(n=[{key:"init",value:function(){this.getTexCoordBuffer().update(new Float32Array([0,0,1,0,0,1,1,1])),this._monoTex=this.createOnePixelTexture(50,50,50,255),document.getElementById("backgroundopen").addEventListener("change",this.loadBackground.bind(this),!1)}},{key:"loadBackground",value:function(e){if(0!==e.target.files.length){var t=e.target.files[0];if(t.type.match("image.*")){var r=this,n=new FileReader;n.onload=function(e){var t=new Image;t.src=e.target.result,t.onload=function(){var e=r._main.getCanvas();r.loadBackgroundTexture(t),r.onResize(e.width,e.height),r._main.render()}},document.getElementById("backgroundopen").value="",n.readAsDataURL(t)}}}},{key:"getGL",value:function(){return this._gl}},{key:"getBlur",value:function(){return this._blur}},{key:"getVertexBuffer",value:function(){return this._vertexBuffer}},{key:"getTexCoordBuffer",value:function(){return this._texCoordBuffer}},{key:"release",value:function(){this.deleteTexture(),this.getVertexBuffer().release(),this.getTexCoordBuffer().release()}},{key:"getType",value:function(){return this._type}},{key:"setType",value:function(e){this._type=e}},{key:"onResize",value:function(e,t){var r=e/t/(this._texWidth/this._texHeight),n=this._fill||0!==this._type?1/r:r,i=n<1?1:1/r,a=n<1?r:1;this.getVertexBuffer().update(new Float32Array([-i,-a,i,-a,-i,a,i,a]))}},{key:"getTexture",value:function(){return this._texture?this._texture:this._monoTex}},{key:"createOnePixelTexture",value:function(e,t,r,n){var i=this._gl,a=i.createTexture();return i.bindTexture(i.TEXTURE_2D,a),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,1,1,0,i.RGBA,i.UNSIGNED_BYTE,new Uint8Array([e,t,r,n])),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.bindTexture(i.TEXTURE_2D,null),a}},{key:"loadBackgroundTexture",value:function(e){var t=this._gl;this.deleteTexture(),this._texWidth=e.width,this._texHeight=e.height,this._texture=t.createTexture(),t.bindTexture(t.TEXTURE_2D,this._texture),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.bindTexture(t.TEXTURE_2D,null)}},{key:"deleteTexture",value:function(){this._texture&&(this._texWidth=this._texHeight=1,this._gl.deleteTexture(this._texture),this._texture=null)}},{key:"render",value:function(){fe[e.A.Shader.BACKGROUND].getOrCreate(this._gl).draw(this)}}])&&bl(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),t}();function Sl(e){return Sl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Sl(e)}function wl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ml(n.key),n)}}function Ml(e){var t=function(e){if("object"!=Sl(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Sl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Sl(t)?t:t+""}var kl=function(){function r(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),this._gl=null,this._cameraSpeed=.25,this._pixelRatio=1,this._viewport=document.getElementById("viewport"),this._canvas=document.getElementById("canvas"),this._canvasWidth=0,this._canvasHeight=0,this._canvasOffsetLeft=0,this._canvasOffsetTop=0,this._stateManager=new Ws(this),this._sculptManager=null,this._camera=new vl(this),this._picking=new ts.A(this),this._pickingSym=new ts.A(this,!0),this._meshPreview=null,this._torusLength=.5,this._torusWidth=.1,this._torusRadius=2*Math.PI,this._torusRadial=32,this._torusTubular=128;var e=(0,T.A)();this._showContour=e.outline,this._showGrid=e.grid,this._grid=null,this._background=null,this._meshes=[],this._selectMeshes=[],this._mesh=null,this._rttContour=null,this._rttMerge=null,this._rttOpaque=null,this._rttTransparent=null,this._focusGui=!1,this._gui=new rl(this),this._preventRender=!1,this._drawFullScene=!1,this._autoMatrix=e.scalecenter,this._vertexSRGB=!0}var n,i;return n=r,i=[{key:"start",value:function(){if(this.initWebGL(),this._gl){this._sculptManager=new Pi(this),this._background=new Tl(this._gl,this),this._rttContour=new Wa(this._gl,e.A.Shader.CONTOUR,null),this._rttMerge=new Wa(this._gl,e.A.Shader.MERGE,null),this._rttOpaque=new Wa(this._gl,e.A.Shader.FXAA),this._rttTransparent=new Wa(this._gl,null,this._rttOpaque.getDepth(),!0),this._grid=$n.createGrid(this._gl),this.initGrid(),this.loadTextures(),this._gui.initGui(),this.onCanvasResize();var t=(0,T.A)().modelurl;t?this.addModelURL(t):this.addSphere()}}},{key:"addModelURL",value:function(e){var t=this.getFileType(e);if(t){var r=new XMLHttpRequest;r.open("GET",e,!0),r.responseType="obj"===t?"text":"arraybuffer",r.onload=function(){200===r.status&&this.loadScene(r.response,t)}.bind(this),r.send(null)}}},{key:"getBackground",value:function(){return this._background}},{key:"getViewport",value:function(){return this._viewport}},{key:"getCanvas",value:function(){return this._canvas}},{key:"getPixelRatio",value:function(){return this._pixelRatio}},{key:"getCanvasWidth",value:function(){return this._canvasWidth}},{key:"getCanvasHeight",value:function(){return this._canvasHeight}},{key:"getCamera",value:function(){return this._camera}},{key:"getGui",value:function(){return this._gui}},{key:"getMeshes",value:function(){return this._meshes}},{key:"getMesh",value:function(){return this._mesh}},{key:"getSelectedMeshes",value:function(){return this._selectMeshes}},{key:"getPicking",value:function(){return this._picking}},{key:"getPickingSymmetry",value:function(){return this._pickingSym}},{key:"getSculptManager",value:function(){return this._sculptManager}},{key:"getStateManager",value:function(){return this._stateManager}},{key:"setMesh",value:function(e){return this.setOrUnsetMesh(e)}},{key:"setCanvasCursor",value:function(e){this._canvas.style.cursor=e}},{key:"initGrid",value:function(){var t=this._grid;t.normalizeSize();var r=t.getMatrix();g.Tl(r,r,[0,-.45,0]),g.hs(r,r,[2.5,2.5,2.5]),this._grid.setShaderType(e.A.Shader.FLAT),t.setFlatColor([.04,.04,.04])}},{key:"setOrUnsetMesh",value:function(e,t){if(e)if(t){var r=this.getIndexSelectMesh(e);r>=0?this._selectMeshes.length>1&&(this._selectMeshes.splice(r,1),e=this._selectMeshes[0]):this._selectMeshes.push(e)}else this._selectMeshes.length=0,this._selectMeshes.push(e);else this._selectMeshes.length=0;return this._mesh=e,this.getGui().updateMesh(),this.render(),e}},{key:"renderSelectOverRtt",value:function(){this._requestRender()&&(this._drawFullScene=!1)}},{key:"_requestRender",value:function(){return!0!==this._preventRender&&(window.requestAnimationFrame(this.applyRender.bind(this)),this._preventRender=!0,!0)}},{key:"render",value:function(){this._drawFullScene=!0,this._requestRender()}},{key:"applyRender",value:function(){this._preventRender=!1,this.updateMatricesAndSort();var e=this._gl;e&&(this._drawFullScene&&this._drawScene(),e.disable(e.DEPTH_TEST),e.bindFramebuffer(e.FRAMEBUFFER,this._rttMerge.getFramebuffer()),this._rttMerge.render(this),e.bindFramebuffer(e.FRAMEBUFFER,null),this._rttOpaque.render(this),e.enable(e.DEPTH_TEST),this._sculptManager.postRender())}},{key:"_drawScene",value:function(){var t=this._gl,r=0,n=this._meshes,i=n.length;t.disable(t.DEPTH_TEST);var a=this._selectMeshes.length>0&&this._showContour&&fe[e.A.Shader.CONTOUR].color[3]>0;if(a){t.bindFramebuffer(t.FRAMEBUFFER,this._rttContour.getFramebuffer()),t.clear(t.COLOR_BUFFER_BIT);for(var o=0,s=this._selectMeshes,l=s.length;o<l;++o)s[o].renderFlatColor(this)}for(t.enable(t.DEPTH_TEST),t.bindFramebuffer(t.FRAMEBUFFER,this._rttOpaque.getFramebuffer()),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT),this._showGrid&&this._grid.render(this),r=0;r<i&&!n[r].isTransparent();++r)n[r].render(this);var u=r;for(this._meshPreview&&this._meshPreview.render(this),this._background.render(),t.bindFramebuffer(t.FRAMEBUFFER,this._rttTransparent.getFramebuffer()),t.clear(t.COLOR_BUFFER_BIT),t.enable(t.BLEND),t.depthFunc(t.LESS),r=0;r<i;++r)n[r].getShowWireframe()&&n[r].renderWireframe(this);for(t.depthFunc(t.LEQUAL),t.depthMask(!1),t.enable(t.CULL_FACE),r=u;r<i;++r)t.cullFace(t.FRONT),n[r].render(this),t.cullFace(t.BACK),n[r].render(this);t.disable(t.CULL_FACE),a&&this._rttContour.render(this),t.depthMask(!0),t.disable(t.BLEND)}},{key:"updateMatricesAndSort",value:function(){var e=this._meshes,t=this._camera;e.length>0&&t.optimizeNearFar(this.computeBoundingBoxScene());for(var r=0,n=e.length;r<n;++r)e[r].updateMatrices(t);e.sort(Se.sortFunction),this._meshPreview&&this._meshPreview.updateMatrices(t),this._grid&&this._grid.updateMatrices(t)}},{key:"initWebGL",value:function(){var e={antialias:!1,stencil:!0},t=document.getElementById("canvas"),r=this._gl=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);r?(Na.initWebGLExtensions(r),Na.getWebGLExtension("OES_element_index_uint")||(ve.ONLY_DRAW_ARRAYS=!0),r.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!0),r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),r.pixelStorei(r.UNPACK_COLORSPACE_CONVERSION_WEBGL,r.NONE),r.disable(r.CULL_FACE),r.frontFace(r.CCW),r.cullFace(r.BACK),r.disable(r.BLEND),r.blendFunc(r.ONE,r.ONE_MINUS_SRC_ALPHA),r.disable(r.DEPTH_TEST),r.depthFunc(r.LEQUAL),r.depthMask(!0),r.clearColor(0,0,0,0),r.clear(r.COLOR_BUFFER_BIT|r.DEPTH_BUFFER_BIT)):window.alert("Could not initialise WebGL. No WebGL, no SculptGL. Sorry.")}},{key:"loadTextures",value:function(){for(var t=this,r=this._gl,n=fe[e.A.Shader.MATCAP],i=function(e,i){var a=new Image;a.src=e,a.onload=function(){n.createTexture(r,a,i),t.render()}},a=0,o=n.matcaps,s=o.length;a<s;++a)i(o[a].path,a);this.initAlphaTextures()}},{key:"initAlphaTextures",value:function(){for(var e=ts.A.INIT_ALPHAS_PATHS,t=ts.A.INIT_ALPHAS_NAMES,r=0,n=e.length;r<n;++r){var i=new Image;i.src="resources/alpha/"+e[r],i.onload=this.onLoadAlphaImage.bind(this,i,t[r])}}},{key:"onCanvasResize",value:function(){var e=this._viewport,t=e.clientWidth*this._pixelRatio,r=e.clientHeight*this._pixelRatio;this._canvasOffsetLeft=e.offsetLeft,this._canvasOffsetTop=e.offsetTop,this._canvasWidth=t,this._canvasHeight=r,this._canvas.width=t,this._canvas.height=r,this._gl.viewport(0,0,t,r),this._camera.onResize(t,r),this._background.onResize(t,r),this._rttContour.onResize(t,r),this._rttMerge.onResize(t,r),this._rttOpaque.onResize(t,r),this._rttTransparent.onResize(t,r),this.render()}},{key:"computeRadiusFromBoundingBox",value:function(e){var t=e[3]-e[0],r=e[4]-e[1],n=e[5]-e[2];return.5*Math.sqrt(t*t+r*r+n*n)}},{key:"computeBoundingBoxMeshes",value:function(e){for(var t=[1/0,1/0,1/0,-1/0,-1/0,-1/0],r=0,n=e.length;r<n;++r)if(e[r].isVisible()){var i=e[r].computeWorldBound();i[0]<t[0]&&(t[0]=i[0]),i[1]<t[1]&&(t[1]=i[1]),i[2]<t[2]&&(t[2]=i[2]),i[3]>t[3]&&(t[3]=i[3]),i[4]>t[4]&&(t[4]=i[4]),i[5]>t[5]&&(t[5]=i[5])}return t}},{key:"computeBoundingBoxScene",value:function(){var e=this._meshes.slice();return e.push(this._grid),this._sculptManager.addSculptToScene(e),this.computeBoundingBoxMeshes(e)}},{key:"normalizeAndCenterMeshes",value:function(e){var r=this.computeBoundingBoxMeshes(e),n=t.A.SCALE/c.xg([r[0],r[1],r[2]],[r[3],r[4],r[5]]),i=g.vt();g.hs(i,i,[n,n,n]),g.Tl(i,i,[.5*-(r[0]+r[3]),.5*-(r[1]+r[4]),.5*-(r[2]+r[5])]);for(var a=0,o=e.length;a<o;++a){var s=e[a].getMatrix();g.lK(s,i,s)}}},{key:"addSphere",value:function(){var e=new ze($n.createCube(this._gl));return e.normalizeSize(),this.subdivideClamp(e),this.addNewMesh(e)}},{key:"addCube",value:function(){var e=new ze($n.createCube(this._gl));return e.normalizeSize(),g.hs(e.getMatrix(),e.getMatrix(),[.7,.7,.7]),this.subdivideClamp(e,!0),this.addNewMesh(e)}},{key:"addCylinder",value:function(){var e=new ze($n.createCylinder(this._gl));return e.normalizeSize(),g.hs(e.getMatrix(),e.getMatrix(),[.7,.7,.7]),this.subdivideClamp(e),this.addNewMesh(e)}},{key:"addTorus",value:function(e){var r=new ze($n.createTorus(this._gl,this._torusLength,this._torusWidth,this._torusRadius,this._torusRadial,this._torusTubular));if(e){r.setShowWireframe(!0);var n=.3*t.A.SCALE;return g.hs(r.getMatrix(),r.getMatrix(),[n,n,n]),void(this._meshPreview=r)}r.normalizeSize(),this.subdivideClamp(r),this.addNewMesh(r)}},{key:"subdivideClamp",value:function(e,t){for(u.LINEAR=!!t;e.getNbFaces()<5e4;)e.addLevel();e._meshes.splice(0,Math.min(e._meshes.length-4,4)),e._sel=e._meshes.length-1,u.LINEAR=!1}},{key:"addNewMesh",value:function(e){return this._meshes.push(e),this._stateManager.pushStateAdd(e),this.setMesh(e),e}},{key:"loadScene",value:function(e,r){var n;"obj"===r?n=Ji.importOBJ(e,this._gl):"sgl"===r?n=Ji.importSGL(e,this._gl,this):"stl"===r?n=Ji.importSTL(e,this._gl):"ply"===r&&(n=Ji.importPLY(e,this._gl));var i=n.length;if(0!==i){for(var a=this._meshes,o=0;o<i;++o){var s=n[o]=new ze(n[o]);!this._vertexSRGB&&s.getColors()&&t.A.convertArrayVec3toSRGB(s.getColors()),s.init(),s.initRender(),a.push(s)}return this._autoMatrix&&this.normalizeAndCenterMeshes(n),this._stateManager.pushStateAdd(n),this.setMesh(a[a.length-1]),this.resetCameraMeshes(n),n}}},{key:"clearScene",value:function(){this.getStateManager().reset(),this.getMeshes().length=0,this.getCamera().resetView(),this.setMesh(null),this._action=e.A.Action.NOTHING}},{key:"deleteCurrentSelection",value:function(){this._mesh&&(this.removeMeshes(this._selectMeshes),this._stateManager.pushStateRemove(this._selectMeshes.slice()),this._selectMeshes.length=0,this.setMesh(null))}},{key:"removeMeshes",value:function(e){for(var t=this._meshes,r=0;r<e.length;++r)t.splice(this.getIndexMesh(e[r]),1)}},{key:"getIndexMesh",value:function(e,t){for(var r=t?this._selectMeshes:this._meshes,n=e.getID(),i=0,a=r.length;i<a;++i){var o=r[i];if(o===e||o.getID()===n)return i}return-1}},{key:"getIndexSelectMesh",value:function(e){return this.getIndexMesh(e,!0)}},{key:"replaceMesh",value:function(e,t){var r=this.getIndexMesh(e);r>=0&&(this._meshes[r]=t),this._mesh===e&&this.setMesh(t)}},{key:"duplicateSelection",value:function(){for(var e=this._selectMeshes.slice(),t=null,r=0;r<e.length;++r){t=e[r];var n=new rn(t.getGL());n.copyData(t),this.addNewMesh(n)}this.setMesh(t)}},{key:"onLoadAlphaImage",value:function(e,t,r){var n=document.createElement("canvas");n.width=e.width,n.height=e.height;var i=n.getContext("2d");i.drawImage(e,0,0);for(var a=i.getImageData(0,0,e.width,e.height).data,o=a.subarray(0,a.length/4),s=0,l=0,u=o.length;s<u;++s,l+=4)o[s]=Math.round((a[l]+a[l+1]+a[l+2])/3);var c={};c[t=ts.A.addAlpha(o,e.width,e.height,t)._name]=t,this.getGui().addAlphaOptions(c),r&&r._ctrlAlpha&&r._ctrlAlpha.setValue(t)}}],i&&wl(n.prototype,i),Object.defineProperty(n,"prototype",{writable:!1}),r}();const El=kl;function xl(e){return xl="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},xl(e)}function Rl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function Cl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Rl(Object(r),!0).forEach(function(t){Pl(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Rl(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function Pl(e,t,r){return(t=Ol(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Dl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Ol(n.key),n)}}function Ol(e){var t=function(e){if("object"!=xl(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=xl(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==xl(t)?t:t+""}var Il=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.canvas=t,this.canvas.style.touchAction="none",this.canvas.style.userSelect="none",this.canvas.style.webkitUserSelect="none",this.canvas.style.webkitTouchCallout="none",this.current={nX:0,nY:0,buttons:0,pressure:1,isDown:!1,altKey:!1,ctrlKey:!1,shiftKey:!1,pointerType:"mouse"},this._pointers=new Map,this._prevDist=0,this.onInput=null,this._bindEvents()}var t,r;return t=e,r=[{key:"_bindEvents",value:function(){var e={passive:!1};this.canvas.addEventListener("pointerdown",this._onDown.bind(this),e),this.canvas.addEventListener("pointermove",this._onMove.bind(this),e),this.canvas.addEventListener("pointerup",this._onUp.bind(this),e),this.canvas.addEventListener("pointercancel",this._onUp.bind(this),e),this.canvas.addEventListener("pointerout",this._onOut.bind(this),e),this.canvas.addEventListener("wheel",this._onWheel.bind(this),e),this.canvas.addEventListener("contextmenu",function(e){return e.preventDefault()})}},{key:"_updateNormalizedCoords",value:function(e,t){var r=this.canvas.getBoundingClientRect();r.width&&r.height&&(this.current.nX=(e-r.left)/r.width,this.current.nY=(t-r.top)/r.height,this.current.nX<0&&(this.current.nX=0),this.current.nX>1&&(this.current.nX=1),this.current.nY<0&&(this.current.nY=0),this.current.nY>1&&(this.current.nY=1))}},{key:"_processGesture",value:function(e,t){var r=Array.from(this._pointers.values());if(1===r.length){var n=r[0];return this._updateNormalizedCoords(n.x,n.y),this.current.isDown=!0,this.current.buttons="mouse"===n.type&&e.buttons||1,this.current.pointerType=n.type,this._updateModifiers(e),void(this.onInput&&this.onInput(t,this.current,e))}if(2===r.length){var i=r[0],a=r[1],o=(i.x+a.x)/2,s=(i.y+a.y)/2;this._updateNormalizedCoords(o,s);var l=Math.hypot(a.x-i.x,a.y-i.y);if(this.current.pointerType="pen"===i.type||"pen"===a.type?"pen":"touch",this._updateModifiers(e),"start"===t||!this._prevDist)return this._prevDist=l,this.onInput&&this.onInput("end",this.current,e),void(this.onInput&&(this.current.buttons=4,this.current.isDown=!0,this.onInput("start",this.current,e)));if("move"===t){this.current.buttons=4,this.current.isDown=!0,this.onInput&&this.onInput("move",this.current,e);var u=Math.max(this._prevDist,1),c=(l-this._prevDist)/u;Math.abs(c)>.004&&(this.onInput&&this.onInput("wheel",Cl(Cl({},this.current),{},{wheelDelta:4*c}),e),this._prevDist=l)}}}},{key:"_onDown",value:function(e){e.cancelable&&e.preventDefault(),e.stopPropagation(),this.canvas.setPointerCapture(e.pointerId),this._pointers.set(e.pointerId,{id:e.pointerId,x:e.clientX,y:e.clientY,type:e.pointerType}),this._processGesture(e,"start")}},{key:"_onMove",value:function(e){e.cancelable&&e.preventDefault(),e.stopPropagation();for(var t="function"==typeof e.getCoalescedEvents?e.getCoalescedEvents():[e],r=0,n=t.length;r<n;++r){var i=t[r];if(this._pointers.has(i.pointerId)){var a=this._pointers.get(i.pointerId);a.x=i.clientX,a.y=i.clientY}0!==this._pointers.size?this._processGesture(i,"move"):(this.current.isDown=!1,this.current.buttons=0,this.current.pointerType=i.pointerType||this.current.pointerType,this._updateNormalizedCoords(i.clientX,i.clientY),this.onInput&&this.onInput("hover",this.current,i))}}},{key:"_onUp",value:function(e){e.cancelable&&e.preventDefault();try{this.canvas.releasePointerCapture(e.pointerId)}catch(e){}if(this._pointers.delete(e.pointerId),this._pointers.size>0)return this._prevDist=0,void this._processGesture(e,"move");this.current.isDown=!1,this.current.buttons=0,this.current.pressure=0,this._prevDist=0,this.onInput&&this.onInput("end",this.current,e)}},{key:"_onOut",value:function(e){this._pointers.has(e.pointerId)&&this._onUp(e)}},{key:"_onWheel",value:function(e){e.cancelable&&e.preventDefault(),e.stopPropagation(),this._updateNormalizedCoords(e.clientX,e.clientY);var t=e.deltaY>0?-1:1;this.onInput&&this.onInput("wheel",Cl(Cl({},this.current),{},{wheelDelta:t}),e)}},{key:"_updateModifiers",value:function(e){this.current.altKey=e.altKey,this.current.ctrlKey=e.ctrlKey,this.current.shiftKey=e.shiftKey,void 0!==e.pressure?(this.current.pressure=e.pressure,0===this.current.pressure&&"pen"===e.pointerType&&(this.current.pressure=.5),0===this.current.pressure&&"touch"===e.pointerType&&(this.current.pressure=1)):"touch"===e.pointerType&&(this.current.pressure=1)}}],r&&Dl(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();const Fl=Il;function Ll(e){return Ll="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Ll(e)}function Vl(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Nl(n.key),n)}}function Nl(e){var t=function(e){if("object"!=Ll(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=Ll(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==Ll(t)?t:t+""}function Bl(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function Ul(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var a=e.apply(t,r);function o(e){Bl(a,n,i,o,s,"next",e)}function s(e){Bl(a,n,i,o,s,"throw",e)}o(void 0)})}}var jl="sculptgl.plugins.v1",Gl="sculptgl-plugin-store",Wl="plugins";function zl(){try{return(new Date).toISOString()}catch(e){return""}}function Xl(){return new Promise(function(e,t){if(!window.indexedDB)return t(new Error("IndexedDB not available"));var r=window.indexedDB.open(Gl,1);r.onupgradeneeded=function(){var e=r.result;e.objectStoreNames.contains(Wl)||e.createObjectStore(Wl,{keyPath:"id"})},r.onsuccess=function(){return e(r.result)},r.onerror=function(){return t(r.error||new Error("Failed to open IndexedDB"))}})}function Kl(e,t){var r=e.transaction(Wl,t);return{tx:r,store:r.objectStore(Wl)}}function Hl(e){return Yl.apply(this,arguments)}function Yl(){return(Yl=Ul(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xl();case 2:return r=e.sent,e.abrupt("return",new Promise(function(e,n){var i=Kl(r,"readonly"),a=i.tx,o=i.store.get(t);o.onsuccess=function(){return e(o.result||null)},o.onerror=function(){return n(o.error)},a.oncomplete=function(){return r.close()}}));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ql(e){return Zl.apply(this,arguments)}function Zl(){return(Zl=Ul(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xl();case 2:return r=e.sent,e.abrupt("return",new Promise(function(e,n){var i=Kl(r,"readwrite"),a=i.tx,o=i.store.put(t);o.onsuccess=function(){return e(!0)},o.onerror=function(){return n(o.error)},a.oncomplete=function(){return r.close()}}));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function Jl(e){return Ql.apply(this,arguments)}function Ql(){return(Ql=Ul(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Xl();case 2:return r=e.sent,e.abrupt("return",new Promise(function(e,n){var i=Kl(r,"readwrite"),a=i.tx,o=i.store.delete(t);o.onsuccess=function(){return e(!0)},o.onerror=function(){return n(o.error)},a.oncomplete=function(){return r.close()}}));case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}const $l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,n,i,a,o,s;return t=e,r=[{key:"loadMetaList",value:function(){try{var e=function(e){try{return JSON.parse(e)}catch(e){return[]}}(window.localStorage.getItem(jl));return Array.isArray(e)?e:[]}catch(e){return[]}}},{key:"saveMetaList",value:function(e){try{window.localStorage.setItem(jl,JSON.stringify(e||[]))}catch(e){}}},{key:"upsertMeta",value:function(t){var r=e.loadMetaList(),n=r.findIndex(function(e){return e.id===t.id});return n>=0?r[n]=t:r.push(t),e.saveMetaList(r),t}},{key:"deleteMeta",value:function(t){var r=e.loadMetaList().filter(function(e){return e.id!==t});e.saveMetaList(r)}},{key:"putCode",value:(s=Ul(regeneratorRuntime.mark(function e(t,r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n={id:t,code:r||"",updatedAt:zl()},e.next=3,ql(n);case 3:case"end":return e.stop()}},e)})),function(e,t){return s.apply(this,arguments)})},{key:"getCode",value:(o=Ul(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Hl(t);case 3:return r=e.sent,e.abrupt("return",r?r.code:null);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",null);case 10:case"end":return e.stop()}},e,null,[[0,7]])})),function(e){return o.apply(this,arguments)})},{key:"deleteCode",value:(a=Ul(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Jl(t);case 3:e.next=7;break;case 5:e.prev=5,e.t0=e.catch(0);case 7:case"end":return e.stop()}},e,null,[[0,5]])})),function(e){return a.apply(this,arguments)})},{key:"clearAllMeta",value:function(){e.saveMetaList([])}},{key:"clearAllCode",value:(i=Ul(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{window.indexedDB&&window.indexedDB.deleteDatabase&&window.indexedDB.deleteDatabase(Gl)}catch(e){}case 1:case"end":return e.stop()}},e)})),function(){return i.apply(this,arguments)})},{key:"clearAll",value:(n=Ul(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e.clearAllMeta(),t.next=3,e.clearAllCode();case 3:case"end":return t.stop()}},t)})),function(){return n.apply(this,arguments)})}],r&&Vl(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function eu(e){return eu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},eu(e)}function tu(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ru(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ru(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,i=function(){};return{s:i,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){s=!0,a=e},f:function(){try{o||null==r.return||r.return()}finally{if(s)throw a}}}}function ru(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function nu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function iu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?nu(Object(r),!0).forEach(function(t){au(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):nu(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function au(e,t,r){return(t=uu(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function ou(e,t,r,n,i,a,o){try{var s=e[a](o),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,i)}function su(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var a=e.apply(t,r);function o(e){ou(a,n,i,o,s,"next",e)}function s(e){ou(a,n,i,o,s,"throw",e)}o(void 0)})}}function lu(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,uu(n.key),n)}}function uu(e){var t=function(e){if("object"!=eu(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=eu(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==eu(t)?t:t+""}function cu(){try{return(new Date).toISOString()}catch(e){return""}}function hu(e){try{var t=new URL(e,window.location.href);return t.pathname.split("/").pop()||t.hostname||"plugin"}catch(e){return"plugin"}}function fu(e){return"url:".concat(e)}function du(e){return window.crypto&&window.crypto.randomUUID?"".concat(e,":").concat(window.crypto.randomUUID()):"".concat(e,":").concat(Date.now().toString(36),"-").concat(Math.random().toString(36).slice(2,10))}const pu=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.scene=t,this._plugins=new Map,this._meta=new Map,this._loading=new Map,this._activePluginId=null,this._persistKey="sculptgl_active_plugin"}var t,r,n,i,a,o,s,l,u,c;return t=e,r=[{key:"register",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e||!t)return!1;this._plugins.set(e,t),r&&this._meta.set(e,r);var n=r&&r.name||t.name||e;return console.log("[PluginManager] Registered plugin: ".concat(n)),!0}},{key:"installFromUrl",value:(c=su(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(t||"").trim()){e.next=3;break}throw new Error("Empty plugin URL");case 3:return n={id:fu(r),name:hu(r),type:"url",source:r,enabled:!0,updatedAt:cu()},$l.upsertMeta(n),e.next=7,this._loadAndRegister(n);case 7:case"end":return e.stop()}},e,this)})),function(e){return c.apply(this,arguments)})},{key:"installFromFile",value:(u=su(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}throw new Error("No plugin file provided");case 2:if("function"!=typeof t.text){e.next=8;break}return e.next=5,t.text();case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,new Promise(function(e,r){var n=new FileReader;n.onload=function(t){return e(t.target.result||"")},n.onerror=function(){return r(n.error||new Error("Failed to read file"))},n.readAsText(t)});case 10:e.t0=e.sent;case 11:return r=e.t0,n={id:du("file"),name:t.name||"plugin",type:"file",source:t.name||"archivo",enabled:!0,updatedAt:cu()},$l.upsertMeta(n),e.next=16,$l.putCode(n.id,r);case 16:return e.next=18,this._loadAndRegister(n);case 18:case"end":return e.stop()}},e,this)})),function(e){return u.apply(this,arguments)})},{key:"listInstalled",value:function(){return $l.loadMetaList()}},{key:"setEnabled",value:(l=su(regeneratorRuntime.mark(function e(t,r){var n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=$l.loadMetaList(),-1!==(i=n.findIndex(function(e){return e.id===t}))){e.next=4;break}return e.abrupt("return");case 4:if(n[i]=iu(iu({},n[i]),{},{enabled:!!r,updatedAt:cu()}),$l.saveMetaList(n),r){e.next=12;break}return this._activePluginId===t&&this.deactivate(),this._plugins.delete(t),this._meta.delete(t),this._loading.delete(t),e.abrupt("return");case 12:return e.next=14,this._loadAndRegister(n[i]);case 14:case"end":return e.stop()}},e,this)})),function(e,t){return l.apply(this,arguments)})},{key:"uninstall",value:(s=su(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this._activePluginId===t&&this.deactivate(),this._plugins.delete(t),this._meta.delete(t),this._loading.delete(t),$l.deleteMeta(t),e.next=7,$l.deleteCode(t);case 7:case"end":return e.stop()}},e,this)})),function(e){return s.apply(this,arguments)})},{key:"clearAll",value:(o=su(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.deactivate(),this._plugins.clear(),this._meta.clear(),this._loading.clear(),e.next=6,$l.clearAll();case 6:case"end":return e.stop()}},e,this)})),function(){return o.apply(this,arguments)})},{key:"loadPersisted",value:(a=su(regeneratorRuntime.mark(function e(){var t,r,n,i,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=$l.loadMetaList(),this._meta.clear(),r=t.filter(function(e){return e&&e.enabled}),n=tu(r),e.prev=4,n.s();case 6:if((i=n.n()).done){e.next=12;break}return a=i.value,e.next=10,this._loadAndRegister(a);case 10:e.next=6;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(4),n.e(e.t0);case 17:return e.prev=17,n.f(),e.finish(17);case 20:if(!(o=this._safeGetStorage(this._persistKey))||!this._plugins.has(o)){e.next=24;break}return this.activate(o),e.abrupt("return");case 24:o&&this._safeRemoveStorage(this._persistKey);case 25:case"end":return e.stop()}},e,this,[[4,14,17,20]])})),function(){return a.apply(this,arguments)})},{key:"activate",value:function(e){if(!this._plugins.has(e))return console.warn("[PluginManager] Plugin not found: ".concat(e)),!1;if(this._activePluginId){var t=this._plugins.get(this._activePluginId);t&&t.onDeactivate&&t.onDeactivate()}this._activePluginId=e;var r=this._plugins.get(e);return r&&r.onActivate&&r.onActivate(),this._persistActive(),console.log("[PluginManager] Activated plugin: ".concat(e)),!0}},{key:"deactivate",value:function(){if(this._activePluginId){var e=this._plugins.get(this._activePluginId);e&&e.onDeactivate&&e.onDeactivate(),this._activePluginId=null,this._persistActive(),console.log("[PluginManager] Deactivated all plugins")}}},{key:"getActivePlugin",value:function(){return this._activePluginId?this._plugins.get(this._activePluginId):null}},{key:"getPluginNames",value:function(){return Array.from(this._plugins.keys())}},{key:"hasActivePlugin",value:function(){return null!==this._activePluginId}},{key:"tryHandleInput",value:function(e,t,r){var n=this.getActivePlugin();if(!n)return!1;if("function"!=typeof n.onInput)return console.warn("[PluginManager] Active plugin has no onInput method"),!1;try{return!0===n.onInput(e,t,r)}catch(e){return console.error("[PluginManager] Plugin error:",e),!1}}},{key:"onRender",value:function(){var e=this.getActivePlugin();if(e&&"function"==typeof e.onRender)try{e.onRender()}catch(e){console.error("[PluginManager] Plugin render error:",e)}}},{key:"onToolChange",value:function(e){var t=this.getActivePlugin();if(t&&"function"==typeof t.onToolChange)try{t.onToolChange(e)}catch(e){console.error("[PluginManager] Plugin tool change error:",e)}}},{key:"dispose",value:function(){var e,t=tu(this._plugins.values());try{for(t.s();!(e=t.n()).done;){var r=e.value;r&&r.dispose&&r.dispose()}}catch(e){t.e(e)}finally{t.f()}this._plugins.clear(),this._meta.clear(),this._activePluginId=null}},{key:"_loadAndRegister",value:(i=su(regeneratorRuntime.mark(function e(t){var r,n,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&t.id){e.next=2;break}return e.abrupt("return",null);case 2:if(!this._plugins.has(t.id)){e.next=4;break}return e.abrupt("return",this._plugins.get(t.id));case 4:if(!this._loading.has(t.id)){e.next=6;break}return e.abrupt("return",this._loading.get(t.id));case 6:return r=su(regeneratorRuntime.mark(function e(){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i._loadModule(t);case 2:if(r=e.sent,n=i._createPluginInstance(r,t)){e.next=6;break}return e.abrupt("return",null);case 6:return!t.name&&n.name&&(t.name=n.name,$l.upsertMeta(t)),i.register(t.id,n,t),e.abrupt("return",n);case 9:case"end":return e.stop()}},e)}))(),this._loading.set(t.id,r),e.prev=8,e.next=11,r;case 11:return n=e.sent,e.abrupt("return",n);case 13:return e.prev=13,this._loading.delete(t.id),e.finish(13);case 16:case"end":return e.stop()}},e,this,[[8,,13,16]])})),function(e){return i.apply(this,arguments)})},{key:"_loadModule",value:(n=su(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("url"!==t.type){e.next=2;break}return e.abrupt("return",import(t.source));case 2:return e.next=4,$l.getCode(t.id);case 4:if(r=e.sent){e.next=7;break}throw new Error("Plugin code not found");case 7:return n=new Blob([r],{type:"text/javascript"}),i=URL.createObjectURL(n),e.prev=9,e.next=12,import(i);case 12:return e.abrupt("return",e.sent);case 13:return e.prev=13,URL.revokeObjectURL(i),e.finish(13);case 16:case"end":return e.stop()}},e,null,[[9,,13,16]])})),function(e){return n.apply(this,arguments)})},{key:"_createPluginInstance",value:function(e,t){if(!e)return null;var r=e.default||e.plugin||e.Plugin||e;return r?"function"==typeof r?r.prototype&&(r.prototype.onInput||r.prototype.onActivate)?new r(this.scene,t):r(this.scene,t):"object"===eu(r)?r:null:null}},{key:"_persistActive",value:function(){try{this._activePluginId?window.localStorage.setItem(this._persistKey,this._activePluginId):window.localStorage.removeItem(this._persistKey)}catch(e){}}},{key:"_safeGetStorage",value:function(e){try{return window.localStorage.getItem(e)}catch(e){return null}}},{key:"_safeRemoveStorage",value:function(e){try{window.localStorage.removeItem(e)}catch(e){}}}],r&&lu(t.prototype,r),Object.defineProperty(t,"prototype",{writable:!1}),e}();function _u(e){return _u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_u(e)}function gu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,n)}return r}function mu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gu(Object(r),!0).forEach(function(t){vu(e,t,r[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gu(Object(r)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))})}return e}function vu(e,t,r){return(t=bu(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function yu(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,bu(n.key),n)}}function bu(e){var t=function(e){if("object"!=_u(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var r=t.call(e,"string");if("object"!=_u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==_u(t)?t:t+""}function Au(){return Au="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=Mu(e)););return e}(e,t);if(n){var i=Object.getOwnPropertyDescriptor(n,t);return i.get?i.get.call(arguments.length<3?e:r):i.value}},Au.apply(null,arguments)}function Tu(e,t){return Tu=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},Tu(e,t)}function Su(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function wu(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(wu=function(){return!!e})()}function Mu(e){return Mu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},Mu(e)}const ku=function(t){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&Tu(e,t)}(a,t);var r,n,i=function(e){var t=wu();return function(){var r,n=Mu(e);if(t){var i=Mu(this).constructor;r=Reflect.construct(n,arguments,i)}else r=n.apply(this,arguments);return function(e,t){if(t&&("object"==_u(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return Su(e)}(this,r)}}(a);function a(){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,a),(t=i.call(this))._pluginManager=new pu(Su(t)),t._inputManager=new Fl(t._canvas),t._inputManager.onInput=t._handleInput.bind(Su(t)),t._mouseX=0,t._mouseY=0,t._lastMouseX=0,t._lastMouseY=0,t._action=e.A.Action.NOTHING,t._isWheelingIn=!1,t._timerEndWheel=null,t.addSystemEvents(),t}return r=a,n=[{key:"start",value:function(){Au(Mu(a.prototype),"start",this).call(this),this._pluginManager&&this._pluginManager.loadPersisted().catch(function(e){console.error("Error loading persisted plugins:",e)})}},{key:"applyRender",value:function(){Au(Mu(a.prototype),"applyRender",this).call(this),this._pluginManager&&this._pluginManager.onRender()}},{key:"getPluginManager",value:function(){return this._pluginManager}},{key:"_handleInput",value:function(e,t,r){var n=t.nX*this._canvasWidth,i=t.nY*this._canvasHeight,a=this._buttonsToWhich(t.buttons);if("number"==typeof t.pressure&&(et.A.pressure=t.pressure),et.A.pointerType=t.pointerType||et.A.pointerType,et.A.mouseX=n,et.A.mouseY=i,"wheel"===e)return this._mouseX=n,this._mouseY=i,this._lastMouseX=n,this._lastMouseY=i,void this.onDeviceWheel(t.wheelDelta);if("hover"===e)return this._mouseX=n,this._mouseY=i,this._lastMouseX=n,this._lastMouseY=i,void this.renderSelectOverRtt();var o={x:n,y:i,buttons:a,pressure:et.A.pressure,pointerType:et.A.pointerType,altKey:t.altKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey};"start"!==e?"move"!==e?"end"===e&&this.onDeviceUp(o,r):this.onDeviceMove(o,r):this.onDeviceDown(o,r)}},{key:"_buttonsToWhich",value:function(e){return 4&e?2:2&e?3:1&e?1:0}},{key:"onDeviceDown",value:function(t){var r=t.x,n=t.y;if(this._lastMouseX=r,this._lastMouseY=n,this._mouseX=r,this._mouseY=n,t.altKey&&1===t.buttons)return t.ctrlKey?this._action=e.A.Action.CAMERA_ZOOM:t.shiftKey?this._action=e.A.Action.CAMERA_PAN:this._action=e.A.Action.CAMERA_ROTATE,void this._camera.start(r,n);if(3===t.buttons)return this._action=t.ctrlKey?e.A.Action.CAMERA_ZOOM:t.shiftKey?e.A.Action.CAMERA_PAN:e.A.Action.CAMERA_ROTATE,void this._camera.start(r,n);if(2===t.buttons)return this._action=e.A.Action.CAMERA_PAN,void this._camera.start(r,n);if(1===t.buttons){var i=this.getMesh(),a=this.getPicking();if(!i||!a)return this._action=e.A.Action.CAMERA_ROTATE,void this._camera.start(r,n);if(a.intersectionMouse(i,this._mouseX,this._mouseY)){if(this._pluginManager.tryHandleInput("start",t,a))return void(this._action=e.A.Action.NOTHING);this._action=e.A.Action.SCULPT_EDIT,this._sculptManager.start(t.shiftKey)}else this._action=e.A.Action.CAMERA_ROTATE,this._camera.start(r,n)}}},{key:"onDeviceMove",value:function(t){var r=t.x,n=t.y;if(this._mouseX=r,this._mouseY=n,this._isCameraAction()){ze.RENDER_HINT=ze.CAMERA;var i=r-this._lastMouseX,a=n-this._lastMouseY,o=this._cameraSpeed/this._canvasHeight;this._action===e.A.Action.CAMERA_ROTATE?this._camera.rotate(r,n):this._action===e.A.Action.CAMERA_PAN?this._camera.translate(i*o,a*o):this._action===e.A.Action.CAMERA_ZOOM&&this._camera.zoom((i+a)*o),this.render()}else if(this._action===e.A.Action.SCULPT_EDIT){var s=this.getPicking();this._pluginManager.tryHandleInput("move",t,s)||(this._sculptManager.preUpdate(),this._sculptManager.update(this),ze.RENDER_HINT=ze.SCULPT,this.getMesh().isDynamic&&this._gui.updateMeshInfo(),this.render())}else this.renderSelectOverRtt();this._lastMouseX=r,this._lastMouseY=n}},{key:"onDeviceUp",value:function(t){if(this._pluginManager.hasActivePlugin()){var r=this.getPicking();this._pluginManager.tryHandleInput("end",mu(mu({},t),{},{buttons:0,pressure:0}),r)}this._action===e.A.Action.SCULPT_EDIT&&this._sculptManager.end(),this._action=e.A.Action.NOTHING,this.setCanvasCursor("default"),ze.RENDER_HINT=ze.NONE,this.render()}},{key:"onDeviceWheel",value:function(e){Math.abs(e)>0&&!this._isWheelingIn&&(this._isWheelingIn=!0,this._camera.start(this._mouseX,this._mouseY)),this._camera.zoom(.02*e),ze.RENDER_HINT=ze.CAMERA,this.render(),this._timerEndWheel&&window.clearTimeout(this._timerEndWheel),this._timerEndWheel=window.setTimeout(this._endWheel.bind(this),300)}},{key:"_endWheel",value:function(){ze.RENDER_HINT=ze.NONE,this._isWheelingIn=!1,this.render()}},{key:"_isCameraAction",value:function(){return this._action===e.A.Action.CAMERA_ROTATE||this._action===e.A.Action.CAMERA_PAN||this._action===e.A.Action.CAMERA_ZOOM}},{key:"addSystemEvents",value:function(){var e=this._canvas;window.addEventListener("keydown",this.onKeyDown.bind(this),!1),window.addEventListener("keyup",this.onKeyUp.bind(this),!1);var t=this.loadFiles.bind(this),r=this.stopAndPrevent.bind(this);window.addEventListener("dragenter",r,!1),window.addEventListener("dragover",r,!1),window.addEventListener("drop",t,!1),e.addEventListener("webglcontextlost",this.onContextLost.bind(this),!1),e.addEventListener("webglcontextrestored",this.onContextRestored.bind(this),!1);var n=document.getElementById("fileopen");n&&n.addEventListener("change",t,!1)}},{key:"stopAndPrevent",value:function(e){e.stopPropagation(),e.preventDefault()}},{key:"onContextLost",value:function(){window.alert("Oops WebGL context lost.")}},{key:"onContextRestored",value:function(){window.alert("Wow Context is restored.")}},{key:"onKeyDown",value:function(e){this._gui.callFunc("onKeyDown",e)}},{key:"onKeyUp",value:function(e){this._gui.callFunc("onKeyUp",e)}},{key:"onMouseWheel",value:function(e){e.stopPropagation(),e.preventDefault(),this._gui.callFunc("onMouseWheel",e);var t=void 0===e.wheelDelta?-e.detail:e.wheelDelta;this.onDeviceWheel(t>0?1:-1)}},{key:"getFileType",value:function(e){var t=e.toLowerCase();return t.endsWith(".obj")?"obj":t.endsWith(".sgl")?"sgl":t.endsWith(".stl")?"stl":t.endsWith(".ply")?"ply":t.endsWith(".glb")||t.endsWith(".gltf")?"glb":null}},{key:"loadFiles",value:function(e){e.stopPropagation(),e.preventDefault();for(var t=e.dataTransfer?e.dataTransfer.files:e.target.files,r=0,n=t.length;r<n;++r)this.readFile(t[r])}},{key:"readFile",value:function(e){var t=this,r=this.getFileType(e.name);if(r){var n=new FileReader;n.onload=function(e){t.loadScene(e.target.result,r);var n=document.getElementById("fileopen");n&&(n.value="")},"obj"===r?n.readAsText(e):n.readAsArrayBuffer(e)}}}],n&&yu(r.prototype,n),Object.defineProperty(r,"prototype",{writable:!1}),a}(El);window.SculptGL=ku})(),__webpack_exports__})());